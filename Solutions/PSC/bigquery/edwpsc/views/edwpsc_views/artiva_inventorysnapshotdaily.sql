CREATE OR REPLACE VIEW edwpsc_views.`artiva_inventorysnapshotdaily`
AS SELECT
  `artiva_inventorysnapshotdaily`.snapshotdate,
  `artiva_inventorysnapshotdaily`.snapshotdatetime,
  `artiva_inventorysnapshotdaily`.sourcesytem,
  `artiva_inventorysnapshotdaily`.hcpatientaccountingnumber,
  `artiva_inventorysnapshotdaily`.ecwclaimkey,
  `artiva_inventorysnapshotdaily`.ecwclaimnumber,
  `artiva_inventorysnapshotdaily`.ecwregionkey,
  `artiva_inventorysnapshotdaily`.pvclaimkey,
  `artiva_inventorysnapshotdaily`.pvclaimnumber,
  `artiva_inventorysnapshotdaily`.pvregionkey,
  `artiva_inventorysnapshotdaily`.hcenid,
  `artiva_inventorysnapshotdaily`.hcacid,
  `artiva_inventorysnapshotdaily`.hcbalance,
  `artiva_inventorysnapshotdaily`.liabilitybalance,
  `artiva_inventorysnapshotdaily`.primaryfinancialclass,
  `artiva_inventorysnapshotdaily`.liabilityfinancialclass,
  `artiva_inventorysnapshotdaily`.hclastloaddate,
  `artiva_inventorysnapshotdaily`.hclastworkeddate,
  `artiva_inventorysnapshotdaily`.psaccountcomplete,
  `artiva_inventorysnapshotdaily`.hccurrentpayerid,
  `artiva_inventorysnapshotdaily`.lastpool,
  `artiva_inventorysnapshotdaily`.hcsequencenumber,
  `artiva_inventorysnapshotdaily`.pspooldept,
  `artiva_inventorysnapshotdaily`.pspooltype,
  `artiva_inventorysnapshotdaily`.coid,
  `artiva_inventorysnapshotdaily`.rownum,
  `artiva_inventorysnapshotdaily`.hcmedicalrecordnumber,
  `artiva_inventorysnapshotdaily`.hcdateofservice,
  `artiva_inventorysnapshotdaily`.psecwclaimstatus,
  `artiva_inventorysnapshotdaily`.psacprevpool,
  `artiva_inventorysnapshotdaily`.psaclpoolstartdte,
  `artiva_inventorysnapshotdaily`.hcfinalbilldate,
  `artiva_inventorysnapshotdaily`.hcoriginalbalance,
  `artiva_inventorysnapshotdaily`.hctotaladjustments,
  `artiva_inventorysnapshotdaily`.hctotalpayments,
  `artiva_inventorysnapshotdaily`.hctotalcharges,
  `artiva_inventorysnapshotdaily`.hcstatuscode,
  `artiva_inventorysnapshotdaily`.hcdenialcode,
  `artiva_inventorysnapshotdaily`.hcdenialdate,
  `artiva_inventorysnapshotdaily`.hchostbalance,
  `artiva_inventorysnapshotdaily`.hcpayername,
  `artiva_inventorysnapshotdaily`.hcactioncode,
  `artiva_inventorysnapshotdaily`.hcresultcode,
  `artiva_inventorysnapshotdaily`.hcworkdate,
  `artiva_inventorysnapshotdaily`.hcvendorid,
  `artiva_inventorysnapshotdaily`.psmiscvalue,
  `artiva_inventorysnapshotdaily`.hcacpriphase,
  `artiva_inventorysnapshotdaily`.hcacpristatus,
  `artiva_inventorysnapshotdaily`.hcaccountphase,
  `artiva_inventorysnapshotdaily`.hcclaimsubmissiondate,
  `artiva_inventorysnapshotdaily`.last_action_code_time,
  `artiva_inventorysnapshotdaily`.last_action_code_user_id,
  `artiva_inventorysnapshotdaily`.last_action_date,
  `artiva_inventorysnapshotdaily`.pschecknumber,
  `artiva_inventorysnapshotdaily`.pvpracticename,
  `artiva_inventorysnapshotdaily`.hcfadesc,
  `artiva_inventorysnapshotdaily`.voidflag,
  `artiva_inventorysnapshotdaily`.deleteflag,
  `artiva_inventorysnapshotdaily`.arclaimflag,
  `artiva_inventorysnapshotdaily`.liabilityiplankey,
  `artiva_inventorysnapshotdaily`.liabilityownertype,
  `artiva_inventorysnapshotdaily`.primaryiplankey,
  `artiva_inventorysnapshotdaily`.waitdate,
  `artiva_inventorysnapshotdaily`.totalpaymentamt,
  `artiva_inventorysnapshotdaily`.totalinsurancepaymentamt,
  `artiva_inventorysnapshotdaily`.pspyclmtype,
  `artiva_inventorysnapshotdaily`.pspygrprptname,
  `artiva_inventorysnapshotdaily`.last_action_code_time2,
  `artiva_inventorysnapshotdaily`.last_action_code_user_id2,
  `artiva_inventorysnapshotdaily`.last_action_date2,
  `artiva_inventorysnapshotdaily`.tieramt,
  `artiva_inventorysnapshotdaily`.psentierthrshld,
  `artiva_inventorysnapshotdaily`.pspoolconctrlnum,
  `artiva_inventorysnapshotdaily`.dwlastupdatedatetime
  FROM
    edwpsc_base_views.`artiva_inventorysnapshotdaily`
  INNER JOIN edwpsc_base_views.secref_facility
  ON LPAD(TRIM(secref_facility.co_id, ' '), 5, '0') = LPAD(TRIM(`artiva_inventorysnapshotdaily`.coid, ' '), 5, '0')
  AND TRIM(secref_facility.user_id, ' ') = TRIM(session_user(), ' ')
;