CREATE OR REPLACE VIEW edwpsc_views.`pv_factsnapshotpaymentline`
AS SELECT
  `pv_factsnapshotpaymentline`.paymentlinekey,
  `pv_factsnapshotpaymentline`.monthid,
  `pv_factsnapshotpaymentline`.snapshotdate,
  `pv_factsnapshotpaymentline`.claimkey,
  `pv_factsnapshotpaymentline`.servicingproviderkey,
  `pv_factsnapshotpaymentline`.renderingproviderkey,
  `pv_factsnapshotpaymentline`.facilitykey,
  `pv_factsnapshotpaymentline`.iplan1iplankey,
  `pv_factsnapshotpaymentline`.practicekey,
  `pv_factsnapshotpaymentline`.cptcodekey,
  `pv_factsnapshotpaymentline`.claimnumber,
  `pv_factsnapshotpaymentline`.gldepartmentnum,
  `pv_factsnapshotpaymentline`.patientid,
  `pv_factsnapshotpaymentline`.servicingproviderid,
  `pv_factsnapshotpaymentline`.renderingproviderid,
  `pv_factsnapshotpaymentline`.facilityid,
  `pv_factsnapshotpaymentline`.practiceid,
  `pv_factsnapshotpaymentline`.claimdatekey,
  `pv_factsnapshotpaymentline`.servicedatekey,
  `pv_factsnapshotpaymentline`.iplan1id,
  `pv_factsnapshotpaymentline`.financialclasskey,
  `pv_factsnapshotpaymentline`.encounterid,
  `pv_factsnapshotpaymentline`.cptid,
  `pv_factsnapshotpaymentline`.paymentlineid,
  `pv_factsnapshotpaymentline`.paymentdetailid,
  `pv_factsnapshotpaymentline`.paymentid,
  `pv_factsnapshotpaymentline`.checknumber,
  `pv_factsnapshotpaymentline`.checktype,
  `pv_factsnapshotpaymentline`.checkdate,
  `pv_factsnapshotpaymentline`.posteddatekey,
  `pv_factsnapshotpaymentline`.allowedamt,
  `pv_factsnapshotpaymentline`.deductableamt,
  `pv_factsnapshotpaymentline`.coinsuranceamt,
  `pv_factsnapshotpaymentline`.memrespamt,
  `pv_factsnapshotpaymentline`.paymentamt,
  `pv_factsnapshotpaymentline`.contractualadjustmentamt,
  `pv_factsnapshotpaymentline`.withheldamt,
  `pv_factsnapshotpaymentline`.msgcode,
  `pv_factsnapshotpaymentline`.eraadjustmentamt,
  `pv_factsnapshotpaymentline`.linetaxamt,
  `pv_factsnapshotpaymentline`.paymentfromid,
  `pv_factsnapshotpaymentline`.paymenttypekey,
  `pv_factsnapshotpaymentline`.cptcode,
  `pv_factsnapshotpaymentline`.cptstartservicedatekey,
  `pv_factsnapshotpaymentline`.cptendservicedatekey,
  `pv_factsnapshotpaymentline`.cptorder,
  `pv_factsnapshotpaymentline`.cptdeleletedline,
  `pv_factsnapshotpaymentline`.cptunits,
  `pv_factsnapshotpaymentline`.cptmodifier1,
  `pv_factsnapshotpaymentline`.cptmodifier2,
  `pv_factsnapshotpaymentline`.cptchargesamt,
  `pv_factsnapshotpaymentline`.paymentlinecreatedate,
  `pv_factsnapshotpaymentline`.paymentlinemodifieddate,
  `pv_factsnapshotpaymentline`.paymentclaimcreatedate,
  `pv_factsnapshotpaymentline`.paymentclaimmodifieddate,
  `pv_factsnapshotpaymentline`.regionkey,
  `pv_factsnapshotpaymentline`.coid
  FROM
    edwpsc_base_views.`pv_factsnapshotpaymentline`
  INNER JOIN edwpsc_base_views.secref_facility
  ON LPAD(TRIM(secref_facility.co_id, ' '), 5, '0') = LPAD(TRIM(`pv_factsnapshotpaymentline`.coid, ' '), 5, '0')
  AND TRIM(secref_facility.user_id, ' ') = TRIM(session_user(), ' ')
;