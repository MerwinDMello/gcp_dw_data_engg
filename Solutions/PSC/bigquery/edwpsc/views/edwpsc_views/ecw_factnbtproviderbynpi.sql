CREATE OR REPLACE VIEW edwpsc_views.`ecw_factnbtproviderbynpi`
AS SELECT
  `ecw_factnbtproviderbynpi`.snapshotdatekey,
  `ecw_factnbtproviderbynpi`.providersourcesystemkey,
  `ecw_factnbtproviderbynpi`.gldepartmentnumber,
  `ecw_factnbtproviderbynpi`.coid,
  `ecw_factnbtproviderbynpi`.providerfirstname,
  `ecw_factnbtproviderbynpi`.providerlastname,
  `ecw_factnbtproviderbynpi`.providermiddlename,
  `ecw_factnbtproviderbynpi`.providernpi,
  `ecw_factnbtproviderbynpi`.providerupin,
  `ecw_factnbtproviderbynpi`.companycode,
  `ecw_factnbtproviderbynpi`.providerrelationshipname,
  `ecw_factnbtproviderbynpi`.specialtyname,
  `ecw_factnbtproviderbynpi`.specialtytype,
  `ecw_factnbtproviderbynpi`.compensationtype,
  `ecw_factnbtproviderbynpi`.budgetccindicator,
  `ecw_factnbtproviderbynpi`.departmentname,
  `ecw_factnbtproviderbynpi`.providerassignedstartdate,
  `ecw_factnbtproviderbynpi`.isapprovedindicator,
  `ecw_factnbtproviderbynpi`.gllastupdateddate,
  `ecw_factnbtproviderbynpi`.gllastupdatedby,
  `ecw_factnbtproviderbynpi`.providerstatusindicator,
  `ecw_factnbtproviderbynpi`.statuschangedate,
  `ecw_factnbtproviderbynpi`.providerstartdate,
  `ecw_factnbtproviderbynpi`.ancillarydepartmentnumber,
  `ecw_factnbtproviderbynpi`.budgetstartdate,
  `ecw_factnbtproviderbynpi`.communitystatus,
  `ecw_factnbtproviderbynpi`.contractpayconversiondate,
  `ecw_factnbtproviderbynpi`.contractcompensationtype,
  `ecw_factnbtproviderbynpi`.contractcurrentpay,
  `ecw_factnbtproviderbynpi`.contracteffectivedate,
  `ecw_factnbtproviderbynpi`.contractexpirationdate,
  `ecw_factnbtproviderbynpi`.ftecount,
  `ecw_factnbtproviderbynpi`.hospitalistindicator,
  `ecw_factnbtproviderbynpi`.multipleproviderdepartmentindicator,
  `ecw_factnbtproviderbynpi`.newreplacementname,
  `ecw_factnbtproviderbynpi`.overheaddepartmentnumber,
  `ecw_factnbtproviderbynpi`.practiceestablishedbyprocessname,
  `ecw_factnbtproviderbynpi`.productivityreason,
  `ecw_factnbtproviderbynpi`.productivitylevelfuture,
  `ecw_factnbtproviderbynpi`.productivityleveltoday,
  `ecw_factnbtproviderbynpi`.productivitystatus,
  `ecw_factnbtproviderbynpi`.datechangedtoproductivity,
  `ecw_factnbtproviderbynpi`.technicallevel,
  `ecw_factnbtproviderbynpi`.projectedterminationdate,
  `ecw_factnbtproviderbynpi`.strategyname,
  `ecw_factnbtproviderbynpi`.strategytypename,
  `ecw_factnbtproviderbynpi`.strategytypereason,
  `ecw_factnbtproviderbynpi`.terminationreason,
  `ecw_factnbtproviderbynpi`.terminationresult,
  `ecw_factnbtproviderbynpi`.terminationtype,
  `ecw_factnbtproviderbynpi`.morproviderstatusid,
  `ecw_factnbtproviderbynpi`.datasourcecode,
  `ecw_factnbtproviderbynpi`.sourcesystemcode,
  `ecw_factnbtproviderbynpi`.countproviderindicator,
  `ecw_factnbtproviderbynpi`.providerlastupdateddate,
  `ecw_factnbtproviderbynpi`.providerlastupdatedby,
  `ecw_factnbtproviderbynpi`.samestoreindicator,
  `ecw_factnbtproviderbynpi`.insertedby,
  `ecw_factnbtproviderbynpi`.inserteddtm,
  `ecw_factnbtproviderbynpi`.dwlastupdatedatetime
  FROM
    edwpsc_base_views.`ecw_factnbtproviderbynpi`
  INNER JOIN edwpsc_base_views.secref_facility
  ON LPAD(TRIM(secref_facility.co_id, ' '), 5, '0') = LPAD(TRIM(`ecw_factnbtproviderbynpi`.coid, ' '), 5, '0')
  AND TRIM(secref_facility.user_id, ' ') = TRIM(session_user(), ' ')
;