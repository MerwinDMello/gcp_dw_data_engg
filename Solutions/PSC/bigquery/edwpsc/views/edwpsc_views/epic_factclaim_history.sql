CREATE OR REPLACE VIEW edwpsc_views.`epic_factclaim_history`
AS SELECT
  `epic_factclaim_history`.claimkey,
  `epic_factclaim_history`.claimnumber,
  `epic_factclaim_history`.coid,
  `epic_factclaim_history`.regionkey,
  `epic_factclaim_history`.claimdatekey,
  `epic_factclaim_history`.servicedatekey,
  `epic_factclaim_history`.patientkey,
  `epic_factclaim_history`.guarantorpatientkey,
  `epic_factclaim_history`.servicingproviderkey,
  `epic_factclaim_history`.renderingproviderkey,
  `epic_factclaim_history`.paytoproviderkey,
  `epic_factclaim_history`.supervisorproviderkey,
  `epic_factclaim_history`.addprovider1providerkey,
  `epic_factclaim_history`.addprovider2providerkey,
  `epic_factclaim_history`.liabilitydatekey,
  `epic_factclaim_history`.liabilityiplankey,
  `epic_factclaim_history`.billedtoid,
  `epic_factclaim_history`.billedtotype,
  `epic_factclaim_history`.facilitykey,
  `epic_factclaim_history`.claimstatuskey,
  `epic_factclaim_history`.encounterkey,
  `epic_factclaim_history`.encounterid,
  `epic_factclaim_history`.encounterform,
  `epic_factclaim_history`.visitnumber,
  `epic_factclaim_history`.accountid,
  `epic_factclaim_history`.totalchargesamt,
  `epic_factclaim_history`.totalbalanceamt,
  `epic_factclaim_history`.totalpatientbalanceamt,
  `epic_factclaim_history`.totalinsurancebalanceamt,
  `epic_factclaim_history`.totalpatientbalanceminuspatientiplansamt,
  `epic_factclaim_history`.totalpaymentsamt,
  `epic_factclaim_history`.totalinsurancepaymentsamt,
  `epic_factclaim_history`.totalpatientpaymentsamt,
  `epic_factclaim_history`.totaladjustmentsamt,
  `epic_factclaim_history`.totaluncoveredamt,
  `epic_factclaim_history`.totalallowedamt,
  `epic_factclaim_history`.totalpatientresponsibilityamt,
  `epic_factclaim_history`.totalestimatedpatientbalanceamt,
  `epic_factclaim_history`.totalpaymentsandadjustmentsamt,
  `epic_factclaim_history`.voidflag,
  `epic_factclaim_history`.deleteflag,
  `epic_factclaim_history`.coidconfigurationkey,
  `epic_factclaim_history`.claimcreatedbyuserkey,
  `epic_factclaim_history`.claimqueueid,
  `epic_factclaim_history`.referringproviderkey,
  `epic_factclaim_history`.referringproviderid,
  `epic_factclaim_history`.referringprovidertype,
  `epic_factclaim_history`.copay,
  `epic_factclaim_history`.arclaimflag,
  `epic_factclaim_history`.voidedclaimreversedclaimnumber,
  `epic_factclaim_history`.voidedclaimcopyclaimnumber,
  `epic_factclaim_history`.voidedclaimoriginalclaimnumber,
  `epic_factclaim_history`.sourceaprimarykeyvalue,
  `epic_factclaim_history`.sourcearecordlastupdated,
  `epic_factclaim_history`.sourceachangedflag,
  `epic_factclaim_history`.dwlastupdatedatetime,
  `epic_factclaim_history`.sourcesystemcode,
  `epic_factclaim_history`.insertedby,
  `epic_factclaim_history`.inserteddtm,
  `epic_factclaim_history`.modifiedby,
  `epic_factclaim_history`.modifieddtm,
  `epic_factclaim_history`.claimlock,
  `epic_factclaim_history`.claimtypeflag,
  `epic_factclaim_history`.accidentindflag,
  `epic_factclaim_history`.accidentstate,
  `epic_factclaim_history`.accidenthour,
  `epic_factclaim_history`.accidentrel,
  `epic_factclaim_history`.symindflag,
  `epic_factclaim_history`.symdatekey,
  `epic_factclaim_history`.emprelated,
  `epic_factclaim_history`.admitdatekey,
  `epic_factclaim_history`.dischargedatekey,
  `epic_factclaim_history`.splpgmid,
  `epic_factclaim_history`.epsdtreferral,
  `epic_factclaim_history`.epsdtrefsts,
  `epic_factclaim_history`.crimerelatedflag,
  `epic_factclaim_history`.docsentdatekey,
  `epic_factclaim_history`.pwk06,
  `epic_factclaim_history`.pregindctorflag,
  `epic_factclaim_history`.relinfodatekey,
  `epic_factclaim_history`.relinfoind,
  `epic_factclaim_history`.labchargesamt,
  `epic_factclaim_history`.labindflag,
  `epic_factclaim_history`.patientid,
  `epic_factclaim_history`.patientinternalid,
  `epic_factclaim_history`.servicingproviderid,
  `epic_factclaim_history`.renderingproviderid,
  `epic_factclaim_history`.paytoproviderid,
  `epic_factclaim_history`.supervisorproviderid,
  `epic_factclaim_history`.addprovider1providerid,
  `epic_factclaim_history`.addprovider2providerid,
  `epic_factclaim_history`.facilityid,
  `epic_factclaim_history`.practiceid,
  `epic_factclaim_history`.claimcreatedbyid,
  `epic_factclaim_history`.deptcode,
  `epic_factclaim_history`.payer1iplankey,
  `epic_factclaim_history`.payer1iplanid,
  `epic_factclaim_history`.payer1financialclasskey,
  `epic_factclaim_history`.payer2iplankey,
  `epic_factclaim_history`.payer2iplanid,
  `epic_factclaim_history`.payer2financialclasskey,
  `epic_factclaim_history`.payer3iplankey,
  `epic_factclaim_history`.payer3iplanid,
  `epic_factclaim_history`.payer3financialclasskey,
  `epic_factclaim_history`.collectionstatus,
  `epic_factclaim_history`.collectioncodechangedate,
  `epic_factclaim_history`.collectioncode,
  `epic_factclaim_history`.collectioncodechangedatedate,
  `epic_factclaim_history`.collectionstatusaging,
  `epic_factclaim_history`.serviceareakey,
  `epic_factclaim_history`.billareakey,
  `epic_factclaim_history`.claimbilledflag,
  `epic_factclaim_history`.sourcebprimarykeyvalue,
  `epic_factclaim_history`.holdcode,
  `epic_factclaim_history`.payer1epicfinancialclass,
  `epic_factclaim_history`.payer1epicfinancialclassdesc,
  `epic_factclaim_history`.sourcecprimarykeyvalue,
  `epic_factclaim_history`.totalholdbalanceamt,
  `epic_factclaim_history`.prearflag,
  `epic_factclaim_history`.totalprearbalanceamt,
  `epic_factclaim_history`.sysstarttime,
  `epic_factclaim_history`.sysendtime
  FROM
    edwpsc_base_views.`epic_factclaim_history`
  INNER JOIN edwpsc_base_views.secref_facility
  ON LPAD(TRIM(secref_facility.co_id, ' '), 5, '0') = LPAD(TRIM(`epic_factclaim_history`.coid, ' '), 5, '0')
  AND TRIM(secref_facility.user_id, ' ') = TRIM(session_user(), ' ')
;