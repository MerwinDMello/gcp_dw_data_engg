CREATE OR REPLACE VIEW edwpsc_views.`epic_factriskanalysis`
AS SELECT
  `epic_factriskanalysis`.riskloaddatekey,
  `epic_factriskanalysis`.claimcategory,
  `epic_factriskanalysis`.claimnumber,
  `epic_factriskanalysis`.claimkey,
  `epic_factriskanalysis`.regionkey,
  `epic_factriskanalysis`.coid,
  `epic_factriskanalysis`.coidlob,
  `epic_factriskanalysis`.coidname,
  `epic_factriskanalysis`.deptcode,
  `epic_factriskanalysis`.marketname,
  `epic_factriskanalysis`.divisionname,
  `epic_factriskanalysis`.groupname,
  `epic_factriskanalysis`.renderingprovidernpi,
  `epic_factriskanalysis`.payerfinancialclass,
  `epic_factriskanalysis`.ppipayorfinancialclass,
  `epic_factriskanalysis`.cpid,
  `epic_factriskanalysis`.facilityid,
  `epic_factriskanalysis`.practicefederaltaxid,
  `epic_factriskanalysis`.epicholdcodeid,
  `epic_factriskanalysis`.epicholdcodedescription,
  `epic_factriskanalysis`.epicholdcodetype,
  `epic_factriskanalysis`.claimpayorid,
  `epic_factriskanalysis`.claimpayorname,
  `epic_factriskanalysis`.claimpayorauthorizationnumber,
  `epic_factriskanalysis`.servicedatekey,
  `epic_factriskanalysis`.claimage,
  `epic_factriskanalysis`.claimlastreleaseddate,
  `epic_factriskanalysis`.totalbalanceamt,
  `epic_factriskanalysis`.totalchargesamt,
  `epic_factriskanalysis`.renderingprovider,
  `epic_factriskanalysis`.providerkey,
  `epic_factriskanalysis`.cactusdivisionname,
  `epic_factriskanalysis`.providerfirstname,
  `epic_factriskanalysis`.providerlastname,
  `epic_factriskanalysis`.providermiddlename,
  `epic_factriskanalysis`.providernpi,
  `epic_factriskanalysis`.providerstartdate,
  `epic_factriskanalysis`.providernotificationdate,
  `epic_factriskanalysis`.providerlastrfcreceiveddate,
  `epic_factriskanalysis`.groupkey,
  `epic_factriskanalysis`.providergroupname,
  `epic_factriskanalysis`.groupdba,
  `epic_factriskanalysis`.groupenrollmentoperation,
  `epic_factriskanalysis`.provideraddresstype,
  `epic_factriskanalysis`.practiceaddressline1,
  `epic_factriskanalysis`.practiceaddressline2,
  `epic_factriskanalysis`.practicecity,
  `epic_factriskanalysis`.practicestate,
  `epic_factriskanalysis`.practicezip,
  `epic_factriskanalysis`.practicetaxid,
  `epic_factriskanalysis`.ppikey,
  `epic_factriskanalysis`.ppieffectivedate,
  `epic_factriskanalysis`.ppidepartmentflag,
  `epic_factriskanalysis`.ppicpidpayorname,
  `epic_factriskanalysis`.ppicpidpayorid,
  `epic_factriskanalysis`.payorsplitbylocationflag,
  `epic_factriskanalysis`.ppitype,
  `epic_factriskanalysis`.ppistatus,
  `epic_factriskanalysis`.ppistatusdescription,
  `epic_factriskanalysis`.ppiphase,
  `epic_factriskanalysis`.ppienrollmentaction,
  `epic_factriskanalysis`.ppileadgrouptaxid,
  `epic_factriskanalysis`.ppialternateeffectivedate,
  `epic_factriskanalysis`.ppistatusdate,
  `epic_factriskanalysis`.ppilastworkeddate,
  `epic_factriskanalysis`.ppiapplicationsenttopayordate,
  `epic_factriskanalysis`.ppiapplicationreceivedfrompayordate,
  `epic_factriskanalysis`.ppiapplicationsenttoproviderdate,
  `epic_factriskanalysis`.ppiapplicationreceivedfromproviderdate,
  `epic_factriskanalysis`.riskstatus,
  `epic_factriskanalysis`.risksubcategory,
  `epic_factriskanalysis`.psgriskstatus,
  `epic_factriskanalysis`.insertedby,
  `epic_factriskanalysis`.inserteddtm,
  `epic_factriskanalysis`.modifiedby,
  `epic_factriskanalysis`.modifieddtm,
  `epic_factriskanalysis`.dwlastupdatedatetime
  FROM
    edwpsc_base_views.`epic_factriskanalysis`
  INNER JOIN edwpsc_base_views.secref_facility
  ON LPAD(TRIM(secref_facility.co_id, ' '), 5, '0') = LPAD(TRIM(`epic_factriskanalysis`.coid, ' '), 5, '0')
  AND TRIM(secref_facility.user_id, ' ') = TRIM(session_user(), ' ')
;