CREATE OR REPLACE VIEW edwpsc_views.`pv_factsnapshotar`
AS SELECT
  `pv_factsnapshotar`.arkey,
  `pv_factsnapshotar`.monthid,
  `pv_factsnapshotar`.snapshotdate,
  `pv_factsnapshotar`.claimkey,
  `pv_factsnapshotar`.claimnumber,
  `pv_factsnapshotar`.regionkey,
  `pv_factsnapshotar`.coid,
  `pv_factsnapshotar`.gldepartment,
  `pv_factsnapshotar`.servicingproviderkey,
  `pv_factsnapshotar`.servicingproviderid,
  `pv_factsnapshotar`.patientkey,
  `pv_factsnapshotar`.patientid,
  `pv_factsnapshotar`.facilitykey,
  `pv_factsnapshotar`.facilityid,
  `pv_factsnapshotar`.renderingproviderkey,
  `pv_factsnapshotar`.renderingproviderid,
  `pv_factsnapshotar`.claimdatekey,
  `pv_factsnapshotar`.claimdatemonthid,
  `pv_factsnapshotar`.servicedatekey,
  `pv_factsnapshotar`.servicedatemonthid,
  `pv_factsnapshotar`.practicekey,
  `pv_factsnapshotar`.practiceid,
  `pv_factsnapshotar`.claimstatuskey,
  `pv_factsnapshotar`.claimstatusdesc,
  `pv_factsnapshotar`.financialclasskey,
  `pv_factsnapshotar`.liabilityfinancialclass,
  `pv_factsnapshotar`.billedfirstsubmitteddatekey,
  `pv_factsnapshotar`.billedlastsubmitteddatekey,
  `pv_factsnapshotar`.iplan1iplankey,
  `pv_factsnapshotar`.iplan1id,
  `pv_factsnapshotar`.iplan2iplankey,
  `pv_factsnapshotar`.iplan2id,
  `pv_factsnapshotar`.iplan3iplankey,
  `pv_factsnapshotar`.iplan3id,
  `pv_factsnapshotar`.liabilityiplankey,
  `pv_factsnapshotar`.liabilityid,
  `pv_factsnapshotar`.liabilitydate,
  `pv_factsnapshotar`.liabilityownertype,
  `pv_factsnapshotar`.lastpaymentdatekey,
  `pv_factsnapshotar`.firstinsurancepaymentdatekey,
  `pv_factsnapshotar`.lastinsurancepaymentdatekey,
  `pv_factsnapshotar`.lastadjustmentdatekey,
  `pv_factsnapshotar`.laststatusdatekey,
  `pv_factsnapshotar`.totalchargesamt,
  `pv_factsnapshotar`.totalbalanceamt,
  `pv_factsnapshotar`.totalpatientbalanceamt,
  `pv_factsnapshotar`.totalinsurancebalanceamt,
  `pv_factsnapshotar`.totalpaymentsamt,
  `pv_factsnapshotar`.totalpatientpaymentsamt,
  `pv_factsnapshotar`.totalinsurancepaymentsamt,
  `pv_factsnapshotar`.totaladjustmentsamt,
  `pv_factsnapshotar`.dwlastupdatedatetime,
  `pv_factsnapshotar`.sourcesystemcode,
  `pv_factsnapshotar`.insertedby,
  `pv_factsnapshotar`.inserteddtm,
  `pv_factsnapshotar`.modifiedby,
  `pv_factsnapshotar`.modifieddtm,
  `pv_factsnapshotar`.billedtoidtype,
  `pv_factsnapshotar`.claimbilledflag,
  `pv_factsnapshotar`.claimarflag,
  `pv_factsnapshotar`.deleteflag,
  `pv_factsnapshotar`.voidflag,
  `pv_factsnapshotar`.addprovider1providerkey,
  `pv_factsnapshotar`.addprovider2providerkey,
  `pv_factsnapshotar`.supervisorproviderkey,
  `pv_factsnapshotar`.paytoproviderkey,
  `pv_factsnapshotar`.addprovider1providerid,
  `pv_factsnapshotar`.addprovider2providerid,
  `pv_factsnapshotar`.supervisorproviderid,
  `pv_factsnapshotar`.paytoproviderid,
  `pv_factsnapshotar`.collectionstatus,
  `pv_factsnapshotar`.collectioncode,
  `pv_factsnapshotar`.collectioncodechangedate,
  `pv_factsnapshotar`.linebalanceamt,
  `pv_factsnapshotar`.holdcode,
  `pv_factsnapshotar`.firstpatientliabilitydatekey,
  `pv_factsnapshotar`.firstzerobalancedatekey,
  `pv_factsnapshotar`.firstchargedebitdatekey
  FROM
    edwpsc_base_views.`pv_factsnapshotar`
  INNER JOIN edwpsc_base_views.secref_facility
  ON LPAD(TRIM(secref_facility.co_id, ' '), 5, '0') = LPAD(TRIM(`pv_factsnapshotar`.coid, ' '), 5, '0')
  AND TRIM(secref_facility.user_id, ' ') = TRIM(session_user(), ' ')
;