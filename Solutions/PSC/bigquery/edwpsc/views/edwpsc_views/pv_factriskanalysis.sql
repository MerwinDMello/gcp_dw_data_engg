CREATE OR REPLACE VIEW edwpsc_views.`pv_factriskanalysis`
AS SELECT
  `pv_factriskanalysis`.riskanalysiskey,
  `pv_factriskanalysis`.riskloaddatekey,
  `pv_factriskanalysis`.claimcategory,
  `pv_factriskanalysis`.claimnumber,
  `pv_factriskanalysis`.claimkey,
  `pv_factriskanalysis`.regionkey,
  `pv_factriskanalysis`.coid,
  `pv_factriskanalysis`.coidlob,
  `pv_factriskanalysis`.coiddeptnum,
  `pv_factriskanalysis`.coidname,
  `pv_factriskanalysis`.marketname,
  `pv_factriskanalysis`.divisionname,
  `pv_factriskanalysis`.groupname,
  `pv_factriskanalysis`.renderingprovidernpi,
  `pv_factriskanalysis`.payerfinancialclass,
  `pv_factriskanalysis`.cpid,
  `pv_factriskanalysis`.facilityid,
  `pv_factriskanalysis`.practicefederaltaxid,
  `pv_factriskanalysis`.artivaruleid,
  `pv_factriskanalysis`.artivaruledesc,
  `pv_factriskanalysis`.artivarulecreatedate,
  `pv_factriskanalysis`.artivarulelastupdatedate,
  `pv_factriskanalysis`.artivaruleglobalflag,
  `pv_factriskanalysis`.artivaholdcodeid,
  `pv_factriskanalysis`.artivaholdcodedescription,
  `pv_factriskanalysis`.artivaholdcodetype,
  `pv_factriskanalysis`.claimpayorid,
  `pv_factriskanalysis`.claimpayorname,
  `pv_factriskanalysis`.claimpayorauthorizationnumber,
  `pv_factriskanalysis`.servicedatekey,
  `pv_factriskanalysis`.claimage,
  `pv_factriskanalysis`.claimlastreleaseddate,
  `pv_factriskanalysis`.totalbalanceamt,
  `pv_factriskanalysis`.totalchargesamt,
  `pv_factriskanalysis`.renderingprovider,
  `pv_factriskanalysis`.providerkey,
  `pv_factriskanalysis`.cactusdivisionname,
  `pv_factriskanalysis`.providerfirstname,
  `pv_factriskanalysis`.providerlastname,
  `pv_factriskanalysis`.providermiddlename,
  `pv_factriskanalysis`.providernpi,
  `pv_factriskanalysis`.providerstartdate,
  `pv_factriskanalysis`.providernotificationdate,
  `pv_factriskanalysis`.providerlastrfcreceiveddate,
  `pv_factriskanalysis`.groupkey,
  `pv_factriskanalysis`.providergroupname,
  `pv_factriskanalysis`.groupdba,
  `pv_factriskanalysis`.groupenrollmentoperation,
  `pv_factriskanalysis`.provideraddresstype,
  `pv_factriskanalysis`.practiceaddressline1,
  `pv_factriskanalysis`.practiceaddressline2,
  `pv_factriskanalysis`.practicecity,
  `pv_factriskanalysis`.practicestate,
  `pv_factriskanalysis`.practicezip,
  `pv_factriskanalysis`.practicetaxid,
  `pv_factriskanalysis`.ppikey,
  `pv_factriskanalysis`.ppieffectivedate,
  `pv_factriskanalysis`.ppidepartmentflag,
  `pv_factriskanalysis`.ppicpidpayorname,
  `pv_factriskanalysis`.ppicpidpayorid,
  `pv_factriskanalysis`.payorsplitbylocationflag,
  `pv_factriskanalysis`.ppitype,
  `pv_factriskanalysis`.ppistatus,
  `pv_factriskanalysis`.ppistatusdescription,
  `pv_factriskanalysis`.ppiphase,
  `pv_factriskanalysis`.ppienrollmentaction,
  `pv_factriskanalysis`.ppileadgrouptaxid,
  `pv_factriskanalysis`.ppialternateeffectivedate,
  `pv_factriskanalysis`.ppistatusdate,
  `pv_factriskanalysis`.ppilastworkeddate,
  `pv_factriskanalysis`.ppiapplicationsenttopayordate,
  `pv_factriskanalysis`.ppiapplicationreceivedfrompayordate,
  `pv_factriskanalysis`.ppiapplicationsenttoproviderdate,
  `pv_factriskanalysis`.ppiapplicationreceivedfromproviderdate,
  `pv_factriskanalysis`.riskstatus,
  `pv_factriskanalysis`.risksubcategory,
  `pv_factriskanalysis`.psgriskstatus,
  `pv_factriskanalysis`.insertedby,
  `pv_factriskanalysis`.inserteddtm,
  `pv_factriskanalysis`.modifiedby,
  `pv_factriskanalysis`.modifieddtm
  FROM
    edwpsc_base_views.`pv_factriskanalysis`
  INNER JOIN edwpsc_base_views.secref_facility
  ON LPAD(TRIM(secref_facility.co_id, ' '), 5, '0') = LPAD(TRIM(`pv_factriskanalysis`.coid, ' '), 5, '0')
  AND TRIM(secref_facility.user_id, ' ') = TRIM(session_user(), ' ')
;