CREATE OR REPLACE VIEW edwpsc_views.`ecw_factsnapshotar`
AS SELECT
  `ecw_factsnapshotar`.arkey,
  `ecw_factsnapshotar`.monthid,
  `ecw_factsnapshotar`.snapshotdate,
  `ecw_factsnapshotar`.claimkey,
  `ecw_factsnapshotar`.claimnumber,
  `ecw_factsnapshotar`.regionkey,
  `ecw_factsnapshotar`.coid,
  `ecw_factsnapshotar`.gldepartment,
  `ecw_factsnapshotar`.servicingproviderkey,
  `ecw_factsnapshotar`.servicingproviderid,
  `ecw_factsnapshotar`.patientkey,
  `ecw_factsnapshotar`.patientid,
  `ecw_factsnapshotar`.facilitykey,
  `ecw_factsnapshotar`.facilityid,
  `ecw_factsnapshotar`.renderingproviderkey,
  `ecw_factsnapshotar`.renderingproviderid,
  `ecw_factsnapshotar`.claimdatekey,
  `ecw_factsnapshotar`.claimdatemonthid,
  `ecw_factsnapshotar`.servicedatekey,
  `ecw_factsnapshotar`.servicedatemonthid,
  `ecw_factsnapshotar`.practicekey,
  `ecw_factsnapshotar`.practiceid,
  `ecw_factsnapshotar`.claimstatuskey,
  `ecw_factsnapshotar`.claimstatusdesc,
  `ecw_factsnapshotar`.financialclasskey,
  `ecw_factsnapshotar`.liabilityfinancialclass,
  `ecw_factsnapshotar`.billedfirstsubmitteddatekey,
  `ecw_factsnapshotar`.billedlastsubmitteddatekey,
  `ecw_factsnapshotar`.iplan1iplankey,
  `ecw_factsnapshotar`.iplan1id,
  `ecw_factsnapshotar`.iplan2iplankey,
  `ecw_factsnapshotar`.iplan2id,
  `ecw_factsnapshotar`.iplan3iplankey,
  `ecw_factsnapshotar`.iplan3id,
  `ecw_factsnapshotar`.liabilityiplankey,
  `ecw_factsnapshotar`.liabilityid,
  `ecw_factsnapshotar`.liabilitydate,
  `ecw_factsnapshotar`.liabilityownertype,
  `ecw_factsnapshotar`.lastpaymentdatekey,
  `ecw_factsnapshotar`.firstinsurancepaymentdatekey,
  `ecw_factsnapshotar`.lastinsurancepaymentdatekey,
  `ecw_factsnapshotar`.lastadjustmentdatekey,
  `ecw_factsnapshotar`.laststatusdatekey,
  `ecw_factsnapshotar`.totalchargesamt,
  `ecw_factsnapshotar`.totalbalanceamt,
  `ecw_factsnapshotar`.totalpatientbalanceamt,
  `ecw_factsnapshotar`.totalinsurancebalanceamt,
  `ecw_factsnapshotar`.totalpaymentsamt,
  `ecw_factsnapshotar`.totalpatientpaymentsamt,
  `ecw_factsnapshotar`.totalinsurancepaymentsamt,
  `ecw_factsnapshotar`.totaladjustmentsamt,
  `ecw_factsnapshotar`.dwlastupdatedatetime,
  `ecw_factsnapshotar`.sourcesystemcode,
  `ecw_factsnapshotar`.insertedby,
  `ecw_factsnapshotar`.inserteddtm,
  `ecw_factsnapshotar`.modifiedby,
  `ecw_factsnapshotar`.modifieddtm,
  `ecw_factsnapshotar`.billedtoidtype,
  `ecw_factsnapshotar`.claimarflag,
  `ecw_factsnapshotar`.deleteflag,
  `ecw_factsnapshotar`.voidflag,
  `ecw_factsnapshotar`.addprovider1providerkey,
  `ecw_factsnapshotar`.addprovider2providerkey,
  `ecw_factsnapshotar`.supervisorproviderkey,
  `ecw_factsnapshotar`.paytoproviderkey,
  `ecw_factsnapshotar`.addprovider1providerid,
  `ecw_factsnapshotar`.addprovider2providerid,
  `ecw_factsnapshotar`.supervisorproviderid,
  `ecw_factsnapshotar`.paytoproviderid,
  `ecw_factsnapshotar`.collectionstatus,
  `ecw_factsnapshotar`.collectioncode,
  `ecw_factsnapshotar`.collectioncodechangedate,
  `ecw_factsnapshotar`.firstpatientliabilitydatekey,
  `ecw_factsnapshotar`.firstzerobalancedatekey,
  `ecw_factsnapshotar`.firstchargedebitdatekey
  FROM
    edwpsc_base_views.`ecw_factsnapshotar`
  INNER JOIN edwpsc_base_views.secref_facility
  ON LPAD(TRIM(secref_facility.co_id, ' '), 5, '0') = LPAD(TRIM(`ecw_factsnapshotar`.coid, ' '), 5, '0')
  AND TRIM(secref_facility.user_id, ' ') = TRIM(session_user(), ' ')
;