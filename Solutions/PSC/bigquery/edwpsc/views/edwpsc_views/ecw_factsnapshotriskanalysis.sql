CREATE OR REPLACE VIEW edwpsc_views.`ecw_factsnapshotriskanalysis`
AS SELECT
  `ecw_factsnapshotriskanalysis`.riskanalysiskey,
  `ecw_factsnapshotriskanalysis`.snapshotdate,
  `ecw_factsnapshotriskanalysis`.riskloaddatedatekey,
  `ecw_factsnapshotriskanalysis`.claimcategory,
  `ecw_factsnapshotriskanalysis`.claimnumber,
  `ecw_factsnapshotriskanalysis`.claimkey,
  `ecw_factsnapshotriskanalysis`.regionkey,
  `ecw_factsnapshotriskanalysis`.coid,
  `ecw_factsnapshotriskanalysis`.coidlob,
  `ecw_factsnapshotriskanalysis`.coiddeptnum,
  `ecw_factsnapshotriskanalysis`.coidname,
  `ecw_factsnapshotriskanalysis`.marketname,
  `ecw_factsnapshotriskanalysis`.divisionname,
  `ecw_factsnapshotriskanalysis`.groupname,
  `ecw_factsnapshotriskanalysis`.renderingprovidernpi,
  `ecw_factsnapshotriskanalysis`.payerfinancialclass,
  `ecw_factsnapshotriskanalysis`.cpid,
  `ecw_factsnapshotriskanalysis`.facilityid,
  `ecw_factsnapshotriskanalysis`.practicefederaltaxid,
  `ecw_factsnapshotriskanalysis`.artivaruleid,
  `ecw_factsnapshotriskanalysis`.artivaruledesc,
  `ecw_factsnapshotriskanalysis`.artivarulecreatedate,
  `ecw_factsnapshotriskanalysis`.artivarulelastupdatedate,
  `ecw_factsnapshotriskanalysis`.artivaruleglobalflag,
  `ecw_factsnapshotriskanalysis`.artivaholdcodeid,
  `ecw_factsnapshotriskanalysis`.artivaholdcodedescription,
  `ecw_factsnapshotriskanalysis`.artivaholdcodetype,
  `ecw_factsnapshotriskanalysis`.claimpayorid,
  `ecw_factsnapshotriskanalysis`.claimpayorname,
  `ecw_factsnapshotriskanalysis`.claimpayorauthorizationnumber,
  `ecw_factsnapshotriskanalysis`.servicedatekey,
  `ecw_factsnapshotriskanalysis`.claimage,
  `ecw_factsnapshotriskanalysis`.claimlastreleaseddate,
  `ecw_factsnapshotriskanalysis`.totalbalanceamt,
  `ecw_factsnapshotriskanalysis`.totalchargesamt,
  `ecw_factsnapshotriskanalysis`.renderingprovider,
  `ecw_factsnapshotriskanalysis`.providerkey,
  `ecw_factsnapshotriskanalysis`.cactusdivisionname,
  `ecw_factsnapshotriskanalysis`.providerfirstname,
  `ecw_factsnapshotriskanalysis`.providerlastname,
  `ecw_factsnapshotriskanalysis`.providermiddlename,
  `ecw_factsnapshotriskanalysis`.providernpi,
  `ecw_factsnapshotriskanalysis`.providerstartdate,
  `ecw_factsnapshotriskanalysis`.providernotificationdate,
  `ecw_factsnapshotriskanalysis`.providerlastrfcreceiveddate,
  `ecw_factsnapshotriskanalysis`.groupkey,
  `ecw_factsnapshotriskanalysis`.providergroupname,
  `ecw_factsnapshotriskanalysis`.groupdba,
  `ecw_factsnapshotriskanalysis`.groupenrollmentoperation,
  `ecw_factsnapshotriskanalysis`.provideraddresstype,
  `ecw_factsnapshotriskanalysis`.practiceaddressline1,
  `ecw_factsnapshotriskanalysis`.practiceaddressline2,
  `ecw_factsnapshotriskanalysis`.practicecity,
  `ecw_factsnapshotriskanalysis`.practicestate,
  `ecw_factsnapshotriskanalysis`.practicezip,
  `ecw_factsnapshotriskanalysis`.practicetaxid,
  `ecw_factsnapshotriskanalysis`.ppikey,
  `ecw_factsnapshotriskanalysis`.ppieffectivedate,
  `ecw_factsnapshotriskanalysis`.ppidepartmentflag,
  `ecw_factsnapshotriskanalysis`.ppicpidpayorname,
  `ecw_factsnapshotriskanalysis`.ppicpidpayorid,
  `ecw_factsnapshotriskanalysis`.payorsplitbylocationflag,
  `ecw_factsnapshotriskanalysis`.ppitype,
  `ecw_factsnapshotriskanalysis`.ppistatus,
  `ecw_factsnapshotriskanalysis`.ppistatusdescription,
  `ecw_factsnapshotriskanalysis`.ppiphase,
  `ecw_factsnapshotriskanalysis`.ppienrollmentaction,
  `ecw_factsnapshotriskanalysis`.ppileadgrouptaxid,
  `ecw_factsnapshotriskanalysis`.ppialternateeffectivedate,
  `ecw_factsnapshotriskanalysis`.ppistatusdate,
  `ecw_factsnapshotriskanalysis`.ppilastworkeddate,
  `ecw_factsnapshotriskanalysis`.ppiapplicationsenttopayordate,
  `ecw_factsnapshotriskanalysis`.ppiapplicationreceivedfrompayordate,
  `ecw_factsnapshotriskanalysis`.ppiapplicationsenttoproviderdate,
  `ecw_factsnapshotriskanalysis`.ppiapplicationreceivedfromproviderdate,
  `ecw_factsnapshotriskanalysis`.riskstatus,
  `ecw_factsnapshotriskanalysis`.risksubcategory,
  `ecw_factsnapshotriskanalysis`.psgriskstatus
  FROM
    edwpsc_base_views.`ecw_factsnapshotriskanalysis`
  INNER JOIN edwpsc_base_views.secref_facility
  ON LPAD(TRIM(secref_facility.co_id, ' '), 5, '0') = LPAD(TRIM(`ecw_factsnapshotriskanalysis`.coid, ' '), 5, '0')
  AND TRIM(secref_facility.user_id, ' ') = TRIM(session_user(), ' ')
;