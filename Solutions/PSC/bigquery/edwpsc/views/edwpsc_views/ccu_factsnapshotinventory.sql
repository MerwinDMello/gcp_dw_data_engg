CREATE OR REPLACE VIEW edwpsc_views.`ccu_factsnapshotinventory`
AS SELECT
  `ccu_factsnapshotinventory`.ccuinventoryhistorykey,
  `ccu_factsnapshotinventory`.snapshotdate,
  `ccu_factsnapshotinventory`.reportlastloadeddatetime,
  `ccu_factsnapshotinventory`.ccuinventorykey,
  `ccu_factsnapshotinventory`.regionkey,
  `ccu_factsnapshotinventory`.facilitykey,
  `ccu_factsnapshotinventory`.practicekey,
  `ccu_factsnapshotinventory`.deptcode,
  `ccu_factsnapshotinventory`.coid,
  `ccu_factsnapshotinventory`.ccugolivestatus,
  `ccu_factsnapshotinventory`.ccugolivedatekey,
  `ccu_factsnapshotinventory`.assignedtovendor,
  `ccu_factsnapshotinventory`.vendorname,
  `ccu_factsnapshotinventory`.vendorassigneddatekey,
  `ccu_factsnapshotinventory`.coidname,
  `ccu_factsnapshotinventory`.coidlob,
  `ccu_factsnapshotinventory`.coidspecialty,
  `ccu_factsnapshotinventory`.practicename,
  `ccu_factsnapshotinventory`.facilityname,
  `ccu_factsnapshotinventory`.pos,
  `ccu_factsnapshotinventory`.encounterid,
  `ccu_factsnapshotinventory`.servicedatekey,
  `ccu_factsnapshotinventory`.patientkey,
  `ccu_factsnapshotinventory`.patientid,
  `ccu_factsnapshotinventory`.patientname,
  `ccu_factsnapshotinventory`.servicingproviderkey,
  `ccu_factsnapshotinventory`.servicingproviderid,
  `ccu_factsnapshotinventory`.servicingprovidernpi,
  `ccu_factsnapshotinventory`.servicingprovidername,
  `ccu_factsnapshotinventory`.servicingproviderspecialty,
  `ccu_factsnapshotinventory`.servicingproviderspecialtycategory,
  `ccu_factsnapshotinventory`.visittypekey,
  `ccu_factsnapshotinventory`.visittype,
  `ccu_factsnapshotinventory`.visittypedescription,
  `ccu_factsnapshotinventory`.visitstatuskey,
  `ccu_factsnapshotinventory`.visitstatus,
  `ccu_factsnapshotinventory`.visitstatusdescription,
  `ccu_factsnapshotinventory`.encounterlockeddatekey,
  `ccu_factsnapshotinventory`.dayssincelockeddate,
  `ccu_factsnapshotinventory`.businessdayssincelockeddate,
  `ccu_factsnapshotinventory`.claimcreatedbyuserkey,
  `ccu_factsnapshotinventory`.claimcreatedbyusername,
  `ccu_factsnapshotinventory`.claimstatuskey,
  `ccu_factsnapshotinventory`.claimstatusname,
  `ccu_factsnapshotinventory`.liabilityiplankey,
  `ccu_factsnapshotinventory`.liabilityiplanname,
  `ccu_factsnapshotinventory`.liabilityiplanid,
  `ccu_factsnapshotinventory`.liabilityfinancialclass,
  `ccu_factsnapshotinventory`.claimnumber,
  `ccu_factsnapshotinventory`.totalbalanceamt,
  `ccu_factsnapshotinventory`.totalchargesamt,
  `ccu_factsnapshotinventory`.sourcesystem,
  `ccu_factsnapshotinventory`.owner,
  `ccu_factsnapshotinventory`.encounterlockflag,
  `ccu_factsnapshotinventory`.inventorytype,
  `ccu_factsnapshotinventory`.claimvsencounterflag,
  `ccu_factsnapshotinventory`.sourcelastupdateddatetime,
  `ccu_factsnapshotinventory`.groupassignment,
  `ccu_factsnapshotinventory`.claimvoidflag,
  `ccu_factsnapshotinventory`.claimdeleteflag,
  `ccu_factsnapshotinventory`.encountertype,
  `ccu_factsnapshotinventory`.claimrequired,
  `ccu_factsnapshotinventory`.nonbillable,
  `ccu_factsnapshotinventory`.servicedateconsolidationdateflag,
  `ccu_factsnapshotinventory`.encounterkey,
  `ccu_factsnapshotinventory`.claimkey,
  `ccu_factsnapshotinventory`.dwlastupdatedatetime,
  `ccu_factsnapshotinventory`.inventoryfirstloaddatekey,
  `ccu_factsnapshotinventory`.dayssinceservicedate,
  `ccu_factsnapshotinventory`.businessdayssinceservicedate,
  `ccu_factsnapshotinventory`.lastclaimstatusupdateddatetime,
  `ccu_factsnapshotinventory`.dayssincelaststatuschange,
  `ccu_factsnapshotinventory`.businessdayssincelaststatuschange,
  `ccu_factsnapshotinventory`.encounterlastmodifieddate,
  `ccu_factsnapshotinventory`.dayssinceencounterlastmodified,
  `ccu_factsnapshotinventory`.businessdayssincelastmodified,
  `ccu_factsnapshotinventory`.ccunoncustomerconfigkey,
  `ccu_factsnapshotinventory`.ccunoncustomerconfiglabel,
  `ccu_factsnapshotinventory`.worked,
  `ccu_factsnapshotinventory`.workeddatekey,
  `ccu_factsnapshotinventory`.ccunoncustomernpiconfigkey,
  `ccu_factsnapshotinventory`.procedurecategory1,
  `ccu_factsnapshotinventory`.procedurecategory2,
  `ccu_factsnapshotinventory`.cptcodes,
  `ccu_factsnapshotinventory`.billingareanumber,
  `ccu_factsnapshotinventory`.department,
  `ccu_factsnapshotinventory`.editflag,
  `ccu_factsnapshotinventory`.datecorrectedflag,
  `ccu_factsnapshotinventory`.workqueueid,
  `ccu_factsnapshotinventory`.workqueuetype,
  `ccu_factsnapshotinventory`.workqueuetab,
  `ccu_factsnapshotinventory`.dischargedate,
  `ccu_factsnapshotinventory`.cptmodifiers,
  `ccu_factsnapshotinventory`.icdcodes,
  `ccu_factsnapshotinventory`.sourceaprimarykeyvalue,
  `ccu_factsnapshotinventory`.accountid,
  `ccu_factsnapshotinventory`.claimsubstatusname,
  `ccu_factsnapshotinventory`.region,
  `ccu_factsnapshotinventory`.reasonforvisit,
  `ccu_factsnapshotinventory`.inventorylastloaddatetime,
  `ccu_factsnapshotinventory`.priority,
  `ccu_factsnapshotinventory`.savedby,
  `ccu_factsnapshotinventory`.saveddatekey,
  `ccu_factsnapshotinventory`.savedbyfirstname,
  `ccu_factsnapshotinventory`.savedbylastname,
  `ccu_factsnapshotinventory`.comments,
  `ccu_factsnapshotinventory`.servicingprovideruser34,
  `ccu_factsnapshotinventory`.visitnumber,
  `ccu_factsnapshotinventory`.recordstatus,
  `ccu_factsnapshotinventory`.docholdreason,
  `ccu_factsnapshotinventory`.workqueuename,
  `ccu_factsnapshotinventory`.groupname,
  `ccu_factsnapshotinventory`.marketname,
  `ccu_factsnapshotinventory`.divisionname,
  `ccu_factsnapshotinventory`.centerdescription
  FROM
    edwpsc_base_views.`ccu_factsnapshotinventory`
  INNER JOIN edwpsc_base_views.secref_facility
  ON LPAD(TRIM(secref_facility.co_id, ' '), 5, '0') = LPAD(TRIM(`ccu_factsnapshotinventory`.coid, ' '), 5, '0')
  AND TRIM(secref_facility.user_id, ' ') = TRIM(session_user(), ' ')
;