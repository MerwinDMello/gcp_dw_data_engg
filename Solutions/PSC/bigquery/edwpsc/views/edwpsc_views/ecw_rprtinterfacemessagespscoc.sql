CREATE OR REPLACE VIEW edwpsc_views.`ecw_rprtinterfacemessagespscoc`
AS SELECT
  `ecw_rprtinterfacemessagespscoc`.regionkey,
  `ecw_rprtinterfacemessagespscoc`.coid,
  `ecw_rprtinterfacemessagespscoc`.createddate,
  `ecw_rprtinterfacemessagespscoc`.sendingapplication,
  `ecw_rprtinterfacemessagespscoc`.visitnumber,
  `ecw_rprtinterfacemessagespscoc`.messagecontrolid,
  `ecw_rprtinterfacemessagespscoc`.patientlastname,
  `ecw_rprtinterfacemessagespscoc`.patientfirstname,
  `ecw_rprtinterfacemessagespscoc`.patientid,
  `ecw_rprtinterfacemessagespscoc`.patientclass,
  `ecw_rprtinterfacemessagespscoc`.patienttype,
  `ecw_rprtinterfacemessagespscoc`.financialclass,
  `ecw_rprtinterfacemessagespscoc`.primaryiplankey,
  `ecw_rprtinterfacemessagespscoc`.primaryinsuranceid,
  `ecw_rprtinterfacemessagespscoc`.primaryecwinsuranceid,
  `ecw_rprtinterfacemessagespscoc`.primaryinsurancename,
  `ecw_rprtinterfacemessagespscoc`.procedurecode,
  `ecw_rprtinterfacemessagespscoc`.cptmodifier,
  `ecw_rprtinterfacemessagespscoc`.proceduredate,
  `ecw_rprtinterfacemessagespscoc`.procedurepos,
  `ecw_rprtinterfacemessagespscoc`.revenuecode,
  `ecw_rprtinterfacemessagespscoc`.facilitykey,
  `ecw_rprtinterfacemessagespscoc`.facilityid,
  `ecw_rprtinterfacemessagespscoc`.ecwfacilityid,
  `ecw_rprtinterfacemessagespscoc`.practice,
  `ecw_rprtinterfacemessagespscoc`.encounterid,
  `ecw_rprtinterfacemessagespscoc`.encounterkey,
  `ecw_rprtinterfacemessagespscoc`.claimid,
  `ecw_rprtinterfacemessagespscoc`.claimkey,
  `ecw_rprtinterfacemessagespscoc`.reconcategory,
  `ecw_rprtinterfacemessagespscoc`.sourcemessage,
  `ecw_rprtinterfacemessagespscoc`.batchdate,
  `ecw_rprtinterfacemessagespscoc`.cptunits,
  `ecw_rprtinterfacemessagespscoc`.cdmcode,
  `ecw_rprtinterfacemessagespscoc`.consolidatedflag,
  `ecw_rprtinterfacemessagespscoc`.consolidationtargetflag,
  `ecw_rprtinterfacemessagespscoc`.firstbatchdate,
  `ecw_rprtinterfacemessagespscoc`.messagecreateddate,
  `ecw_rprtinterfacemessagespscoc`.datemessagereceivedoriginal,
  `ecw_rprtinterfacemessagespscoc`.datemessagereceived,
  `ecw_rprtinterfacemessagespscoc`.claimcreatedbyuserid,
  `ecw_rprtinterfacemessagespscoc`.voidflag,
  `ecw_rprtinterfacemessagespscoc`.receivedflag,
  `ecw_rprtinterfacemessagespscoc`.transmittedflag,
  `ecw_rprtinterfacemessagespscoc`.datemessagetransmitted,
  `ecw_rprtinterfacemessagespscoc`.pendingflag,
  `ecw_rprtinterfacemessagespscoc`.ecwsuppressflag,
  `ecw_rprtinterfacemessagespscoc`.batchid,
  `ecw_rprtinterfacemessagespscoc`.authorizationnumber,
  `ecw_rprtinterfacemessagespscoc`.hospitalservice,
  `ecw_rprtinterfacemessagespscoc`.iserror,
  `ecw_rprtinterfacemessagespscoc`.iserroropenconnect,
  `ecw_rprtinterfacemessagespscoc`.iserrorecw,
  `ecw_rprtinterfacemessagespscoc`.facilityactiveflag,
  `ecw_rprtinterfacemessagespscoc`.systemsuppressflag,
  `ecw_rprtinterfacemessagespscoc`.suppressflag,
  `ecw_rprtinterfacemessagespscoc`.admittingproviderkey,
  `ecw_rprtinterfacemessagespscoc`.admittingproviderid,
  `ecw_rprtinterfacemessagespscoc`.billingproviderkey,
  `ecw_rprtinterfacemessagespscoc`.billingproviderid,
  `ecw_rprtinterfacemessagespscoc`.servicingproviderkey,
  `ecw_rprtinterfacemessagespscoc`.servicingproviderid,
  `ecw_rprtinterfacemessagespscoc`.performedbyproviderkey,
  `ecw_rprtinterfacemessagespscoc`.performedbyproviderid,
  `ecw_rprtinterfacemessagespscoc`.referringproviderkey,
  `ecw_rprtinterfacemessagespscoc`.referringproviderid,
  `ecw_rprtinterfacemessagespscoc`.consultingproviderkey,
  `ecw_rprtinterfacemessagespscoc`.consultingproviderid,
  `ecw_rprtinterfacemessagespscoc`.providerkey,
  `ecw_rprtinterfacemessagespscoc`.providerid,
  `ecw_rprtinterfacemessagespscoc`.orderedbyproviderkey,
  `ecw_rprtinterfacemessagespscoc`.orderedbyid,
  `ecw_rprtinterfacemessagespscoc`.triggeringevent,
  `ecw_rprtinterfacemessagespscoc`.lastmessageid,
  `ecw_rprtinterfacemessagespscoc`.lastmessagecontrolid,
  `ecw_rprtinterfacemessagespscoc`.firststatusreason,
  `ecw_rprtinterfacemessagespscoc`.firststatusmessage,
  `ecw_rprtinterfacemessagespscoc`.firststatusdate,
  `ecw_rprtinterfacemessagespscoc`.firstcategory,
  `ecw_rprtinterfacemessagespscoc`.firstcategorydate,
  `ecw_rprtinterfacemessagespscoc`.laststatusreason,
  `ecw_rprtinterfacemessagespscoc`.laststatusmessage,
  `ecw_rprtinterfacemessagespscoc`.laststatusdate,
  `ecw_rprtinterfacemessagespscoc`.lastcategory,
  `ecw_rprtinterfacemessagespscoc`.lastcategorydate,
  `ecw_rprtinterfacemessagespscoc`.firstiserror,
  `ecw_rprtinterfacemessagespscoc`.firstiserrordate,
  `ecw_rprtinterfacemessagespscoc`.firstiserrorecw,
  `ecw_rprtinterfacemessagespscoc`.firstiserrorecwdate,
  `ecw_rprtinterfacemessagespscoc`.firstsuppressflag,
  `ecw_rprtinterfacemessagespscoc`.firstsuppressflagdate,
  `ecw_rprtinterfacemessagespscoc`.firstdftdatereceived,
  `ecw_rprtinterfacemessagespscoc`.lastdftdatereceived,
  `ecw_rprtinterfacemessagespscoc`.firstpendingflag,
  `ecw_rprtinterfacemessagespscoc`.firstecwsuppressflag,
  `ecw_rprtinterfacemessagespscoc`.firstecwsuppressflagdate,
  `ecw_rprtinterfacemessagespscoc`.sourceaprimarykeyvalue,
  `ecw_rprtinterfacemessagespscoc`.sourcebprimarykeyvalue,
  `ecw_rprtinterfacemessagespscoc`.sourcesystemcode,
  `ecw_rprtinterfacemessagespscoc`.dwlastupdateddate,
  `ecw_rprtinterfacemessagespscoc`.insertedby,
  `ecw_rprtinterfacemessagespscoc`.inserteddtm,
  `ecw_rprtinterfacemessagespscoc`.modifiedby,
  `ecw_rprtinterfacemessagespscoc`.modifieddtm,
  `ecw_rprtinterfacemessagespscoc`.messagedataxml,
  `ecw_rprtinterfacemessagespscoc`.dwlastupdatedatetime
  FROM
    edwpsc_base_views.`ecw_rprtinterfacemessagespscoc`
  INNER JOIN edwpsc_base_views.secref_facility
  ON LPAD(TRIM(secref_facility.co_id, ' '), 5, '0') = LPAD(TRIM(`ecw_rprtinterfacemessagespscoc`.coid, ' '), 5, '0')
  AND TRIM(secref_facility.user_id, ' ') = TRIM(session_user(), ' ')
;