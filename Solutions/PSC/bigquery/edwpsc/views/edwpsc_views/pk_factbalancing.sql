CREATE OR REPLACE VIEW edwpsc_views.`pk_factbalancing`
AS SELECT
  `pk_factbalancing`.pkbid,
  `pk_factbalancing`.regionkey,
  `pk_factbalancing`.coid,
  `pk_factbalancing`.cptfoundinecw,
  `pk_factbalancing`.visitnumber,
  `pk_factbalancing`.batchnumber,
  `pk_factbalancing`.firstmessageid,
  `pk_factbalancing`.lastmessageid,
  `pk_factbalancing`.pmid,
  `pk_factbalancing`.firstdatereceived,
  `pk_factbalancing`.lastdatereceived,
  `pk_factbalancing`.firstclaimnumber,
  `pk_factbalancing`.lastclaimnumber,
  `pk_factbalancing`.firstmessagestatus,
  `pk_factbalancing`.lastmessagestatus,
  `pk_factbalancing`.lasterrormessage,
  `pk_factbalancing`.doctorid,
  `pk_factbalancing`.reconciledflag,
  `pk_factbalancing`.facilityid,
  `pk_factbalancing`.practiceidfromresults,
  `pk_factbalancing`.proceduredatefromhl7,
  `pk_factbalancing`.dobfromhl7,
  `pk_factbalancing`.patientfirstnamefromhl7,
  `pk_factbalancing`.patientlastnamefromhl7,
  `pk_factbalancing`.patientidfoundfromhl7,
  `pk_factbalancing`.providernpifromhl7,
  `pk_factbalancing`.provideridfoundfromhl7,
  `pk_factbalancing`.procedurecodefromhl7,
  `pk_factbalancing`.claimnumberfoundfromhl7lookup,
  `pk_factbalancing`.cptidfoundfromhl7lookup,
  `pk_factbalancing`.createdbyfromhl7lookup,
  `pk_factbalancing`.claimpatientidfound2fromresultslookup,
  `pk_factbalancing`.patientfirstnameresultslookup,
  `pk_factbalancing`.patientlastnameresultslookup,
  `pk_factbalancing`.patientdobresultslookup,
  `pk_factbalancing`.claimservicedtresultslookup,
  `pk_factbalancing`.claimnumberfound2fromresults,
  `pk_factbalancing`.cptidfound2fromresultslookup,
  `pk_factbalancing`.createdby2fromresultslookup,
  `pk_factbalancing`.createdbyid2fromresultslookup,
  `pk_factbalancing`.createdbyidfromhl7lookup,
  `pk_factbalancing`.claimnumber,
  `pk_factbalancing`.voidflagclaim,
  `pk_factbalancing`.deleteflagclaim,
  `pk_factbalancing`.patientid,
  `pk_factbalancing`.createdbyid,
  `pk_factbalancing`.inbalanceflag,
  `pk_factbalancing`.claimcreatedbysystemflag,
  `pk_factbalancing`.claimcreatedbyuserflag,
  `pk_factbalancing`.hashcpt,
  `pk_factbalancing`.facilitycodefromhl7,
  `pk_factbalancing`.dwlastupdatedatetime,
  `pk_factbalancing`.sourcesystemcode,
  `pk_factbalancing`.insertedby,
  `pk_factbalancing`.inserteddtm,
  `pk_factbalancing`.modifiedby,
  `pk_factbalancing`.modifieddtm,
  `pk_factbalancing`.providernamefromhl7,
  `pk_factbalancing`.isignoredflag,
  `pk_factbalancing`.actionbyusername,
  `pk_factbalancing`.actiondatetime,
  `pk_factbalancing`.claimnumberfound3,
  `pk_factbalancing`.reconmodifieddate,
  `pk_factbalancing`.reconuserid,
  `pk_factbalancing`.reconclaimid,
  `pk_factbalancing`.reconnotes,
  `pk_factbalancing`.messagecontrolid,
  `pk_factbalancing`.chargetransactionid,
  `pk_factbalancing`.pkregionname
  FROM
    edwpsc_base_views.`pk_factbalancing`
  INNER JOIN edwpsc_base_views.secref_facility
  ON LPAD(TRIM(secref_facility.co_id, ' '), 5, '0') = LPAD(TRIM(`pk_factbalancing`.coid, ' '), 5, '0')
  AND TRIM(secref_facility.user_id, ' ') = TRIM(session_user(), ' ')
;