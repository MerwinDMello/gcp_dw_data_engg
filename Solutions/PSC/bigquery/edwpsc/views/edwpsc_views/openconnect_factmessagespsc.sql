CREATE OR REPLACE VIEW edwpsc_views.`openconnect_factmessagespsc`
AS SELECT
  `openconnect_factmessagespsc`.openconnectmessagekey,
  `openconnect_factmessagespsc`.regionkey,
  `openconnect_factmessagespsc`.coid,
  `openconnect_factmessagespsc`.createddate,
  `openconnect_factmessagespsc`.datemessagereceivedoriginal,
  `openconnect_factmessagespsc`.datemessagereceived,
  `openconnect_factmessagespsc`.sendingapplication,
  `openconnect_factmessagespsc`.visitnumber,
  `openconnect_factmessagespsc`.messagecontrolid,
  `openconnect_factmessagespsc`.patientlastname,
  `openconnect_factmessagespsc`.patientfirstname,
  `openconnect_factmessagespsc`.patientdateofbirth,
  `openconnect_factmessagespsc`.patientid,
  `openconnect_factmessagespsc`.patientclass,
  `openconnect_factmessagespsc`.patienttype,
  `openconnect_factmessagespsc`.financialclass,
  `openconnect_factmessagespsc`.primaryiplankey,
  `openconnect_factmessagespsc`.primaryinsuranceid,
  `openconnect_factmessagespsc`.primaryecwinsuranceid,
  `openconnect_factmessagespsc`.primaryinsurancename,
  `openconnect_factmessagespsc`.primaryinsurancesetid,
  `openconnect_factmessagespsc`.primaryinsurancegroupnumber,
  `openconnect_factmessagespsc`.primaryinsurancegroupname,
  `openconnect_factmessagespsc`.primaryinsuranceeffectivedate,
  `openconnect_factmessagespsc`.primaryinsuranceterminationdate,
  `openconnect_factmessagespsc`.primaryinsuredlastname,
  `openconnect_factmessagespsc`.primaryinsuredfirstname,
  `openconnect_factmessagespsc`.primaryinsuredmiddleinitial,
  `openconnect_factmessagespsc`.primaryinsuredrelationshiptopatient,
  `openconnect_factmessagespsc`.primaryinsuranceassignmentofbenefits,
  `openconnect_factmessagespsc`.primaryinsurancecoordinationofbenefitspriority,
  `openconnect_factmessagespsc`.primaryinsurancepolicynumber,
  `openconnect_factmessagespsc`.secondaryiplankey,
  `openconnect_factmessagespsc`.secondaryinsuranceid,
  `openconnect_factmessagespsc`.secondaryecwinsuranceid,
  `openconnect_factmessagespsc`.secondaryinsurancename,
  `openconnect_factmessagespsc`.secondaryinsurancesetid,
  `openconnect_factmessagespsc`.secondaryinsurancegroupnumber,
  `openconnect_factmessagespsc`.secondaryinsurancegroupname,
  `openconnect_factmessagespsc`.secondaryinsuranceeffectivedate,
  `openconnect_factmessagespsc`.secondaryinsuranceterminationdate,
  `openconnect_factmessagespsc`.secondaryinsuredlastname,
  `openconnect_factmessagespsc`.secondaryinsuredfirstname,
  `openconnect_factmessagespsc`.secondaryinsuredmiddleinitial,
  `openconnect_factmessagespsc`.secondaryinsuredrelationshiptopatient,
  `openconnect_factmessagespsc`.secondaryinsuranceassignmentofbenefits,
  `openconnect_factmessagespsc`.secondaryinsurancecoordinationofbenefitspriority,
  `openconnect_factmessagespsc`.secondaryinsurancepolicynumber,
  `openconnect_factmessagespsc`.tertiaryiplankey,
  `openconnect_factmessagespsc`.tertiaryinsuranceid,
  `openconnect_factmessagespsc`.tertiaryecwinsuranceid,
  `openconnect_factmessagespsc`.tertiaryinsurancename,
  `openconnect_factmessagespsc`.tertiaryinsurancesetid,
  `openconnect_factmessagespsc`.tertiaryinsurancegroupnumber,
  `openconnect_factmessagespsc`.tertiaryinsurancegroupname,
  `openconnect_factmessagespsc`.tertiaryinsuranceeffectivedate,
  `openconnect_factmessagespsc`.tertiaryinsuranceterminationdate,
  `openconnect_factmessagespsc`.tertiaryinsuredlastname,
  `openconnect_factmessagespsc`.tertiaryinsuredfirstname,
  `openconnect_factmessagespsc`.tertiaryinsuredmiddleinitial,
  `openconnect_factmessagespsc`.tertiaryinsuredrelationshiptopatient,
  `openconnect_factmessagespsc`.tertiaryinsuranceassignmentofbenefits,
  `openconnect_factmessagespsc`.tertiaryinsurancecoordinationofbenefitspriority,
  `openconnect_factmessagespsc`.tertiaryinsurancepolicynumber,
  `openconnect_factmessagespsc`.procedurecode,
  `openconnect_factmessagespsc`.cptmodifier,
  `openconnect_factmessagespsc`.proceduredate,
  `openconnect_factmessagespsc`.procedurepos,
  `openconnect_factmessagespsc`.admittingproviderkey,
  `openconnect_factmessagespsc`.admittingproviderid,
  `openconnect_factmessagespsc`.billingproviderkey,
  `openconnect_factmessagespsc`.billingproviderid,
  `openconnect_factmessagespsc`.servicingproviderkey,
  `openconnect_factmessagespsc`.servicingproviderid,
  `openconnect_factmessagespsc`.performedbyproviderkey,
  `openconnect_factmessagespsc`.performedbyproviderid,
  `openconnect_factmessagespsc`.referringproviderkey,
  `openconnect_factmessagespsc`.referringproviderid,
  `openconnect_factmessagespsc`.consultingproviderkey,
  `openconnect_factmessagespsc`.consultingproviderid,
  `openconnect_factmessagespsc`.providerkey,
  `openconnect_factmessagespsc`.providerid,
  `openconnect_factmessagespsc`.orderedbyproviderkey,
  `openconnect_factmessagespsc`.orderedbyid,
  `openconnect_factmessagespsc`.visitnumbersplitcheckproviderkey,
  `openconnect_factmessagespsc`.visitnumbersplitcheckproviderid,
  `openconnect_factmessagespsc`.facilitykey,
  `openconnect_factmessagespsc`.facilityid,
  `openconnect_factmessagespsc`.ecwfacilityid,
  `openconnect_factmessagespsc`.practice,
  `openconnect_factmessagespsc`.encounterid,
  `openconnect_factmessagespsc`.encounterkey,
  `openconnect_factmessagespsc`.claimid,
  `openconnect_factmessagespsc`.claimkey,
  `openconnect_factmessagespsc`.reconcategory,
  `openconnect_factmessagespsc`.hospitalservice,
  `openconnect_factmessagespsc`.triggeringevent,
  `openconnect_factmessagespsc`.suppressflag,
  `openconnect_factmessagespsc`.adtmessagecontrolid,
  `openconnect_factmessagespsc`.iserror,
  `openconnect_factmessagespsc`.iserroropenconnect,
  `openconnect_factmessagespsc`.iserrorecw,
  `openconnect_factmessagespsc`.facilityactiveflag,
  `openconnect_factmessagespsc`.firstdftdatereceived,
  `openconnect_factmessagespsc`.lastdftdatereceived,
  `openconnect_factmessagespsc`.sourceaprimarykeyvalue,
  `openconnect_factmessagespsc`.dwlastupdatedatetime,
  `openconnect_factmessagespsc`.insertedby,
  `openconnect_factmessagespsc`.inserteddtm,
  `openconnect_factmessagespsc`.modifiedby,
  `openconnect_factmessagespsc`.modifieddtm,
  `openconnect_factmessagespsc`.systemsuppressflag,
  `openconnect_factmessagespsc`.batchdate,
  `openconnect_factmessagespsc`.cptunits,
  `openconnect_factmessagespsc`.cdmcode,
  `openconnect_factmessagespsc`.consolidatedflag,
  `openconnect_factmessagespsc`.consolidationtargetflag,
  `openconnect_factmessagespsc`.lastmessageid,
  `openconnect_factmessagespsc`.lastmessagecontrolid,
  `openconnect_factmessagespsc`.revenuecode,
  `openconnect_factmessagespsc`.sourcebprimarykeyvalue,
  `openconnect_factmessagespsc`.sourcesystemcode,
  `openconnect_factmessagespsc`.sourcemessage,
  `openconnect_factmessagespsc`.claimcreatedbyuserid,
  `openconnect_factmessagespsc`.voidflag,
  `openconnect_factmessagespsc`.receivedflag,
  `openconnect_factmessagespsc`.transmittedflag,
  `openconnect_factmessagespsc`.datemessagetransmitted,
  `openconnect_factmessagespsc`.pendingflag,
  `openconnect_factmessagespsc`.ecwsuppressflag,
  `openconnect_factmessagespsc`.batchid,
  `openconnect_factmessagespsc`.authorizationnumber,
  `openconnect_factmessagespsc`.messagedataxml
  FROM
    edwpsc_base_views.`openconnect_factmessagespsc`
  INNER JOIN edwpsc_base_views.secref_facility
  ON LPAD(TRIM(secref_facility.co_id, ' '), 5, '0') = LPAD(TRIM(`openconnect_factmessagespsc`.coid, ' '), 5, '0')
  AND TRIM(secref_facility.user_id, ' ') = TRIM(session_user(), ' ')
;