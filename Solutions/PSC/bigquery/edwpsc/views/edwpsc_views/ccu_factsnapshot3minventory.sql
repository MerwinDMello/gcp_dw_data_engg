CREATE OR REPLACE VIEW edwpsc_views.`ccu_factsnapshot3minventory`
AS SELECT
  `ccu_factsnapshot3minventory`.ccu3minventoryhistorykey,
  `ccu_factsnapshot3minventory`.snapshotdate,
  `ccu_factsnapshot3minventory`.ccu3minventorykey,
  `ccu_factsnapshot3minventory`.regionkey,
  `ccu_factsnapshot3minventory`.facilitykey,
  `ccu_factsnapshot3minventory`.practicekey,
  `ccu_factsnapshot3minventory`.deptcode,
  `ccu_factsnapshot3minventory`.coid,
  `ccu_factsnapshot3minventory`.ccugolivestatus,
  `ccu_factsnapshot3minventory`.ccugolivedate,
  `ccu_factsnapshot3minventory`.assignedtovendor,
  `ccu_factsnapshot3minventory`.vendorname,
  `ccu_factsnapshot3minventory`.vendorassigneddate,
  `ccu_factsnapshot3minventory`.encounterid,
  `ccu_factsnapshot3minventory`.servicedate,
  `ccu_factsnapshot3minventory`.patientkey,
  `ccu_factsnapshot3minventory`.servicingproviderkey,
  `ccu_factsnapshot3minventory`.servicingproviderspecialty,
  `ccu_factsnapshot3minventory`.servicingproviderspecialtycategory,
  `ccu_factsnapshot3minventory`.visittypekey,
  `ccu_factsnapshot3minventory`.visitstatuskey,
  `ccu_factsnapshot3minventory`.encounterlockeddate,
  `ccu_factsnapshot3minventory`.dayssincelockeddate,
  `ccu_factsnapshot3minventory`.claimcreatedbyuserkey,
  `ccu_factsnapshot3minventory`.claimstatuskey,
  `ccu_factsnapshot3minventory`.liabilityiplankey,
  `ccu_factsnapshot3minventory`.claimnumber,
  `ccu_factsnapshot3minventory`.totalbalanceamt,
  `ccu_factsnapshot3minventory`.sourcesystem,
  `ccu_factsnapshot3minventory`.owner,
  `ccu_factsnapshot3minventory`.encounterlockflag,
  `ccu_factsnapshot3minventory`.inventorytype,
  `ccu_factsnapshot3minventory`.claimvsencounterflag,
  `ccu_factsnapshot3minventory`.dwlastupdatedatetime,
  `ccu_factsnapshot3minventory`.groupassignment,
  `ccu_factsnapshot3minventory`.claimvoidflag,
  `ccu_factsnapshot3minventory`.claimdeleteflag,
  `ccu_factsnapshot3minventory`.encountertype,
  `ccu_factsnapshot3minventory`.claimrequired,
  `ccu_factsnapshot3minventory`.nonbillable,
  `ccu_factsnapshot3minventory`.servicedateconsolidationdateflag,
  `ccu_factsnapshot3minventory`.encounterkey,
  `ccu_factsnapshot3minventory`.claimkey,
  `ccu_factsnapshot3minventory`.loaddate,
  `ccu_factsnapshot3minventory`.dayssinceservicedate,
  `ccu_factsnapshot3minventory`.lastclaimstatusupdateddatekey,
  `ccu_factsnapshot3minventory`.dayssincelaststatuschange,
  `ccu_factsnapshot3minventory`.encounterlastmodifieddate,
  `ccu_factsnapshot3minventory`.dayssinceencounterlastmodified,
  `ccu_factsnapshot3minventory`.worked,
  `ccu_factsnapshot3minventory`.workeddate,
  `ccu_factsnapshot3minventory`.daysopen,
  `ccu_factsnapshot3minventory`.ccunoncustomerconfigkey,
  `ccu_factsnapshot3minventory`.insertedby,
  `ccu_factsnapshot3minventory`.inserteddtm,
  `ccu_factsnapshot3minventory`.modifiedby,
  `ccu_factsnapshot3minventory`.modifieddtm,
  `ccu_factsnapshot3minventory`.sourcelastupdateddatetime,
  `ccu_factsnapshot3minventory`.ccunoncustomernpiconfigkey,
  `ccu_factsnapshot3minventory`.procedurecategory1,
  `ccu_factsnapshot3minventory`.procedurecategory2,
  `ccu_factsnapshot3minventory`.cptcodes,
  `ccu_factsnapshot3minventory`.rhprimaryminsubmissiondatekey,
  `ccu_factsnapshot3minventory`.firstinsurancebilldatekey,
  `ccu_factsnapshot3minventory`.datecorrectedflag,
  `ccu_factsnapshot3minventory`.cptmodifiers,
  `ccu_factsnapshot3minventory`.icdcodes,
  `ccu_factsnapshot3minventory`.recordstatus,
  `ccu_factsnapshot3minventory`.docholdreason,
  `ccu_factsnapshot3minventory`.workqueuename
  FROM
    edwpsc_base_views.`ccu_factsnapshot3minventory`
  INNER JOIN edwpsc_base_views.secref_facility
  ON LPAD(TRIM(secref_facility.co_id, ' '), 5, '0') = LPAD(TRIM(`ccu_factsnapshot3minventory`.coid, ' '), 5, '0')
  AND TRIM(secref_facility.user_id, ' ') = TRIM(session_user(), ' ')
;