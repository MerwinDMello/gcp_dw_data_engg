CREATE OR REPLACE VIEW edwpsc_views.`ecw_rprtinterfacemessagespsgoc`
AS SELECT
  `ecw_rprtinterfacemessagespsgoc`.regionkey,
  `ecw_rprtinterfacemessagespsgoc`.coid,
  `ecw_rprtinterfacemessagespsgoc`.createddate,
  `ecw_rprtinterfacemessagespsgoc`.sendingapplication,
  `ecw_rprtinterfacemessagespsgoc`.visitnumber,
  `ecw_rprtinterfacemessagespsgoc`.messagecontrolid,
  `ecw_rprtinterfacemessagespsgoc`.patientlastname,
  `ecw_rprtinterfacemessagespsgoc`.patientfirstname,
  `ecw_rprtinterfacemessagespsgoc`.patientid,
  `ecw_rprtinterfacemessagespsgoc`.patientclass,
  `ecw_rprtinterfacemessagespsgoc`.patienttype,
  `ecw_rprtinterfacemessagespsgoc`.financialclass,
  `ecw_rprtinterfacemessagespsgoc`.primaryiplankey,
  `ecw_rprtinterfacemessagespsgoc`.primaryinsuranceid,
  `ecw_rprtinterfacemessagespsgoc`.primaryecwinsuranceid,
  `ecw_rprtinterfacemessagespsgoc`.primaryinsurancename,
  `ecw_rprtinterfacemessagespsgoc`.procedurecode,
  `ecw_rprtinterfacemessagespsgoc`.cptmodifier,
  `ecw_rprtinterfacemessagespsgoc`.proceduredate,
  `ecw_rprtinterfacemessagespsgoc`.procedurepos,
  `ecw_rprtinterfacemessagespsgoc`.revenuecode,
  `ecw_rprtinterfacemessagespsgoc`.facilitykey,
  `ecw_rprtinterfacemessagespsgoc`.facilityid,
  `ecw_rprtinterfacemessagespsgoc`.ecwfacilityid,
  `ecw_rprtinterfacemessagespsgoc`.practice,
  `ecw_rprtinterfacemessagespsgoc`.encounterid,
  `ecw_rprtinterfacemessagespsgoc`.encounterkey,
  `ecw_rprtinterfacemessagespsgoc`.claimid,
  `ecw_rprtinterfacemessagespsgoc`.claimkey,
  `ecw_rprtinterfacemessagespsgoc`.reconcategory,
  `ecw_rprtinterfacemessagespsgoc`.sourcemessage,
  `ecw_rprtinterfacemessagespsgoc`.batchdate,
  `ecw_rprtinterfacemessagespsgoc`.cptunits,
  `ecw_rprtinterfacemessagespsgoc`.cdmcode,
  `ecw_rprtinterfacemessagespsgoc`.consolidatedflag,
  `ecw_rprtinterfacemessagespsgoc`.consolidationtargetflag,
  `ecw_rprtinterfacemessagespsgoc`.firstbatchdate,
  `ecw_rprtinterfacemessagespsgoc`.messagecreateddate,
  `ecw_rprtinterfacemessagespsgoc`.datemessagereceivedoriginal,
  `ecw_rprtinterfacemessagespsgoc`.datemessagereceived,
  `ecw_rprtinterfacemessagespsgoc`.claimcreatedbyuserid,
  `ecw_rprtinterfacemessagespsgoc`.voidflag,
  `ecw_rprtinterfacemessagespsgoc`.receivedflag,
  `ecw_rprtinterfacemessagespsgoc`.transmittedflag,
  `ecw_rprtinterfacemessagespsgoc`.datemessagetransmitted,
  `ecw_rprtinterfacemessagespsgoc`.pendingflag,
  `ecw_rprtinterfacemessagespsgoc`.ecwsuppressflag,
  `ecw_rprtinterfacemessagespsgoc`.batchid,
  `ecw_rprtinterfacemessagespsgoc`.authorizationnumber,
  `ecw_rprtinterfacemessagespsgoc`.hospitalservice,
  `ecw_rprtinterfacemessagespsgoc`.iserror,
  `ecw_rprtinterfacemessagespsgoc`.iserroropenconnect,
  `ecw_rprtinterfacemessagespsgoc`.iserrorecw,
  `ecw_rprtinterfacemessagespsgoc`.facilityactiveflag,
  `ecw_rprtinterfacemessagespsgoc`.systemsuppressflag,
  `ecw_rprtinterfacemessagespsgoc`.suppressflag,
  `ecw_rprtinterfacemessagespsgoc`.admittingproviderkey,
  `ecw_rprtinterfacemessagespsgoc`.admittingproviderid,
  `ecw_rprtinterfacemessagespsgoc`.billingproviderkey,
  `ecw_rprtinterfacemessagespsgoc`.billingproviderid,
  `ecw_rprtinterfacemessagespsgoc`.servicingproviderkey,
  `ecw_rprtinterfacemessagespsgoc`.servicingproviderid,
  `ecw_rprtinterfacemessagespsgoc`.performedbyproviderkey,
  `ecw_rprtinterfacemessagespsgoc`.performedbyproviderid,
  `ecw_rprtinterfacemessagespsgoc`.referringproviderkey,
  `ecw_rprtinterfacemessagespsgoc`.referringproviderid,
  `ecw_rprtinterfacemessagespsgoc`.consultingproviderkey,
  `ecw_rprtinterfacemessagespsgoc`.consultingproviderid,
  `ecw_rprtinterfacemessagespsgoc`.providerkey,
  `ecw_rprtinterfacemessagespsgoc`.providerid,
  `ecw_rprtinterfacemessagespsgoc`.orderedbyproviderkey,
  `ecw_rprtinterfacemessagespsgoc`.orderedbyid,
  `ecw_rprtinterfacemessagespsgoc`.triggeringevent,
  `ecw_rprtinterfacemessagespsgoc`.lastmessageid,
  `ecw_rprtinterfacemessagespsgoc`.lastmessagecontrolid,
  `ecw_rprtinterfacemessagespsgoc`.firststatusreason,
  `ecw_rprtinterfacemessagespsgoc`.firststatusmessage,
  `ecw_rprtinterfacemessagespsgoc`.firststatusdate,
  `ecw_rprtinterfacemessagespsgoc`.firstcategory,
  `ecw_rprtinterfacemessagespsgoc`.firstcategorydate,
  `ecw_rprtinterfacemessagespsgoc`.laststatusreason,
  `ecw_rprtinterfacemessagespsgoc`.laststatusmessage,
  `ecw_rprtinterfacemessagespsgoc`.laststatusdate,
  `ecw_rprtinterfacemessagespsgoc`.lastcategory,
  `ecw_rprtinterfacemessagespsgoc`.lastcategorydate,
  `ecw_rprtinterfacemessagespsgoc`.firstiserror,
  `ecw_rprtinterfacemessagespsgoc`.firstiserrordate,
  `ecw_rprtinterfacemessagespsgoc`.firstiserrorecw,
  `ecw_rprtinterfacemessagespsgoc`.firstiserrorecwdate,
  `ecw_rprtinterfacemessagespsgoc`.firstsuppressflag,
  `ecw_rprtinterfacemessagespsgoc`.firstsuppressflagdate,
  `ecw_rprtinterfacemessagespsgoc`.firstdftdatereceived,
  `ecw_rprtinterfacemessagespsgoc`.lastdftdatereceived,
  `ecw_rprtinterfacemessagespsgoc`.firstpendingflag,
  `ecw_rprtinterfacemessagespsgoc`.firstecwsuppressflag,
  `ecw_rprtinterfacemessagespsgoc`.firstecwsuppressflagdate,
  `ecw_rprtinterfacemessagespsgoc`.sourceaprimarykeyvalue,
  `ecw_rprtinterfacemessagespsgoc`.sourcebprimarykeyvalue,
  `ecw_rprtinterfacemessagespsgoc`.sourcesystemcode,
  `ecw_rprtinterfacemessagespsgoc`.dwlastupdateddate,
  `ecw_rprtinterfacemessagespsgoc`.insertedby,
  `ecw_rprtinterfacemessagespsgoc`.inserteddtm,
  `ecw_rprtinterfacemessagespsgoc`.modifiedby,
  `ecw_rprtinterfacemessagespsgoc`.modifieddtm,
  `ecw_rprtinterfacemessagespsgoc`.splitsourceflag,
  `ecw_rprtinterfacemessagespsgoc`.splittargetflag,
  `ecw_rprtinterfacemessagespsgoc`.splitsourcemessageid,
  `ecw_rprtinterfacemessagespsgoc`.dwlastupdatedatetime
  FROM
    edwpsc_base_views.`ecw_rprtinterfacemessagespsgoc`
  INNER JOIN edwpsc_base_views.secref_facility
  ON LPAD(TRIM(secref_facility.co_id, ' '), 5, '0') = LPAD(TRIM(`ecw_rprtinterfacemessagespsgoc`.coid, ' '), 5, '0')
  AND TRIM(secref_facility.user_id, ' ') = TRIM(session_user(), ' ')
;