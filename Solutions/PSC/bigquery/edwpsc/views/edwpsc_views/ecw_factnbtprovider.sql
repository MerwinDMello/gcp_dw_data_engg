CREATE OR REPLACE VIEW edwpsc_views.`ecw_factnbtprovider`
AS SELECT
  `ecw_factnbtprovider`.nbtproviderkey,
  `ecw_factnbtprovider`.snapshotdatekey,
  `ecw_factnbtprovider`.monthid,
  `ecw_factnbtprovider`.hcpdwid,
  `ecw_factnbtprovider`.gldepartmentnum,
  `ecw_factnbtprovider`.coid,
  `ecw_factnbtprovider`.companycode,
  `ecw_factnbtprovider`.ancillarydeptnum,
  `ecw_factnbtprovider`.assignedstartdatekey,
  `ecw_factnbtprovider`.budgetcoid,
  `ecw_factnbtprovider`.budgetohdeptnum,
  `ecw_factnbtprovider`.budgetstartdatekey,
  `ecw_factnbtprovider`.coiddeptname,
  `ecw_factnbtprovider`.coiddeptstartdatekey,
  `ecw_factnbtprovider`.coiddepttermdatekey,
  `ecw_factnbtprovider`.coidstartdatekey,
  `ecw_factnbtprovider`.communitystatus,
  `ecw_factnbtprovider`.compensationtype,
  `ecw_factnbtprovider`.srcsyscompensationtypekey,
  `ecw_factnbtprovider`.contractexpirationdatekey,
  `ecw_factnbtprovider`.contractrenewaldatekey,
  `ecw_factnbtprovider`.developmenttypename,
  `ecw_factnbtprovider`.srcsysdevelopmentkey,
  `ecw_factnbtprovider`.birthdatekey,
  `ecw_factnbtprovider`.effectivedatekey,
  `ecw_factnbtprovider`.providerfirstname,
  `ecw_factnbtprovider`.fte,
  `ecw_factnbtprovider`.isbudgetind,
  `ecw_factnbtprovider`.ishospitalistind,
  `ecw_factnbtprovider`.ismultipleproviderdeptind,
  `ecw_factnbtprovider`.providerlastname,
  `ecw_factnbtprovider`.providermiddleinitial,
  `ecw_factnbtprovider`.newreplacedind,
  `ecw_factnbtprovider`.newreplacedname,
  `ecw_factnbtprovider`.overheadallocation,
  `ecw_factnbtprovider`.originalstartdatekey,
  `ecw_factnbtprovider`.providernpi,
  `ecw_factnbtprovider`.providerkey,
  `ecw_factnbtprovider`.practiceaddress1,
  `ecw_factnbtprovider`.practiceaddress2,
  `ecw_factnbtprovider`.practicecity,
  `ecw_factnbtprovider`.practicefax,
  `ecw_factnbtprovider`.practicemanagerfirstname,
  `ecw_factnbtprovider`.practicemanagerlastname,
  `ecw_factnbtprovider`.practicename,
  `ecw_factnbtprovider`.srcsyspracticenum,
  `ecw_factnbtprovider`.practicephone,
  `ecw_factnbtprovider`.practicestate,
  `ecw_factnbtprovider`.practicezip,
  `ecw_factnbtprovider`.projectedterminationdatekey,
  `ecw_factnbtprovider`.providerheadcount,
  `ecw_factnbtprovider`.srcsysproviderkey,
  `ecw_factnbtprovider`.relationshipind,
  `ecw_factnbtprovider`.socialsecuritynum,
  `ecw_factnbtprovider`.specialtycode,
  `ecw_factnbtprovider`.specialtyname,
  `ecw_factnbtprovider`.specialtytype,
  `ecw_factnbtprovider`.terminationreasonname,
  `ecw_factnbtprovider`.terminationtypename,
  `ecw_factnbtprovider`.terminationtypeid,
  `ecw_factnbtprovider`.terminationresults,
  `ecw_factnbtprovider`.upin,
  `ecw_factnbtprovider`.status,
  `ecw_factnbtprovider`.datasourcecode,
  `ecw_factnbtprovider`.createddtm,
  `ecw_factnbtprovider`.dwlastupdatedatetime,
  `ecw_factnbtprovider`.sourcesystemcode,
  `ecw_factnbtprovider`.insertedby,
  `ecw_factnbtprovider`.inserteddtm,
  `ecw_factnbtprovider`.modifiedby,
  `ecw_factnbtprovider`.modifieddtm
  FROM
    edwpsc_base_views.`ecw_factnbtprovider`
  INNER JOIN edwpsc_base_views.secref_facility
  ON LPAD(TRIM(secref_facility.co_id, ' '), 5, '0') = LPAD(TRIM(`ecw_factnbtprovider`.coid, ' '), 5, '0')
  AND TRIM(secref_facility.user_id, ' ') = TRIM(session_user(), ' ')
;