CREATE OR REPLACE VIEW edwpsc_views.`epic_factarcube`
AS SELECT
  `epic_factarcube`.claimkey,
  `epic_factarcube`.claimnumber,
  `epic_factarcube`.visitnumber,
  `epic_factarcube`.regionkey,
  `epic_factarcube`.coid,
  `epic_factarcube`.claimadjustmentsgreaterthantotalcharges,
  `epic_factarcube`.claimagebyclaimfilestatuslastchangedate,
  `epic_factarcube`.claimagebydateofservice,
  `epic_factarcube`.claimagebylastbilleddate,
  `epic_factarcube`.claimagebylastliabilityownerchangedate,
  `epic_factarcube`.claimagebylastpaymentdate,
  `epic_factarcube`.claimagebylastpaymentoradjustmentdate,
  `epic_factarcube`.claimagebyvoidandrecreatedate,
  `epic_factarcube`.claimagingbucketbydateofservice,
  `epic_factarcube`.claimagingbucketbydateofservicesortorder,
  `epic_factarcube`.claimagingbucketbylastliabilityownerchangedate,
  `epic_factarcube`.claimagingbucketbylastliabilityownerchangedatesortorder,
  `epic_factarcube`.claimagingbucketbylastpaymentoradjustmentdate,
  `epic_factarcube`.claimagingbucketbylastpaymentoradjustmentdatesortorder,
  `epic_factarcube`.claimbalancebucket,
  `epic_factarcube`.claimbalancebucketsortorder,
  `epic_factarcube`.claimbalancepercentadjudicated,
  `epic_factarcube`.claimcreditbalance,
  `epic_factarcube`.claimdate,
  `epic_factarcube`.claimfilestatusid,
  `epic_factarcube`.claimfilestatuslastchangedate,
  `epic_factarcube`.claimfilestatusname,
  `epic_factarcube`.claimlastbilledcategory,
  `epic_factarcube`.claimlastbilleddate,
  `epic_factarcube`.claimlastinsurancepaymentdate,
  `epic_factarcube`.claimlastnote,
  `epic_factarcube`.claimlastpatientpaymentdate,
  `epic_factarcube`.claimoriginalclaimnumber,
  `epic_factarcube`.claimowner,
  `epic_factarcube`.claimvoidandrecreatedate,
  `epic_factarcube`.claimzerobalance,
  `epic_factarcube`.claimrebilled,
  `epic_factarcube`.claimbilled,
  `epic_factarcube`.claimtype,
  `epic_factarcube`.dateofservice,
  `epic_factarcube`.facilityid,
  `epic_factarcube`.facilityname,
  `epic_factarcube`.facilityplaceofservicecode,
  `epic_factarcube`.ins1insurancepayerfinancialclassname,
  `epic_factarcube`.ins1insurancepayerfinancialclassnum,
  `epic_factarcube`.ins1insurancepayerepicfinancialclassname,
  `epic_factarcube`.ins1insurancepayerepicfinancialclassnum,
  `epic_factarcube`.ins1insurancepayergroupname,
  `epic_factarcube`.ins1insurancepayerid,
  `epic_factarcube`.ins1insurancepayername,
  `epic_factarcube`.ins1insuredsubscribernumber,
  `epic_factarcube`.ins1insuredsubscribergroupnumber,
  `epic_factarcube`.ins2insurancepayerfinancialclassname,
  `epic_factarcube`.ins2insurancepayerfinancialclassnum,
  `epic_factarcube`.ins2insurancepayerepicfinancialclassname,
  `epic_factarcube`.ins2insurancepayerepicfinancialclassnum,
  `epic_factarcube`.ins2insurancepayergroupname,
  `epic_factarcube`.ins2insurancepayerid,
  `epic_factarcube`.ins2insurancepayername,
  `epic_factarcube`.ins2insuredsubscribernumber,
  `epic_factarcube`.ins2insuredsubscribergroupnumber,
  `epic_factarcube`.ins3insurancepayerfinancialclassname,
  `epic_factarcube`.ins3insurancepayerfinancialclassnum,
  `epic_factarcube`.ins3insurancepayerepicfinancialclassname,
  `epic_factarcube`.ins3insurancepayerepicfinancialclassnum,
  `epic_factarcube`.ins3insurancepayergroupname,
  `epic_factarcube`.ins3insurancepayerid,
  `epic_factarcube`.ins3insurancepayername,
  `epic_factarcube`.ins3insuredsubscribernumber,
  `epic_factarcube`.ins3insuredsubscribergroupnumber,
  `epic_factarcube`.liabilityownerfinancialclassname,
  `epic_factarcube`.liabilityownerfinancialclassnum,
  `epic_factarcube`.liabilityownerepicfinancialclassname,
  `epic_factarcube`.liabilityownerepicfinancialclassnum,
  `epic_factarcube`.liabilityownergovernmentindicator,
  `epic_factarcube`.liabilityownerid,
  `epic_factarcube`.liabilityownerindicator,
  `epic_factarcube`.liabilityownerinsuredsubscribernumber,
  `epic_factarcube`.liabilityownerinsuredsubscribergroupnumber,
  `epic_factarcube`.liabilityownerlastchangedate,
  `epic_factarcube`.liabilityownername,
  `epic_factarcube`.liabilityownerpayergroupname,
  `epic_factarcube`.patientdeceased,
  `epic_factarcube`.patientfirstname,
  `epic_factarcube`.patientid,
  `epic_factarcube`.patientepicinternalid,
  `epic_factarcube`.patientmrn,
  `epic_factarcube`.patientlastname,
  `epic_factarcube`.patientmiddlename,
  `epic_factarcube`.patientsendstatements,
  `epic_factarcube`.patientunidentified,
  `epic_factarcube`.practicegroupnpi,
  `epic_factarcube`.practiceid,
  `epic_factarcube`.practicename,
  `epic_factarcube`.practicestate,
  `epic_factarcube`.practicetaxid,
  `epic_factarcube`.referringproviderid,
  `epic_factarcube`.referringprovidername,
  `epic_factarcube`.referringproviderupin,
  `epic_factarcube`.servicingproviderid,
  `epic_factarcube`.servicingprovidername,
  `epic_factarcube`.servicingprovidernpi,
  `epic_factarcube`.servicingproviderspecialty,
  `epic_factarcube`.servicingprovidersubspecialty,
  `epic_factarcube`.servicingprovidertaxonomycode,
  `epic_factarcube`.servicingproviderupin,
  `epic_factarcube`.gldeptnum,
  `epic_factarcube`.ins1insurancetotalpayments,
  `epic_factarcube`.ins2insurancetotalpayments,
  `epic_factarcube`.ins1insurancefirstbilleddate,
  `epic_factarcube`.ins1insurancelastbilleddate,
  `epic_factarcube`.ins2insurancefirstbilleddate,
  `epic_factarcube`.ins2insurancelastbilleddate,
  `epic_factarcube`.adjustmentsadministration,
  `epic_factarcube`.adjustmentsbaddebt,
  `epic_factarcube`.adjustmentscapitation,
  `epic_factarcube`.adjustmentscharity,
  `epic_factarcube`.adjustmentscontractual,
  `epic_factarcube`.adjustmentsdenial,
  `epic_factarcube`.adjustmentsescheat,
  `epic_factarcube`.adjustmentsinterest,
  `epic_factarcube`.adjustmentsnsf,
  `epic_factarcube`.adjustmentsrefund,
  `epic_factarcube`.adjustmentsuninsured,
  `epic_factarcube`.balanceinsuranceliability,
  `epic_factarcube`.balancepatientliability,
  `epic_factarcube`.billcountins1,
  `epic_factarcube`.billcountins1withvoids,
  `epic_factarcube`.billcountins2,
  `epic_factarcube`.billcountins2withvoids,
  `epic_factarcube`.billcountins3,
  `epic_factarcube`.billcountins3withvoids,
  `epic_factarcube`.claimcount,
  `epic_factarcube`.paymentsinsurance,
  `epic_factarcube`.paymentspatient,
  `epic_factarcube`.totaladjustments,
  `epic_factarcube`.totalbalance,
  `epic_factarcube`.totalcharges,
  `epic_factarcube`.totalpayments,
  `epic_factarcube`.collectioncode,
  `epic_factarcube`.collectioncodechangedate,
  `epic_factarcube`.diagnosiscode1,
  `epic_factarcube`.diagnosiscode2,
  `epic_factarcube`.holdcode
  FROM
    edwpsc_base_views.`epic_factarcube`
  INNER JOIN edwpsc_base_views.secref_facility
  ON LPAD(TRIM(secref_facility.co_id, ' '), 5, '0') = LPAD(TRIM(`epic_factarcube`.coid, ' '), 5, '0')
  AND TRIM(secref_facility.user_id, ' ') = TRIM(session_user(), ' ')
;