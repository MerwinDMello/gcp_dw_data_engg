CREATE OR REPLACE VIEW edwpsc_views.`pk_facttransactiondetails`
AS SELECT
  `pk_facttransactiondetails`.pktransactiondetailskey,
  `pk_facttransactiondetails`.pkregionname,
  `pk_facttransactiondetails`.coid,
  `pk_facttransactiondetails`.accountid,
  `pk_facttransactiondetails`.authorizinguserid,
  `pk_facttransactiondetails`.comments,
  `pk_facttransactiondetails`.revieweddatetime,
  `pk_facttransactiondetails`.revieweddatekey,
  `pk_facttransactiondetails`.servicedatekey,
  `pk_facttransactiondetails`.currentstatus,
  `pk_facttransactiondetails`.chargetransactionid,
  `pk_facttransactiondetails`.visitid,
  `pk_facttransactiondetails`.heldforreview,
  `pk_facttransactiondetails`.chargesyncid,
  `pk_facttransactiondetails`.chargesyncrepid,
  `pk_facttransactiondetails`.chargequantity,
  `pk_facttransactiondetails`.cptcode,
  `pk_facttransactiondetails`.cptcodedescription,
  `pk_facttransactiondetails`.patientfirstname,
  `pk_facttransactiondetails`.patientlastname,
  `pk_facttransactiondetails`.patientmiddlename,
  `pk_facttransactiondetails`.patientmrn,
  `pk_facttransactiondetails`.pkfinancialnumber,
  `pk_facttransactiondetails`.reasonforvisit,
  `pk_facttransactiondetails`.financialclass,
  `pk_facttransactiondetails`.visittypeindicator,
  `pk_facttransactiondetails`.billingareaabbrev,
  `pk_facttransactiondetails`.billingareaname,
  `pk_facttransactiondetails`.billingareanumber,
  `pk_facttransactiondetails`.billingdepartmentid,
  `pk_facttransactiondetails`.billingdepartmentlabel,
  `pk_facttransactiondetails`.billingproviderfirstname,
  `pk_facttransactiondetails`.billingproviderlastname,
  `pk_facttransactiondetails`.billingproviderusername,
  `pk_facttransactiondetails`.billingproviderusernumber,
  `pk_facttransactiondetails`.cptmodifier1,
  `pk_facttransactiondetails`.modifierdescription1,
  `pk_facttransactiondetails`.cptmodifier2,
  `pk_facttransactiondetails`.modifierdescription2,
  `pk_facttransactiondetails`.cptmodifier3,
  `pk_facttransactiondetails`.modifierdescription3,
  `pk_facttransactiondetails`.cptmodifier4,
  `pk_facttransactiondetails`.modifierdescription4,
  `pk_facttransactiondetails`.cptmodifier5,
  `pk_facttransactiondetails`.modifierdescription5,
  `pk_facttransactiondetails`.visitlocationfacility,
  `pk_facttransactiondetails`.visitlocationunit,
  `pk_facttransactiondetails`.visitlocation,
  `pk_facttransactiondetails`.visitlocationbed,
  `pk_facttransactiondetails`.createdtime,
  `pk_facttransactiondetails`.modifiedtime,
  `pk_facttransactiondetails`.errorsflag,
  `pk_facttransactiondetails`.deleteflag,
  `pk_facttransactiondetails`.sourcesystemcode,
  `pk_facttransactiondetails`.sourceaprimarykeyvalue,
  `pk_facttransactiondetails`.sourcebprimarykeyvalue,
  `pk_facttransactiondetails`.insertedby,
  `pk_facttransactiondetails`.inserteddtm,
  `pk_facttransactiondetails`.modifiedby,
  `pk_facttransactiondetails`.modifieddtm,
  `pk_facttransactiondetails`.billingproviderdeleteflag,
  `pk_facttransactiondetails`.billingprovidernpi,
  `pk_facttransactiondetails`.lastmodifiedtime,
  `pk_facttransactiondetails`.authorizedtime,
  `pk_facttransactiondetails`.supervisingprovider,
  `pk_facttransactiondetails`.servicingprovider,
  `pk_facttransactiondetails`.servicesite,
  `pk_facttransactiondetails`.transactionsyncid,
  `pk_facttransactiondetails`.supervisingprovidernpi,
  `pk_facttransactiondetails`.servicingprovidernpi,
  `pk_facttransactiondetails`.source,
  `pk_facttransactiondetails`.dischargedate,
  `pk_facttransactiondetails`.batchid,
  `pk_facttransactiondetails`.admitdate,
  `pk_facttransactiondetails`.practiceid,
  `pk_facttransactiondetails`.chargeid,
  `pk_facttransactiondetails`.messagecontrolid,
  `pk_facttransactiondetails`.saveddate,
  `pk_facttransactiondetails`.savedby,
  `pk_facttransactiondetails`.savedbyfirstname,
  `pk_facttransactiondetails`.savedbylastname,
  `pk_facttransactiondetails`.nonbillablereason,
  `pk_facttransactiondetails`.postype,
  `pk_facttransactiondetails`.encounterstatus,
  `pk_facttransactiondetails`.cptchangerequest,
  `pk_facttransactiondetails`.cptchangerequestdate,
  `pk_facttransactiondetails`.cptchangestatus,
  `pk_facttransactiondetails`.cptchangereason,
  `pk_facttransactiondetails`.primaryinsurancename,
  `pk_facttransactiondetails`.secondaryinsurancename,
  `pk_facttransactiondetails`.reasonforhold,
  `pk_facttransactiondetails`.billingcomments,
  `pk_facttransactiondetails`.dwlastupdatedatetime
  FROM
    edwpsc_base_views.`pk_facttransactiondetails`
  INNER JOIN edwpsc_base_views.secref_facility
  ON LPAD(TRIM(secref_facility.co_id, ' '), 5, '0') = LPAD(TRIM(`pk_facttransactiondetails`.coid, ' '), 5, '0')
  AND TRIM(secref_facility.user_id, ' ') = TRIM(session_user(), ' ')
;