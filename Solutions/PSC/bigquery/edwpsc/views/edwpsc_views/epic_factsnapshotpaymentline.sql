CREATE OR REPLACE VIEW edwpsc_views.`epic_factsnapshotpaymentline`
AS SELECT
  `epic_factsnapshotpaymentline`.paymentlinekey,
  `epic_factsnapshotpaymentline`.monthid,
  `epic_factsnapshotpaymentline`.snapshotdate,
  `epic_factsnapshotpaymentline`.claimkey,
  `epic_factsnapshotpaymentline`.claimnumber,
  `epic_factsnapshotpaymentline`.visitnumber,
  `epic_factsnapshotpaymentline`.transactionnumber,
  `epic_factsnapshotpaymentline`.servicingproviderkey,
  `epic_factsnapshotpaymentline`.renderingproviderkey,
  `epic_factsnapshotpaymentline`.facilitykey,
  `epic_factsnapshotpaymentline`.iplan1iplankey,
  `epic_factsnapshotpaymentline`.practicekey,
  `epic_factsnapshotpaymentline`.cptcodekey,
  `epic_factsnapshotpaymentline`.gldepartmentnum,
  `epic_factsnapshotpaymentline`.patientid,
  `epic_factsnapshotpaymentline`.servicingproviderid,
  `epic_factsnapshotpaymentline`.renderingproviderid,
  `epic_factsnapshotpaymentline`.facilityid,
  `epic_factsnapshotpaymentline`.practiceid,
  `epic_factsnapshotpaymentline`.claimdatekey,
  `epic_factsnapshotpaymentline`.servicedatekey,
  `epic_factsnapshotpaymentline`.iplan1id,
  `epic_factsnapshotpaymentline`.financialclasskey,
  `epic_factsnapshotpaymentline`.encounterid,
  `epic_factsnapshotpaymentline`.cptid,
  `epic_factsnapshotpaymentline`.paymentlineid,
  `epic_factsnapshotpaymentline`.paymentdetailid,
  `epic_factsnapshotpaymentline`.paymentid,
  `epic_factsnapshotpaymentline`.checknumber,
  `epic_factsnapshotpaymentline`.checktype,
  `epic_factsnapshotpaymentline`.checkdate,
  `epic_factsnapshotpaymentline`.posteddatekey,
  `epic_factsnapshotpaymentline`.allowedamt,
  `epic_factsnapshotpaymentline`.deductableamt,
  `epic_factsnapshotpaymentline`.coinsuranceamt,
  `epic_factsnapshotpaymentline`.memrespamt,
  `epic_factsnapshotpaymentline`.paymentamt,
  `epic_factsnapshotpaymentline`.contractualadjustmentamt,
  `epic_factsnapshotpaymentline`.withheldamt,
  `epic_factsnapshotpaymentline`.msgcode,
  `epic_factsnapshotpaymentline`.eraadjustmentamt,
  `epic_factsnapshotpaymentline`.linetaxamt,
  `epic_factsnapshotpaymentline`.paymentfromid,
  `epic_factsnapshotpaymentline`.paymenttypekey,
  `epic_factsnapshotpaymentline`.cptcode,
  `epic_factsnapshotpaymentline`.cptstartservicedatekey,
  `epic_factsnapshotpaymentline`.cptendservicedatekey,
  `epic_factsnapshotpaymentline`.cptorder,
  `epic_factsnapshotpaymentline`.cptdeleletedline,
  `epic_factsnapshotpaymentline`.cptunits,
  `epic_factsnapshotpaymentline`.cptmodifier1,
  `epic_factsnapshotpaymentline`.cptmodifier2,
  `epic_factsnapshotpaymentline`.cptchargesamt,
  `epic_factsnapshotpaymentline`.paymentlinecreatedate,
  `epic_factsnapshotpaymentline`.paymentlinemodifieddate,
  `epic_factsnapshotpaymentline`.paymentclaimcreatedate,
  `epic_factsnapshotpaymentline`.paymentclaimmodifieddate,
  `epic_factsnapshotpaymentline`.regionkey,
  `epic_factsnapshotpaymentline`.coid
  FROM
    edwpsc_base_views.`epic_factsnapshotpaymentline`
  INNER JOIN edwpsc_base_views.secref_facility
  ON LPAD(TRIM(secref_facility.co_id, ' '), 5, '0') = LPAD(TRIM(`epic_factsnapshotpaymentline`.coid, ' '), 5, '0')
  AND TRIM(secref_facility.user_id, ' ') = TRIM(session_user(), ' ')
;