CREATE OR REPLACE VIEW edwpsc_views.`ccu_factecwinventory`
AS SELECT
  `ccu_factecwinventory`.ccuecwinventorykey,
  `ccu_factecwinventory`.regionkey,
  `ccu_factecwinventory`.facilitykey,
  `ccu_factecwinventory`.practicekey,
  `ccu_factecwinventory`.deptcode,
  `ccu_factecwinventory`.coid,
  `ccu_factecwinventory`.ccugolivestatus,
  `ccu_factecwinventory`.ccugolivedate,
  `ccu_factecwinventory`.assignedtovendor,
  `ccu_factecwinventory`.vendorname,
  `ccu_factecwinventory`.vendorassigneddate,
  `ccu_factecwinventory`.encounterid,
  `ccu_factecwinventory`.servicedate,
  `ccu_factecwinventory`.patientkey,
  `ccu_factecwinventory`.servicingproviderkey,
  `ccu_factecwinventory`.servicingproviderspecialty,
  `ccu_factecwinventory`.servicingproviderspecialtycategory,
  `ccu_factecwinventory`.visittypekey,
  `ccu_factecwinventory`.visitstatuskey,
  `ccu_factecwinventory`.encounterlockeddate,
  `ccu_factecwinventory`.dayssincelockeddate,
  `ccu_factecwinventory`.claimcreatedbyuserkey,
  `ccu_factecwinventory`.claimstatuskey,
  `ccu_factecwinventory`.liabilityiplankey,
  `ccu_factecwinventory`.claimnumber,
  `ccu_factecwinventory`.totalbalanceamt,
  `ccu_factecwinventory`.sourcesystem,
  `ccu_factecwinventory`.owner,
  `ccu_factecwinventory`.encounterlockflag,
  `ccu_factecwinventory`.inventorytype,
  `ccu_factecwinventory`.claimvsencounterflag,
  `ccu_factecwinventory`.dwlastupdatedatetime,
  `ccu_factecwinventory`.groupassignment,
  `ccu_factecwinventory`.claimvoidflag,
  `ccu_factecwinventory`.claimdeleteflag,
  `ccu_factecwinventory`.encountertype,
  `ccu_factecwinventory`.claimrequired,
  `ccu_factecwinventory`.nonbillable,
  `ccu_factecwinventory`.servicedateconsolidationdateflag,
  `ccu_factecwinventory`.encounterkey,
  `ccu_factecwinventory`.claimkey,
  `ccu_factecwinventory`.loaddate,
  `ccu_factecwinventory`.dayssinceservicedate,
  `ccu_factecwinventory`.lastclaimstatusupdateddatekey,
  `ccu_factecwinventory`.dayssincelaststatuschange,
  `ccu_factecwinventory`.encounterlastmodifieddate,
  `ccu_factecwinventory`.dayssinceencounterlastmodified,
  `ccu_factecwinventory`.worked,
  `ccu_factecwinventory`.workeddate,
  `ccu_factecwinventory`.ccunoncustomerconfigkey,
  `ccu_factecwinventory`.insertedby,
  `ccu_factecwinventory`.inserteddtm,
  `ccu_factecwinventory`.modifiedby,
  `ccu_factecwinventory`.modifieddtm,
  `ccu_factecwinventory`.sourcelastupdateddatetime,
  `ccu_factecwinventory`.ccunoncustomernpiconfigkey,
  `ccu_factecwinventory`.procedurecategory1,
  `ccu_factecwinventory`.procedurecategory2,
  `ccu_factecwinventory`.cptcodes,
  `ccu_factecwinventory`.datecorrectedflag,
  `ccu_factecwinventory`.busincessdayssinceservicedate,
  `ccu_factecwinventory`.busincessdayssincelastmodified,
  `ccu_factecwinventory`.busincessdayssincelaststatuschange,
  `ccu_factecwinventory`.businessdayssincelockeddate,
  `ccu_factecwinventory`.cptmodifiers,
  `ccu_factecwinventory`.icdcodes
  FROM
    edwpsc_base_views.`ccu_factecwinventory`
  INNER JOIN edwpsc_base_views.secref_facility
  ON LPAD(TRIM(secref_facility.co_id, ' '), 5, '0') = LPAD(TRIM(`ccu_factecwinventory`.coid, ' '), 5, '0')
  AND TRIM(secref_facility.user_id, ' ') = TRIM(session_user(), ' ')
;