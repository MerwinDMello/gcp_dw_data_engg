CREATE TABLE IF NOT EXISTS edwpsc.ccu_factsnapshotinventory
(
  ccuinventoryhistorykey INT64 NOT NULL,
  snapshotdate DATE,
  reportlastloadeddatetime DATETIME NOT NULL,
  ccuinventorykey INT64,
  regionkey INT64,
  facilitykey INT64,
  practicekey INT64,
  deptcode STRING,
  coid STRING,
  ccugolivestatus STRING,
  ccugolivedatekey DATE,
  assignedtovendor STRING,
  vendorname STRING,
  vendorassigneddatekey DATE,
  coidname STRING,
  coidlob STRING,
  coidspecialty STRING,
  practicename STRING,
  facilityname STRING,
  pos STRING,
  encounterid STRING,
  servicedatekey DATE,
  patientkey INT64,
  patientid STRING,
  patientname STRING,
  servicingproviderkey INT64,
  servicingproviderid INT64,
  servicingprovidernpi STRING,
  servicingprovidername STRING,
  servicingproviderspecialty STRING,
  servicingproviderspecialtycategory STRING,
  visittypekey INT64,
  visittype STRING,
  visittypedescription STRING,
  visitstatuskey INT64,
  visitstatus STRING,
  visitstatusdescription STRING,
  encounterlockeddatekey DATE,
  dayssincelockeddate INT64,
  businessdayssincelockeddate INT64,
  claimcreatedbyuserkey INT64,
  claimcreatedbyusername STRING,
  claimstatuskey INT64,
  claimstatusname STRING,
  liabilityiplankey INT64,
  liabilityiplanname STRING,
  liabilityiplanid INT64,
  liabilityfinancialclass STRING,
  claimnumber INT64,
  totalbalanceamt NUMERIC(33, 4),
  totalchargesamt NUMERIC(33, 4),
  sourcesystem STRING NOT NULL,
  owner STRING,
  encounterlockflag STRING,
  inventorytype STRING,
  claimvsencounterflag STRING,
  sourcelastupdateddatetime DATETIME,
  groupassignment STRING,
  claimvoidflag INT64,
  claimdeleteflag INT64,
  encountertype INT64,
  claimrequired INT64,
  nonbillable INT64,
  servicedateconsolidationdateflag STRING,
  encounterkey INT64,
  claimkey INT64,
  dwlastupdatedatetime DATETIME,
  inventoryfirstloaddatekey DATE,
  dayssinceservicedate INT64,
  businessdayssinceservicedate INT64,
  lastclaimstatusupdateddatetime DATETIME,
  dayssincelaststatuschange INT64,
  businessdayssincelaststatuschange INT64,
  encounterlastmodifieddate DATE,
  dayssinceencounterlastmodified INT64,
  businessdayssincelastmodified INT64,
  ccunoncustomerconfigkey INT64,
  ccunoncustomerconfiglabel STRING,
  worked INT64,
  workeddatekey DATE,
  ccunoncustomernpiconfigkey INT64,
  procedurecategory1 STRING,
  procedurecategory2 STRING,
  cptcodes STRING,
  billingareanumber STRING,
  department STRING,
  editflag STRING,
  datecorrectedflag INT64,
  workqueueid INT64,
  workqueuetype STRING,
  workqueuetab STRING,
  dischargedate DATETIME,
  cptmodifiers STRING,
  icdcodes STRING,
  sourceaprimarykeyvalue INT64,
  accountid INT64,
  claimsubstatusname STRING,
  region STRING,
  reasonforvisit STRING,
  inventorylastloaddatetime DATETIME,
  priority STRING NOT NULL,
  savedby STRING,
  saveddatekey DATE,
  savedbyfirstname STRING,
  savedbylastname STRING,
  comments STRING,
  servicingprovideruser34 STRING,
  visitnumber STRING,
  recordstatus STRING,
  docholdreason STRING,
  workqueuename STRING,
  groupname STRING,
  marketname STRING,
  divisionname STRING,
  centerdescription STRING
)
PARTITION BY snapshotdate
;