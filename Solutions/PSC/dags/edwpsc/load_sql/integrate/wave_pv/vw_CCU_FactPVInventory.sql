
        
TRUNCATE TABLE {{ params.param_psc_core_dataset_name }}.vw_CCU_FactPVInventory ;

INSERT INTO {{ params.param_psc_core_dataset_name }}.vw_CCU_FactPVInventory (CCUPVInventoryKey, RegionKey, FacilityKey, COID, AssignedToVendor, VendorName, VendorAssignedDate, ServiceDate, ServicingProviderKey, ServicingProviderSpecialty, ServicingProviderSpecialtyCategory, VendorAssigned, ClaimLastUpdatedDate, DaysSinceClaimLastUpdatedDate, ClaimNumber, TotalChargesAmt, TotalBalanceAmt, TotalInsuranceBalanceAmt, HoldCode, EncounterID, SourceSystem, OWNER, InventoryType, DWLastUpdateDateTime, GroupAssignment, ClaimKey, VisitTypeKey, VisitStatusKey, PatientKey, LoadDate, Worked, WorkedDate, CCUNonCustomerConfigKey, InsertedBy, InsertedDTM, ModifiedBy, ModifiedDTM, EncounterKey, SourceLastUpdatedDateTime, CCUNonCustomerNPIConfigKey, ProcedureCategory1, ProcedureCategory2, CPTCodes, BusincessDaysSinceServiceDate, DaysSinceServiceDate, BusincessDaysSinceLastModified, CPTModifiers, ICDCodes)
SELECT source.CCUPVInventoryKey, source.RegionKey, source.FacilityKey, TRIM(source.COID), TRIM(source.AssignedToVendor), TRIM(source.VendorName), source.VendorAssignedDate, source.ServiceDate, source.ServicingProviderKey, TRIM(source.ServicingProviderSpecialty), TRIM(source.ServicingProviderSpecialtyCategory), TRIM(source.VendorAssigned), source.ClaimLastUpdatedDate, source.DaysSinceClaimLastUpdatedDate, TRIM(source.ClaimNumber), source.TotalChargesAmt, source.TotalBalanceAmt, source.TotalInsuranceBalanceAmt, TRIM(source.HoldCode), source.EncounterID, TRIM(source.SourceSystem), TRIM(source.OWNER), TRIM(source.InventoryType), source.DWLastUpdateDateTime, TRIM(source.GroupAssignment), source.ClaimKey, source.VisitTypeKey, source.VisitStatusKey, source.PatientKey, source.LoadDate, source.Worked, source.WorkedDate, source.CCUNonCustomerConfigKey, TRIM(source.InsertedBy), source.InsertedDTM, TRIM(source.ModifiedBy), source.ModifiedDTM, source.EncounterKey, source.SourceLastUpdatedDateTime, source.CCUNonCustomerNPIConfigKey, TRIM(source.ProcedureCategory1), TRIM(source.ProcedureCategory2), TRIM(source.CPTCodes), source.BusincessDaysSinceServiceDate, source.DaysSinceServiceDate, source.BusincessDaysSinceLastModified, TRIM(source.CPTModifiers), TRIM(source.ICDCodes)
FROM {{ params.param_psc_stage_dataset_name }}.CCU_FactPVInventory as source;
