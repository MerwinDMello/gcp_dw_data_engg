
        
TRUNCATE TABLE {{ params.param_psc_core_dataset_name }}.vw_PV_FactARCube ;

INSERT INTO {{ params.param_psc_core_dataset_name }}.vw_PV_FactARCube (ClaimKey, ClaimNumber, RegionKey, Coid, ClaimAdjustmentsGreaterThanTotalCharges, ClaimAgeByClaimFileStatusLastChangeDate, ClaimAgeByDateOfService, ClaimAgeByLastBilledDate, ClaimAgeByLastLiabilityOwnerChangeDate, ClaimAgeByLastPaymentDate, ClaimAgeByLastPaymentOrAdjustmentDate, ClaimAgeByLastReleaseDate, ClaimAgeByVoidAndRecreateDate, ClaimAgingBucketByDateOfService, ClaimAgingBucketByDateOfServiceSortOrder, ClaimAgingBucketByLastLiabilityOwnerChangeDate, ClaimAgingBucketByLastLiabilityOwnerChangeDateSortOrder, ClaimAgingBucketByLastPaymentOrAdjustmentDate, ClaimAgingBucketByLastPaymentOrAdjustmentDateSortOrder, ClaimBalanceBucket, ClaimBalanceBucketSortOrder, ClaimBalancePercentAdjudicated, ClaimCreditBalance, ClaimDate, ClaimFileStatusId, ClaimFileStatusLastChangeDate, ClaimFileStatusName, ClaimLastBilledCategory, ClaimLastBilledDate, ClaimLastInsurancePaymentDate, ClaimLastNote, ClaimLastPatientPaymentDate, ClaimOriginalClaimNumber, ClaimOwner, ClaimVoidAndRecreateDate, ClaimZeroBalance, ClaimRebilled, ClaimBilled, ClaimType, DateOfService, FacilityId, FacilityName, FacilityPlaceOfServiceCode, Ins1InsurancePayerFinancialClassName, Ins1InsurancePayerFinancialClassNum, Ins1InsurancePayerPVFinancialClassName, Ins1InsurancePayerPVFinancialClassNum, Ins1InsurancePayerGroupName, Ins1InsurancePayerId, Ins1InsurancePayerName, Ins1InsuredSubscriberNumber, Ins1InsuredSubscriberGroupNumber, Ins2InsurancePayerFinancialClassName, Ins2InsurancePayerFinancialClassNum, Ins2InsurancePayerPVFinancialClassName, Ins2InsurancePayerPVFinancialClassNum, Ins2InsurancePayerGroupName, Ins2InsurancePayerId, Ins2InsurancePayerName, Ins2InsuredSubscriberNumber, Ins2InsuredSubscriberGroupNumber, Ins3InsurancePayerFinancialClassName, Ins3InsurancePayerFinancialClassNum, Ins3InsurancePayerPVFinancialClassName, Ins3InsurancePayerPVFinancialClassNum, Ins3InsurancePayerGroupName, Ins3InsurancePayerId, Ins3InsurancePayerName, Ins3InsuredSubscriberNumber, Ins3InsuredSubscriberGroupNumber, LiabilityOwnerFinancialClassName, LiabilityOwnerFinancialClassNum, LiabilityOwnerPVFinancialClassName, LiabilityOwnerPVFinancialClassNum, LiabilityOwnerGovernmentIndicator, LiabilityOwnerId, LiabilityOwnerIndicator, LiabilityOwnerInsuredSubscriberNumber, LiabilityOwnerInsuredSubscriberGroupNumber, LiabilityOwnerLastChangeDate, LiabilityOwnerName, LiabilityOwnerPayerGroupName, PatientDeceased, PatientFirstName, PatientId, PatientLastName, PatientMiddleName, PatientSendStatements, PatientUnidentified, PracticeGroupNPI, PracticeId, PracticeName, PracticeSiteId, PracticeState, PracticeTaxId, ReferringProviderId, ReferringProviderName, ReferringProviderUPIN, ServicingProviderId, ServicingProviderName, ServicingProviderNPI, ServicingProviderSpecialty, ServicingProviderSubSpecialty, ServicingProviderTaxonomyCode, ServicingProviderUPIN, GLDeptNum, Ins1InsuranceTotalPayments, Ins2InsuranceTotalPayments, Ins1InsuranceFirstBilledDate, Ins1InsuranceLastBilledDate, Ins2InsuranceFirstBilledDate, Ins2InsuranceLastBilledDate, AdjustmentsAdministration, AdjustmentsBaddebt, AdjustmentsCapitation, AdjustmentsCharity, AdjustmentsContractual, AdjustmentsDenial, AdjustmentsEscheat, AdjustmentsInterest, AdjustmentsNsf, AdjustmentsRefund, AdjustmentsUninsured, BalanceInsuranceLiability, BalancePatientLiability, BillCountIns1, BillCountIns1WithVoids, BillCountIns2, BillCountIns2WithVoids, BillCountIns3, BillCountIns3WithVoids, ClaimCount, PaymentsInsurance, PaymentsPatient, TotalAdjustments, TotalBalance, TotalCharges, TotalPayments, CollectionCode, CollectionCodeChangeDate, DiagnosisCode1, DiagnosisCode2, FacilityDbaName, FacilityBillingName, FacilityEdiId, FacilityTaxonomyCode, UnbilledStatusKey, RHHoldCode, EncounterVisitReason, EncounterTimeIn, ServicingProviderDoctorType, RelayHealthLastReleaseClaimType, EncounterCategory, ProtocolName, IplanOccMedPricing, IplanWCPricing, CompanyNumber, ArtivaPSENRELAYGUID, SupervisingProviderId, SupervisingProviderName, SupervisingProviderNPI, SupervisingProviderSpecialty, SupervisingProviderSubSpecialty, SupervisingProviderTaxonomyCode, SupervisingProviderUPIN)
SELECT source.ClaimKey, source.ClaimNumber, source.RegionKey, TRIM(source.Coid), TRIM(source.ClaimAdjustmentsGreaterThanTotalCharges), source.ClaimAgeByClaimFileStatusLastChangeDate, source.ClaimAgeByDateOfService, source.ClaimAgeByLastBilledDate, source.ClaimAgeByLastLiabilityOwnerChangeDate, source.ClaimAgeByLastPaymentDate, source.ClaimAgeByLastPaymentOrAdjustmentDate, source.ClaimAgeByLastReleaseDate, source.ClaimAgeByVoidAndRecreateDate, TRIM(source.ClaimAgingBucketByDateOfService), source.ClaimAgingBucketByDateOfServiceSortOrder, TRIM(source.ClaimAgingBucketByLastLiabilityOwnerChangeDate), source.ClaimAgingBucketByLastLiabilityOwnerChangeDateSortOrder, TRIM(source.ClaimAgingBucketByLastPaymentOrAdjustmentDate), source.ClaimAgingBucketByLastPaymentOrAdjustmentDateSortOrder, TRIM(source.ClaimBalanceBucket), source.ClaimBalanceBucketSortOrder, TRIM(source.ClaimBalancePercentAdjudicated), TRIM(source.ClaimCreditBalance), source.ClaimDate, TRIM(source.ClaimFileStatusId), source.ClaimFileStatusLastChangeDate, TRIM(source.ClaimFileStatusName), TRIM(source.ClaimLastBilledCategory), source.ClaimLastBilledDate, source.ClaimLastInsurancePaymentDate, TRIM(source.ClaimLastNote), source.ClaimLastPatientPaymentDate, source.ClaimOriginalClaimNumber, TRIM(source.ClaimOwner), source.ClaimVoidAndRecreateDate, TRIM(source.ClaimZeroBalance), TRIM(source.ClaimRebilled), TRIM(source.ClaimBilled), TRIM(source.ClaimType), source.DateOfService, TRIM(source.FacilityId), TRIM(source.FacilityName), source.FacilityPlaceOfServiceCode, TRIM(source.Ins1InsurancePayerFinancialClassName), TRIM(source.Ins1InsurancePayerFinancialClassNum), TRIM(source.Ins1InsurancePayerPVFinancialClassName), TRIM(source.Ins1InsurancePayerPVFinancialClassNum), TRIM(source.Ins1InsurancePayerGroupName), TRIM(source.Ins1InsurancePayerId), TRIM(source.Ins1InsurancePayerName), TRIM(source.Ins1InsuredSubscriberNumber), TRIM(source.Ins1InsuredSubscriberGroupNumber), TRIM(source.Ins2InsurancePayerFinancialClassName), TRIM(source.Ins2InsurancePayerFinancialClassNum), TRIM(source.Ins2InsurancePayerPVFinancialClassName), TRIM(source.Ins2InsurancePayerPVFinancialClassNum), TRIM(source.Ins2InsurancePayerGroupName), TRIM(source.Ins2InsurancePayerId), TRIM(source.Ins2InsurancePayerName), TRIM(source.Ins2InsuredSubscriberNumber), TRIM(source.Ins2InsuredSubscriberGroupNumber), TRIM(source.Ins3InsurancePayerFinancialClassName), TRIM(source.Ins3InsurancePayerFinancialClassNum), TRIM(source.Ins3InsurancePayerPVFinancialClassName), TRIM(source.Ins3InsurancePayerPVFinancialClassNum), TRIM(source.Ins3InsurancePayerGroupName), TRIM(source.Ins3InsurancePayerId), TRIM(source.Ins3InsurancePayerName), TRIM(source.Ins3InsuredSubscriberNumber), TRIM(source.Ins3InsuredSubscriberGroupNumber), TRIM(source.LiabilityOwnerFinancialClassName), TRIM(source.LiabilityOwnerFinancialClassNum), TRIM(source.LiabilityOwnerPVFinancialClassName), TRIM(source.LiabilityOwnerPVFinancialClassNum), TRIM(source.LiabilityOwnerGovernmentIndicator), TRIM(source.LiabilityOwnerId), TRIM(source.LiabilityOwnerIndicator), TRIM(source.LiabilityOwnerInsuredSubscriberNumber), TRIM(source.LiabilityOwnerInsuredSubscriberGroupNumber), source.LiabilityOwnerLastChangeDate, TRIM(source.LiabilityOwnerName), TRIM(source.LiabilityOwnerPayerGroupName), TRIM(source.PatientDeceased), TRIM(source.PatientFirstName), source.PatientId, TRIM(source.PatientLastName), TRIM(source.PatientMiddleName), TRIM(source.PatientSendStatements), TRIM(source.PatientUnidentified), TRIM(source.PracticeGroupNPI), TRIM(source.PracticeId), TRIM(source.PracticeName), TRIM(source.PracticeSiteId), TRIM(source.PracticeState), TRIM(source.PracticeTaxId), TRIM(source.ReferringProviderId), TRIM(source.ReferringProviderName), TRIM(source.ReferringProviderUPIN), TRIM(source.ServicingProviderId), TRIM(source.ServicingProviderName), TRIM(source.ServicingProviderNPI), TRIM(source.ServicingProviderSpecialty), TRIM(source.ServicingProviderSubSpecialty), TRIM(source.ServicingProviderTaxonomyCode), TRIM(source.ServicingProviderUPIN), TRIM(source.GLDeptNum), source.Ins1InsuranceTotalPayments, source.Ins2InsuranceTotalPayments, source.Ins1InsuranceFirstBilledDate, source.Ins1InsuranceLastBilledDate, source.Ins2InsuranceFirstBilledDate, source.Ins2InsuranceLastBilledDate, source.AdjustmentsAdministration, source.AdjustmentsBaddebt, source.AdjustmentsCapitation, source.AdjustmentsCharity, source.AdjustmentsContractual, source.AdjustmentsDenial, source.AdjustmentsEscheat, source.AdjustmentsInterest, source.AdjustmentsNsf, source.AdjustmentsRefund, source.AdjustmentsUninsured, source.BalanceInsuranceLiability, source.BalancePatientLiability, source.BillCountIns1, source.BillCountIns1WithVoids, source.BillCountIns2, source.BillCountIns2WithVoids, source.BillCountIns3, source.BillCountIns3WithVoids, source.ClaimCount, source.PaymentsInsurance, source.PaymentsPatient, source.TotalAdjustments, source.TotalBalance, source.TotalCharges, source.TotalPayments, TRIM(source.CollectionCode), source.CollectionCodeChangeDate, TRIM(source.DiagnosisCode1), TRIM(source.DiagnosisCode2), TRIM(source.FacilityDbaName), TRIM(source.FacilityBillingName), TRIM(source.FacilityEdiId), TRIM(source.FacilityTaxonomyCode), source.UnbilledStatusKey, TRIM(source.RHHoldCode), TRIM(source.EncounterVisitReason), source.EncounterTimeIn, TRIM(source.ServicingProviderDoctorType), TRIM(source.RelayHealthLastReleaseClaimType), TRIM(source.EncounterCategory), TRIM(source.ProtocolName), TRIM(source.IplanOccMedPricing), TRIM(source.IplanWCPricing), source.CompanyNumber, TRIM(source.ArtivaPSENRELAYGUID), TRIM(source.SupervisingProviderId), TRIM(source.SupervisingProviderName), TRIM(source.SupervisingProviderNPI), TRIM(source.SupervisingProviderSpecialty), TRIM(source.SupervisingProviderSubSpecialty), TRIM(source.SupervisingProviderTaxonomyCode), TRIM(source.SupervisingProviderUPIN)
FROM {{ params.param_psc_stage_dataset_name }}.PV_FactARCube as source;
