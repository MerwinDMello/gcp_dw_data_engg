TRUNCATE TABLE {{ params.param_psc_core_dataset_name }}.CCU_RprtCodeQuality ;

INSERT INTO {{ params.param_psc_core_dataset_name }}.CCU_RprtCodeQuality 
(CodeQualityKey, ClaimKey, ClaimNumber, RegionKey, COID, ServiceDateKey, SvcProviderSpecialty, FirstInsBillDateWkOfMonth, FirstDenialCategories, PreBillEditCategories, QUALITYCATEGORY, Coder, Coder34Id, CoderType, ClaimCount, PracticeId,PatientMRN, PatientInternalId, VisitNumber, TransactionNumber_combined, SourceSystemCode, DWLastUpdateDateTime, InsertedBy, InsertedDTM, ModifiedBy, ModifiedDTM, CoderActionDate, FirstInsuranceBillDate, MinFirstDenialERADate)
SELECT CodeQualityKey, ClaimKey, ClaimNumber, RegionKey, TRIM(COID) AS COID, CAST(ServiceDateKey AS DATE) AS ServiceDateKey, TRIM(SvcProviderSpecialty) AS SvcProviderSpecialty, FirstInsBillDateWkOfMonth, TRIM(FirstDenialCategories) AS FirstDenialCategories, TRIM(PreBillEditCategories) AS PreBillEditCategories, TRIM(QUALITYCATEGORY) AS QUALITYCATEGORY, TRIM(Coder) AS Coder, TRIM(Coder34Id) AS Coder34Id, TRIM(CoderType) AS CoderType, ClaimCount, TRIM(PracticeId) AS PracticeId, TRIM(PatientMRN) AS PatientMRN, PatientInternalId, VisitNumber, TRIM(TransactionNumber_combined) AS TransactionNumber_combined, TRIM(SourceSystemCode) AS SourceSystemCode, CAST(DWLastUpdateDateTime AS DATE) AS DWLastUpdateDateTime, TRIM(InsertedBy) AS InsertedBy, CAST(InsertedDTM AS DATETIME) AS InsertedDTM, TRIM(ModifiedBy) AS ModifiedBy, CAST(ModifiedDTM AS DATETIME) AS ModifiedDTM, CAST(CoderActionDate AS DATE) AS CoderActionDate, CAST(FirstInsuranceBillDate AS DATE) AS FirstInsuranceBillDate, CAST(MinFirstDenialERADate AS DATE) AS MinFirstDenialERADate
FROM {{ params.param_psc_stage_dataset_name }}.CCU_RprtCodeQuality as source;
