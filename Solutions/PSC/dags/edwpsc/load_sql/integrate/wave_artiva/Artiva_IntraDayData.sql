
        
TRUNCATE TABLE {{ params.param_psc_core_dataset_name }}.Artiva_IntraDayData ;

INSERT INTO {{ params.param_psc_core_dataset_name }}.Artiva_IntraDayData (RefreshDate, Reporting_Date, WorkCategory, SourceSystem, Pat_Acct_Num, Unit_Num, COID, SSC, Same_Store, Customer_Code, HCA_Ind, CLIENT_Email_Ind, Total_Billed_Charge_Amt, Insurance_Payment_Amt, Current_Balance_Amt, Balance_Threshold, Stratification, Report_Type, Inclusion_Flag, Current_Pool_Category_Desc, Prev_Pool_Assignment_Id, Prev_Pool_Assignment_Desc, Iplan_Id, IplanName, Major_Payor_Group_ID, Major_Payor_Name, Specialization, Liability_Phase_Status_Desc, Encounter_Financial_Class_Code, Liability_Financial_Class_Code, Current_Pool_Assignment_Id, Current_Pool_Assignment_Desc, Wait_Date, Liability_Sequence_Number, Patient_Type_Code, Account_Status_Code, Discharge_Date, Pool_Responsible_Dept_Name, Last_Action_Date, Prev_Pool_Date, Age_In_Pool, Age_Gt_7Days, Age_Gt_7Days_Count, Action_Not_Taken, Numerator, Day_Interval_Sid, TierAmt, TierLevel, Current_Pool_PSPOOLDEPT, Current_Pool_PSPOOLTYPE, Current_Pool_PoolSubGroup, Current_Pool_PoolFunction, Current_Pool_PoolSLA, Current_Pool_PSPOOLVENDOR, Current_Pool_PSPOOLITMPRHR, Current_Pool_PSPOOLVNDESC, Current_Pool_PSPOOLLOB, Current_Pool_PSPOOLMANAGER, Current_Pool_PSPOOLPAYGRP, Current_Pool_PSPOOLRESDEPT, Current_Pool_PSPOOLTIER, Current_Pool_SeqNumber, Current_Pool_AccountID, Current_Pool_EncounterID, WorkedTodayBy, WorkedTodayTime, WorkedTodayActionID, WorkedTodayActionVendor, WorkedTodayActionVendorRoleType, WorkedTodayStatusID, WorkedTodayResultID, WorkedTodayPoolNumber, WorkedAccount, WorkedAccountYN, WorkedTodayTierAmt, ViewedButNotWorkedAccount, ViewedButNotWorkedAccountYN, TotalAccounts, ClaimBalance, ViewedTodayID, ViewedTodayTime, ViewedTodayDate, ViewedTodayVendor, ViewedTodayVendorRoleType, Claim_Entered_Current_Pool_Count, pvclaimkey, ecwClaimKey, Current_Pool_PSPOOLCONCTRLNUM, pvregionkey, ecwregionkey, DWLastUpdateDateTime)
SELECT source.RefreshDate, source.Reporting_Date, TRIM(source.WorkCategory), TRIM(source.SourceSystem), TRIM(source.Pat_Acct_Num), TRIM(source.Unit_Num), TRIM(source.COID), TRIM(source.SSC), TRIM(source.Same_Store), TRIM(source.Customer_Code), TRIM(source.HCA_Ind), TRIM(source.CLIENT_Email_Ind), source.Total_Billed_Charge_Amt, source.Insurance_Payment_Amt, source.Current_Balance_Amt, TRIM(source.Balance_Threshold), TRIM(source.Stratification), TRIM(source.Report_Type), TRIM(source.Inclusion_Flag), TRIM(source.Current_Pool_Category_Desc), TRIM(source.Prev_Pool_Assignment_Id), TRIM(source.Prev_Pool_Assignment_Desc), TRIM(source.Iplan_Id), TRIM(source.IplanName), TRIM(source.Major_Payor_Group_ID), TRIM(source.Major_Payor_Name), TRIM(source.Specialization), TRIM(source.Liability_Phase_Status_Desc), TRIM(source.Encounter_Financial_Class_Code), TRIM(source.Liability_Financial_Class_Code), TRIM(source.Current_Pool_Assignment_Id), TRIM(source.Current_Pool_Assignment_Desc), source.Wait_Date, source.Liability_Sequence_Number, TRIM(source.Patient_Type_Code), TRIM(source.Account_Status_Code), source.Discharge_Date, TRIM(source.Pool_Responsible_Dept_Name), source.Last_Action_Date, source.Prev_Pool_Date, source.Age_In_Pool, TRIM(source.Age_Gt_7Days), source.Age_Gt_7Days_Count, source.Action_Not_Taken, TRIM(source.Numerator), TRIM(source.Day_Interval_Sid), source.TierAmt, TRIM(source.TierLevel), TRIM(source.Current_Pool_PSPOOLDEPT), TRIM(source.Current_Pool_PSPOOLTYPE), TRIM(source.Current_Pool_PoolSubGroup), TRIM(source.Current_Pool_PoolFunction), source.Current_Pool_PoolSLA, TRIM(source.Current_Pool_PSPOOLVENDOR), source.Current_Pool_PSPOOLITMPRHR, TRIM(source.Current_Pool_PSPOOLVNDESC), TRIM(source.Current_Pool_PSPOOLLOB), TRIM(source.Current_Pool_PSPOOLMANAGER), TRIM(source.Current_Pool_PSPOOLPAYGRP), TRIM(source.Current_Pool_PSPOOLRESDEPT), TRIM(source.Current_Pool_PSPOOLTIER), source.Current_Pool_SeqNumber, TRIM(source.Current_Pool_AccountID), TRIM(source.Current_Pool_EncounterID), TRIM(source.WorkedTodayBy), source.WorkedTodayTime, TRIM(source.WorkedTodayActionID), TRIM(source.WorkedTodayActionVendor), TRIM(source.WorkedTodayActionVendorRoleType), TRIM(source.WorkedTodayStatusID), TRIM(source.WorkedTodayResultID), TRIM(source.WorkedTodayPoolNumber), source.WorkedAccount, TRIM(source.WorkedAccountYN), source.WorkedTodayTierAmt, source.ViewedButNotWorkedAccount, TRIM(source.ViewedButNotWorkedAccountYN), source.TotalAccounts, source.ClaimBalance, TRIM(source.ViewedTodayID), source.ViewedTodayTime, source.ViewedTodayDate, TRIM(source.ViewedTodayVendor), TRIM(source.ViewedTodayVendorRoleType), source.Claim_Entered_Current_Pool_Count, source.pvclaimkey, source.ecwClaimKey, TRIM(source.Current_Pool_PSPOOLCONCTRLNUM), source.pvregionkey, source.ecwregionkey, source.DWLastUpdateDateTime
FROM {{ params.param_psc_stage_dataset_name }}.Artiva_IntraDayData as source;
