
        
TRUNCATE TABLE {{ params.param_psc_core_dataset_name }}.Artiva_StgHCENCOUNTER ;

INSERT INTO {{ params.param_psc_core_dataset_name }}.Artiva_StgHCENCOUNTER (HCENID, HCEncounterAgefromDischarge, HCAdmittingDiagnosisCode, HCAdmittingDiagnosisCodeDesc, HCAdmittingDoctorId, HCAdmittingDoctorName, HCAdmittingDoctorUPIN, HCAdmissionDate, HCAdmissionSourceCode, HCAdmissionTime, HCAdmissionType, HCAltResponsiblePartyId, HCArrivalName, HCArrivalType, HCENASGPLNPARTCD, HCAttendingDoctorId, HCAttendingDoctorNumber, HCAttendingDoctorUPIN, HCAttendingDoctor, HCENAUTHEXCEPTCD, HCENAUTOACCDTE, HCENAUTOACCST, HCBadDebtType, HCBalance, HCBenefitsAssigned, HCENBENASGCRTIND, HCBrokenPromiseCount, HCNumberofCallsCount, HCChecklistUpdatedDate, HCENCLMFREQ, HCNumberofContactsCount, HCPayerContractName, HCENCONTRACTTYPCD, HCCorrespondenceId, HCDiagnosisCode1, HCDiagnosisCode2, HCDiagnosisCode3, HCDiagnosisCode4, HCDiagnosisCode5, HCDiagnosisCode6, HCDiagnosisCode7, HCDiagnosisCode8, HCDiagnosisCode1Description, HCDiagnosisCode10Description, HCDiagnosisCode11Description, HCDiagnosisCode12Description, HCDiagnosisCode13Description, HCDiagnosisCode14Description, HCDiagnosisCode15Description, HCDiagnosisCode16Description, HCDiagnosisCode17Description, HCDiagnosisCode18Description, HCDiagnosisCode2Description, HCDiagnosisCode3Description, HCDiagnosisCode4Description, HCDiagnosisCode5Description, HCDiagnosisCode6Description, HCDiagnosisCode7Description, HCDiagnosisCode8Description, HCDiagnosisCode9Description, HCDiagnosisIndicator, HCDischargeDiagnosis, HCDiagnosisRelatedGroup, HCDischargeDate, HCDischargeHour, HCDischargeMode, HCDischargeStatusCode, HCEstimatedBillAmount, HCFinAssistApprovedDate, HCFacilityId, HCENFACTYPE, HCFinalBillAmount, HCFinalBillDate, HCFinancialClass, HCDateofFirstPaymentDefault, HCGuarantorId, HCBalanceOnHostSystem, HCLastContactDate, HCLastLetterSentDate, HCLastPaymentAmount, HCLastPaymentDate, HCLastLoadDate, HCLastWorkedDate, HCNumberofLettersSent, HCManuallyProratedDate, HCManuallySequencedDate, HCMedicalRecordNumber, HCOccurrenceCode1, HCOccurrenceCode2, HCOccurrenceCode3, HCOccurrenceCode4, HCOccurrenceCode5, HCOccurrenceCode6, HCOccurrenceCode7, HCOccurrenceCode8, HCOccurrenceCodeDate1, HCOccurrenceCodeDate2, HCOccurrenceCodeDate3, HCOccurrenceCodeDate4, HCOccurrenceCodeDate5, HCOccurrenceCodeDate6, HCOccurrenceCodeDate7, HCOccurrenceCodeDate8, HCENOPPHYSID, HCENOPPHYSNAME, HCOriginalLoadDate, HCOriginalBalance, HCOriginationDate, HCOtherDoctor, HCOtherResponsiblePartyId, HCLastContactDateInPntAssist, HCNumContactsInPntAssist, HCNumberofPayments, HCPointofServiceAmount, HCPreQualificationDate, HCPreQualificationFamilySize, HCPreQualificationIncome, HCPreQualificationPercentage, HCPreregistrationComplete, HCENPRESENTONADMIND, HCPriorFinancialClass, HCPrimaryInsuranceId, HCENPRIORAUTHNUM, HCSelfPayAccountId, HCENPRNDIAGCD, HCProcedureCode1, HCProcedureCode2, HCProcedureCode3, HCProcedureCode4, HCProcedureCode5, HCProcedureCode6, HCProcedureCode1Description, HCProcedureCode2Description, HCProcedureCode3Description, HCProcedureCode4Description, HCProcedureCode5Description, HCProcedureCode6Description, HCProcedureCode1Date, HCProcedureCode2Date, HCProcedureCode3Date, HCProcedureCode4Date, HCProcedureCode5Date, HCProcedureCode6Date, HCPatientAccountingNumber, HCENPTAMTPAID, HCPatientId, HCNumberOfPromisesTaken, HCENPTSTATUSCD, HCPatientType, HCENPTVISITREASON, HCENPTVISITREASON2, HCENPTVISITREASON3, HCENPYRCLMCTRLNUM, HCReconciliationRecDate, HCReconciliationFoundDate, HCENREFNUM, HCRegistrarId, HCENRELCAUSECD, HCENRELCAUSECD2, HCReleaseOfInformation, HCENRENDPROVID, HCENRENDPROVNAME, HCENRENDPROVTAXID, HCResponsiblePartyId, HCServiceCode, HCDateOfService, HCServiceType, HCENSTMTFROMDATE, HCENSTMTTODATE, HCFacilitySubunit, HCTempResponsiblePartyId, HCTotalAdjustments, HCTotalAllowances, HCTotalCharges, HCTotalContractualAdj, HCTotalPayments, HCTotalWriteOffs, HCTotalTimeWorkedOnEncounter, PSAccidentIndicator, PSAdditionalDoctor1, PSAdditionalDoctor2, PSEncounterApptDeleteFlg, PSAppointmentIDECWEncounter, PSEncounterAppointmentStatus, PSBillingDoctor, PSClosedPracticeDate, PSClosedPracticeFlag, PSClosedPracticeType, PSCOIDForClaim, PSCollectionStatus, PSECWClaimStatus, PSEligibilityStatus, PSEmploymentRelatedClaimInd, PSFirstSymptomDate, PSFirstSymptomIndicator, PSICD9Or10Indicator, PSDateOfLastMenstrual, PSLastStatementDate, PSMiscValue, PSNewPatientFlag, PSOriginalClaimID, PSPlaceOfService, PSPregnancyIndicator, PSPreviousClaimID, RenderingProviderNPI, RenderingPhysician, PSServicingDoctor, PSStatementCount, PSSupervisingDoctor, PSTerminatedProviderDate, PSTerminatedProviderFlag, PSTerminatedProviderType, PSVisitType, PSRenderingProviderID, PSENSPCAGNY, PSENSPCAGNYSTARTDTE, PSENSPCAGNYENDDATE, PSENOCCSTMTCNT, PSENOCCLSTSTMTDTE, PSENOCCINVOICENMBR, PSENOCCLSTSTMTNMBR, PSENUNWORKTODTE, PSENUNWORKFRMDTE, PSENSTERLABORT, PSENSPECPRGID, PSENRESTYPE, PSENRENDPROVUPIN, PSReferringProviderID, PSENOCCINVOICEDTE, PSENOUTLABCHRGIND, PSENNATURECOND, PSENLASTSEENDTE, PSENLABCHRGAMT, PSENHEALTHKIDSERV, PSENACCEXTCAUSE, PSENEPSDTREFERRAL, PSENINITTREATDTE, PSENEPSDTREFERCD, PSENACCHOUR, PSENSIGDTE, PSENACCPLACE, PSENDTEDOCSENT, PSENDOCTYPE, PSENDOCREPTRANSIND, PSENCLMDELETEDIND, PSENACCRESPIND, PSENBILLTOTYPE, PSENATTACHCTRLNUM, PSENAPPTTIME, PSENAPPTDTE, HCENDIAGCD9, HCENDIAGCD10, HCENDIAGCD11, HCENDIAGCD12, PSENCURPAYER, PSENCOIDGRP, PSENSEQ1ID, PSENSEQ2ID, PSENSEQ3ID, PSENECWCLMSTATDTEACT, PSENECWCLMSTATUSDTE, PSENECWCLMSTPRTOADJ, PSENCLMUNPOSTAMT, PSENAPPTUNPOSTAMT, PSPRICollectionStatus, PSENLSTRETRCLCODE, PSENLSTRETRCLDTE, PSENCOLLSTATUSDTE, PSENVENDID, PSENSEQ1PAYERID, PSENSEQ1PYCPID, PSENHRUID, HCENSUBUNIT, PSENRELAYGUID, PSENINTCLAIMST, PSENINTINVDATE, PSENINTINVNUM, PSENINTINVORGNUM, PSENINTREBILLFLG, PSENINTVISITTYPE, PSENINTWHREAS, PSENQUEUETYPE, claimnumber, sourcesystem, ECWClaimKey, ECWClaimNumber, ECWRegionKey, PVClaimKey, PVClaimNumber, PVPracticeName, PVRegionKey, PSENTIER, PSENRHHOLDIND, PSENCASENUMBER, PSENTIERTHRSHLD, PSENLASTHBPSCRUBDTE)
SELECT TRIM(source.HCENID), source.HCEncounterAgefromDischarge, TRIM(source.HCAdmittingDiagnosisCode), TRIM(source.HCAdmittingDiagnosisCodeDesc), source.HCAdmittingDoctorId, TRIM(source.HCAdmittingDoctorName), TRIM(source.HCAdmittingDoctorUPIN), TRIM(source.HCAdmissionDate), TRIM(source.HCAdmissionSourceCode), TRIM(source.HCAdmissionTime), TRIM(source.HCAdmissionType), source.HCAltResponsiblePartyId, TRIM(source.HCArrivalName), TRIM(source.HCArrivalType), TRIM(source.HCENASGPLNPARTCD), TRIM(source.HCAttendingDoctorId), source.HCAttendingDoctorNumber, TRIM(source.HCAttendingDoctorUPIN), TRIM(source.HCAttendingDoctor), TRIM(source.HCENAUTHEXCEPTCD), TRIM(source.HCENAUTOACCDTE), TRIM(source.HCENAUTOACCST), TRIM(source.HCBadDebtType), source.HCBalance, TRIM(source.HCBenefitsAssigned), TRIM(source.HCENBENASGCRTIND), source.HCBrokenPromiseCount, source.HCNumberofCallsCount, TRIM(source.HCChecklistUpdatedDate), TRIM(source.HCENCLMFREQ), source.HCNumberofContactsCount, TRIM(source.HCPayerContractName), TRIM(source.HCENCONTRACTTYPCD), source.HCCorrespondenceId, TRIM(source.HCDiagnosisCode1), TRIM(source.HCDiagnosisCode2), TRIM(source.HCDiagnosisCode3), TRIM(source.HCDiagnosisCode4), TRIM(source.HCDiagnosisCode5), TRIM(source.HCDiagnosisCode6), TRIM(source.HCDiagnosisCode7), TRIM(source.HCDiagnosisCode8), TRIM(source.HCDiagnosisCode1Description), TRIM(source.HCDiagnosisCode10Description), TRIM(source.HCDiagnosisCode11Description), TRIM(source.HCDiagnosisCode12Description), TRIM(source.HCDiagnosisCode13Description), TRIM(source.HCDiagnosisCode14Description), TRIM(source.HCDiagnosisCode15Description), TRIM(source.HCDiagnosisCode16Description), TRIM(source.HCDiagnosisCode17Description), TRIM(source.HCDiagnosisCode18Description), TRIM(source.HCDiagnosisCode2Description), TRIM(source.HCDiagnosisCode3Description), TRIM(source.HCDiagnosisCode4Description), TRIM(source.HCDiagnosisCode5Description), TRIM(source.HCDiagnosisCode6Description), TRIM(source.HCDiagnosisCode7Description), TRIM(source.HCDiagnosisCode8Description), TRIM(source.HCDiagnosisCode9Description), TRIM(source.HCDiagnosisIndicator), TRIM(source.HCDischargeDiagnosis), TRIM(source.HCDiagnosisRelatedGroup), TRIM(source.HCDischargeDate), source.HCDischargeHour, TRIM(source.HCDischargeMode), TRIM(source.HCDischargeStatusCode), source.HCEstimatedBillAmount, TRIM(source.HCFinAssistApprovedDate), TRIM(source.HCFacilityId), TRIM(source.HCENFACTYPE), source.HCFinalBillAmount, TRIM(source.HCFinalBillDate), TRIM(source.HCFinancialClass), TRIM(source.HCDateofFirstPaymentDefault), TRIM(source.HCGuarantorId), source.HCBalanceOnHostSystem, TRIM(source.HCLastContactDate), TRIM(source.HCLastLetterSentDate), source.HCLastPaymentAmount, TRIM(source.HCLastPaymentDate), TRIM(source.HCLastLoadDate), TRIM(source.HCLastWorkedDate), source.HCNumberofLettersSent, TRIM(source.HCManuallyProratedDate), TRIM(source.HCManuallySequencedDate), TRIM(source.HCMedicalRecordNumber), TRIM(source.HCOccurrenceCode1), TRIM(source.HCOccurrenceCode2), TRIM(source.HCOccurrenceCode3), TRIM(source.HCOccurrenceCode4), TRIM(source.HCOccurrenceCode5), TRIM(source.HCOccurrenceCode6), TRIM(source.HCOccurrenceCode7), TRIM(source.HCOccurrenceCode8), TRIM(source.HCOccurrenceCodeDate1), TRIM(source.HCOccurrenceCodeDate2), TRIM(source.HCOccurrenceCodeDate3), TRIM(source.HCOccurrenceCodeDate4), TRIM(source.HCOccurrenceCodeDate5), TRIM(source.HCOccurrenceCodeDate6), TRIM(source.HCOccurrenceCodeDate7), TRIM(source.HCOccurrenceCodeDate8), TRIM(source.HCENOPPHYSID), TRIM(source.HCENOPPHYSNAME), TRIM(source.HCOriginalLoadDate), source.HCOriginalBalance, TRIM(source.HCOriginationDate), TRIM(source.HCOtherDoctor), source.HCOtherResponsiblePartyId, TRIM(source.HCLastContactDateInPntAssist), source.HCNumContactsInPntAssist, source.HCNumberofPayments, source.HCPointofServiceAmount, TRIM(source.HCPreQualificationDate), source.HCPreQualificationFamilySize, source.HCPreQualificationIncome, source.HCPreQualificationPercentage, TRIM(source.HCPreregistrationComplete), TRIM(source.HCENPRESENTONADMIND), TRIM(source.HCPriorFinancialClass), source.HCPrimaryInsuranceId, TRIM(source.HCENPRIORAUTHNUM), source.HCSelfPayAccountId, TRIM(source.HCENPRNDIAGCD), TRIM(source.HCProcedureCode1), TRIM(source.HCProcedureCode2), TRIM(source.HCProcedureCode3), TRIM(source.HCProcedureCode4), TRIM(source.HCProcedureCode5), TRIM(source.HCProcedureCode6), TRIM(source.HCProcedureCode1Description), TRIM(source.HCProcedureCode2Description), TRIM(source.HCProcedureCode3Description), TRIM(source.HCProcedureCode4Description), TRIM(source.HCProcedureCode5Description), TRIM(source.HCProcedureCode6Description), TRIM(source.HCProcedureCode1Date), TRIM(source.HCProcedureCode2Date), TRIM(source.HCProcedureCode3Date), TRIM(source.HCProcedureCode4Date), TRIM(source.HCProcedureCode5Date), TRIM(source.HCProcedureCode6Date), TRIM(source.HCPatientAccountingNumber), source.HCENPTAMTPAID, source.HCPatientId, source.HCNumberOfPromisesTaken, TRIM(source.HCENPTSTATUSCD), TRIM(source.HCPatientType), TRIM(source.HCENPTVISITREASON), TRIM(source.HCENPTVISITREASON2), TRIM(source.HCENPTVISITREASON3), TRIM(source.HCENPYRCLMCTRLNUM), TRIM(source.HCReconciliationRecDate), TRIM(source.HCReconciliationFoundDate), TRIM(source.HCENREFNUM), TRIM(source.HCRegistrarId), TRIM(source.HCENRELCAUSECD), TRIM(source.HCENRELCAUSECD2), TRIM(source.HCReleaseOfInformation), TRIM(source.HCENRENDPROVID), TRIM(source.HCENRENDPROVNAME), TRIM(source.HCENRENDPROVTAXID), source.HCResponsiblePartyId, TRIM(source.HCServiceCode), TRIM(source.HCDateOfService), TRIM(source.HCServiceType), TRIM(source.HCENSTMTFROMDATE), TRIM(source.HCENSTMTTODATE), TRIM(source.HCFacilitySubunit), source.HCTempResponsiblePartyId, source.HCTotalAdjustments, source.HCTotalAllowances, source.HCTotalCharges, source.HCTotalContractualAdj, source.HCTotalPayments, source.HCTotalWriteOffs, source.HCTotalTimeWorkedOnEncounter, TRIM(source.PSAccidentIndicator), TRIM(source.PSAdditionalDoctor1), TRIM(source.PSAdditionalDoctor2), source.PSEncounterApptDeleteFlg, TRIM(source.PSAppointmentIDECWEncounter), TRIM(source.PSEncounterAppointmentStatus), TRIM(source.PSBillingDoctor), TRIM(source.PSClosedPracticeDate), TRIM(source.PSClosedPracticeFlag), TRIM(source.PSClosedPracticeType), TRIM(source.PSCOIDForClaim), TRIM(source.PSCollectionStatus), TRIM(source.PSECWClaimStatus), TRIM(source.PSEligibilityStatus), TRIM(source.PSEmploymentRelatedClaimInd), TRIM(source.PSFirstSymptomDate), TRIM(source.PSFirstSymptomIndicator), TRIM(source.PSICD9Or10Indicator), TRIM(source.PSDateOfLastMenstrual), TRIM(source.PSLastStatementDate), TRIM(source.PSMiscValue), TRIM(source.PSNewPatientFlag), TRIM(source.PSOriginalClaimID), TRIM(source.PSPlaceOfService), TRIM(source.PSPregnancyIndicator), TRIM(source.PSPreviousClaimID), TRIM(source.RenderingProviderNPI), TRIM(source.RenderingPhysician), TRIM(source.PSServicingDoctor), source.PSStatementCount, TRIM(source.PSSupervisingDoctor), TRIM(source.PSTerminatedProviderDate), TRIM(source.PSTerminatedProviderFlag), TRIM(source.PSTerminatedProviderType), TRIM(source.PSVisitType), TRIM(source.PSRenderingProviderID), TRIM(source.PSENSPCAGNY), TRIM(source.PSENSPCAGNYSTARTDTE), TRIM(source.PSENSPCAGNYENDDATE), TRIM(source.PSENOCCSTMTCNT), TRIM(source.PSENOCCLSTSTMTDTE), TRIM(source.PSENOCCINVOICENMBR), TRIM(source.PSENOCCLSTSTMTNMBR), TRIM(source.PSENUNWORKTODTE), TRIM(source.PSENUNWORKFRMDTE), TRIM(source.PSENSTERLABORT), TRIM(source.PSENSPECPRGID), TRIM(source.PSENRESTYPE), TRIM(source.PSENRENDPROVUPIN), TRIM(source.PSReferringProviderID), TRIM(source.PSENOCCINVOICEDTE), TRIM(source.PSENOUTLABCHRGIND), TRIM(source.PSENNATURECOND), TRIM(source.PSENLASTSEENDTE), TRIM(source.PSENLABCHRGAMT), TRIM(source.PSENHEALTHKIDSERV), TRIM(source.PSENACCEXTCAUSE), TRIM(source.PSENEPSDTREFERRAL), TRIM(source.PSENINITTREATDTE), TRIM(source.PSENEPSDTREFERCD), TRIM(source.PSENACCHOUR), TRIM(source.PSENSIGDTE), TRIM(source.PSENACCPLACE), TRIM(source.PSENDTEDOCSENT), TRIM(source.PSENDOCTYPE), TRIM(source.PSENDOCREPTRANSIND), TRIM(source.PSENCLMDELETEDIND), TRIM(source.PSENACCRESPIND), TRIM(source.PSENBILLTOTYPE), TRIM(source.PSENATTACHCTRLNUM), TRIM(source.PSENAPPTTIME), TRIM(source.PSENAPPTDTE), TRIM(source.HCENDIAGCD9), TRIM(source.HCENDIAGCD10), TRIM(source.HCENDIAGCD11), TRIM(source.HCENDIAGCD12), TRIM(source.PSENCURPAYER), TRIM(source.PSENCOIDGRP), TRIM(source.PSENSEQ1ID), TRIM(source.PSENSEQ2ID), TRIM(source.PSENSEQ3ID), TRIM(source.PSENECWCLMSTATDTEACT), TRIM(source.PSENECWCLMSTATUSDTE), TRIM(source.PSENECWCLMSTPRTOADJ), TRIM(source.PSENCLMUNPOSTAMT), TRIM(source.PSENAPPTUNPOSTAMT), TRIM(source.PSPRICollectionStatus), TRIM(source.PSENLSTRETRCLCODE), source.PSENLSTRETRCLDTE, source.PSENCOLLSTATUSDTE, TRIM(source.PSENVENDID), TRIM(source.PSENSEQ1PAYERID), TRIM(source.PSENSEQ1PYCPID), source.PSENHRUID, TRIM(source.HCENSUBUNIT), TRIM(source.PSENRELAYGUID), TRIM(source.PSENINTCLAIMST), source.PSENINTINVDATE, TRIM(source.PSENINTINVNUM), TRIM(source.PSENINTINVORGNUM), TRIM(source.PSENINTREBILLFLG), TRIM(source.PSENINTVISITTYPE), TRIM(source.PSENINTWHREAS), TRIM(source.PSENQUEUETYPE), source.claimnumber, TRIM(source.sourcesystem), source.ECWClaimKey, source.ECWClaimNumber, source.ECWRegionKey, source.PVClaimKey, source.PVClaimNumber, TRIM(source.PVPracticeName), source.PVRegionKey, source.PSENTIER, TRIM(source.PSENRHHOLDIND), TRIM(source.PSENCASENUMBER), TRIM(source.PSENTIERTHRSHLD), TRIM(source.PSENLASTHBPSCRUBDTE)
FROM {{ params.param_psc_stage_dataset_name }}.Artiva_StgHCENCOUNTER as source;
