
        
TRUNCATE TABLE {{ params.param_psc_core_dataset_name }}.Artiva_FactECT ;

INSERT INTO {{ params.param_psc_core_dataset_name }}.Artiva_FactECT (ArtivaECTKey, ECTID, PPIKey, ECTRequestType, ECTRequestDescription, ECTInitialChangeFlag, ECTSource, ECTRoute, ECTEscalationLevel, ECTPriority, ECTCreatedDate, ECTCreatedTime, ECTUpdatedDate, ECTExportDate, ECTCompletedFlag, ECTNewMessagesFlag, ECTNewDocumentsFlag, ECTClosedDate, ECTClosedTime, ECTClosedMessage, ECTStatus, ECTAssignedTo, ECTOriginalSignatureRequiredFlag, ECTCarrier, ECTTrackingNumber, ECTInstructions, ECTActiveFlag, ECTCarrierNoteFlag, ECTClosedActionGroup, ECTClosedReason, ECTClosedUser, ECTDeletedFlag, ECTEscalationDate1, ECTEscalationDate2, ECTInstructionsCopiedFlag, ECTMessage, ECTNotes, ECTGuid, ECTPortalID, ECTRequestCode, ECTUpdateType, ECTFirstEscalationDays, ECTSecondEscalationDays, ECTRequestLockedFlag, ECTLastMessageDate, ECTLastMessageSource, ECTLastMessageUser, ECTLastMessageText, ECTFirstMessageDate, ECTFirstMessageSource, ECTFirstMessageUser, ECTFirstMessageText, DaysBetweenECTCreatedAndClosedDate, DaysBetweenECTCreatedAndClosedDateAgingBucket, DaysSinceECTUpdatedDate, DaysSinceECTUpdatedDateAgingBucket, ECTEffectiveDateOfChange, DWLastUpdateDateTime, SourceSystemCode, InsertedBy, InsertedDTM, ModifiedBy, ModifiedDTM, ECTTypeIndicator, DaysSinceECTCreatedDate, ProviderKey, GroupKey, PPICPIDPayorID, ECTPool, ECTLastPool, ECTStatusChangeDate, DaysSinceECTStatusDate, DaysSinceECTStatusDateAgingBucket)
SELECT source.ArtivaECTKey, source.ECTID, TRIM(source.PPIKey), TRIM(source.ECTRequestType), TRIM(source.ECTRequestDescription), TRIM(source.ECTInitialChangeFlag), TRIM(source.ECTSource), TRIM(source.ECTRoute), TRIM(source.ECTEscalationLevel), TRIM(source.ECTPriority), source.ECTCreatedDate, source.ECTCreatedTime, source.ECTUpdatedDate, source.ECTExportDate, TRIM(source.ECTCompletedFlag), TRIM(source.ECTNewMessagesFlag), TRIM(source.ECTNewDocumentsFlag), source.ECTClosedDate, source.ECTClosedTime, TRIM(source.ECTClosedMessage), TRIM(source.ECTStatus), TRIM(source.ECTAssignedTo), TRIM(source.ECTOriginalSignatureRequiredFlag), TRIM(source.ECTCarrier), TRIM(source.ECTTrackingNumber), TRIM(source.ECTInstructions), TRIM(source.ECTActiveFlag), TRIM(source.ECTCarrierNoteFlag), TRIM(source.ECTClosedActionGroup), TRIM(source.ECTClosedReason), TRIM(source.ECTClosedUser), TRIM(source.ECTDeletedFlag), source.ECTEscalationDate1, source.ECTEscalationDate2, TRIM(source.ECTInstructionsCopiedFlag), TRIM(source.ECTMessage), TRIM(source.ECTNotes), TRIM(source.ECTGuid), TRIM(source.ECTPortalID), TRIM(source.ECTRequestCode), TRIM(source.ECTUpdateType), TRIM(source.ECTFirstEscalationDays), TRIM(source.ECTSecondEscalationDays), TRIM(source.ECTRequestLockedFlag), source.ECTLastMessageDate, TRIM(source.ECTLastMessageSource), TRIM(source.ECTLastMessageUser), TRIM(source.ECTLastMessageText), source.ECTFirstMessageDate, TRIM(source.ECTFirstMessageSource), TRIM(source.ECTFirstMessageUser), TRIM(source.ECTFirstMessageText), source.DaysBetweenECTCreatedAndClosedDate, TRIM(source.DaysBetweenECTCreatedAndClosedDateAgingBucket), source.DaysSinceECTUpdatedDate, TRIM(source.DaysSinceECTUpdatedDateAgingBucket), source.ECTEffectiveDateOfChange, source.DWLastUpdateDateTime, TRIM(source.SourceSystemCode), TRIM(source.InsertedBy), source.InsertedDTM, TRIM(source.ModifiedBy), source.ModifiedDTM, TRIM(source.ECTTypeIndicator), source.DaysSinceECTCreatedDate, TRIM(source.ProviderKey), TRIM(source.GroupKey), TRIM(source.PPICPIDPayorID), TRIM(source.ECTPool), TRIM(source.ECTLastPool), source.ECTStatusChangeDate, source.DaysSinceECTStatusDate, TRIM(source.DaysSinceECTStatusDateAgingBucket)
FROM {{ params.param_psc_stage_dataset_name }}.Artiva_FactECT as source;
