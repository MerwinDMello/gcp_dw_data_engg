
        
TRUNCATE TABLE {{ params.param_psc_core_dataset_name }}.ECW_FactRiskAnalysis ;

INSERT INTO {{ params.param_psc_core_dataset_name }}.ECW_FactRiskAnalysis (RiskAnalysisKey, RiskLoadDateDateKey, ClaimCategory, ClaimNumber, ClaimKey, RegionKey, COID, COIDLOB, COIDDeptNum, COIDName, MarketName, DivisionName, GroupName, RenderingProviderNPI, PayerFinancialClass, CPID, FacilityID, PracticeFederalTaxID, ArtivaRuleID, ArtivaRuleDesc, ArtivaRuleCreateDate, ArtivaRuleLastUpdateDate, ArtivaRuleGlobalFlag, ArtivaHoldCodeID, ArtivaHoldCodeDescription, ArtivaHoldCodeType, ClaimPayorID, ClaimPayorName, ClaimPayorAuthorizationNumber, ServiceDateKey, ClaimAge, ClaimLastReleasedDate, TotalBalanceAmt, TotalChargesAmt, RenderingProvider, ProviderKey, CactusDivisionName, ProviderFirstName, ProviderLastName, ProviderMiddleName, ProviderNPI, ProviderStartDate, ProviderNotificationDate, ProviderLastRFCReceivedDate, GroupKey, ProviderGroupName, GroupDBA, GroupEnrollmentOperation, ProviderAddressType, PracticeAddressLine1, PracticeAddressLine2, PracticeCity, PracticeState, PracticeZip, PracticeTaxID, PPIKey, PPIEffectiveDate, PPIDepartmentFlag, PPICPIDPayorName, PPICPIDPayorID, PayorSplitByLocationFlag, PPIType, PPIStatus, PPIStatusDescription, PPIPhase, PPIEnrollmentAction, PPILeadGroupTaxID, PPIAlternateEffectiveDate, PPIStatusDate, PPILastWorkedDate, PPIApplicationSentToPayorDate, PPIApplicationReceivedFromPayorDate, PPIApplicationSentToProviderDate, PPIApplicationReceivedFromProviderDate, RiskStatus, RiskSubcategory, PSGRiskStatus, DWLastUpdateDateTime)
SELECT source.RiskAnalysisKey, source.RiskLoadDateDateKey, TRIM(source.ClaimCategory), source.ClaimNumber, source.ClaimKey, source.RegionKey, TRIM(source.COID), TRIM(source.COIDLOB), TRIM(source.COIDDeptNum), TRIM(source.COIDName), TRIM(source.MarketName), TRIM(source.DivisionName), TRIM(source.GroupName), TRIM(source.RenderingProviderNPI), TRIM(source.PayerFinancialClass), TRIM(source.CPID), TRIM(source.FacilityID), TRIM(source.PracticeFederalTaxID), source.ArtivaRuleID, TRIM(source.ArtivaRuleDesc), source.ArtivaRuleCreateDate, source.ArtivaRuleLastUpdateDate, source.ArtivaRuleGlobalFlag, TRIM(source.ArtivaHoldCodeID), TRIM(source.ArtivaHoldCodeDescription), TRIM(source.ArtivaHoldCodeType), source.ClaimPayorID, TRIM(source.ClaimPayorName), TRIM(source.ClaimPayorAuthorizationNumber), source.ServiceDateKey, source.ClaimAge, source.ClaimLastReleasedDate, source.TotalBalanceAmt, source.TotalChargesAmt, TRIM(source.RenderingProvider), TRIM(source.ProviderKey), TRIM(source.CactusDivisionName), TRIM(source.ProviderFirstName), TRIM(source.ProviderLastName), TRIM(source.ProviderMiddleName), TRIM(source.ProviderNPI), source.ProviderStartDate, source.ProviderNotificationDate, source.ProviderLastRFCReceivedDate, TRIM(source.GroupKey), TRIM(source.ProviderGroupName), TRIM(source.GroupDBA), TRIM(source.GroupEnrollmentOperation), TRIM(source.ProviderAddressType), TRIM(source.PracticeAddressLine1), TRIM(source.PracticeAddressLine2), TRIM(source.PracticeCity), TRIM(source.PracticeState), TRIM(source.PracticeZip), TRIM(source.PracticeTaxID), TRIM(source.PPIKey), source.PPIEffectiveDate, TRIM(source.PPIDepartmentFlag), TRIM(source.PPICPIDPayorName), TRIM(source.PPICPIDPayorID), TRIM(source.PayorSplitByLocationFlag), TRIM(source.PPIType), TRIM(source.PPIStatus), TRIM(source.PPIStatusDescription), TRIM(source.PPIPhase), TRIM(source.PPIEnrollmentAction), TRIM(source.PPILeadGroupTaxID), source.PPIAlternateEffectiveDate, source.PPIStatusDate, source.PPILastWorkedDate, source.PPIApplicationSentToPayorDate, source.PPIApplicationReceivedFromPayorDate, source.PPIApplicationSentToProviderDate, source.PPIApplicationReceivedFromProviderDate, TRIM(source.RiskStatus), TRIM(source.RiskSubcategory), TRIM(source.PSGRiskStatus), source.DWLastUpdateDateTime
FROM {{ params.param_psc_stage_dataset_name }}.ECW_FactRiskAnalysis as source;
