
        
TRUNCATE TABLE {{ params.param_psc_core_dataset_name }}.Artiva_FactPPI ;

INSERT INTO {{ params.param_psc_core_dataset_name }}.Artiva_FactPPI (ArtivaPPIKey, ArtivaProviderKey, ArtivaGroupKey, ArtivaProviderLocationKey, ArtivaGroupLocationKey, ArtivaLocationKey, PPIKey, PPILeadGroupTaxID, PPILeadGroupPrimaryCOID, PPILeadGroupProviderStartDate, PPILeadGroupProviderNotificationDate, PPIPool, PPIPoolDescription, PPIPayorLinkID, PPIPayorLinkDescription, PPIPayorLinkLeadFlag, PPIPayorLinkProducts, PPIType, PPIDepartmentFlag, PPIEnrollmentAction, PPIEnrollmentActionCategory, PPIPriorEnrollmentAction, PPIHighestPriorityECT, PPIHighestPriorityECTRequestType, PPIHighestPriorityECTRequestDescription, PPICPIDPayorName, PPICPIDPayorID, PPIAssociatedLocationType, PPIAssociatedLocationAddress, PPIOriginationDate, PPIPhase, PPIStatus, PPIStatusDescription, PPIResponsibleParty, PPIMilestoneCategory, PPIStatusDate, PPICompleteDate, PPICompletedFlag, PPIDaysInStatus, PPILastResultCode, PPIFollowUpDate, PPILastWorkedDate, PPIEffectiveDate, PPIAlternateEffectiveDate, PPIApplicationSentToProviderDate, PPIApplicationReceivedFromProviderDate, PPIApplicationSentToPayorDate, PPIApplicationReceivedFromPayorDate, PPIReactivationStartDate, PPIRecredentialingFromDate, PPIRecredentialingToDate, PPIStopEnrollmentDate, PPIStopEnrollmentReason, PPIPriorPhase, PPIPriorStatus, PPIPanels, PPIGin, PPIPin, PPIEDIApplicationEscalationFlag, PPIEDIApplicationSubmittedForSignatureDate, PPIEDIDelayDate, PPIEDIDuplicationApplicationFlag, PPIEDIApprovedDate, PPIEDISubmittedDate, PPIEDIEFAEFTApprovedDate, PPIEDIEFAEFTDelayDate, PPIEDIEFAEFTSubmittedDate, PPIEDIOnlinePortalApprovedDate, PPIEDIOnlinePortalSubmittedDate, PPIEDIOverrideCompletedDate, PPIEDIOverrideEscalationFlag, PPIEDIOverrideFailedFlag, PPIEDIOverridePayorVerifiedDate, PPIEDIOverrideRemedyTicketNumber, PPIEDIOverrideRemedyCompletedDate, PPIEDIOverrideSetupCompletedDate, PPIEDIOverrideSubmittedDate, PPIEDIOverrideTestingPassedDate, PPIEDIOverrideTestingSubmittedDate, PPIEDIOverrideRemedyTicketForwardedDate, PPIEDISecretServerCompletedDate, PPIEDISecretServerSubmittedDate, PPIEDITermEnrollmentOrOverrideDate, DaysSincePPIApplicationSentToPayorDate, DaysSincePPIStatusDate, DaysBetweenPPIOriginationDateAndApplicationSentToPayorDate, DaysBetweenPPIApplicationSentToPayorAndApplicationReceivedFromPayorDate, PPIApplicationSentToPayorDateYear, PPIApplicationSentToPayorDateMonthYear, PPIOriginationDateYear, PPIOriginationDateAgingBucket, PPIApplicationSentToPayorDateAgingBucket, PPIStatusDateAgingBucket, PPIApplicationSentToPayorAndApplicationReceivedFromPayorDateAgingBucket, PPILastNoteDate, PPILastNoteType, PPILastNoteCreatedBy, PPILastNote, PPIDaysSinceLastNote, PPIClaimsOnHoldBalance, PPIClaimsOnHoldCount, PPIClaimsAtRiskBalance, PPIClaimsAtRiskCount, PPIPEClaimsOnHoldBalance, PPIPEClaimsOnHoldCount, ProviderActionPlanSentDate, ProviderActionPlanReceivedDate, ProviderActionPlanCompletedDate, DaysBetweenActionPlanCompletedAndApplicationSentToProviderDate, DaysBetweenActionPlanCompletedAndApplicationSentToPayorDate, DaysBetweenPPIReceivedFromProviderAndApplicationSentToPayorDate, DaysBetweenPPIApplicationSentToProviderAndApplicationReceivedFromProviderDate, DaysSincePPILastWorkedDate, DaysSincePPILastWorkedDateAgingBucket, PPIFirstDateOfService, PPITotalChargesAmount, PPIVoidFlag, PPIEnrollmentActionChangedDate, PPIPoolStartDate, DaysSincePPIPoolStartDate, PPIPoolStartDateAgingBucket, DWLastUpdateDateTime, SourceSystemCode, InsertedBy, InsertedDTM, ModifiedBy, ModifiedDTM, PPISentToCMODate, PPISentToCommitteeDate, PPInitialSentToProviderDate, PPIInitialReceivedFromProviderDate, PPIInitialSentToPayorDate, PPIInitialReceivedFromPayorDate, PPIInitalEffectiveDate, PPIInitialSentToCMODate, PPIInitialSentToCommitteeDate, PPIInitialProvisionalSentToCMODate, PPIReactivationSentToProviderDate, PPIReactivationReceivedFromProviderDate, PPIReactivationSentToPayorDate, PPIReactivationReceivedFromPayorDate, PPICoreMissingItemsReceivedDate, PPIAllMissingItemsReceivedDate, PPIInitialHCAPSCredentialingStatusDate, PPIInitialCAQHAttestationDate, PPITypeIndicatorECT, PPIInitalReadyForCreation, PPINoLongerPending, PPReactivationReadyForCreation, PPIPacketColor, PPIEftSubmittedDate, PPIEftSecretServerSubmittedDate, PPIEftSecretServerCompletedDate, PPIEftWebPortalSubmittedDate, PPIEftWebPortalApprovedDate, PPIEftSigReq, PPIEftMgrSig, PPIEftVPSIG, PPIEftSecretServerReq, PPIEftIndProvApp, PPIEftNotarySig, PPIEftNumWebPortals, PPIEftPayorOutreach, PPIEftMultiCpidApp, PPIEftWebPortReq, PPIClaimsSubmissionBeforeEft, PPIEftPaymentProcessor, PPIEftOnlinePortalSetup, PPIEftGroupApp, PPIEftProcessTime, PPIEftAppChanged, PPIEnrollOnStateFlag, PPIPayorStateFLag, PPIPayorRejectionReason, PPIAssociatedLocationAddressLine2, PPITRACKING, PSPEPPIPRGRPTRMDTE, PSPEPPITEMPTAG, PSPEPPICORRCVDFLG, PSPEPPIDEACTDATE, PSPEPPIDEACTENDDATE)
SELECT source.ArtivaPPIKey, TRIM(source.ArtivaProviderKey), TRIM(source.ArtivaGroupKey), TRIM(source.ArtivaProviderLocationKey), TRIM(source.ArtivaGroupLocationKey), TRIM(source.ArtivaLocationKey), TRIM(source.PPIKey), TRIM(source.PPILeadGroupTaxID), TRIM(source.PPILeadGroupPrimaryCOID), source.PPILeadGroupProviderStartDate, source.PPILeadGroupProviderNotificationDate, TRIM(source.PPIPool), TRIM(source.PPIPoolDescription), TRIM(source.PPIPayorLinkID), TRIM(source.PPIPayorLinkDescription), TRIM(source.PPIPayorLinkLeadFlag), TRIM(source.PPIPayorLinkProducts), TRIM(source.PPIType), TRIM(source.PPIDepartmentFlag), TRIM(source.PPIEnrollmentAction), TRIM(source.PPIEnrollmentActionCategory), TRIM(source.PPIPriorEnrollmentAction), source.PPIHighestPriorityECT, TRIM(source.PPIHighestPriorityECTRequestType), TRIM(source.PPIHighestPriorityECTRequestDescription), TRIM(source.PPICPIDPayorName), TRIM(source.PPICPIDPayorID), TRIM(source.PPIAssociatedLocationType), TRIM(source.PPIAssociatedLocationAddress), source.PPIOriginationDate, TRIM(source.PPIPhase), TRIM(source.PPIStatus), TRIM(source.PPIStatusDescription), TRIM(source.PPIResponsibleParty), TRIM(source.PPIMilestoneCategory), source.PPIStatusDate, source.PPICompleteDate, TRIM(source.PPICompletedFlag), source.PPIDaysInStatus, TRIM(source.PPILastResultCode), source.PPIFollowUpDate, source.PPILastWorkedDate, source.PPIEffectiveDate, source.PPIAlternateEffectiveDate, source.PPIApplicationSentToProviderDate, source.PPIApplicationReceivedFromProviderDate, source.PPIApplicationSentToPayorDate, source.PPIApplicationReceivedFromPayorDate, source.PPIReactivationStartDate, source.PPIRecredentialingFromDate, source.PPIRecredentialingToDate, source.PPIStopEnrollmentDate, TRIM(source.PPIStopEnrollmentReason), TRIM(source.PPIPriorPhase), TRIM(source.PPIPriorStatus), TRIM(source.PPIPanels), TRIM(source.PPIGin), TRIM(source.PPIPin), TRIM(source.PPIEDIApplicationEscalationFlag), source.PPIEDIApplicationSubmittedForSignatureDate, source.PPIEDIDelayDate, TRIM(source.PPIEDIDuplicationApplicationFlag), source.PPIEDIApprovedDate, source.PPIEDISubmittedDate, source.PPIEDIEFAEFTApprovedDate, source.PPIEDIEFAEFTDelayDate, source.PPIEDIEFAEFTSubmittedDate, source.PPIEDIOnlinePortalApprovedDate, source.PPIEDIOnlinePortalSubmittedDate, source.PPIEDIOverrideCompletedDate, TRIM(source.PPIEDIOverrideEscalationFlag), TRIM(source.PPIEDIOverrideFailedFlag), source.PPIEDIOverridePayorVerifiedDate, TRIM(source.PPIEDIOverrideRemedyTicketNumber), source.PPIEDIOverrideRemedyCompletedDate, source.PPIEDIOverrideSetupCompletedDate, source.PPIEDIOverrideSubmittedDate, source.PPIEDIOverrideTestingPassedDate, source.PPIEDIOverrideTestingSubmittedDate, source.PPIEDIOverrideRemedyTicketForwardedDate, source.PPIEDISecretServerCompletedDate, source.PPIEDISecretServerSubmittedDate, source.PPIEDITermEnrollmentOrOverrideDate, source.DaysSincePPIApplicationSentToPayorDate, source.DaysSincePPIStatusDate, source.DaysBetweenPPIOriginationDateAndApplicationSentToPayorDate, source.DaysBetweenPPIApplicationSentToPayorAndApplicationReceivedFromPayorDate, source.PPIApplicationSentToPayorDateYear, source.PPIApplicationSentToPayorDateMonthYear, source.PPIOriginationDateYear, TRIM(source.PPIOriginationDateAgingBucket), TRIM(source.PPIApplicationSentToPayorDateAgingBucket), TRIM(source.PPIStatusDateAgingBucket), TRIM(source.PPIApplicationSentToPayorAndApplicationReceivedFromPayorDateAgingBucket), source.PPILastNoteDate, TRIM(source.PPILastNoteType), TRIM(source.PPILastNoteCreatedBy), TRIM(source.PPILastNote), source.PPIDaysSinceLastNote, source.PPIClaimsOnHoldBalance, source.PPIClaimsOnHoldCount, source.PPIClaimsAtRiskBalance, source.PPIClaimsAtRiskCount, source.PPIPEClaimsOnHoldBalance, source.PPIPEClaimsOnHoldCount, source.ProviderActionPlanSentDate, source.ProviderActionPlanReceivedDate, source.ProviderActionPlanCompletedDate, source.DaysBetweenActionPlanCompletedAndApplicationSentToProviderDate, source.DaysBetweenActionPlanCompletedAndApplicationSentToPayorDate, source.DaysBetweenPPIReceivedFromProviderAndApplicationSentToPayorDate, source.DaysBetweenPPIApplicationSentToProviderAndApplicationReceivedFromProviderDate, source.DaysSincePPILastWorkedDate, TRIM(source.DaysSincePPILastWorkedDateAgingBucket), source.PPIFirstDateOfService, source.PPITotalChargesAmount, TRIM(source.PPIVoidFlag), source.PPIEnrollmentActionChangedDate, source.PPIPoolStartDate, source.DaysSincePPIPoolStartDate, TRIM(source.PPIPoolStartDateAgingBucket), source.DWLastUpdateDateTime, TRIM(source.SourceSystemCode), TRIM(source.InsertedBy), source.InsertedDTM, TRIM(source.ModifiedBy), source.ModifiedDTM, source.PPISentToCMODate, source.PPISentToCommitteeDate, source.PPInitialSentToProviderDate, source.PPIInitialReceivedFromProviderDate, source.PPIInitialSentToPayorDate, source.PPIInitialReceivedFromPayorDate, source.PPIInitalEffectiveDate, source.PPIInitialSentToCMODate, source.PPIInitialSentToCommitteeDate, source.PPIInitialProvisionalSentToCMODate, source.PPIReactivationSentToProviderDate, source.PPIReactivationReceivedFromProviderDate, source.PPIReactivationSentToPayorDate, source.PPIReactivationReceivedFromPayorDate, source.PPICoreMissingItemsReceivedDate, source.PPIAllMissingItemsReceivedDate, source.PPIInitialHCAPSCredentialingStatusDate, source.PPIInitialCAQHAttestationDate, TRIM(source.PPITypeIndicatorECT), source.PPIInitalReadyForCreation, source.PPINoLongerPending, source.PPReactivationReadyForCreation, TRIM(source.PPIPacketColor), source.PPIEftSubmittedDate, source.PPIEftSecretServerSubmittedDate, source.PPIEftSecretServerCompletedDate, source.PPIEftWebPortalSubmittedDate, source.PPIEftWebPortalApprovedDate, TRIM(source.PPIEftSigReq), TRIM(source.PPIEftMgrSig), TRIM(source.PPIEftVPSIG), TRIM(source.PPIEftSecretServerReq), TRIM(source.PPIEftIndProvApp), TRIM(source.PPIEftNotarySig), TRIM(source.PPIEftNumWebPortals), TRIM(source.PPIEftPayorOutreach), TRIM(source.PPIEftMultiCpidApp), TRIM(source.PPIEftWebPortReq), TRIM(source.PPIClaimsSubmissionBeforeEft), TRIM(source.PPIEftPaymentProcessor), TRIM(source.PPIEftOnlinePortalSetup), TRIM(source.PPIEftGroupApp), source.PPIEftProcessTime, source.PPIEftAppChanged, TRIM(source.PPIEnrollOnStateFlag), TRIM(source.PPIPayorStateFLag), TRIM(source.PPIPayorRejectionReason), TRIM(source.PPIAssociatedLocationAddressLine2), TRIM(source.PPITRACKING), source.PSPEPPIPRGRPTRMDTE, TRIM(source.PSPEPPITEMPTAG), TRIM(source.PSPEPPICORRCVDFLG), source.PSPEPPIDEACTDATE, source.PSPEPPIDEACTENDDATE
FROM {{ params.param_psc_stage_dataset_name }}.Artiva_FactPPI as source;
