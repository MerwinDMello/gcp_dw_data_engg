
INSERT INTO {{ params.param_psc_core_dataset_name }}.CCU_FactSnapShotMTXInventory (ccumtxinventoryhistorykey, snapshotdatekey, ccumtxinventorykey, sourcesystem, owner, regionkey, coid, ccugolivestatus, ccugolivedate, assignedtovendor, vendorname, vendorassigneddate, practicekey, facilitykey, encounterid, servicedate, patientkey, servicingproviderkey, servicingproviderspecialty, servicingproviderspecialtycategory, visitstatusdescription, encounterlockeddate, inventorytype, claimvsencounterflag, sourcelastupdateddatetime, groupassignment, servicedateconsolidationdateflag, pos, encountermtxkey, loaddate, worked, workeddate, encounterlastmodifieddate, dayssincemodifieddate, dayssinceservicedate, busincessdayssinceservicedate, busincessdayssincelastmodified, procedurecategory1, procedurecategory2, cptcodes, ccunoncustomerconfigkey, ccunoncustomernpiconfigkey, daysopen, dwlastupdatedatetime, insertedby, inserteddtm, modifiedby, modifieddtm, cptmodifiers, icdcodes, snapshotdate)
SELECT source.ccumtxinventoryhistorykey, source.snapshotdatekey, source.ccumtxinventorykey, TRIM(source.sourcesystem), TRIM(source.owner), source.regionkey, TRIM(source.coid), TRIM(source.ccugolivestatus), source.ccugolivedate, TRIM(source.assignedtovendor), TRIM(source.vendorname), source.vendorassigneddate, source.practicekey, source.facilitykey, TRIM(source.encounterid), source.servicedate, source.patientkey, source.servicingproviderkey, TRIM(source.servicingproviderspecialty), TRIM(source.servicingproviderspecialtycategory), TRIM(source.visitstatusdescription), source.encounterlockeddate, TRIM(source.inventorytype), TRIM(source.claimvsencounterflag), source.sourcelastupdateddatetime, TRIM(source.groupassignment), TRIM(source.servicedateconsolidationdateflag), TRIM(source.pos), source.encountermtxkey, source.loaddate, source.worked, source.workeddate, source.encounterlastmodifieddate, source.dayssincemodifieddate, source.dayssinceservicedate, source.busincessdayssinceservicedate, source.busincessdayssincelastmodified, TRIM(source.procedurecategory1), TRIM(source.procedurecategory2), TRIM(source.cptcodes), source.ccunoncustomerconfigkey, source.ccunoncustomernpiconfigkey, source.daysopen, source.dwlastupdatedatetime, TRIM(source.insertedby), source.inserteddtm, TRIM(source.modifiedby), source.modifieddtm, TRIM(source.cptmodifiers), TRIM(source.icdcodes), source.snapshotdate
FROM {{ params.param_psc_stage_dataset_name }}.CCU_FactSnapShotMTXInventory as source;
