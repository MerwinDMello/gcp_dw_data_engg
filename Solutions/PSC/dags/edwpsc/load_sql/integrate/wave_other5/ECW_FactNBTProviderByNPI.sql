
        
TRUNCATE TABLE {{ params.param_psc_core_dataset_name }}.ECW_FactNBTProviderByNPI ;

INSERT INTO {{ params.param_psc_core_dataset_name }}.ECW_FactNBTProviderByNPI (SnapShotDateKey, ProviderSourceSystemKey, GLDepartmentNumber, Coid, ProviderFirstName, ProviderLastName, ProviderMiddleName, ProviderNPI, ProviderUPIN, CompanyCode, ProviderRelationshipName, SpecialtyName, SpecialtyType, CompensationType, BudgetCCIndicator, DepartmentName, ProviderAssignedStartDate, IsApprovedIndicator, GLLastUpdatedDate, GLLastUpdatedBy, ProviderStatusIndicator, StatusChangeDate, ProviderStartDate, AncillaryDepartmentNumber, BudgetStartDate, CommunityStatus, ContractPayConversionDate, ContractCompensationType, ContractCurrentPay, ContractEffectiveDate, ContractExpirationDate, FTECount, HospitalistIndicator, MultipleProviderDepartmentIndicator, NewReplacementName, OverheadDepartmentNumber, PracticeEstablishedByProcessName, ProductivityReason, ProductivityLevelFuture, ProductivityLevelToday, ProductivityStatus, DateChangedToProductivity, TechnicalLevel, ProjectedTerminationDate, StrategyName, StrategyTypeName, StrategyTypeReason, TerminationReason, TerminationResult, TerminationType, MORProviderStatusId, DataSourceCode, SourceSystemCode, CountProviderIndicator, ProviderLastUpdatedDate, ProviderLastUpdatedBy, SameStoreIndicator, InsertedBy, InsertedDTM, DWLastUpdateDateTime)
SELECT source.SnapShotDateKey, TRIM(source.ProviderSourceSystemKey), TRIM(source.GLDepartmentNumber), TRIM(source.Coid), TRIM(source.ProviderFirstName), TRIM(source.ProviderLastName), TRIM(source.ProviderMiddleName), TRIM(source.ProviderNPI), TRIM(source.ProviderUPIN), TRIM(source.CompanyCode), TRIM(source.ProviderRelationshipName), TRIM(source.SpecialtyName), TRIM(source.SpecialtyType), TRIM(source.CompensationType), TRIM(source.BudgetCCIndicator), TRIM(source.DepartmentName), source.ProviderAssignedStartDate, TRIM(source.IsApprovedIndicator), source.GLLastUpdatedDate, TRIM(source.GLLastUpdatedBy), TRIM(source.ProviderStatusIndicator), source.StatusChangeDate, source.ProviderStartDate, TRIM(source.AncillaryDepartmentNumber), source.BudgetStartDate, TRIM(source.CommunityStatus), source.ContractPayConversionDate, TRIM(source.ContractCompensationType), source.ContractCurrentPay, source.ContractEffectiveDate, source.ContractExpirationDate, source.FTECount, TRIM(source.HospitalistIndicator), TRIM(source.MultipleProviderDepartmentIndicator), TRIM(source.NewReplacementName), TRIM(source.OverheadDepartmentNumber), TRIM(source.PracticeEstablishedByProcessName), TRIM(source.ProductivityReason), TRIM(source.ProductivityLevelFuture), TRIM(source.ProductivityLevelToday), TRIM(source.ProductivityStatus), source.DateChangedToProductivity, TRIM(source.TechnicalLevel), source.ProjectedTerminationDate, TRIM(source.StrategyName), TRIM(source.StrategyTypeName), TRIM(source.StrategyTypeReason), TRIM(source.TerminationReason), TRIM(source.TerminationResult), TRIM(source.TerminationType), source.MORProviderStatusId, TRIM(source.DataSourceCode), TRIM(source.SourceSystemCode), TRIM(source.CountProviderIndicator), source.ProviderLastUpdatedDate, TRIM(source.ProviderLastUpdatedBy), TRIM(source.SameStoreIndicator), TRIM(source.InsertedBy), source.InsertedDTM, source.DWLastUpdateDateTime
FROM {{ params.param_psc_stage_dataset_name }}.ECW_FactNBTProviderByNPI as source;
