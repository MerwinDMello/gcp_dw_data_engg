
INSERT INTO {{ params.param_psc_core_dataset_name }}.CCU_FactSnapshotInventory (ccuinventoryhistorykey, snapshotdate, reportlastloadeddatetime, ccuinventorykey, regionkey, facilitykey, practicekey, deptcode, coid, ccugolivestatus, ccugolivedatekey, assignedtovendor, vendorname, vendorassigneddatekey, coidname, coidlob, coidspecialty, practicename, facilityname, pos, encounterid, servicedatekey, patientkey, patientid, patientname, servicingproviderkey, servicingproviderid, servicingprovidernpi, servicingprovidername, servicingproviderspecialty, servicingproviderspecialtycategory, visittypekey, visittype, visittypedescription, visitstatuskey, visitstatus, visitstatusdescription, encounterlockeddatekey, dayssincelockeddate, businessdayssincelockeddate, claimcreatedbyuserkey, claimcreatedbyusername, claimstatuskey, claimstatusname, liabilityiplankey, liabilityiplanname, liabilityiplanid, liabilityfinancialclass, claimnumber, totalbalanceamt, totalchargesamt, sourcesystem, owner, encounterlockflag, inventorytype, claimvsencounterflag, sourcelastupdateddatetime, groupassignment, claimvoidflag, claimdeleteflag, encountertype, claimrequired, nonbillable, servicedateconsolidationdateflag, encounterkey, claimkey, dwlastupdatedatetime, inventoryfirstloaddatekey, dayssinceservicedate, businessdayssinceservicedate, lastclaimstatusupdateddatetime, dayssincelaststatuschange, businessdayssincelaststatuschange, encounterlastmodifieddate, dayssinceencounterlastmodified, businessdayssincelastmodified, ccunoncustomerconfigkey, ccunoncustomerconfiglabel, worked, workeddatekey, ccunoncustomernpiconfigkey, procedurecategory1, procedurecategory2, cptcodes, billingareanumber, department, editflag, datecorrectedflag, workqueueid, workqueuetype, workqueuetab, dischargedate, cptmodifiers, icdcodes, sourceaprimarykeyvalue, accountid, claimsubstatusname, region, reasonforvisit, inventorylastloaddatetime, priority, savedby, saveddatekey, savedbyfirstname, savedbylastname, comments, servicingprovideruser34, visitnumber, recordstatus, docholdreason, workqueuename, groupname, marketname, divisionname, centerdescription)
SELECT source.ccuinventoryhistorykey, source.snapshotdate, source.reportlastloadeddatetime, source.ccuinventorykey, source.regionkey, source.facilitykey, source.practicekey, TRIM(source.deptcode), TRIM(source.coid), TRIM(source.ccugolivestatus), source.ccugolivedatekey, TRIM(source.assignedtovendor), TRIM(source.vendorname), source.vendorassigneddatekey, TRIM(source.coidname), TRIM(source.coidlob), TRIM(source.coidspecialty), TRIM(source.practicename), TRIM(source.facilityname), TRIM(source.pos), TRIM(source.encounterid), source.servicedatekey, source.patientkey, TRIM(source.patientid), TRIM(source.patientname), source.servicingproviderkey, source.servicingproviderid, TRIM(source.servicingprovidernpi), TRIM(source.servicingprovidername), TRIM(source.servicingproviderspecialty), TRIM(source.servicingproviderspecialtycategory), source.visittypekey, TRIM(source.visittype), TRIM(source.visittypedescription), source.visitstatuskey, TRIM(source.visitstatus), TRIM(source.visitstatusdescription), source.encounterlockeddatekey, source.dayssincelockeddate, source.businessdayssincelockeddate, source.claimcreatedbyuserkey, TRIM(source.claimcreatedbyusername), source.claimstatuskey, TRIM(source.claimstatusname), source.liabilityiplankey, TRIM(source.liabilityiplanname), source.liabilityiplanid, TRIM(source.liabilityfinancialclass), source.claimnumber, source.totalbalanceamt, source.totalchargesamt, TRIM(source.sourcesystem), TRIM(source.owner), TRIM(source.encounterlockflag), TRIM(source.inventorytype), TRIM(source.claimvsencounterflag), source.sourcelastupdateddatetime, TRIM(source.groupassignment), source.claimvoidflag, source.claimdeleteflag, source.encountertype, source.claimrequired, source.nonbillable, TRIM(source.servicedateconsolidationdateflag), source.encounterkey, source.claimkey, source.dwlastupdatedatetime, source.inventoryfirstloaddatekey, source.dayssinceservicedate, source.businessdayssinceservicedate, source.lastclaimstatusupdateddatetime, source.dayssincelaststatuschange, source.businessdayssincelaststatuschange, source.encounterlastmodifieddate, source.dayssinceencounterlastmodified, source.businessdayssincelastmodified, source.ccunoncustomerconfigkey, TRIM(source.ccunoncustomerconfiglabel), source.worked, source.workeddatekey, source.ccunoncustomernpiconfigkey, TRIM(source.procedurecategory1), TRIM(source.procedurecategory2), TRIM(source.cptcodes), TRIM(source.billingareanumber), TRIM(source.department), TRIM(source.editflag), source.datecorrectedflag, source.workqueueid, TRIM(source.workqueuetype), TRIM(source.workqueuetab), source.dischargedate, TRIM(source.cptmodifiers), TRIM(source.icdcodes), source.sourceaprimarykeyvalue, source.accountid, TRIM(source.claimsubstatusname), TRIM(source.region), TRIM(source.reasonforvisit), source.inventorylastloaddatetime, TRIM(source.priority), TRIM(source.savedby), source.saveddatekey, TRIM(source.savedbyfirstname), TRIM(source.savedbylastname), TRIM(source.comments), TRIM(source.servicingprovideruser34), TRIM(source.visitnumber), TRIM(source.recordstatus), TRIM(source.docholdreason), TRIM(source.workqueuename), TRIM(source.groupname), TRIM(source.marketname), TRIM(source.divisionname), TRIM(source.centerdescription)
FROM {{ params.param_psc_stage_dataset_name }}.CCU_FactSnapshotInventory as source;
