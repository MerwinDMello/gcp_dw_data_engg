
TRUNCATE TABLE {{ params.param_psc_core_dataset_name }}.ECW_CashValueCurrentClaimLineCharge;

INSERT INTO {{ params.param_psc_core_dataset_name }}.ECW_CashValueCurrentClaimLineCharge
  (
    ClaimLineChargeKey,
    Coid,
    DeptCode,
    CPTCodeKey,
    CPTModifier1,
    CPTUnits,
    CPTChargesAmt,
    CalculatedLineBalance,
    PostedInsurancePaymentAmt,
    PostedPatientPaymentAmt,
    PostedContractualAdjustmentAmt,
    PostedFinancialAdjustmentAmt,
    CopayCPTOrder,
    ClaimKey,
    ClaimNumber,
    RegionKey,
    ServiceDateKey,
    RenderingProviderKey,
    GuarantorPatientKey,
    PatientBillType,
    Payer1IplanKey,
    Payer2IplanKey,
    LiabilityOwnerType,
    LiabilityIplanKey,
    ClaimBilledFlag,
    FirstInsuranceBillDateKey,
    LastInsuranceBillDateKey,
    BankDaysFromLastBillDate,
    InsuranceBillCount,
    FirstPatientStatementBillDateKey,
    LastPatientStatementBillDateKey,
    PatientStatementCount,
    PaymentExpectedRedFlagDaysThreshold,
    PaymentExpectedRedFlag,
    DenialProbability,
    InsurancePaymentProbability,
    ContractualExpectedAmt,
    AllowedExpectedAmt,
    PrimaryInsurancePaymentExpectedAmt,
    PrimaryInsurancePaymentLagDays,
    PrimaryInsurancePaymentExpectedDate,
    SecondaryInsurancePaymentExpectedAmt,
    SecondaryInsurancePaymentLagDays,
    SecondaryInsurancePaymentExpectedDate,
    PatientPaymentProbability,
    PatientPaymentExpectedAmt,
    PatientPaymentLagDays,
    PatientPaymentExpectedDate,
    LineBalanceCashValueAmt,
    ChargeValueKey,
    DWLastUpdateDateTime)
SELECT
  source.ClaimLineChargeKey,
  TRIM(source.Coid),
  TRIM(source.DeptCode),
  source.CPTCodeKey,
  TRIM(source.CPTModifier1),
  source.CPTUnits,
  source.CPTChargesAmt,
  source.CalculatedLineBalance,
  source.PostedInsurancePaymentAmt,
  source.PostedPatientPaymentAmt,
  source.PostedContractualAdjustmentAmt,
  source.PostedFinancialAdjustmentAmt,
  source.CopayCPTOrder,
  source.ClaimKey,
  source.ClaimNumber,
  source.RegionKey,
  source.ServiceDateKey,
  source.RenderingProviderKey,
  source.GuarantorPatientKey,
  TRIM(source.PatientBillType),
  source.Payer1IplanKey,
  source.Payer2IplanKey,
  source.LiabilityOwnerType,
  source.LiabilityIplanKey,
  source.ClaimBilledFlag,
  source.FirstInsuranceBillDateKey,
  source.LastInsuranceBillDateKey,
  source.BankDaysFromLastBillDate,
  source.InsuranceBillCount,
  source.FirstPatientStatementBillDateKey,
  source.LastPatientStatementBillDateKey,
  source.PatientStatementCount,
  source.PaymentExpectedRedFlagDaysThreshold,
  source.PaymentExpectedRedFlag,
  source.DenialProbability,
  source.InsurancePaymentProbability,
  source.ContractualExpectedAmt,
  source.AllowedExpectedAmt,
  source.PrimaryInsurancePaymentExpectedAmt,
  source.PrimaryInsurancePaymentLagDays,
  source.PrimaryInsurancePaymentExpectedDate,
  source.SecondaryInsurancePaymentExpectedAmt,
  source.SecondaryInsurancePaymentLagDays,
  source.SecondaryInsurancePaymentExpectedDate,
  source.PatientPaymentProbability,
  source.PatientPaymentExpectedAmt,
  source.PatientPaymentLagDays,
  source.PatientPaymentExpectedDate,
  source.LineBalanceCashValueAmt,
  source.ChargeValueKey,
  source.DWLastUpdateDateTime
FROM
  {{ params.param_psc_stage_dataset_name }}.ECW_CashValueCurrentClaimLineCharge
    AS source;
