
        
TRUNCATE TABLE {{ params.param_psc_core_dataset_name }}.ECW_AllClaimsCube ;

INSERT INTO {{ params.param_psc_core_dataset_name }}.ECW_AllClaimsCube (ClaimNumber, EcwRegionId, COID, CoidName, CoidAndCoidName, GroupName, DivisionName, MarketName, LineOfBusiness, ClaimAgeByClaimFileStatusLastChangeDate, ClaimAgeByDateOfService, ClaimAgeByLastBilledDate, ClaimAgeByLastReleaseDate, ClaimAgingBucketByDateOfService, ClaimAgingBucketByDateOfServiceSortOrder, ClaimArCategory, ClaimArSubcategory, ClaimBalanceBucket, ClaimBalanceBucketSortOrder, ClaimBalancePercentAdjudicated, ClaimCasCodesFromEcw, ClaimCasCodesFromEra, ClaimCreditBalance, ClaimDate, ClaimFileStatusId, ClaimFileStatusLastChangeDate, ClaimFileStatusName, ClaimIetActive, ClaimIetActiveCbo, ClaimIetActivePractice, ClaimLastBilledCategory, ClaimLastBilledDate, ClaimLastInsurancePaymentDate, ClaimLastPatientPaymentDate, ClaimOwner, ClaimRemarkCodes, ClaimZeroBalance, DateOfService, FacilityId, FacilityName, FacilityPlaceOfServiceCode, Ins1InsurancePayerFinancialClassName, Ins1InsurancePayerFinancialClassNum, Ins1InsurancePayerGroupName, Ins1InsurancePayerId, Ins1InsurancePayerName, Ins1InsurancePriorAuthNumber, Ins2InsurancePayerFinancialClassName, Ins2InsurancePayerFinancialClassNum, Ins2InsurancePayerGroupName, Ins2InsurancePayerId, Ins2InsurancePayerName, Ins2InsurancePriorAuthNumber, Ins3InsurancePayerFinancialClassName, Ins3InsurancePayerFinancialClassNum, Ins3InsurancePayerGroupName, Ins3InsurancePayerId, Ins3InsurancePayerName, LiabilityOwnerFinancialClassName, LiabilityOwnerFinancialClassNum, LiabilityOwnerGovernmentIndicator, LiabilityOwnerId, LiabilityOwnerIndicator, LiabilityOwnerName, LiabilityOwnerPayerGroupName, PatientFirstName, PatientId, PatientLastName, PatientMiddleName, PracticeGroupNPI, PracticeId, PracticeName, PracticeSiteId, PracticeState, PracticeTaxId, ReferringProviderId, ReferringProviderName, ReferringProviderUPIN, RelayHealthEdiEnrollmentError, RelayHealthFirstReleaseDate, RelayHealthFirstSubmissionDate, RelayHealthHoldCode, RelayHealthHoldStatus, RelayHealthLast277ResponseCategoryCode, RelayHealthLast277ResponseCategoryDescription, RelayHealthLast277ResponseDate, RelayHealthLast277ResponsePayerName, RelayHealthLastReleaseDate, RelayHealthLastSubmissionDate, RenderingProviderId, RenderingProviderName, RenderingProviderNPI, RenderingProviderSameStoreIndicator, RenderingProviderSpecialty, RenderingProviderSubSpecialty, RenderingProviderTaxonomyCode, RenderingProviderUPIN, ServicingProviderId, ServicingProviderName, ServicingProviderNPI, ServicingProviderSpecialty, ServicingProviderSubSpecialty, ServicingProviderTaxonomyCode, ServicingProviderUPIN, VirtualVisitFlag, VirtualVisitType, DOS_Month, DOS_Year, DOS_Year_Month, AdjustmentsAdministration, AdjustmentsBaddebt, AdjustmentsCapitation, AdjustmentsCharity, AdjustmentsContractual, AdjustmentsDenial, AdjustmentsEscheat, AdjustmentsInterest, AdjustmentsNsf, AdjustmentsRefund, AdjustmentsUninsured, BalanceInsuranceLiability, BalanceOnHold, BalancePatientLiability, ClaimCount, PaymentsInsurance, PaymentsPatient, TotalAdjustments, TotalBalance, TotalCharges, TotalPayments, PatientKeeperClaim)
SELECT source.ClaimNumber, source.EcwRegionId, TRIM(source.COID), TRIM(source.CoidName), TRIM(source.CoidAndCoidName), TRIM(source.GroupName), TRIM(source.DivisionName), TRIM(source.MarketName), TRIM(source.LineOfBusiness), source.ClaimAgeByClaimFileStatusLastChangeDate, source.ClaimAgeByDateOfService, source.ClaimAgeByLastBilledDate, source.ClaimAgeByLastReleaseDate, TRIM(source.ClaimAgingBucketByDateOfService), source.ClaimAgingBucketByDateOfServiceSortOrder, TRIM(source.ClaimArCategory), TRIM(source.ClaimArSubcategory), TRIM(source.ClaimBalanceBucket), source.ClaimBalanceBucketSortOrder, TRIM(source.ClaimBalancePercentAdjudicated), TRIM(source.ClaimCasCodesFromEcw), TRIM(source.ClaimCasCodesFromEra), TRIM(source.ClaimCreditBalance), source.ClaimDate, TRIM(source.ClaimFileStatusId), source.ClaimFileStatusLastChangeDate, TRIM(source.ClaimFileStatusName), TRIM(source.ClaimIetActive), TRIM(source.ClaimIetActiveCbo), TRIM(source.ClaimIetActivePractice), TRIM(source.ClaimLastBilledCategory), source.ClaimLastBilledDate, source.ClaimLastInsurancePaymentDate, source.ClaimLastPatientPaymentDate, TRIM(source.ClaimOwner), TRIM(source.ClaimRemarkCodes), TRIM(source.ClaimZeroBalance), source.DateOfService, source.FacilityId, TRIM(source.FacilityName), source.FacilityPlaceOfServiceCode, TRIM(source.Ins1InsurancePayerFinancialClassName), TRIM(source.Ins1InsurancePayerFinancialClassNum), TRIM(source.Ins1InsurancePayerGroupName), source.Ins1InsurancePayerId, TRIM(source.Ins1InsurancePayerName), TRIM(source.Ins1InsurancePriorAuthNumber), TRIM(source.Ins2InsurancePayerFinancialClassName), TRIM(source.Ins2InsurancePayerFinancialClassNum), TRIM(source.Ins2InsurancePayerGroupName), source.Ins2InsurancePayerId, TRIM(source.Ins2InsurancePayerName), TRIM(source.Ins2InsurancePriorAuthNumber), TRIM(source.Ins3InsurancePayerFinancialClassName), TRIM(source.Ins3InsurancePayerFinancialClassNum), TRIM(source.Ins3InsurancePayerGroupName), source.Ins3InsurancePayerId, TRIM(source.Ins3InsurancePayerName), TRIM(source.LiabilityOwnerFinancialClassName), TRIM(source.LiabilityOwnerFinancialClassNum), TRIM(source.LiabilityOwnerGovernmentIndicator), source.LiabilityOwnerId, TRIM(source.LiabilityOwnerIndicator), TRIM(source.LiabilityOwnerName), TRIM(source.LiabilityOwnerPayerGroupName), TRIM(source.PatientFirstName), source.PatientId, TRIM(source.PatientLastName), TRIM(source.PatientMiddleName), TRIM(source.PracticeGroupNPI), source.PracticeId, TRIM(source.PracticeName), TRIM(source.PracticeSiteId), TRIM(source.PracticeState), TRIM(source.PracticeTaxId), source.ReferringProviderId, TRIM(source.ReferringProviderName), TRIM(source.ReferringProviderUPIN), TRIM(source.RelayHealthEdiEnrollmentError), source.RelayHealthFirstReleaseDate, source.RelayHealthFirstSubmissionDate, TRIM(source.RelayHealthHoldCode), TRIM(source.RelayHealthHoldStatus), TRIM(source.RelayHealthLast277ResponseCategoryCode), TRIM(source.RelayHealthLast277ResponseCategoryDescription), source.RelayHealthLast277ResponseDate, TRIM(source.RelayHealthLast277ResponsePayerName), source.RelayHealthLastReleaseDate, source.RelayHealthLastSubmissionDate, source.RenderingProviderId, TRIM(source.RenderingProviderName), TRIM(source.RenderingProviderNPI), TRIM(source.RenderingProviderSameStoreIndicator), TRIM(source.RenderingProviderSpecialty), TRIM(source.RenderingProviderSubSpecialty), TRIM(source.RenderingProviderTaxonomyCode), TRIM(source.RenderingProviderUPIN), source.ServicingProviderId, TRIM(source.ServicingProviderName), TRIM(source.ServicingProviderNPI), TRIM(source.ServicingProviderSpecialty), TRIM(source.ServicingProviderSubSpecialty), TRIM(source.ServicingProviderTaxonomyCode), TRIM(source.ServicingProviderUPIN), TRIM(source.VirtualVisitFlag), TRIM(source.VirtualVisitType), TRIM(source.DOS_Month), source.DOS_Year, TRIM(source.DOS_Year_Month), source.AdjustmentsAdministration, source.AdjustmentsBaddebt, source.AdjustmentsCapitation, source.AdjustmentsCharity, source.AdjustmentsContractual, source.AdjustmentsDenial, source.AdjustmentsEscheat, source.AdjustmentsInterest, source.AdjustmentsNsf, source.AdjustmentsRefund, source.AdjustmentsUninsured, source.BalanceInsuranceLiability, source.BalanceOnHold, source.BalancePatientLiability, source.ClaimCount, source.PaymentsInsurance, source.PaymentsPatient, source.TotalAdjustments, source.TotalBalance, source.TotalCharges, source.TotalPayments, TRIM(source.PatientKeeperClaim)
FROM {{ params.param_psc_stage_dataset_name }}.ECW_AllClaimsCube as source;
