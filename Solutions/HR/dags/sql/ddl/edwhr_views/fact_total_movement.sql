/***************************************************************************************
S E C U R I T Y   V I E W
****************************************************************************************/

  CREATE OR REPLACE VIEW {{ params.param_hr_views_dataset_name }}.fact_total_movement AS SELECT
      a.total_movement_sid,
      a.employee_sid,
      a.date_id,
      a.analytics_msr_sid,
      a.employee_num,
      a.action_code,
      a.action_reason_text,
      a.movement_type,
      a.movement_direction_text,
      a.from_position_sid,
      a.from_position_level_sequence_num,
      a.from_fte_pct,
      a.from_schedule_work_code,
      a.from_working_location_code,
      a.from_dept_sid,
      a.from_lawson_company_num,
      a.from_process_level_code,
      a.from_job_code_sid,
      a.from_job_class_sid,
      a.from_coid,
      a.from_company_code,
      a.from_sub_functional_dept_num,
      a.from_functional_dept_num,
      a.from_auxiliary_status_sid,
      a.from_employee_status_sid,
      a.from_pay_rate_amt,
      a.from_key_talent_id,
      a.from_integrated_lob_id,
      a.to_position_sid,
      a.to_position_level_sequence_num,
      a.to_fte_pct,
      a.to_schedule_work_code,
      a.to_working_location_code,
      a.to_dept_sid,
      a.to_lawson_company_num,
      a.to_process_level_code,
      a.to_job_code_sid,
      a.to_job_class_sid,
      a.to_coid,
      a.to_company_code,
      a.to_sub_functional_dept_num,
      a.to_functional_dept_num,
      a.to_auxiliary_status_sid,
      a.to_employee_status_sid,
      a.to_pay_rate_amt,
      a.to_key_talent_id,
      a.to_integrated_lob_id,
      a.pay_change_diff_amt,
      a.source_system_code,
      a.dw_last_update_date_time
    FROM
      {{ params.param_hr_base_views_dataset_name }}.fact_total_movement AS a
  ;

