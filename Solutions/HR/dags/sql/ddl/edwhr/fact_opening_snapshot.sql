create table if not exists `{{ params.param_hr_core_dataset_name }}.fact_opening_snapshot`
(
  employee_sid INT64 NOT NULL OPTIONS(description="Unique numeric number generated for unique combination of Employee Identifier and HR Company Identifier"),
  analytics_msr_sid INT64 NOT NULL OPTIONS(description="This is the system assigned number to uniquely identfiy a row in the hierarchy."),
  position_sid INT64 NOT NULL OPTIONS(description="Unique ETL generated sequence number for each user defined codes that represents a position in the HR company."),
  requisition_sid INT64 NOT NULL OPTIONS(description="Unique id of an lawson generated requisition."),
  date_id DATE NOT NULL OPTIONS(description="The month the metric was calculated for the given dimensions."),
  period_end_date DATE OPTIONS(description="Date on which the period ends."),
  process_level_uid STRING OPTIONS(description="The combination of Coid, Process Level Code, Department Code and Lawson Company Number"),
  workflow_code STRING OPTIONS(description="A code for a short description for the workflow of a submission "),
  coid STRING OPTIONS(description="The company identifier which uniquely identifies a facility to corporate and all other facilities."),
  company_code STRING OPTIONS(description="Part of the unique identifier that identifies the company with which a facility is affiliated for application processing purposes."),
  recruitment_requisition_sid INT64 OPTIONS(description="A unique identifier for each requisition coming from the recruitment system."),
  recruitment_requisition_num_text STRING OPTIONS(description="A unique value coming from the source that combines the location code and lawson requisition number."),
  lawson_requisition_num INT64 OPTIONS(description="A unique identifier for the Lawson requisition from Lawson."),
  ghr_requisition_num INT64 OPTIONS(description="The requisition_SID for GHR records"),
  status_desc STRING OPTIONS(description="The description of the requisition status. (From Ref_Requisition_Status)"),
  key_talent_id INT64 OPTIONS(description="It is the unique sequence number generated by ETL for each Job code and Facility level combination"),
  status_code STRING OPTIONS(description="This represents the available code values for the status of the employee or applicant. "),
  position_key STRING OPTIONS(description="A combination of the Position_SID and the Job position Eff_To_Date"),
  job_code_sid INT64 OPTIONS(description="Unique Job code of an HR Company."),
  location_code STRING OPTIONS(description="Unique list of location codes are maintained in this table. Location codes are mainatined for Employee working location and also for Process level location."),
  functional_dept_num STRING OPTIONS(description="The number assigned in QMIRS for the input of departmental rollups."),
  sub_functional_dept_num STRING OPTIONS(description="Rollup of an account number under a specific department performed by the QMIRS source system."),
  dept_num STRING OPTIONS(description="It is the HCA department number of an company"),
  dept_sid INT64 OPTIONS(description="Unique ETL Generated Numeric number for each department code of Process level code associated with an HR Company Code."),
  dept_name STRING OPTIONS(description="This value is the name of an Department code"),
  dept_code STRING OPTIONS(description="Unique Department code of an HR Company"),
  process_level_code STRING OPTIONS(description="Unique process level code of an HR company value maintained in this field."),
  work_schedule_code STRING OPTIONS(description="Code that describes the weekly schedule of the requisition."),
  job_schedule_desc STRING OPTIONS(description="The description for the schedule of a job."),
  open_fte_percent NUMERIC OPTIONS(description="FTE percent of opened requisition"),
  requisition_approval_date DATE OPTIONS(description="The date that a requisition receives its final approval."),
  requisition_open_day_cnt NUMERIC OPTIONS(description="A count of the number of days between day the HR metric was calculated and the day the requisition was approved."),
  final_status_code STRING OPTIONS(description="A code that displays whether it was approved or rejected"),
  employee_num INT64 OPTIONS(description="This is an lawson employee number"),
  recruiter_owner_user_sid INT64 OPTIONS(description="A link to Recruitment_User to identify who is the owner of the requisition."),
  recruiter_name STRING OPTIONS(description="The combination of the first and last name of the recruiter."),
  hiring_manager_user_sid INT64 OPTIONS(description="A unique identifier for the hiring manager."),
  hiring_manager_name STRING OPTIONS(description="The combination of the first and last name of the hiring manager."),
  removed_ind STRING OPTIONS(description="Is deleted if the record is removed or No if the record is not removed"),
  patient_care_position_ind STRING OPTIONS(description="If the position is in Patient Care then the field says PCT, Else, No"),
  integrated_lob_id INT64 OPTIONS(description="This field captures ETL generated unique sequence number for each LOB description"),
  prn_tier_text STRING OPTIONS(description="Text to show which tier of PRN the opening is."),
  workforce_category_text STRING OPTIONS(description="Whether the position is Core or a Flex"),
  first_posted_date DATE OPTIONS(description="The date in which the posting was first posted"),
  metric_numerator_qty NUMERIC OPTIONS(description="This is the metric value that has met the target for the measure."),
  source_system_code STRING NOT NULL OPTIONS(description="A one character code indicating the specific source system from which the data originated."),
  dw_last_update_date_time DATETIME NOT NULL OPTIONS(description="Timestamp of update or load of this record to the Enterprise Data Warehouse.")
)
PARTITION BY date_id
CLUSTER BY employee_sid, analytics_msr_sid, position_sid, requisition_sid
OPTIONS(
  description="This table contains a snapshot of facts for recruitment openings."
);