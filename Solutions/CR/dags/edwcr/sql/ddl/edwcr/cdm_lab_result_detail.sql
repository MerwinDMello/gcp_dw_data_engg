CREATE OR REPLACE TABLE {{ params.param_cr_core_dataset_name }}.cdm_lab_result_detail
(
  clinical_finding_sk NUMERIC(29) NOT NULL OPTIONS(description='This element is the anchor surrogate key of the clinical finding'),
  patient_dw_id NUMERIC(29) NOT NULL OPTIONS(description='Primary Index element of the Patient Encounter in EDW.  It is accessed by a lookup using the natural key Patient Account Number and Facility Identifier.'),
  company_code STRING NOT NULL OPTIONS(description='An Identifier for the enterprise entity.  e.g. "H" for "HCA"'),
  coid STRING NOT NULL OPTIONS(description='Unique identifier for the enterprise'),
  lab_test_type_ref_code STRING OPTIONS(description='A code indicating the type of lab test such as a lab result (LAB), microbiology result (MICRO)'),
  lab_test_type_desc STRING OPTIONS(description='Description of the lab test type reference code.'),
  lab_test_id_text STRING OPTIONS(description='The Last Test ID Text is a unique identifier for the test that has been generated by the applicating system for the submitting organization. It is an external identifier and has not been created internally.'),
  lab_test_subid_text STRING OPTIONS(description='The Lab Test SubIdentifier Num is the display text of the test generated externally by a laboratory application system.'),
  lab_test_collect_ts DATETIME OPTIONS(description='The Finding Collected TS is a valid calendar date together with a valid hours, minutes and seconds when the finding was collected.'),
  lab_test_specimen_received_ts DATETIME OPTIONS(description='The Lab Test Specimen Received TS is a valid calendar date in month, day, year format together with  hours, minutes and seconds that records when the specimen was received'),
  lab_test_reported_ts DATETIME OPTIONS(description='The Lab Test Resulted TS is a valid calendar date in month, day, year format together with  hours, minutes and seconds that records the official relating or tell about an observation or test.'),
  lab_test_result_status_ts DATETIME OPTIONS(description='The Lab Test Result Status Ts is a valid calendar date in month, day, year format together with hours, minutes and seconds that records the effective day and time of the Finding Result Status.'),
  lab_test_result_status_ref_code STRING OPTIONS(description='The Lab Test Result Status Cd is an acronym or abbreviation that describes the current condition of the finding result. Possible values are: interim and final (F).'),
  lab_test_value_numeric_ind STRING OPTIONS(description='The Lab Test Value Numeric Indicator is  Y = Numeric and N = Not Numeric.'),
  lab_test_value_unit_type_code STRING OPTIONS(description='The Lab Test Value Unit Type code is the type of units the result is reported with'),
  lab_test_value_text STRING OPTIONS(description='The Text of the Lab Result'),
  lab_test_value_num NUMERIC(35, 6) OPTIONS(description='This is the numerical value of the lab test (if applicable)'),
  ref_range_low_text STRING OPTIONS(description='Reference Range Low is the lower value of the range'),
  ref_range_high_text STRING OPTIONS(description='Reference Range High is the higher value of the range'),
  ref_range_text STRING OPTIONS(description='Reference Range Text is the textual display of the range'),
  abnormal_flag_name STRING OPTIONS(description='The Abnormal Flag NM is the word or words used to interpret the numeric value of the result. The example is, The glucose test is normal, .0001/mg.'),
  source_system_original_code STRING OPTIONS(description='This is the code as it appears in the originating system before any mapping or tranformation has been performed.'),
  source_system_code STRING NOT NULL OPTIONS(description='A one character code indicating the specific source system from which the data originated.'),
  dw_last_update_date_time DATETIME NOT NULL OPTIONS(description='Timestamp of update or load of this record to the Enterprise Data Warehouse.')
)
CLUSTER BY patient_dw_id
OPTIONS(
  description='This view contains lab tests, their results, and range information for a result.'
);
