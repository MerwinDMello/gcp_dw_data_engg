#source system specific configuration values

v_sourcesysnm: navadhoc
v_databasetype: sqlserver
v_cred_secret_name: cr_sql_navadhoc_credentials/versions/latest
v_jdbc_class_name: com.microsoft.sqlserver.jdbc.SQLServerDriver
v_jdbc_jar: mssql-jdbc-12.4.0.jre8.jar
v_jdkfile: jre-8u351-linux-x64.tar.gz
v_jdkversion: jre1.8.0_351
v_jdbcbqpytemplate: Jdbc_to_BigQuery_PythonTemplate.py
v_machine_type: n1-standard-32

#DAG_1
tblist1: [
  "1~Navadhoc.dbo.PatientTumor~v_cr_stage_dataset_name.ref_status_stg~append~SELECT rtrim(ltrim(StatusDesc)) as Status_Desc, rtrim(ltrim(Status_Type_Desc)) as Status_Type_Desc, 'N' as source_system_code ,'v_currtimestamp' as dw_last_update_date_time  FROM (SELECT DISTINCT NavigationStatus as StatusDesc, 'Navigation' AS Status_Type_Desc FROM Navadhoc.dbo.PatientTumor (NOLOCK) where NavigationStatus is not null and NavigationStatus <> '' Union SELECT DISTINCT TaskState as StatusDesc, 'Task' AS Status_Type_Desc FROM Navadhoc.dbo.SurvivorShipCarePlan (NOLOCK) where TaskState is not null and TaskState <> '' union SELECT DISTINCT TransplantCandidacyStatus as StatusDesc, 'Cellular Therapy' AS Status_Type_Desc FROM Navadhoc.dbo.PatientHemeTransplant (NOLOCK) where TransplantCandidacyStatus is not null and TransplantCandidacyStatus <> '' Union SELECT DISTINCT DiseaseStatus as StatusDesc, 'Disease' AS Status_Type_Desc FROM Navadhoc.dbo.PatientImaging (NOLOCK) where DiseaseStatus is not null and DiseaseStatus <> '' Union SELECT DISTINCT TreatementStatus as StatusDesc, 'Treatment' AS Status_Type_Desc FROM Navadhoc.dbo.PatientImaging (NOLOCK) where TreatementStatus is not null and TreatementStatus <> '' union SELECT DISTINCT DiseaseStatus as StatusDesc, 'Disease' AS Status_Type_Desc FROM Navadhoc.dbo.PatientHemeDiagnosis (NOLOCK) where DiseaseStatus is not null and DiseaseStatus <> '' Union SELECT DISTINCT DiseaseStatus as StatusDesc, 'Disease' AS Status_Type_Desc FROM Navadhoc.dbo.PatientHemeDiseaseAssessment (NOLOCK) where DiseaseStatus is not null and DiseaseStatus <> '' Union SELECT DISTINCT TreatementStatus as StatusDesc, 'Treatment' AS Status_Type_Desc FROM Navadhoc.dbo.PatientHemeDiseaseAssessment (NOLOCK) where TreatementStatus is not null and TreatementStatus <> '' ) mm~100000",
  "2~Navadhoc.dbo.SurvivorShipCarePlan~v_cr_stage_dataset_name.ref_contact_method_stg~append~SELECT rtrim(ltrim(taskmeansofcontact)) as contact_method_desc , 'N' as source_system_code ,'v_currtimestamp' as dw_last_update_date_time FROM (SELECT DISTINCT TaskMeansofContact FROM Navadhoc.dbo.SurvivorShipCarePlan (NOLOCK) where TaskMeansofContact is not null and ltrim(rtrim(TaskMeansofContact)) <> '' UNION SELECT DISTINCT MeansOfContact  FROM Navadhoc.dbo.PatientCommunication (NOLOCK) ) source_query~100000",
  "3~navadhoc.dbo.patientgenetictesting~v_cr_stage_dataset_name.ref_breast_cancer_type_stg~append~SELECT DISTINCT rtrim(ltrim(geneticsbrcatype))  as Breast_Cancer_Type_Desc , 'N' as source_system_code ,'v_currtimestamp' as dw_last_update_date_time FROM Navadhoc.dbo.PatientGeneticTesting (NOLOCK) where GeneticsBRCAType is not null~100000",
  "4~navadhoc.dbo.patientcomplication~v_cr_stage_dataset_name.therapy_type_stg~append~SELECT DISTINCT rtrim(ltrim(associatetherapytype)) as therapy_type_desc, 'N' as source_system_code ,'v_currtimestamp' as dw_last_update_date_time FROM Navadhoc.dbo.PatientComplication (NOLOCK) where AssociateTherapyType is not null and ltrim(rtrim(AssociateTherapyType)) <> ''~100000",
  "5~navadhoc.dbo.patienthemeriskfactor~v_cr_stage_dataset_name.ref_site_location_stg~append~SELECT rtrim(ltrim(biopsysite)) as site_location_desc , 'N' as source_system_code ,'v_currtimestamp' as dw_last_update_date_time FROM (SELECT DISTINCT BiopsySite FROM	Navadhoc.dbo.PatientBiopsy (NOLOCK) where BiopsySite is not null UNION SELECT DISTINCT ROLocation FROM Navadhoc.dbo.PatientradiationOncology (NOLOCK) where ROLocation is not null UNION SELECT DISTINCT TumorDiseaseSite FROM Navadhoc.dbo.PatientHemeRiskFactor (NOLOCK) where TumorDiseaseSite IS NOT NULL UNION SELECT DISTINCT OtherTumorDiseaseSite FROM Navadhoc.dbo.PatientHemeRiskFactor (NOLOCK) where OtherTumorDiseaseSite IS NOT NULL) source_query~100000", 
  "6~navadhoc.dbo.patientprocedure~v_cr_stage_dataset_name.procedure_type_stg~append~SELECT DISTINCT ltrim(rtrim(proceduretype)) AS Procedure_type_desc, case when ltrim(rtrim(LinePlacementType)) <> '' and ltrim(rtrim(LinePlacementType)) is not NULL then ltrim(rtrim(LinePlacementType)) when ltrim(rtrim(OtherProcedureType)) <> '' and ltrim(rtrim(OtherProcedureType)) is not NULL then ltrim(rtrim(OtherProcedureType)) when ltrim(rtrim(OtherSurgeryType)) <> '' and ltrim(rtrim(OtherSurgeryType)) is not NULL then ltrim(rtrim(OtherSurgeryType)) else null end AS Procedure_Sub_Type_Desc , 'N' as source_system_code ,'v_currtimestamp' as dw_last_update_date_time FROM Navadhoc.dbo.PatientProcedure (NOLOCK) Where ProcedureType is not null and ltrim(rtrim(ProcedureType)) <> ''~100000",
  "7~navadhoc.dbo.patientbiopsy~v_cr_stage_dataset_name.ref_physician_specialty_stg~append~SELECT DISTINCT rtrim(ltrim(BiopsyPhysicianType)) as physician_speciality_desc, 'N' as source_system_code ,'v_currtimestamp' as dw_last_update_date_time FROM Navadhoc.dbo.PatientBiopsy (NOLOCK) Where BiopsyPhysicianType is not NULL~100000",
  "8~navadhoc.dbo.patientbiopsy~v_cr_stage_dataset_name.ref_result_stg~append~SELECT nav_result_desc , 'N' as source_system_code ,'v_currtimestamp' as dw_last_update_date_time  FROM (SELECT DISTINCT rtrim(ltrim(SurgeryPathResultType)) as Nav_Result_Desc FROM Navadhoc.dbo.PatientSurgery (NOLOCK) where SurgeryPathResultType is not null and ltrim(rtrim(SurgeryPathResultType)) <>''   union   SELECT DISTINCT rtrim(ltrim(SurgeryPathMarginResult)) as Nav_Result_Desc FROM Navadhoc.dbo.PatientSurgery (NOLOCK) where SurgeryPathMarginResult is not null and ltrim(rtrim(SurgeryPathMarginResult)) <>''   union   SELECT DISTINCT rtrim(ltrim(SurgeryPathOncoTypeDxResult)) as Nav_Result_Desc FROM Navadhoc.dbo.PatientSurgery (NOLOCK) where SurgeryPathOncoTypeDxResult is not null and ltrim(rtrim(SurgeryPathOncoTypeDxResult)) <>''   UNION   SELECT DISTINCT rtrim(ltrim(ComplicationOutcome)) as Nav_Result_Desc  FROM Navadhoc.dbo.PatientComplication (NOLOCK) where ComplicationOutcome is not null and ltrim(rtrim(ComplicationOutcome)) <>''   UNION   SELECT DISTINCT rtrim(ltrim(BxPathResultType)) as Nav_Result_Desc FROM Navadhoc.dbo.PatientBiopsy (NOLOCK) where BxPathResultType is not null and ltrim(rtrim(BxPathResultType)) <>''   UNION   SELECT DISTINCT rtrim(ltrim(BxPathMarginResult)) as Nav_Result_Desc FROM Navadhoc.dbo.PatientBiopsy (NOLOCK) where BxPathMarginResult is not null and ltrim(rtrim(BxPathMarginResult)) <>''   UNION   SELECT DISTINCT rtrim(ltrim(BxPathOncoTypeDxResult)) as Nav_Result_Desc FROM Navadhoc.dbo.PatientBiopsy (NOLOCK) where BxPathOncoTypeDxResult is not null and ltrim(rtrim(BxPathOncoTypeDxResult)) <>'' ) source_query~100000",
  "9~navadhoc.dbo.patientcommunication~v_cr_stage_dataset_name.contact_person_stg~append~SELECT DISTINCT rtrim(ltrim(PersonofContact)) as contact_person_desc , 'N' as source_system_code ,'v_currtimestamp' as dw_last_update_date_time FROM Navadhoc.dbo.PatientCommunication (NOLOCK) where PersonofContact is not null and ltrim(rtrim(PersonofContact)) <> ''~100000",
  "10~navadhoc.dbo.patientcommunication~v_cr_stage_dataset_name.contact_purpose_stg~append~SELECT DISTINCT rtrim(ltrim(purposeofcontact)) as contact_purpose_desc , 'N' as source_system_code ,'v_currtimestamp' as dw_last_update_date_time FROM Navadhoc.dbo.PatientCommunication (NOLOCK) where purposeofcontact is not null and ltrim(rtrim(purposeofcontact)) <> ''~100000",
  "11~navadhoc.dbo.patientdiagnosis~v_cr_stage_dataset_name.ref_diagnosis_detail_stg~append~SELECT DISTINCT rtrim(ltrim(DiagnosisMetastatic)) as diagnosis_detail_desc, rtrim(ltrim(DiagnosisIndicator)) as diagnosis_indicator_text, 'N' as source_system_code ,'v_currtimestamp' as dw_last_update_date_time FROM Navadhoc.dbo.PatientDiagnosis (NOLOCK) where DiagnosisMetastatic is not null OR DiagnosisIndicator is not null ~100000",
  "12~navadhoc.dbo.patientdiagnosis~v_cr_stage_dataset_name.ref_side_stg~append~SELECT rtrim(ltrim(side_desc)) as side_desc , 'N' as source_system_code ,'v_currtimestamp' as dw_last_update_date_time FROM (SELECT SurgerySide AS Side_Desc FROM Navadhoc.dbo.PatientSurgery (NOLOCK) UNION SELECT ImageArea AS Side_Desc FROM Navadhoc.dbo.PatientImaging (NOLOCK) UNION SELECT ReconSurgerySide AS Side_Desc FROM Navadhoc.dbo.PatientSurgeryReconstructive (NOLOCK) UNION SELECT DiagnosisSide AS Side_Desc FROM Navadhoc.dbo.PatientDiagnosis (NOLOCK)) source_query~100000",
  "13~navadhoc.dbo.patientradiationoncology~v_cr_stage_dataset_name.ref_lung_lobe_location_stg~append~SELECT DISTINCT  rtrim(ltrim(ROLobes)) as lung_lobe_location_desc  , 'N' as source_system_code ,'v_currtimestamp' as dw_last_update_date_time FROM Navadhoc.dbo.PatientRadiationOncology (NOLOCK) where ROLobes is not null ~100000",
  "14~navadhoc.dbo.patientradiationoncology~v_cr_stage_dataset_name.ref_facility_stg~append~SELECT DISTINCT REPLACE(REPLACE(LTRIM(RTRIM(A.FacilityName)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) AS facility_name, 'N' AS source_system_code, 'v_currtimestamp' AS dw_last_update_date_time FROM ( SELECT ROFacility AS FacilityName FROM Navadhoc.dbo.PatientRadiationOncology (NOLOCK) UNION ALL SELECT TumorReferralSource AS FacilityName FROM Navadhoc.dbo.PatientTumor (NOLOCK) UNION ALL SELECT ImageCenter AS FacilityName FROM Navadhoc.dbo.PatientImaging (NOLOCK) UNION ALL SELECT BiopsyFacility AS FacilityName FROM Navadhoc.dbo.PatientBiopsy (NOLOCK) UNION ALL SELECT MOFacility AS FacilityName FROM Navadhoc.dbo.PatientMedicalOncology (NOLOCK) UNION ALL SELECT EndTreatmentLocation AS FacilityName FROM Navadhoc.dbo.PatientTumor (NOLOCK) UNION ALL SELECT SurgeryFacility AS FacilityName FROM Navadhoc.dbo.PatientSurgery (NOLOCK) UNION ALL SELECT FacilityName AS FacilityName FROM Navadhoc.dbo.PatientHemeDiseaseAssessment (NOLOCK) ) AS A~100000",
  "15~navadhoc.dbo.patientimaging~v_cr_stage_dataset_name.ref_imaging_mode_stg~append~SELECT DISTINCT rtrim(ltrim(ImageMode)) as imaging_mode_desc , 'N' as source_system_code ,'v_currtimestamp' as dw_last_update_date_time FROM Navadhoc.dbo.PatientImaging (NOLOCK) where ImageMode is not NULL and rtrim(ltrim(ImageMode)) <> ''~100000",
  "16~navadhoc.dbo.dimtumortype~v_cr_stage_dataset_name.ref_tumor_type_stg~append~SELECT COALESCE(tumortypedimid,0) as tumor_type_id, REPLACE(REPLACE(COALESCE(LTRIM(RTRIM(tumortypedesc)),''), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) as tumor_type_desc, COALESCE(navigationtumorcode,0) as navigation_tumor_code_id, COALESCE(rtrim(ltrim(tumortypegroup)),'') as tumor_type_group_name , 'N' as source_system_code ,'v_currtimestamp' as dw_last_update_date_time FROM navadhoc.dbo.dimtumortype (NOLOCK)~100000",
  "17~navadhoc.dbo.reftreatmenttype~v_cr_core_dataset_name.ref_treatment_type~append~SELECT COALESCE(treatmenttypeid,0 )as treatment_type_id, COALESCE(rtrim(ltrim(treatmenttypedesc)) ,'' ) as treatment_type_desc, 'N' as source_system_code ,'v_currtimestamp' as dw_last_update_date_time FROM navadhoc.dbo.reftreatmenttype (nolock)~100000",
  "18~navadhoc.dbo.dimsurgerytype~v_cr_core_dataset_name.ref_surgery_type~append~SELECT COALESCE(surgerytypedimid,0) as surgery_type_id, COALESCE(rtrim(ltrim(surgerydesc)),'') as surgery_type_desc, 'N' as source_system_code ,'v_currtimestamp' as dw_last_update_date_time FROM navadhoc.dbo.dimsurgerytype (nolock)~100000",
  "19~navadhoc.dbo.dimnavigator~v_cr_core_dataset_name.ref_navigator~append~SELECT COALESCE(navigatordimid,0) as navigator_id, REPLACE(REPLACE(rtrim(ltrim(navigatorname)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) as navigator_name, rtrim(ltrim(navigator34id)) as navigator_3_4_id, 'N' as source_system_code ,'v_currtimestamp' as dw_last_update_date_time FROM navadhoc.dbo.dimnavigator (nolock)~100000",
  "20~navadhoc.dbo.reflabtype~v_cr_core_dataset_name.ref_lab_type~append~SELECT COALESCE(labtypeid,0) as lab_type_id,rtrim(ltrim(labtypedesc)) as lab_type_desc,'N' as source_system_code ,'v_currtimestamp' as dw_last_update_date_time FROM navadhoc.dbo.reflabtype (nolock)~100000",
  "21~navadhoc.dbo.refimagingtype~v_cr_core_dataset_name.ref_imaging_type~append~SELECT COALESCE(imagingtypeid,0) as imaging_type_id,rtrim(ltrim(imagingtypedesc)) as imaging_type_desc,'N' as source_system_code ,'v_currtimestamp' as dw_last_update_date_time FROM navadhoc.dbo.refimagingtype (nolock)~100000",
  "22~navadhoc.dbo.refdiagnosisresult~v_cr_core_dataset_name.ref_diagnosis_result~append~SELECT COALESCE(diagnosisresultid,0) as diagnosis_result_id,COALESCE(RTRIM(LTRIM(diagnosisresultdesc)),'') as  diagnosis_result_desc,'N' as source_system_code ,'v_currtimestamp' as dw_last_update_date_time FROM navadhoc.dbo.refdiagnosisresult (nolock)~100000",
  "23~navadhoc.dbo.dimdiagnosisname~v_cr_core_dataset_name.ref_diagnosis_navigation~append~SELECT COALESCE(diagnosisdimid ,0) as nav_diagnosis_id,COALESCE(rtrim(ltrim(diagnosisdesc)) ,'') as nav_diagnosis_desc,'N' as source_system_code ,'v_currtimestamp' as dw_last_update_date_time FROM navadhoc.dbo.dimdiagnosisname (nolock)~100000",
  "24~navadhoc.dbo.refcorerecord~v_cr_core_dataset_name.ref_core_record_type~append~SELECT COALESCE(corerecordid,0) as core_record_type_id, rtrim(ltrim(corerecorddesc)) as core_record_type_desc,'N' as source_system_code ,'v_currtimestamp' as dw_last_update_date_time FROM navadhoc.dbo.refcorerecord  (nolock)~100000",
  "25~navadhoc.dbo.dimbiopsytype~v_cr_core_dataset_name.ref_biopsy_type~append~SELECT COALESCE(biopsytypedimid,0) as  biopsy_type_id,rtrim(ltrim(biopsytypedesc)) as  biopsy_type_desc,'N' as source_system_code ,'v_currtimestamp' as dw_last_update_date_time FROM navadhoc.dbo.dimbiopsytype (nolock)~100000",
  "26~navadhoc.dbo.refbiopsyresult~v_cr_core_dataset_name.ref_biopsy_result~append~SELECT COALESCE(biopsyresultid,0) as biopsy_result_id,rtrim(ltrim(biopsyresultdesc)) as biopsy_result_desc,'N' as source_system_code ,'v_currtimestamp' as dw_last_update_date_time FROM navadhoc.dbo.refbiopsyresult (nolock)~100000",
  "27~navadhoc.dbo.refconsulttype~v_cr_core_dataset_name.ref_consult_type~append~SELECT COALESCE(consulttypeid,0) as consult_type_id,rtrim(ltrim(consulttypedesc)) as consult_type_desc,'N' as source_system_code ,'v_currtimestamp' as dw_last_update_date_time FROM navadhoc.dbo.refconsulttype (nolock)~100000"
]

#DAG_2
tblist2: [
  "28~navadhoc.dbo.dimnavqaction~v_cr_core_dataset_name.ref_navque_action~append~select coalesce(NavQActionDimID,0) as navque_action_id,coalesce(ltrim(rtrim(NavQActionName)),'') as navque_action_name,ltrim(rtrim(NavQActionDesc)) as navque_action_desc,'N' as source_system_code,'v_currtimestamp' as dw_last_update_date_time from navadhoc.dbo.dimnavqaction (NOLOCK)~100000",
  "29~navadhoc.dbo.dimnavqreason~v_cr_core_dataset_name.ref_navque_reason~append~select coalesce(NavQReasonDimID,0) as navque_reason_id,coalesce(ltrim(rtrim(NavQReasonName)),'') as navque_reason_name,ltrim(rtrim(NavQReasonDesc)) as navque_reason_desc,'N' as source_system_code,'v_currtimestamp' as dw_last_update_date_time from navadhoc.dbo.dimnavqreason (NOLOCK)~100000",
  "30~navadhoc.dbo.patientheme~v_cr_stage_dataset_name.ref_housing_type_stg~append~select DISTINCT Housing as housing_type_name,'v_currtimestamp' as dw_last_update_date_time from navadhoc.dbo.patientheme (NOLOCK)~100000",
  "31~navadhoc.dbo.patientcomplication~v_cr_stage_dataset_name.cn_patient_complication_stg~append~select coalesce(PatientComplicationFactID,0) as cn_patient_complication_sid,coalesce(PatientDimID,0) as nav_patient_id,coalesce(CoreRecordID,0) as core_record_type_id,coalesce(TumorTypeDimID,0) as tumor_type_id,coalesce(DiagnosisResultID,0) as diagnosis_result_id,coalesce(DiagnosisDimID,0) as nav_diagnosis_id,coalesce(NavigatorDimID,0) as navigator_id,coid,ComplicationDate as complication_date,REPLACE(REPLACE(ltrim(rtrim(AssociateTherapyType)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) as associatetherapytype,REPLACE(REPLACE(ltrim(rtrim(ComplicationOutcome)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) as complicationoutcome,coalesce(case when ltrim(rtrim(TreatmentStoppedDueToComplication))='Treatment Stopped' then 'Y' else 'N' end,'') as treatment_stopped_ind,REPLACE(REPLACE(ltrim(rtrim(Complication)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) as complication_text,REPLACE(REPLACE(ltrim(rtrim(SpecificComplication)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) as specific_complication_text,REPLACE(REPLACE(ltrim(rtrim(cast(Comments as varchar(1000)))), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) as comment_text,coalesce(concat('0x',convert(varchar(50),HBSource,2)),'') as hashbite_ssk,'v_currtimestamp' as dw_last_update_date_time from navadhoc.dbo.patientcomplication (NOLOCK)~100000",
  "32~navadhoc.dbo.patientheme~v_cr_stage_dataset_name.cn_patient_heme_stg~append~SELECT COALESCE(patienthemefactid,0) as patienthemefactid       ,COALESCE (patientdimid,0) as patientdimid       ,COALESCE (tumortypedimid,0) as tumortypedimid       ,COALESCE (diagnosisresultid,0) as diagnosisresultid       ,COALESCE (diagnosisdimid,0) as diagnosisdimid       ,COALESCE (facilitydimid,0) as facilitydimid       ,coid       ,COALESCE (navigatordimid,0) as navigatordimid       ,housing       ,localhousingaddress       ,otherlocalhousingaddress       ,transportation       ,drugusehistory       ,hematologist       ,CAST(concat('0x',CONVERT(varchar(50),hbsource,2)) as  VARCHAR(60)) as hbsource ,CAST(lastupdatedatetime as VARCHAR(27)) as lastupdatedatetime ,'v_currtimestamp' as dw_last_update_date_time FROM navadhoc.dbo.PatientHeme (NOLOCK)~100000",
  "33~navadhoc.dbo.patientsurgeryreconstructive~v_cr_stage_dataset_name.cn_patient_surgery_reconstruction_stg~append~select coalesce(PatientSurgeryReconstructiveFactID,0) as cn_patient_surgery_recstr_sid,coalesce(CoreRecordID,0) as core_record_type_id,coalesce(MedicalSpecialistDimId,0) as med_spcl_physician_id,coalesce(PatientDimID,0) as nav_patient_id,coalesce(TumorTypeDimId,0) as tumor_type_id,coalesce(DiagnosisResultId,0) as diagnosis_result_id,coalesce(DiagnosisDimId,0) as nav_diagnosis_id,coalesce(NavigatorDimId,0) as navigator_id,coid,'H' as company_code,ReconSurgeryDate as recstr_date,REPLACE(REPLACE(ltrim(rtrim(ReconSurgeryType)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) as surgery_recstr_type_text,reconsurgeryside ,case when upper(rtrim(ltrim(ReconSurgeryDeclined))) = 'RECON SURGERY DECLINED' then 'Y' else 'N' end as declined_ind,coalesce(concat('0x',convert(varchar(50),HBSource,2)),'') as hashbite_ssk,'N' as source_system_code,'v_currtimestamp' as dw_last_update_date_time from  navadhoc.dbo.patientsurgeryreconstructive (NOLOCK)~100000",
  "34~navadhoc.dbo.patientradiationoncology~v_cr_stage_dataset_name.cn_patient_radiation_oncology_stg~append~select coalesce(PatientRadiationOncologyFactID,0) as cn_patient_rad_oncology_sid,coalesce(CoreRecordID,0) as core_record_type_id,coalesce(PatientDimID,0) as nav_patient_id,coalesce(TumorTypeDimId,0) as tumor_type_id,coalesce(DiagnosisResultId,0) as diagnosis_result_id,coalesce(DiagnosisDimID,0) as nav_diagnosis_id,coalesce(TreatmentTypeId,0) as treatment_type_id,coid,'H' as company_code,coalesce(NavigatorDimId,0) as navigator_id,coalesce(MedicalSpecialistDimId,0) as med_spcl_physician_id,ROCoreRecordDate as core_record_date,ROActualStartDate as treatment_start_date,ROEndTreatmentDate as treatment_end_date,NULL as treatment_fractions_num,ROLocation as treatment_site_location_id,ROLobes as lung_lobe_location_id,case when ROElapse = 'Elapse' then 'Y' else 'N'  end as elapse_ind,ROElapseStart as elapse_start_date,ROElapseEnd as elapse_end_date,ltrim(rtrim(ROReason)) as radiation_oncology_reason_text,CASE When RONeoVsAdj='Neo-adjuvant' then 'Neo' when RONeoVsAdj='Adjuvant' then 'Adj' else null END AS treatment_therapy_schedule_cd,coalesce(case when ROPalliativeOnly='Palliative Only' then 'Y' else 'N' end,'') as palliative_ind,ROFacility as radiation_oncology_facility_id,cast(ROComment as varchar(4000)) as comment_text,coalesce(concat('0x',convert(varchar(50),HBSource,2)),'') as hashbite_ssk,'N' as source_system_code,'v_currtimestamp' as dw_last_update_date_time from navadhoc.dbo.patientradiationoncology (NOLOCK)~100000",
  "35~navadhoc.dbo.patientmultidisciplinarymeeting~v_cr_stage_dataset_name.cn_patient_mltp_disciplinary_meeting_stg~append~select coalesce(PatientMDMFactId,0) as cn_patient_mltp_disc_meet_sid,coalesce(PatientDimId,0) as nav_patient_id,coalesce(TumorTypeDimId,0) as tumor_type_id,coalesce(NavigatorDimId,0) as navigator_id,coid,'H' as company_code,MDMDate as meeting_date,case when upper(ltrim(rtrim(PresentedtoMDMMeeting))) = 'YES' then 'Y' when upper(ltrim(rtrim(PresentedtoMDMMeeting))) = 'NO' then 'N' when ltrim(rtrim(PresentedtoMDMMeeting)) is NULL or ltrim(rtrim(PresentedtoMDMMeeting)) = '' then NULL end as patient_discussed_ind, case when upper(ltrim(rtrim(PathwayChanged))) = 'YES' then 'Y' when upper(ltrim(rtrim(PathwayChanged))) = 'NO' then 'N' when ltrim(rtrim(PathwayChanged)) is NULL or ltrim(rtrim(PathwayChanged)) = '' then NULL end as treatment_change_ind,REPLACE(REPLACE(ltrim(rtrim(MDMComments)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) as meeting_notes_text,coalesce(concat('0x',convert(varchar(50),HBSource,2)),'') as hashbite_ssk,'N' as source_system_code,'v_currtimestamp' as dw_last_update_date_time from navadhoc.dbo.patientmultidisciplinarymeeting (NOLOCK)~100000",
  "36~navadhoc.dbo.patientlab~v_cr_stage_dataset_name.cn_patient_lab_result_stg~append~select coalesce(PatientLabFactID,0) as nav_patient_lab_result_sid,coalesce(CoreRecordID,0) as core_record_type_id,coalesce(PatientDimID,0) as nav_patient_id,coalesce(TumorTypeDimID,0) as tumor_type_id,coalesce(DiagnosisResultID,0) as diagnosis_result_id,coalesce(DiagnosisDimID,0) as nav_diagnosis_id,coalesce(NavigatorDimID,0) as navigator_id,coid,'H' as company_code,LabDate as lab_date,coalesce(LabTypeID,0) as lab_type_id,REPLACE(REPLACE(ltrim(rtrim(LabResults)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) as lab_result_text,REPLACE(REPLACE(ltrim(rtrim(cast(LabComments as varchar(5000)))), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) as comment_text,coalesce(concat('0x',convert(varchar(50),HBSource,2)),'') as hashbite_ssk,'N' as source_system_code ,current_timestamp as dw_last_update_date_time from navadhoc.dbo.patientlab (NOLOCK)~100000",
  "37~navadhoc.dbo.dimpatient~v_cr_stage_dataset_name.cn_physician_detail_stg~append~SELECT SRC.Physician_Id AS Physician_Id, REPLACE(REPLACE(LTRIM(RTRIM(SRC.Physician_Name)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) AS Physician_Name, REPLACE(REPLACE(LTRIM(RTRIM(SRC.Physician_Phone_Num)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) AS Physician_Phone_Num, 'v_currtimestamp' AS dw_last_update_date_time FROM ( SELECT NULL AS Physician_Id, Gynecologist AS Physician_Name, GynecologistPhone AS Physician_Phone_Num FROM navadhoc.dbo.DimPatient (NOLOCK) UNION SELECT NULL AS Physician_Id, PrimaryCarePhysician AS Physician_Name, PCPPhone AS Physician_Phone_Num FROM navadhoc.dbo.DimPatient (NOLOCK) UNION SELECT NULL AS Physician_Id, EndTreatmentPhysician, NULL AS Physician_Phone_Num FROM navadhoc.dbo.PatientTumor (NOLOCK) UNION SELECT MedicalSpecialistDimId AS Physician_Id, SpecialistName AS Physician_Name, NULL AS Physician_Phone_Num FROM navadhoc.dbo.DimMedicalSpecialist (NOLOCK) UNION SELECT NULL AS Physician_Id, Hematologist, NULL AS Physician_Phone_Num FROM navadhoc.dbo.PatientHeme (NOLOCK) ) SRC WHERE (LTRIM(RTRIM(SRC.Physician_Name)) IS NOT NULL OR LTRIM(RTRIM(SRC.Physician_Phone_Num)) IS NOT NULL) AND (LTRIM(RTRIM(SRC.Physician_Name)) <> '' OR LTRIM(RTRIM(SRC.Physician_Phone_Num)) <>'');~100000",
  "38~navadhoc.dbo.patientgenetictesting~v_cr_stage_dataset_name.cn_patient_genetics_testing_stg~append~SELECT GeneticsTestingFactID, CoreRecordID, PatientDimID, TumorTypeDimId, DiagnosisResultId, DiagnosisDimID, FacilityDimId, Coid, NavigatorDimId, GeneticsDate, REPLACE(REPLACE(LTRIM(RTRIM(GeneticsTestType)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) AS geneticstesttype, REPLACE(REPLACE(LTRIM(RTRIM(GeneticsSpecialist)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) AS geneticsspecialist, REPLACE(REPLACE(LTRIM(RTRIM(GeneticsBRCAType)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) AS geneticsbrcatype, REPLACE(REPLACE(LTRIM(RTRIM(CAST(GeneticsComments AS VARCHAR(1000)))), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) AS GeneticsComments, REPLACE(REPLACE(LTRIM(RTRIM(concat('0x', CONVERT(VARCHAR(50), HBSource, 2)))), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) AS HBSource, 'v_currtimestamp' AS dw_last_update_date_time FROM navadhoc.dbo.PatientGeneticTesting (NOLOCK)~100000",
  "39~navadhoc.dbo.patientclinicaltrial~v_cr_stage_dataset_name.cn_patient_clinical_trial_stg~append~select coalesce(PatientClinicalTrialFactID,0) as cn_patient_clinical_trial_sid,coalesce(PatientDimID,0) as nav_patient_id,coalesce(TumorTypeDimID,0) as tumor_type_id,coalesce(DiagnosisResultID,0) as diagnosis_result_id,coalesce(DiagnosisDimID,0) as nav_diagnosis_id,coalesce(NavigatorDimID,0) as navigator_id,coid, 'H' as company_code,REPLACE(REPLACE(LTRIM(RTRIM(ClinicalTrialName)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) as clinical_trial_name,case when ltrim(rtrim(EnrolledDuringCurrentDiagnosis)) = 'YES' then 'Y' when ltrim(rtrim(EnrolledDuringCurrentDiagnosis)) = 'NO' then 'N' else NULL end as clinical_trial_enrolled_ind,ClinicalTrialStartDate as clinical_trial_enrolled_date,coalesce(case when ltrim(rtrim(ClinicalTrialOffered)) = 'Clinical Trial Offered' then 'Y' else 'N' end,'') as clinical_trial_offered_ind,ClinicalTrialOfferedDate as clinical_trial_offered_date,concat('0x',convert(varchar(50),HBSource,2)) as hashbite_ssk,'N' as source_system_code,'v_currtimestamp' as dw_last_update_date_time from navadhoc.dbo.patientclinicaltrial (NOLOCK)~100000",
  "40~navadhoc.dbo.patientbrcascreeningassessment~v_cr_stage_dataset_name.cn_patient_brca_screening_assessment_stg~append~select coalesce(PatientBRCAScreeningAssessmentFactID,0) as brca_screening_assessment_sid,coalesce(PatientDimID,0) as nav_patient_id,coalesce(TumorTypeDimID,0) as tumor_type_id,coalesce(NavigatorDimID,0) as navigator_id,coid,'H' as company_code ,coalesce(case when EarlyOnsetBreastCancerPriorTo50 = 'YES' then 'Y' when EarlyOnsetBreastCancerPriorTo50 = 'NO' then 'N'  when EarlyOnsetBreastCancerPriorTo50 = 'UNKNOWN' then 'U'  else NULL end,'') as early_onset_breast_cancer_ind ,coalesce(case  when OvarianCancerHXOrFamilyHX = 'YES' then 'Y' when OvarianCancerHXOrFamilyHX = 'NO' then 'N'  when OvarianCancerHXOrFamilyHX = 'UNKNOWN' then 'U'  else NULL end,'') as ovarian_cancer_history_ind  ,coalesce(case  when TwoPrimaryBreastCancers = 'YES' then 'Y' when TwoPrimaryBreastCancers = 'NO' then 'N'  when TwoPrimaryBreastCancers = 'UNKNOWN' then 'U'  else NULL end,'') as two_primary_breast_cancer_ind , coalesce(case  when MaleBreastCancer = 'YES' then 'Y' when MaleBreastCancer = 'NO' then 'N'  when MaleBreastCancer = 'UNKNOWN' then 'U'  else NULL end,'') as male_breast_cancer_ind  ,coalesce(case  when TripleNegative = 'YES' then 'Y' when TripleNegative = 'NO' then 'N'  when TripleNegative = 'UNKNOWN' then 'U'  else NULL end,'') as triple_negative_ind   , coalesce(case  when AshkenaziJewish = 'YES' then 'Y' when AshkenaziJewish = 'NO' then 'N'  when AshkenaziJewish = 'UNKNOWN' then 'U'  else NULL end,'') as ashkenazi_jewish_ind , coalesce(case  when TwoOrMoreRelativesWithBreastCancer = 'YES' then 'Y' when TwoOrMoreRelativesWithBreastCancer = 'NO' then 'N'  when TwoOrMoreRelativesWithBreastCancer = 'UNKNOWN' then 'U'  else NULL end,'') as two_plus_relative_cancer_ind  ,coalesce(case  when PatientMeetsAssessmentCriteria = 'YES' then 'Y' when PatientMeetsAssessmentCriteria = 'NO' then 'N'  when PatientMeetsAssessmentCriteria = 'UNKNOWN' then 'U'  else NULL end,'') as meeting_assmnt_critieria_ind   ,concat('0x',convert(varchar(50),HBSource,2)) as hashbite_ssk ,'N' as source_system_code ,'v_currtimestamp' as dw_last_update_date_time from navadhoc.dbo.patientbrcascreeningassessment (NOLOCK)~100000",
  "41~navadhoc.dbo.patientprocedure~v_cr_stage_dataset_name.cn_patient_procedure_stg~append~select coalesce(PatientProcedureFactID,0) as cn_patient_procedure_sid,coalesce(CoreRecordID,0) as core_record_type_id,coalesce(MedicalSpecialistDimId,0) as med_spcl_physician_id,coalesce(PatientDimID,0) as nav_patient_id,coalesce(TumorTypeDimId,0) as tumor_type_id,coalesce(DiagnosisResultId,0) as diagnosis_result_id,coalesce(DiagnosisDimID,0) as nav_diagnosis_id,coid,'H' as company_code,coalesce(NavigatorDimId,0) as navigator_id,ProcedureDate as procedure_date,proceduretype,case when ltrim(rtrim(OtherProcedureType)) != '' then ltrim(rtrim(OtherProcedureType)) else NULL end as otherproceduretype,case when ltrim(rtrim(OtherSurgeryType)) != '' then ltrim(rtrim(OtherSurgeryType)) else NULL end as othersurgerytype,case when ltrim(rtrim(LinePlacementType)) != '' then ltrim(rtrim(LinePlacementType)) else NULL end as lineplacementtype,coalesce(case when ltrim(rtrim(ProcedurePalliative)) ='Palliative' then 'Y' else 'N' end,'') as palliative_ind,coalesce(ltrim(rtrim(concat('0x',convert(varchar(50),HBSource,2)))),'') as hashbite_ssk,'N' as source_system_code,'v_currtimestamp' as dw_last_update_date_time from navadhoc.dbo.patientprocedure (NOLOCK)~100000",
  "42~navadhoc.dbo.dimpatient~v_cr_stage_dataset_name.cn_patient_phone_num_stg~append~select nav_patient_id,phone_num,phone_num_type_code,source_system_code,dw_last_update_date_time from (select coalesce(PatientDimID,0) as nav_patient_id,'H' as  phone_num_type_code ,ltrim(rtrim(PatientPhone)) as phone_num,'N' as source_system_code,current_timestamp as dw_last_update_date_time from navadhoc.dbo.dimpatient (NOLOCK)  where PatientPhone is not null union select coalesce(PatientDimID,0) as nav_patient_id,'C' as  phone_num_type_code,ltrim(rtrim(PatientCellPhone)) as phone_num,'N' as source_system_code,current_timestamp as dw_last_update_date_time from navadhoc.dbo.dimpatient (NOLOCK) where PatientCellPhone is not null) source_query~100000",
  "43~navadhoc.dbo.patienttest~v_cr_stage_dataset_name.cn_patient_test_result_stg~append~SELECT COALESCE (PatientTestFactID,0) as nav_patient_test_result_sid, COALESCE (PatientDimID,0) as nav_patient_id, COALESCE (TumorTypeDimID,0)as tumor_type_id, COALESCE (DiagnosisResultID,0) as diagnosis_result_id, COALESCE (DiagnosisDimID,0)as nav_diagnosis_id, COALESCE (NavigatorDimID,0) as navigator_id, /*COALESCE (FacilityDimID,0) , */ REPLACE(REPLACE(ltrim(rtrim(coid)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) as coid, 'H' Company_Code, testdate as test_date, /*COALESCE (TestName,' '),*/ CASE 	WHEN ltrim(rtrim(TestName)) = 'KarnofskyPerformed' THEN 82 	WHEN ltrim(rtrim(TestName)) = 'ECOGPerformed' THEN 83     WHEN ltrim(rtrim(TestName)) = 'FEV1Performed' THEN 84 	WHEN ltrim(rtrim(TestName)) = 'DLCOPerformed' THEN 85 END as Test_Type_ID, /*Result,*/ CASE WHEN UPPER(ltrim(rtrim(Result))) = 'PERFORMED' THEN 'Y' ELSE 'N' END as Test_Performed_Ind, CASE 	WHEN ltrim(rtrim(TestName)) = 'KarnofskyPerformed' THEN KarnofskyScalePercent WHEN ltrim(rtrim(TestName)) = 'ECOGPerformed' THEN ECOG WHEN ltrim(rtrim(TestName)) = 'FEV1Performed' THEN FEV1Pct WHEN ltrim(rtrim(TestName)) = 'DLCOPerformed' THEN DLCOPct END as Test_Value_Num, COALESCE (concat('0x',CONVERT(varchar(50),HBSource,2)),'') as hashbite_ssk, 'N' as source_system_code ,'v_currtimestamp' as dw_last_update_date_time FROM navadhoc.dbo.patienttest (NOLOCK) cross apply  (values ('KarnofskyPerformed',KarnofskyPerformed),('ECOGPerformed',ECOGPerformed),('FEV1Performed',FEV1Performed),('DLCOPerformed',DLCOPerformed) ) c (TestName,Result)~100000",
  "44~navadhoc.dbo.survivorshipcareplan~v_cr_stage_dataset_name.cn_patient_survivorship_plan_task_stg~append~SELECT COALESCE (SurvivorShipCarePlanFactID,0) as nav_survivorship_plan_task_sid ,COALESCE (PatientDimID,0)  as nav_patient_id ,COALESCE (NavigatorDimID,0) as navigator_id /*,COALESCE (FacilityDimID,0) as */ ,LTRIM(RTRIM(Coid))  as coid ,'H' as company_code ,LTRIM(RTRIM(taskdescription)) as task_desc_text ,taskstate ,taskresolutiondate  as task_resolution_date ,taskcloseddate as task_closed_date ,taskmeansofcontact as taskmeasnofcontact ,LTRIM(RTRIM(TaskResultofContact)) as contact_result_text ,taskdateofcontact as contact_date ,LTRIM(RTRIM(TaskComments)) as comment_text ,concat('0x',CONVERT(varchar(50),HBSource,2)) as hashbite_ssk, 'N' as source_system_code ,'v_currtimestamp' as dw_last_update_date_time FROM navadhoc.dbo.SurvivorShipCarePlan (NOLOCK)~100000",
]

tblist3: [
  "45~navadhoc.dbo.patientmedicaloncology~v_cr_stage_dataset_name.cn_patient_medical_oncology_stg~append~select coalesce(MedicalOncologyFactID,0) as cn_patient_medical_oncology_id, coalesce(CoreRecordID,0) as core_record_type_id, coalesce(MedicalSpecialistDimID,0) as med_spcl_physician_id,coalesce(PatientDimID,0) as nav_patient_id,coalesce(TumorTypeDimID,0) as tumor_type_id,coalesce(DiagnosisResultID,0) as diagnosis_result_id,coalesce(DiagnosisDimID,0) as nav_diagnosis_id,coalesce(NavigatorDimID,0) as navigator_id,coid,'H' as company_code,coalesce(TreatmentTypeID,0) as treatment_type_id,coalesce(MOCoreRecordDate,'') as core_record_date,MOActualStartDate as treatment_start_date,MOActualEndDate as treatment_end_date,MOEstimatedEndDate as estimated_end_date,MOFacility as medical_oncology_facility_id,MODrug as drug_name,coalesce(case when MODoseDenseChemo ='Dose Dense Chemo' then 'Y' else 'N' end,'') dose_dense_chemo_ind,MODose as drug_dose_amt_text,MOMeasurement as drug_dose_measurement_text,coalesce(case when upper(ltrim(rtrim(MODosingAvailable))) ='YES' then 'Y' when upper(ltrim(rtrim(MODosingAvailable))) = 'NO' then  'N' else 'U' end,'') as drug_available_ind,MOQuantity as drug_qty,MOCycles as cycle_num,MOTimesEvery as cycle_frequency_text,MOReason as medical_oncology_reason_text,case when upper(ltrim(rtrim(MOTerminated)))='YES' then 'Y'  when upper(ltrim(rtrim(MOTerminated)))='NO' then 'N'  else 'U' end as terminated_ind,case when ltrim(rtrim(MONeoVsAdj)) = 'Neo-adjuvant' then 'Neo' when ltrim(rtrim(MONeoVsAdj)) = 'Adjuvant' then 'Adj' else null end as treatment_therapy_schedule_cd,cast(MOComments as varchar(4000)) as comment_text,coalesce(concat('0x',convert(varchar(50),HBSource,2)),'') as hashbite_ssk,'N' as source_system_code,'v_currtimestamp' as dw_last_update_date_time from navadhoc.dbo.patientmedicaloncology (NOLOCK)~100000",
  "46~navadhoc.dbo.patientbiopsy~v_cr_stage_dataset_name.cn_patient_biopsy_stg~append~select coalesce(PatientBiopsyFactID,0) as cn_patient_biopsy_sid,coalesce(CoreRecordID,0) as core_record_type_id,MedicalSpecialistDimID as med_spcl_physician_id,coalesce(ReferringMDDimID,0) as referring_physician_id,coalesce(PatientDimID,0) as nav_patient_id,coalesce(TumorTypeDimID,0) as tumor_type_id,coalesce(DiagnosisResultID,0) as diagnosis_result_id,coalesce(DiagnosisDimID,0) as nav_diagnosis_id,coalesce(NavigatorDimID,0) as navigator_id,REPLACE(REPLACE(ltrim(rtrim(coid)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) as coid,'H' as company_code,coalesce(BiopsyTypeDimID,0) as biopsy_type_id,coalesce(BiopsyResultID,0) as biopsy_result_id,BiopsyDate as biopsy_date,REPLACE(REPLACE(ltrim(rtrim(BiopsyFacility)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) as biopsyfacility,REPLACE(REPLACE(ltrim(rtrim(BiopsySite)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) as biopsysite, case when upper(ltrim(rtrim(BiopsyClip))) = 'YES' then 1 when upper(ltrim(rtrim(BiopsyClip))) = 'NO' then 0  when upper(ltrim(rtrim(BiopsyClip))) is NULL or upper(ltrim(rtrim(BiopsyClip))) = '' then NULL end as biopsy_clip_sw, case when upper(ltrim(rtrim(BiopsyNeedleBiopsy))) = 'YES' then 1 when upper(ltrim(rtrim(BiopsyNeedleBiopsy))) = 'NO' then 0  when upper(ltrim(rtrim(BiopsyNeedleBiopsy))) is NULL or upper(ltrim(rtrim(BiopsyNeedleBiopsy))) = '' then NULL end as biopsy_needle_sw, REPLACE(REPLACE(ltrim(rtrim(GeneralBiopsyType)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) as general_biopsy_type_text,REPLACE(REPLACE(ltrim(rtrim(BiopsyPhysicianType)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) as biopsyphysiciantype,REPLACE(REPLACE(ltrim(rtrim(cast(BiopsyComments as varchar(1000)))), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) as comment_text, coalesce(concat('0x',convert(varchar(50),HBSource,2)),'') as hashbite_ssk,'N' as source_system_code,'v_currtimestamp' as dw_last_update_date_time from navadhoc.dbo.patientbiopsy (NOLOCK)~100000",
  "47~navadhoc.dbo.patientconsultation~v_cr_stage_dataset_name.cn_patient_consultation_stg~append~select coalesce(PatientConsultationFactID,0) as cn_patient_consultation_sid,coalesce(PatientDimID,0) as nav_patient_id,coalesce(TumorTypeDimID,0) as tumor_type_id,coalesce(DiagnosisResultID,0) as diagnosis_result_id,coalesce(DiagnosisDimID,0) as nav_diagnosis_id,coalesce(NavigatorDimID,0) as navigator_id,coid,'H' as company_code,MedicalSpecialistDimID as med_spcl_physician_id,REPLACE(REPLACE(ltrim(rtrim(ConsultOtherType)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) as consult_other_type_text,ConsultDate as consult_date,ConsultPhone as consult_phone_num,coalesce(ConsultTypeID,0) as consult_type_id,REPLACE(REPLACE(ltrim(rtrim(cast(ConsultNotes as varchar(5000)))), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) as consult_notes_text,concat('0x',convert(varchar(50),hbsource,2)) as hashbite_ssk,'N' as source_system_code ,current_timestamp as dw_last_update_date_time from navadhoc.dbo.patientconsultation (NOLOCK)~100000",
  "48~navadhoc.dbo.patientdiagnosis~v_cr_stage_dataset_name.cn_patient_diagnosis_stg~append~select coalesce(PatientDiagnosisFactID,0) as cn_patient_diagnosis_sid,coalesce(PatientDimID,0) as nav_patient_id,coalesce(TumorTypeDimID,0) as tumor_type_id,coalesce(DiagnosisResultID,0) as diagnosis_result_id,coalesce(DiagnosisDimID,0) as nav_diagnosis_id,coalesce(NavigatorDimID,0) as navigator_id,coid,REPLACE(REPLACE(ltrim(rtrim(GeneralDiagnosisName)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) as general_diagnosis_name,diagnosisdate as diagnosis_date,REPLACE(REPLACE(ltrim(rtrim(DiagnosisMetastatic)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) as diagnosismetastatic,REPLACE(REPLACE(ltrim(rtrim(DiagnosisIndicator)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) as diagnosisindicator,REPLACE(REPLACE(ltrim(rtrim(DiagnosisSide)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) as diagnosisside,coalesce(concat('0x',convert(varchar(50),HBSource,2)),'') as hashbite_ssk,'v_currtimestamp' as dw_last_update_date_time from navadhoc.dbo.patientdiagnosis (NOLOCK)~100000",
  "49~navadhoc.dbo.dimpatient~v_cr_stage_dataset_name.cn_patient_address_stg~append~select coalesce(d.PatientDimID,0) as nav_patient_id,REPLACE(REPLACE(ltrim(rtrim(PatientAddress1)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) as address_line_1_text,REPLACE(REPLACE(ltrim(rtrim(PatientAddress2)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) as address_line_2_text,(ltrim(rtrim(PatientCity))) as city_name,(ltrim(rtrim(PatientState))) as state_code,(ltrim(rtrim(PatientZip))) as zip_code,(ltrim(rtrim(Housing))) as housing,(ltrim(rtrim(LocalHousingAddress))) as localhousingaddress,(ltrim(rtrim(OtherLocalHousingAddress))) as otherlocalhousingaddress,'N' as source_system_code,'v_currtimestamp' as dw_last_update_date_time from navadhoc.dbo.dimpatient (NOLOCK) d left join ( select Housing,LocalHousingAddress,OtherLocalHousingAddress,PatientDimID,row_number() over(partition by PatientDimID order by Housing,LocalHousingAddress,OtherLocalHousingAddress desc) as rn from navadhoc.dbo.patientheme (NOLOCK)) h on d.patientdimid = h.patientdimid and h.rn=1~100000",
  "50~navadhoc.dbo.patientsurgery~v_cr_stage_dataset_name.cn_patient_procedure_pathology_result_stg~append~select cn_patient_procedure_sid,margin_result_id,nav_result_id,oncotype_diagnosis_result_id,navigation_procedure_type_code,pathology_result_date,pathology_result_name,pathology_grade_available_ind,pathology_grade_num,pathology_tumor_size_av_ind,tumor_size_num_text,margin_result_detail_text,sentinel_node_result_code,estrogen_receptor_sw,estrogen_receptor_st_cd,estrogen_receptor_pct_text,progesterone_receptor_sw,progesterone_receptor_st_cd,progesterone_receptor_pct_text,oncotype_diagnosis_score_num,oncotype_diagnosis_risk_text,comment_text,hashbite_ssk,source_system_code,dw_last_update_date_time from (select coalesce(PatientSurgeryFactId,0) as cn_patient_procedure_sid,'S' as navigation_procedure_type_code, SurgeryPathResultType as nav_result_id,SurgeryPathResultDate as pathology_result_date,rtrim(ltrim(SurgeryPathResultName)) as pathology_result_name,case  when upper(ltrim(rtrim(SurgeryPathGradeAvailable))) = 'YES' then 'Y'  when upper(ltrim(rtrim(SurgeryPathGradeAvailable))) = 'NO'  then 'N' else null end as pathology_grade_available_ind, cast( case when SurgeryPathGrade = 'I' then 1 when SurgeryPathGrade = 'II' then 2 when SurgeryPathGrade = 'III' then 3 else null end as INT) as pathology_grade_num, case  when upper(ltrim(rtrim(SurgeryPathTumorSizeAvailable))) = 'YES' then 'Y' when upper(ltrim(rtrim(SurgeryPathTumorSizeAvailable))) = 'NO'  then 'N' else null end as pathology_tumor_size_av_ind, ltrim(rtrim(cast(SurgeryPathTumorSize as varchar(30)))) as tumor_size_num_text,ltrim(rtrim(SurgeryPathMarginResult)) as margin_result_id, ltrim(rtrim(SurgeryPathMarginDetail)) as margin_result_detail_text,ltrim(rtrim(SurgeryPathSentinelNodeResult)) as sentinel_node_result_code,cast (case when upper(ltrim(rtrim(SurgeryPathReceptorsER))) ='POS' then 1 when upper(ltrim(rtrim(SurgeryPathReceptorsER))) ='NEG' then 0 else null end as INTEGER) as estrogen_receptor_sw, SurgeryPathReceptorsERStrength as estrogen_receptor_st_cd, ltrim(rtrim(cast(SurgeryPathReceptorsERpct as varchar(20)))) as estrogen_receptor_pct_text,cast (case when upper(ltrim(rtrim(SurgeryPathReceptorsPR))) ='POS' then 1 when upper(ltrim(rtrim(SURGERYPATHRECEPTORSPR))) ='NEG' then 0 else null end  as INTEGER) as progesterone_receptor_sw, ltrim(rtrim(SurgeryPathReceptorsPRStrength)) as progesterone_receptor_st_cd, ltrim(rtrim(cast(SurgeryPathReceptorsPRpct as varchar(20))))  as progesterone_receptor_pct_text, SurgeryPathOncoTypeDxResult as oncotype_diagnosis_result_id,ltrim(rtrim(SurgeryPathOncoTypeDxScore)) as oncotype_diagnosis_score_num,ltrim(rtrim(SurgeryPathOncoTypeDxRisk)) as oncotype_diagnosis_risk_text,ltrim(rtrim(cast(SurgeryPathComments as varchar(4000)))) as comment_text,coalesce(concat('0x',convert(varchar(50),HBSource,2)),'')  as hashbite_ssk,'N' as source_system_code,'v_currtimestamp' as dw_last_update_date_time from navadhoc.dbo.patientsurgery (NOLOCK) union  select  coalesce(PatientBiopsyFactID,0) as cn_patient_procedure_sid, 'B' as navigation_procedure_type_code,BxPathResultType as nav_result_id,BxPathResultDate as pathology_result_date,ltrim(rtrim(BxPathResultName)) as pathology_result_name,NULL as pathology_grade_available_ind,cast(case when BxPathGrade = 'I' then 1 when BxPathGrade = 'II' then 2 when BxPathGrade = 'III' then 3 else null end as INT) as pathology_grade_num, NULL as pathology_tumor_size_av_ind, ltrim(rtrim(cast (BxPathTumorSize as varchar(30)))) as tumor_size_num_text,  ltrim(rtrim(BxPathMarginResult)) as margin_result_id, ltrim(rtrim(BxPathMarginDetail)) as margin_result_detail_text, ltrim(rtrim(BxPathSentinelNodeResult)) as sentinel_node_result_code, cast(case when upper(ltrim(rtrim(BxPathReceptorsER))) ='POS' then 1  when upper(ltrim(rtrim(BxPathReceptorsER))) ='NEG' then 0 else null end  as INTEGER) as estrogen_receptor_sw,  BxPathReceptorsERStrength as estrogen_receptor_st_cd, ltrim(rtrim(cast(BxPathReceptorsERpct as varchar(20)))) as estrogen_receptor_pct_text, cast(case when upper(ltrim(rtrim(BxPathReceptorsPR))) ='POS' then 1  when upper(ltrim(rtrim(BxPathReceptorsPR))) ='NEG' then 0 else null end  as INTEGER) as progesterone_receptor_sw,ltrim(rtrim(BxPathReceptorsPRstrength)) as progesterone_receptor_st_cd,ltrim(rtrim(cast(BxPathReceptorsPRpct as varchar(20)))) as progesterone_receptor_pct_text,BxPathOncoTypeDxResult as oncotype_diagnosis_result_id,ltrim(rtrim(BxPathOncoTypeDxScore)) as oncotype_diagnosis_score_num,ltrim(rtrim(BxPathOncoTypeDxRisk)) as oncotype_diagnosis_risk_text,ltrim(rtrim(cast(BxPathComments as varchar(4000)))) as comment_text,coalesce(concat('0x',convert(varchar(50),HBSource,2)),'')  as hashbite_ssk,'N' as source_system_code,'v_currtimestamp' as dw_last_update_date_time from navadhoc.dbo.patientbiopsy (NOLOCK))source_query~100000",
  "51~navadhoc.dbo.patientimaging~v_cr_stage_dataset_name.cn_patient_imaging_stg~append~select coalesce(PatientImagingFactID,0) as cn_patient_imaging_sid,coalesce(CoreRecordID,0) as core_record_type_id,coalesce(PatientDimID,0) as nav_patient_id,coalesce(MedicalSpecialistDimID,0) as med_spcl_physician_id,coalesce(TumorTypeDimID,0) as tumor_type_id,coalesce(DiagnosisResultID,0) as diagnosis_result_id,coalesce(DiagnosisDimID,0) as nav_diagnosis_id,coalesce(NavigatorDimID,0) as navigator_id,coid,coalesce(ImagingTypeID,0) as imaging_type_id,coalesce(ImageDate,'') as imaging_date,REPLACE(REPLACE(ltrim(rtrim(ImageMode)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) as imagemode,REPLACE(REPLACE(ltrim(rtrim(ImageArea)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) as imagearea,REPLACE(REPLACE(ltrim(rtrim(ImageLocation)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) as imaging_location_text,REPLACE(REPLACE(ltrim(rtrim(ImageCenter)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) as imagecenter,REPLACE(REPLACE(ltrim(rtrim(ImageBirad)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) as birad_scale_code,REPLACE(REPLACE(ltrim(rtrim(cast(ImageComments as varchar(1000)))), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) as comment_text,coalesce(DiseaseStatus,'') as disease_status,coalesce(TreatementStatus,'') as treatment_status,coalesce(OtherImageType,'') as other_image_type_text,coalesce(InitialDiagnosis,'') as initial_diagnosis_ind,coalesce(DiseaseMonitoring,'') as disease_monitoring_ind,coalesce(Comment,'') as radiology_result_text,coalesce(concat('0x',convert(varchar(50),HBSource,2)),'') as hashbite_ssk,'v_currtimestamp' as dw_last_update_date_time from navadhoc.dbo.patientimaging (NOLOCK)~100000",
  "52~navadhoc.dbo.dimpatient~v_cr_stage_dataset_name.cn_patient_stg~append~SELECT COALESCE(patientdimid,0) as nav_patient_id, COALESCE(navigationpersonid,0) as navigator_id, coid, REPLACE(REPLACE(LTRIM(RTRIM(marketurn)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) as patient_market_urn, REPLACE(REPLACE(LTRIM(RTRIM(mrn)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) as medical_record_num, REPLACE(REPLACE(LTRIM(RTRIM(URN)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) as empi_text, REPLACE(REPLACE(LTRIM(RTRIM(gynecologist)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) as gynecologist, REPLACE(REPLACE(LTRIM(RTRIM(gynecologistphone)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) as gynecologistphone, REPLACE(REPLACE(LTRIM(RTRIM(primarycarephysician)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) as primarycarephysician, REPLACE(REPLACE(LTRIM(RTRIM(pcpphone)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) as PCPPhone, inavcreatedatetime as nav_create_date ,'v_currtimestamp' as dw_last_update_date_time FROM navadhoc.dbo.dimpatient (nolock)~1000",
  "53~navadhoc.dbo.patienttumor~v_cr_stage_dataset_name.cn_patient_tumor_stg~append~SELECT PatientTumorFactID AS cn_patient_tumor_sid, PatientDimID AS nav_patient_id, TumorTypeDimID AS tumor_type_id, NavigatorDimID AS navigator_id, Coid, REPLACE(REPLACE(LTRIM(RTRIM(EFolderID)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) AS electronic_folder_id_text, REPLACE(REPLACE(LTRIM(RTRIM(TumorReferralSource)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) AS tumorreferralsource, REPLACE(REPLACE(LTRIM(RTRIM(NavigationStatus)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) AS navigationstatus, REPLACE(REPLACE(LTRIM(RTRIM(TumorEntryPoint)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) AS identification_period_text, TumorReferralDate AS referral_date, ReferringMDDimID AS referring_physician_id, REPLACE(REPLACE(LTRIM(RTRIM(EndNavigationReason)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) AS nav_end_reason_text, REPLACE(REPLACE(LTRIM(RTRIM(EndTreatmentReason)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) AS treatment_end_reason_text, REPLACE(REPLACE(LTRIM(RTRIM(EndTreatmentPhysician)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) AS endtreatmentphysician, REPLACE(REPLACE(LTRIM(RTRIM(EndTreatmentLocation)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) AS endtreatmentlocation, concat('0x', CONVERT(VARCHAR(50), HBSource, 2)) AS hashbite_ssk, 'v_currtimestamp' AS dw_last_update_date_time FROM navadhoc.dbo.PatientTumor (NOLOCK)~100000",
  "54~navadhoc.dbo.timeline~v_cr_stage_dataset_name.cn_patient_timeline_stg~append~SELECT COALESCE(timelinefactid,0) as cn_patient_timeline_id ,COALESCE (patientdimid,0) as nav_patient_id ,COALESCE (tumortypedimid,0) as tumor_type_id ,COALESCE (navigatordimid,0) as navigator_id ,coid ,'H' as company_code ,datereferredintonavigation as nav_referred_date ,datefirsttreatment as first_treatment_date ,datefirstconsult as first_consult_date ,datefirstimage as first_imaging_date ,datefirstmedonc as first_medical_oncology_date , datefirstradonc as first_radiation_oncology_date ,datefirstdiagnosis  as first_diagnosis_date , datefirstbiopsy as first_biopsy_date ,datefirstsurgeryconsult as first_surgery_consult_date ,datefirstsurgery  as first_surgery_date ,datesurvivorshipcareplandeliveredclosed as surv_care_plan_close_date ,datesurvivorshipcareplandeliveredresolved as surv_care_plan_resolve_date ,dateendtreatmentapplicationdate as end_treatment_date ,Cast(datedeath as date) as death_date ,daysdxtofirsttx as diag_first_trt_day_num ,CASE WHEN DxToFirstTxAvailable =1  THEN 'Y' ELSE 'N' END  as diag_first_trt_available_ind ,COALESCE(concat('0x',CONVERT(varchar(50),HBSource,2)),'') AS hashbite_ssk ,'N' as source_system_code ,'v_currtimestamp' as dw_last_update_date_time FROM navadhoc.dbo.timeline (NOLOCK)~100000",
  "55~navadhoc.dbo.dimpatient~v_cr_stage_dataset_name.cn_person_stg~append~/*not present td patientfirstinitial,patientlastinitial*/SELECT COALESCE (patientdimid,0) as nav_patient_id ,patientdob as birth_date ,REPLACE(REPLACE(LTRIM(RTRIM(patientfirstname)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) as first_name ,REPLACE(REPLACE(LTRIM(RTRIM(patientlastname)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) as last_name ,REPLACE(REPLACE(LTRIM(RTRIM(patientmiddlename)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) as middle_name ,REPLACE(REPLACE(LTRIM(RTRIM(patientpreferredname)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) as perferred_name ,REPLACE(REPLACE(LTRIM(RTRIM(patientgender)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) as gender_code ,REPLACE(REPLACE(LTRIM(RTRIM(patientpreferredlanguage)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) as preferred_langauage_text ,patientdeathdate as death_date ,REPLACE(REPLACE(LTRIM(RTRIM(patientemail)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) as patient_email_text , 'v_currtimestamp' as dw_last_update_date_time FROM navadhoc.dbo.dimpatient (NOLOCK)~100000",
  "56~navadhoc.dbo.patientsurgery~v_cr_stage_dataset_name.cn_patient_surgery_stg~append~SELECT COALESCE (patientsurgeryfactid,0) as cn_patient_surgery_sid ,COALESCE (corerecordid,0) as core_record_type_id ,COALESCE (medicalspecialistdimid ,0) as med_spcl_physician_id ,COALESCE (referringmddimid,0) as referring_physician_id ,COALESCE (patientdimid,0) as nav_patient_id ,COALESCE (tumortypedimid,0) as tumor_type_id ,COALESCE (diagnosisresultid,0) as diagnosis_result_id ,COALESCE (diagnosisdimid,0) as nav_diagnosis_id ,COALESCE (navigatordimid,0) as navigator_id /*,COALESCE (FacilityDimId,0)extra*/ ,coid ,'H' as company_code ,COALESCE (surgerytypedimid,0) as surgery_type_id ,surgerydate as surgery_date ,REPLACE(REPLACE(LTRIM(RTRIM(generalsurgerytype)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) as general_surgery_type_text ,REPLACE(REPLACE(LTRIM(RTRIM(surgeryside)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) as surgeryside ,REPLACE(REPLACE(LTRIM(RTRIM(surgeryfacility)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) as surgeryfacility /*,surgeryreconstructionoffered extra */ ,CASE  WHEN Upper(rtrim(ltrim(surgeryreconstructionoffered))) = 'YES' THEN 'Y'  WHEN Upper(rtrim(ltrim(surgeryreconstructionoffered))) = 'NO' THEN 'N'  END as reconstructive_offered_ind ,CASE WHEN Upper(rtrim(ltrim(palliativeonly))) = 'PALLIATIVE ONLY' THEN 'Y' ELSE 'N' END as palliative_ind ,REPLACE(REPLACE(LTRIM(RTRIM(surgerycomments)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) as comment_text ,COALESCE (concat('0x',CONVERT(varchar(50),HBSource,2)),'') as hashbite_ssk,'N' as source_system_code,'v_currtimestamp' as dw_last_update_date_time FROM navadhoc.dbo.patientsurgery (NOLOCK)~100000"
]

tblist4: [
  "57~navadhoc.dbo.navqhistory~v_cr_stage_dataset_name.navque_history_stg~append~select coalesce(NavQHistoryFactID,0) as navque_history_id,coalesce(NavQActionDimID,0) as navque_action_id,coalesce(NavQReasonDimID,0) as navque_reason_id,coalesce(TumorTypeDimID,0) as tumor_type_id,coalesce(NavigatorDimID,0) as navigator_id,coid,'H' as company_code,coalesce(ltrim(rtrim(MessageControlID)),'') as message_control_id_text,coalesce(MessageDate,'') as message_date,coalesce(NavQInsertDate,'') as navque_insert_date,coalesce(NavQActionDate,'') as navque_action_date,coalesce(MRN,'') as medical_record_num,ltrim(rtrim(substring(NetworkURN,4,len(NetworkURN)))) as patient_market_urn,ltrim(rtrim(substring(NetworkURN,1,3))) as network_mnemonic_cs,coalesce(TOC,0) as transition_of_care_score_num,case when ltrim(rtrim(NavigatedPatient))='Navigated' then 'Y' when  ltrim(rtrim(NavigatedPatient))='Not Navigated' then 'N' else NULL end as navigated_patient_ind, [source] as message_source_flag,coalesce(ltrim(rtrim(concat('0x',convert(varchar(50),HBSource,2)))),'') as hashbite_ssk,'N' as source_system_code,'v_currtimestamp' as dw_last_update_date_time from navadhoc.dbo.navqhistory (NOLOCK)~250000"
]

tblist5: [
  "58~navadhoc.dbo.patientpathologyresults~v_cr_stage_dataset_name.cn_patient_staging_stg~append~select cn_patient_staging_sid ,nav_patient_id ,tumor_type_id ,diagnosis_result_id ,nav_diagnosis_id ,navigator_id ,coid ,company_code ,cancer_stage_class_method_code ,cancer_staging_result_code ,cancer_staging_type_code ,cancer_stage_code ,hashbite_ssk ,source_system_code ,dw_last_update_date_time from (select coalesce(abc.PatientClinicalStagingFactID,0) as cn_patient_staging_sid, coalesce(PatientDimID,0) as nav_patient_id, coalesce(TumorTypeDimID,0) as tumor_type_id, coalesce(DiagnosisResultID,0) as diagnosis_result_id, coalesce(DiagnosisDimID,0) as nav_diagnosis_id, coalesce(NavigatorDimID,0) as navigator_id, coid, 'H' as company_code, 'C' as cancer_stage_class_method_code, abc.Cancer_Staging_Result_Code as cancer_staging_result_code, coalesce(abc.Cancer_Staging_Type_Code, '') as cancer_staging_type_code , ClinicalStage as cancer_stage_code, concat('0x', convert(varchar(50), pcs.HBSource, 2)) as hashbite_ssk, 'N' as source_system_code, current_timestamp as dw_last_update_date_time from navadhoc.dbo.patientclinicalstaging (NOLOCK) pcs inner join ( select ClinicalCancerCodeT as cancer_staging_result_code, PatientClinicalStagingFactID, 'T' as cancer_staging_type_code, hbsource from navadhoc.dbo.patientclinicalstaging (NOLOCK) where ClinicalCancerCodeT is not null union select ClinicalCancerCodeM as cancer_staging_result_code, PatientClinicalStagingFactID, 'M' as cancer_staging_type_code, hbsource from navadhoc.dbo.patientclinicalstaging (NOLOCK) where ClinicalCancerCodeM is not null union select ClinicalCancerCodeN as cancer_staging_result_code, patientclinicalstagingfactid, 'N' as cancer_staging_type_code, hbsource from navadhoc.dbo.patientclinicalstaging (NOLOCK) where ClinicalCancerCodeN is not null union select NULL as Cancer_Staging_Result_Code, PatientClinicalStagingFactID, NULL as cancer_staging_type_code, hbsource from navadhoc.dbo.patientclinicalstaging (NOLOCK) where clinicalcancercodeN is null and clinicalcancercodet is null and clinicalcancercodem is null )abc on abc.patientclinicalstagingfactid = pcs.patientclinicalstagingfactid and abc.hbsource = pcs.hbsource union select pps.PatientPathologicalStagingFactID as cn_patient_staging_sid, PatientDimID as nav_patient_id, TumorTypeDimID as tumor_type_id, DiagnosisResultID as diagnosis_result_id, DiagnosisDimID as nav_diagnosis_id, NavigatorDimID as navigator_id, coid, 'H' as company_code, 'P' as cancer_stage_class_method_code, patstg.Cancer_Staging_Result_Code as cancer_staging_result_code, patstg.Cancer_Staging_Type_Code as cancer_staging_type_code , PathologicalStage as cancer_stage_code, concat('0x', convert(varchar(50), pps.HBSource, 2)) as hashbite_ssk, 'N' as source_system_code, current_timestamp as dw_last_update_date_time from navadhoc.dbo.patientpathologicalstaging (NOLOCK) pps inner join ( select PathologicalCancerCodeT as cancer_staging_result_code, PatientPathologicalStagingFactID, 'T' as cancer_staging_type_code, hbsource from navadhoc.dbo.patientpathologicalstaging (NOLOCK) where PathologicalCancerCodeT is not null union select PathologicalCancerCodeM as cancer_staging_result_code, PatientPathologicalStagingFactID, 'M' as cancer_staging_type_code, hbsource from navadhoc.dbo.patientpathologicalstaging (NOLOCK) where PathologicalCancerCodeM is not null union select PathologicalCancerCodeN as cancer_staging_result_code, PatientPathologicalStagingFactID, 'N' as cancer_staging_type_code, hbsource from navadhoc.dbo.patientpathologicalstaging (NOLOCK) where PathologicalCancerCodeN is not null union select NULL as cancer_staging_result_code, PatientPathologicalStagingFactID, NULL as cancer_staging_type_code, hbsource from navadhoc.dbo.patientpathologicalstaging (NOLOCK) where pathologicalcancercoden is null and pathologicalcancercodem is null and pathologicalcancercodet is null )patstg on patstg.patientpathologicalstagingfactid = pps.patientpathologicalstagingfactid and patstg.hbsource = pps.hbsource ) source_query~250000"
]

tblist6: [
  "59~navadhoc.dbo.patientcommunication~v_cr_stage_dataset_name.cn_patient_contact_stg~append~select coalesce(PatientComunicationFactID,0) as cn_patient_contact_sid,coalesce(PatientDimID,0) as nav_patient_id,MeansOfContact as method_of_contact,coalesce(TumorTypeDimID,0) as tumor_type_id,coalesce(DiagnosisResultID,0) as diagnosis_result_id,coalesce(DiagnosisDimID,0) as nav_diagnosis_id,coalesce(NavigatorDimID,0) as navigator_id,coid,'H' as company_code,ContactDate as contact_date,PurposeofContact as purpose_of_contact,REPLACE(REPLACE(ltrim(rtrim(otherpurposeofcontact )), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) as other_purpose_detail_text,PersonofContact as person_of_contact,REPLACE(REPLACE(ltrim(rtrim(otherpersonofcontact)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) as other_person_contacted_text,REPLACE(REPLACE(ltrim(rtrim(timespent)), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) as time_spent_amount_text,REPLACE(REPLACE(ltrim(rtrim(cast (comments as nvarchar(4000)))), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) as comment_text,coalesce(concat('0x',convert(varchar(50),HBSource,2)),'') as hashbite_ssk,'N' as source_system_code,current_timestamp as dw_last_update_date_time from navadhoc.dbo.patientcommunication (NOLOCK)~250000"
]

tblist7: [
  "60~navadhoc.dbo.patientpathologyresults~v_cr_stage_dataset_name.cn_patient_pathology_result_stg~append~select cn_patient_pathology_res_sid, pathology_result_type_id, core_record_type_id, nav_patient_id, tumor_type_id, diagnosis_result_id, nav_diagnosis_id, navigator_id, coid, company_code, result_value_text, hashbite_ssk, 'N' as  source_system_code, 'v_currtimestamp' as dw_last_update_date_time from (select coalesce(PatientPathologyResultFactID,'') as CN_Patient_Pathology_Res_SID ,coalesce(CoreRecordID,'') as Core_Record_Type_Id ,coalesce(PatientDimId,'') as Nav_Patient_Id ,coalesce(TumorTypeDimId,'') as Tumor_Type_Id ,coalesce(DiagnosisResultID,'') as Diagnosis_Result_Id ,coalesce(DiagnosisDimID,'') as Nav_Diagnosis_Id ,coalesce(NavigatorDimID,'') as Navigator_Id ,Coid as Coid ,'H' as Company_Code ,1 as Pathology_Result_Type_Id ,ltrim(rtrim(KRAS))  as Result_Value_Text ,coalesce(ltrim(rtrim(concat('0x',CONVERT(varchar(50),HBSource,2)))),'') as Hashbite_SSK from NavAdhoc.dbo.PatientPathologyResults (NOLOCK) where ltrim(rtrim(KRAS)) <>'' AND KRAS is not null UNION Select coalesce(PatientPathologyResultFactID,'') as CN_Patient_Pathology_Res_SID ,coalesce(CoreRecordID,'') as Core_Record_Type_Id ,coalesce(PatientDimId,'') as Nav_Patient_Id ,coalesce(TumorTypeDimId,'') as Tumor_Type_Id ,coalesce(DiagnosisResultID,'') as Diagnosis_Result_Id ,coalesce(DiagnosisDimID,'') as Nav_Diagnosis_Id ,coalesce(NavigatorDimID,'') as Navigator_Id ,Coid as Coid ,'H' as Company_Code ,2 as Pathology_Result_Type_Id ,ltrim(rtrim(BRAF))  as Result_Value_Text ,coalesce(ltrim(rtrim(concat('0x',CONVERT(varchar(50),HBSource,2)))),'') as Hashbite_SSK from NavAdhoc.dbo.PatientPathologyResults (NOLOCK) where ltrim(rtrim(BRAF)) <>'' AND BRAF is not null UNION Select coalesce(PatientPathologyResultFactID,'') as CN_Patient_Pathology_Res_SID ,coalesce(CoreRecordID,'') as Core_Record_Type_Id ,coalesce(PatientDimId,'') as Nav_Patient_Id ,coalesce(TumorTypeDimId,'') as Tumor_Type_Id ,coalesce(DiagnosisResultID,'') as Diagnosis_Result_Id ,coalesce(DiagnosisDimID,'') as Nav_Diagnosis_Id ,coalesce(NavigatorDimID,'') as Navigator_Id ,Coid as Coid ,'H' as Company_Code ,3 as Pathology_Result_Type_Id ,ltrim(rtrim(MSI))  as Result_Value_Text ,coalesce(ltrim(rtrim(concat('0x',CONVERT(varchar(50),HBSource,2)))),'') as Hashbite_SSK from NavAdhoc.dbo.PatientPathologyResults (NOLOCK) where ltrim(rtrim(MSI)) <>'' AND MSI is not null UNION Select coalesce(PatientPathologyResultFactID,'') as CN_Patient_Pathology_Res_SID ,coalesce(CoreRecordID,'') as Core_Record_Type_Id ,coalesce(PatientDimId,'') as Nav_Patient_Id ,coalesce(TumorTypeDimId,'') as Tumor_Type_Id ,coalesce(DiagnosisResultID,'') as Diagnosis_Result_Id ,coalesce(DiagnosisDimID,'') as Nav_Diagnosis_Id ,coalesce(NavigatorDimID,'') as Navigator_Id ,Coid as Coid ,'H' as Company_Code ,4 as Pathology_Result_Type_Id ,ltrim(rtrim(Ki67Results))  as Result_Value_Text ,coalesce(ltrim(rtrim(concat('0x',CONVERT(varchar(50),HBSource,2)))),'') as Hashbite_SSK from NavAdhoc.dbo.PatientPathologyResults (NOLOCK) where ltrim(rtrim(Ki67Results)) <>'' AND Ki67Results is not null UNION Select coalesce(PatientPathologyResultFactID,'') as CN_Patient_Pathology_Res_SID ,coalesce(CoreRecordID,'') as Core_Record_Type_Id ,coalesce(PatientDimId,'') as Nav_Patient_Id ,coalesce(TumorTypeDimId,'') as Tumor_Type_Id ,coalesce(DiagnosisResultID,'') as Diagnosis_Result_Id ,coalesce(DiagnosisDimID,'') as Nav_Diagnosis_Id ,coalesce(NavigatorDimID,'') as Navigator_Id ,Coid as Coid ,'H' as Company_Code ,5 as Pathology_Result_Type_Id ,ltrim(rtrim(Ki67))  as Result_Value_Text ,coalesce(ltrim(rtrim(concat('0x',CONVERT(varchar(50),HBSource,2)))),'') as Hashbite_SSK from NavAdhoc.dbo.PatientPathologyResults (NOLOCK) where ltrim(rtrim(Ki67)) <>'' AND Ki67 is not null UNION Select coalesce(PatientPathologyResultFactID,'') as CN_Patient_Pathology_Res_SID ,coalesce(CoreRecordID,'') as Core_Record_Type_Id ,coalesce(PatientDimId,'') as Nav_Patient_Id ,coalesce(TumorTypeDimId,'') as Tumor_Type_Id ,coalesce(DiagnosisResultID,'') as Diagnosis_Result_Id ,coalesce(DiagnosisDimID,'') as Nav_Diagnosis_Id ,coalesce(NavigatorDimID,'') as Navigator_Id ,Coid as Coid ,'H' as Company_Code ,6 as Pathology_Result_Type_Id ,ltrim(rtrim(CMET))  as Result_Value_Text ,coalesce(ltrim(rtrim(concat('0x',CONVERT(varchar(50),HBSource,2)))),'') as Hashbite_SSK from NavAdhoc.dbo.PatientPathologyResults (NOLOCK) where ltrim(rtrim(CMET)) <>'' AND CMET is not null UNION Select coalesce(PatientPathologyResultFactID,'') as CN_Patient_Pathology_Res_SID ,coalesce(CoreRecordID,'') as Core_Record_Type_Id ,coalesce(PatientDimId,'') as Nav_Patient_Id ,coalesce(TumorTypeDimId,'') as Tumor_Type_Id ,coalesce(DiagnosisResultID,'') as Diagnosis_Result_Id ,coalesce(DiagnosisDimID,'') as Nav_Diagnosis_Id ,coalesce(NavigatorDimID,'') as Navigator_Id ,Coid as Coid ,'H' as Company_Code ,7 as Pathology_Result_Type_Id ,ltrim(rtrim(SignetRing))  as Result_Value_Text ,coalesce(ltrim(rtrim(concat('0x',CONVERT(varchar(50),HBSource,2)))),'') as Hashbite_SSK from NavAdhoc.dbo.PatientPathologyResults (NOLOCK) where ltrim(rtrim(SignetRing)) <>'' AND SignetRing is not null UNION Select coalesce(PatientPathologyResultFactID,'') as CN_Patient_Pathology_Res_SID ,coalesce(CoreRecordID,'') as Core_Record_Type_Id ,coalesce(PatientDimId,'') as Nav_Patient_Id ,coalesce(TumorTypeDimId,'') as Tumor_Type_Id ,coalesce(DiagnosisResultID,'') as Diagnosis_Result_Id ,coalesce(DiagnosisDimID,'') as Nav_Diagnosis_Id ,coalesce(NavigatorDimID,'') as Navigator_Id ,Coid as Coid ,'H' as Company_Code ,8 as Pathology_Result_Type_Id ,ltrim(rtrim(LinitisPlastica)) as Result_Value_Text ,coalesce(ltrim(rtrim(concat('0x',CONVERT(varchar(50),HBSource,2)))),'') as Hashbite_SSK from NavAdhoc.dbo.PatientPathologyResults (NOLOCK) where ltrim(rtrim(LinitisPlastica)) <>'' AND LinitisPlastica is not null UNION Select coalesce(PatientPathologyResultFactID,'') as CN_Patient_Pathology_Res_SID ,coalesce(CoreRecordID,'') as Core_Record_Type_Id ,coalesce(PatientDimId,'') as Nav_Patient_Id ,coalesce(TumorTypeDimId,'') as Tumor_Type_Id ,coalesce(DiagnosisResultID,'') as Diagnosis_Result_Id ,coalesce(DiagnosisDimID,'') as Nav_Diagnosis_Id ,coalesce(NavigatorDimID,'') as Navigator_Id ,Coid as Coid ,'H' as Company_Code ,9 as Pathology_Result_Type_Id ,ltrim(rtrim(NonSmallCellName)) as Result_Value_Text ,coalesce(ltrim(rtrim(concat('0x',CONVERT(varchar(50),HBSource,2)))),'') as Hashbite_SSK from NavAdhoc.dbo.PatientPathologyResults (NOLOCK) where ltrim(rtrim(NonSmallCellName)) <>'' AND NonSmallCellName is not null UNION Select coalesce(PatientPathologyResultFactID,'') as CN_Patient_Pathology_Res_SID ,coalesce(CoreRecordID,'') as Core_Record_Type_Id ,coalesce(PatientDimId,'') as Nav_Patient_Id ,coalesce(TumorTypeDimId,'') as Tumor_Type_Id ,coalesce(DiagnosisResultID,'') as Diagnosis_Result_Id ,coalesce(DiagnosisDimID,'') as Nav_Diagnosis_Id ,coalesce(NavigatorDimID,'') as Navigator_Id ,Coid as Coid ,'H' as Company_Code ,10 as Pathology_Result_Type_Id ,ltrim(rtrim(PanCoast)) as Result_Value_Text ,coalesce(ltrim(rtrim(concat('0x',CONVERT(varchar(50),HBSource,2)))),'') as Hashbite_SSK from NavAdhoc.dbo.PatientPathologyResults (NOLOCK) where ltrim(rtrim(PanCoast)) <>'' AND PanCoast is not null UNION Select coalesce(PatientPathologyResultFactID,'') as CN_Patient_Pathology_Res_SID ,coalesce(CoreRecordID,'') as Core_Record_Type_Id ,coalesce(PatientDimId,'') as Nav_Patient_Id ,coalesce(TumorTypeDimId,'') as Tumor_Type_Id ,coalesce(DiagnosisResultID,'') as Diagnosis_Result_Id ,coalesce(DiagnosisDimID,'') as Nav_Diagnosis_Id ,coalesce(NavigatorDimID,'') as Navigator_Id ,Coid as Coid ,'H' as Company_Code ,11 as Pathology_Result_Type_Id ,ltrim(rtrim(ALK))  as Result_Value_Text ,coalesce(ltrim(rtrim(concat('0x',CONVERT(varchar(50),HBSource,2)))),'') as Hashbite_SSK from NavAdhoc.dbo.PatientPathologyResults (NOLOCK) where ltrim(rtrim(ALK)) <>'' AND ALK is not null UNION Select coalesce(PatientPathologyResultFactID,'') as CN_Patient_Pathology_Res_SID ,coalesce(CoreRecordID,'') as Core_Record_Type_Id ,coalesce(PatientDimId,'') as Nav_Patient_Id ,coalesce(TumorTypeDimId,'') as Tumor_Type_Id ,coalesce(DiagnosisResultID,'') as Diagnosis_Result_Id ,coalesce(DiagnosisDimID,'') as Nav_Diagnosis_Id ,coalesce(NavigatorDimID,'') as Navigator_Id ,Coid as Coid ,'H' as Company_Code ,12 as Pathology_Result_Type_Id ,ltrim(rtrim(EGFR))  as Result_Value_Text ,coalesce(ltrim(rtrim(concat('0x',CONVERT(varchar(50),HBSource,2)))),'') as Hashbite_SSK from NavAdhoc.dbo.PatientPathologyResults (NOLOCK) where ltrim(rtrim(EGFR)) <>'' AND EGFR is not null UNION Select coalesce(PatientPathologyResultFactID,'') as CN_Patient_Pathology_Res_SID ,coalesce(CoreRecordID,'') as Core_Record_Type_Id ,coalesce(PatientDimId,'') as Nav_Patient_Id ,coalesce(TumorTypeDimId,'') as Tumor_Type_Id ,coalesce(DiagnosisResultID,'') as Diagnosis_Result_Id ,coalesce(DiagnosisDimID,'') as Nav_Diagnosis_Id ,coalesce(NavigatorDimID,'') as Navigator_Id ,Coid as Coid ,'H' as Company_Code ,13 as Pathology_Result_Type_Id ,ltrim(rtrim(ROS))  as Result_Value_Text ,coalesce(ltrim(rtrim(concat('0x',CONVERT(varchar(50),HBSource,2)))),'') as Hashbite_SSK from NavAdhoc.dbo.PatientPathologyResults (NOLOCK) where ltrim(rtrim(ROS)) <>'' AND ROS is not null UNION Select coalesce(PatientPathologyResultFactID,'') as CN_Patient_Pathology_Res_SID ,coalesce(CoreRecordID,'') as Core_Record_Type_Id ,coalesce(PatientDimId,'') as Nav_Patient_Id ,coalesce(TumorTypeDimId,'') as Tumor_Type_Id ,coalesce(DiagnosisResultID,'') as Diagnosis_Result_Id ,coalesce(DiagnosisDimID,'') as Nav_Diagnosis_Id ,coalesce(NavigatorDimID,'') as Navigator_Id ,Coid as Coid ,'H' as Company_Code ,14 as Pathology_Result_Type_Id ,ltrim(rtrim(PIK3CA))  as Result_Value_Text ,coalesce(ltrim(rtrim(concat('0x',CONVERT(varchar(50),HBSource,2)))),'') as Hashbite_SSK from NavAdhoc.dbo.PatientPathologyResults (NOLOCK) where ltrim(rtrim(PIK3CA)) <>'' AND PIK3CA is not null UNION Select coalesce(PatientPathologyResultFactID,'') as CN_Patient_Pathology_Res_SID ,coalesce(CoreRecordID,'') as Core_Record_Type_Id ,coalesce(PatientDimId,'') as Nav_Patient_Id ,coalesce(TumorTypeDimId,'') as Tumor_Type_Id ,coalesce(DiagnosisResultID,'') as Diagnosis_Result_Id ,coalesce(DiagnosisDimID,'') as Nav_Diagnosis_Id ,coalesce(NavigatorDimID,'') as Navigator_Id ,Coid as Coid ,'H' as Company_Code ,15 as Pathology_Result_Type_Id ,ltrim(rtrim(MET))  as Result_Value_Text ,coalesce(ltrim(rtrim(concat('0x',CONVERT(varchar(50),HBSource,2)))),'') as Hashbite_SSK from NavAdhoc.dbo.PatientPathologyResults (NOLOCK) where ltrim(rtrim(MET)) <>'' AND MET is not null UNION Select coalesce(PatientPathologyResultFactID,'') as CN_Patient_Pathology_Res_SID ,coalesce(CoreRecordID,'') as Core_Record_Type_Id ,coalesce(PatientDimId,'') as Nav_Patient_Id ,coalesce(TumorTypeDimId,'') as Tumor_Type_Id ,coalesce(DiagnosisResultID,'') as Diagnosis_Result_Id ,coalesce(DiagnosisDimID,'') as Nav_Diagnosis_Id ,coalesce(NavigatorDimID,'') as Navigator_Id ,Coid as Coid ,'H' as Company_Code ,16 as Pathology_Result_Type_Id ,ltrim(rtrim(Her2NeuIHC))  as Result_Value_Text ,coalesce(ltrim(rtrim(concat('0x',CONVERT(varchar(50),HBSource,2)))),'') as Hashbite_SSK from NavAdhoc.dbo.PatientPathologyResults (NOLOCK) where ltrim(rtrim(Her2NeuIHC)) <>'' AND Her2NeuIHC is not null UNION Select coalesce(PatientPathologyResultFactID,'') as CN_Patient_Pathology_Res_SID ,coalesce(CoreRecordID,'') as Core_Record_Type_Id ,coalesce(PatientDimId,'') as Nav_Patient_Id ,coalesce(TumorTypeDimId,'') as Tumor_Type_Id ,coalesce(DiagnosisResultID,'') as Diagnosis_Result_Id ,coalesce(DiagnosisDimID,'') as Nav_Diagnosis_Id ,coalesce(NavigatorDimID,'') as Navigator_Id ,Coid as Coid ,'H' as Company_Code ,17 as Pathology_Result_Type_Id ,ltrim(rtrim(FISH))  as Result_Value_Text ,coalesce(ltrim(rtrim(concat('0x',CONVERT(varchar(50),HBSource,2)))),'') as Hashbite_SSK from NavAdhoc.dbo.PatientPathologyResults (NOLOCK) where ltrim(rtrim(FISH)) <>'' AND FISH is not null UNION Select coalesce(PatientPathologyResultFactID,'') as CN_Patient_Pathology_Res_SID ,coalesce(CoreRecordID,'') as Core_Record_Type_Id ,coalesce(PatientDimId,'') as Nav_Patient_Id ,coalesce(TumorTypeDimId,'') as Tumor_Type_Id ,coalesce(DiagnosisResultID,'') as Diagnosis_Result_Id ,coalesce(DiagnosisDimID,'') as Nav_Diagnosis_Id ,coalesce(NavigatorDimID,'') as Navigator_Id ,Coid as Coid ,'H' as Company_Code ,18 as Pathology_Result_Type_Id ,ltrim(rtrim(AxillaryNodesTested))  as Result_Value_Text ,coalesce(ltrim(rtrim(concat('0x',CONVERT(varchar(50),HBSource,2)))),'') as Hashbite_SSK from NavAdhoc.dbo.PatientPathologyResults (NOLOCK) where ltrim(rtrim(AxillaryNodesTested)) <>'' AND AxillaryNodesTested is not null UNION Select coalesce(PatientPathologyResultFactID,'') as CN_Patient_Pathology_Res_SID ,coalesce(CoreRecordID,'') as Core_Record_Type_Id ,coalesce(PatientDimId,'') as Nav_Patient_Id ,coalesce(TumorTypeDimId,'') as Tumor_Type_Id ,coalesce(DiagnosisResultID,'') as Diagnosis_Result_Id ,coalesce(DiagnosisDimID,'') as Nav_Diagnosis_Id ,coalesce(NavigatorDimID,'') as Navigator_Id ,Coid as Coid ,'H' as Company_Code ,19 as Pathology_Result_Type_Id ,ltrim(rtrim(Mucinous))  as Result_Value_Text ,coalesce(ltrim(rtrim(concat('0x',CONVERT(varchar(50),HBSource,2)))),'') as Hashbite_SSK from NavAdhoc.dbo.PatientPathologyResults (NOLOCK) where ltrim(rtrim(Mucinous)) <>'' AND Mucinous is not null UNION Select coalesce(PatientPathologyResultFactID,'') as CN_Patient_Pathology_Res_SID ,coalesce(CoreRecordID,'') as Core_Record_Type_Id ,coalesce(PatientDimId,'') as Nav_Patient_Id ,coalesce(TumorTypeDimId,'') as Tumor_Type_Id ,coalesce(DiagnosisResultID,'') as Diagnosis_Result_Id ,coalesce(DiagnosisDimID,'') as Nav_Diagnosis_Id ,coalesce(NavigatorDimID,'') as Navigator_Id ,Coid as Coid ,'H' as Company_Code ,20 as Pathology_Result_Type_Id ,ltrim(rtrim(Comedonecrosis))  as Result_Value_Text ,coalesce(ltrim(rtrim(concat('0x',CONVERT(varchar(50),HBSource,2)))),'') as Hashbite_SSK from NavAdhoc.dbo.PatientPathologyResults (NOLOCK) where ltrim(rtrim(Comedonecrosis)) <>'' AND Comedonecrosis is not null UNION Select coalesce(PatientPathologyResultFactID,'') as CN_Patient_Pathology_Res_SID ,coalesce(CoreRecordID,'') as Core_Record_Type_Id ,coalesce(PatientDimId,'') as Nav_Patient_Id ,coalesce(TumorTypeDimId,'') as Tumor_Type_Id ,coalesce(DiagnosisResultID,'') as Diagnosis_Result_Id ,coalesce(DiagnosisDimID,'') as Nav_Diagnosis_Id ,coalesce(NavigatorDimID,'') as Navigator_Id ,Coid as Coid ,'H' as Company_Code ,21 as Pathology_Result_Type_Id ,ltrim(rtrim(FishEquivocal))  as Result_Value_Text ,coalesce(ltrim(rtrim(concat('0x',CONVERT(varchar(50),HBSource,2)))),'') as Hashbite_SSK from NavAdhoc.dbo.PatientPathologyResults (NOLOCK) where ltrim(rtrim(FishEquivocal)) <>'' AND FishEquivocal is not null UNION Select coalesce(PatientPathologyResultFactID,'') as CN_Patient_Pathology_Res_SID ,coalesce(CoreRecordID,'') as Core_Record_Type_Id ,coalesce(PatientDimId,'') as Nav_Patient_Id ,coalesce(TumorTypeDimId,'') as Tumor_Type_Id ,coalesce(DiagnosisResultID,'') as Diagnosis_Result_Id ,coalesce(DiagnosisDimID,'') as Nav_Diagnosis_Id ,coalesce(NavigatorDimID,'') as Navigator_Id ,Coid as Coid ,'H' as Company_Code ,22 as Pathology_Result_Type_Id ,ltrim(rtrim(cast(AnyLocalEvent_DCIS_Inv_pct as varchar(50)))) as Result_Value_Text ,coalesce(ltrim(rtrim(concat('0x',CONVERT(varchar(50),HBSource,2)))),'') as Hashbite_SSK from NavAdhoc.dbo.PatientPathologyResults (NOLOCK) where  AnyLocalEvent_DCIS_Inv_pct is not null UNION Select coalesce(PatientPathologyResultFactID,'') as CN_Patient_Pathology_Res_SID ,coalesce(CoreRecordID,'') as Core_Record_Type_Id ,coalesce(PatientDimId,'') as Nav_Patient_Id ,coalesce(TumorTypeDimId,'') as Tumor_Type_Id ,coalesce(DiagnosisResultID,'') as Diagnosis_Result_Id ,coalesce(DiagnosisDimID,'') as Nav_Diagnosis_Id ,coalesce(NavigatorDimID,'') as Navigator_Id ,Coid as Coid ,'H' as Company_Code ,23 as Pathology_Result_Type_Id ,ltrim(rtrim(cast('10yrRecurrenceRatePct'  as varchar(50)))) as Result_Value_Text ,coalesce(ltrim(rtrim(concat('0x',CONVERT(varchar(50),HBSource,2)))),'') as Hashbite_SSK from NavAdhoc.dbo.PatientPathologyResults (NOLOCK) where '10yrRecurrenceRatePct' is not null UNION Select coalesce(PatientPathologyResultFactID,'') as CN_Patient_Pathology_Res_SID ,coalesce(CoreRecordID,'') as Core_Record_Type_Id ,coalesce(PatientDimId,'') as Nav_Patient_Id ,coalesce(TumorTypeDimId,'') as Tumor_Type_Id ,coalesce(DiagnosisResultID,'') as Diagnosis_Result_Id ,coalesce(DiagnosisDimID,'') as Nav_Diagnosis_Id ,coalesce(NavigatorDimID,'') as Navigator_Id ,Coid as Coid ,'H' as Company_Code ,24 as Pathology_Result_Type_Id ,ltrim(rtrim(cast(InvasiveLocalEventPct as varchar(50))))  as Result_Value_Text ,coalesce(ltrim(rtrim(concat('0x',CONVERT(varchar(50),HBSource,2)))),'') as Hashbite_SSK from NavAdhoc.dbo.PatientPathologyResults (NOLOCK) where  InvasiveLocalEventPct is not null UNION Select coalesce(PatientPathologyResultFactID,'') as CN_Patient_Pathology_Res_SID ,coalesce(CoreRecordID,'') as Core_Record_Type_Id ,coalesce(PatientDimId,'') as Nav_Patient_Id ,coalesce(TumorTypeDimId,'') as Tumor_Type_Id ,coalesce(DiagnosisResultID,'') as Diagnosis_Result_Id ,coalesce(DiagnosisDimID,'') as Nav_Diagnosis_Id ,coalesce(NavigatorDimID,'') as Navigator_Id ,Coid as Coid ,'H' as Company_Code ,25 as Pathology_Result_Type_Id ,ltrim(rtrim(ERPR))  as Result_Value_Text ,coalesce(ltrim(rtrim(concat('0x',CONVERT(varchar(50),HBSource,2)))),'') as Hashbite_SSK from NavAdhoc.dbo.PatientPathologyResults (NOLOCK) where ltrim(rtrim(ERPR)) <>'' AND ERPR is not null )source_query~250000"               
]

tblist8: [
  "61~navadhoc.dbo.patienthistory~v_cr_stage_dataset_name.cn_patient_family_history_stg~append~SELECT PatientHistoryFactID, PatientDimID, Coid, Family_History_Query_Id, REPLACE(REPLACE(Family_History_Value_Text, NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) AS Family_History_Value_Text, HBSource, 'v_currtimestamp' AS dw_last_update_date_time FROM ( SELECT PatientHistoryFactID, PatientDimID, Coid, 61 AS Family_History_Query_Id, LTRIM(RTRIM(CAST(FamilyHistory AS VARCHAR(1000)))) AS Family_History_Value_Text, concat('0x', CONVERT(VARCHAR(50), HBSource, 2)) AS HBSource FROM navadhoc.dbo.patienthistory (NOLOCK) WHERE LTRIM(RTRIM(FamilyHistory)) IS NOT NULL AND LTRIM(RTRIM(FamilyHistory))<>'' UNION SELECT PatientHistoryFactID, PatientDimID, Coid, 62 AS Family_History_Query_Id, LTRIM(RTRIM(CAST(Lineage AS VARCHAR(1000)))) AS Family_History_Value_Text, concat('0x', CONVERT(VARCHAR(50), HBSource, 2)) AS HBSource FROM navadhoc.dbo.patienthistory (NOLOCK) WHERE LTRIM(RTRIM(Lineage)) IS NOT NULL AND LTRIM(RTRIM(Lineage))<>'' UNION SELECT PatientHistoryFactID, PatientDimID, Coid, 63 AS Family_History_Query_Id, LTRIM(RTRIM(CAST(Age AS VARCHAR(1000)))) AS Family_History_Value_Text, concat('0x', CONVERT(VARCHAR(50), HBSource, 2)) AS HBSource FROM navadhoc.dbo.patienthistory (NOLOCK) WHERE LTRIM(RTRIM(Age)) IS NOT NULL AND LTRIM(RTRIM(Age))<>'' UNION SELECT PatientHistoryFactID, PatientDimID, Coid, 64 AS Family_History_Query_Id, LTRIM(RTRIM(CAST(RelationToPatient AS VARCHAR(1000)))) AS Family_History_Value_Text, concat('0x', CONVERT(VARCHAR(50), HBSource, 2)) AS HBSource FROM navadhoc.dbo.patienthistory (NOLOCK) WHERE LTRIM(RTRIM(RelationToPatient)) IS NOT NULL AND LTRIM(RTRIM(RelationToPatient))<>'' UNION SELECT PatientHistoryFactID, PatientDimID, Coid, 65 AS Family_History_Query_Id, LTRIM(RTRIM(CAST(TumorSite AS VARCHAR(1000)))) AS Family_History_Value_Text, concat('0x', CONVERT(VARCHAR(50), HBSource, 2)) AS HBSource FROM navadhoc.dbo.patienthistory (NOLOCK) WHERE LTRIM(RTRIM(TumorSite)) IS NOT NULL AND LTRIM(RTRIM(TumorSite))<>'' UNION SELECT PatientHistoryFactID, PatientDimID, Coid, 66 AS Family_History_Query_Id, LTRIM(RTRIM(CAST(AshkenaziJewish AS VARCHAR(1000)))) AS Family_History_Value_Text, concat('0x', CONVERT(VARCHAR(50), HBSource, 2)) AS HBSource FROM navadhoc.dbo.patienthistory (NOLOCK) WHERE LTRIM(RTRIM(AshkenaziJewish)) IS NOT NULL AND LTRIM(RTRIM(AshkenaziJewish))<>'' UNION SELECT PatientHistoryFactID, PatientDimID, Coid, 67 AS Family_History_Query_Id, LTRIM(RTRIM(CAST(EverSmoked AS VARCHAR(1000)))) AS Family_History_Value_Text, concat('0x', CONVERT(VARCHAR(50), HBSource, 2)) AS HBSource FROM navadhoc.dbo.patienthistory (NOLOCK) WHERE LTRIM(RTRIM(EverSmoked)) IS NOT NULL AND LTRIM(RTRIM(EverSmoked))<>'' UNION SELECT PatientHistoryFactID, PatientDimID, Coid, 68 AS Family_History_Query_Id, LTRIM(RTRIM(CAST(SmokingCessationOffered AS VARCHAR(1000)))) AS Family_History_Value_Text, concat('0x', CONVERT(VARCHAR(50), HBSource, 2)) AS HBSource FROM navadhoc.dbo.patienthistory (NOLOCK) WHERE LTRIM(RTRIM(SmokingCessationOffered)) IS NOT NULL AND LTRIM(RTRIM(SmokingCessationOffered))<>'' UNION SELECT PatientHistoryFactID, PatientDimID, Coid, 69 AS Family_History_Query_Id, LTRIM(RTRIM(CAST(QuitSmoking AS VARCHAR(1000)))) AS Family_History_Value_Text, concat('0x', CONVERT(VARCHAR(50), HBSource, 2)) AS HBSource FROM navadhoc.dbo.patienthistory (NOLOCK) WHERE LTRIM(RTRIM(QuitSmoking)) IS NOT NULL AND LTRIM(RTRIM(QuitSmoking))<>'' UNION SELECT PatientHistoryFactID, PatientDimID, Coid, 70 AS Family_History_Query_Id, LTRIM(RTRIM(CAST(DateQuitSmoking AS VARCHAR(1000)))) AS Family_History_Value_Text, concat('0x', CONVERT(VARCHAR(50), HBSource, 2)) AS HBSource FROM navadhoc.dbo.patienthistory (NOLOCK) WHERE LTRIM(RTRIM(DateQuitSmoking)) IS NOT NULL AND LTRIM(RTRIM(DateQuitSmoking))<>'' UNION SELECT PatientHistoryFactID, PatientDimID, Coid, 71 AS Family_History_Query_Id, LTRIM(RTRIM(CAST(PackPerDay AS VARCHAR(1000)))) AS Family_History_Value_Text, concat('0x', CONVERT(VARCHAR(50), HBSource, 2)) AS HBSource FROM navadhoc.dbo.patienthistory (NOLOCK) WHERE LTRIM(RTRIM(PackPerDay)) IS NOT NULL AND LTRIM(RTRIM(PackPerDay))<>'' UNION SELECT PatientHistoryFactID, PatientDimID, Coid, 72 AS Family_History_Query_Id, LTRIM(RTRIM(CAST(Years AS VARCHAR(1000)))) AS Family_History_Value_Text, concat('0x', CONVERT(VARCHAR(50), HBSource, 2)) AS HBSource FROM navadhoc.dbo.patienthistory (NOLOCK) WHERE LTRIM(RTRIM(Years)) IS NOT NULL AND LTRIM(RTRIM(Years))<>'' UNION SELECT PatientHistoryFactID, PatientDimID, Coid, 73 AS Family_History_Query_Id, LTRIM(RTRIM(CAST(PackYearHx AS VARCHAR(1000)))) AS Family_History_Value_Text, concat('0x', CONVERT(VARCHAR(50), HBSource, 2)) AS HBSource FROM navadhoc.dbo.patienthistory (NOLOCK) WHERE LTRIM(RTRIM(PackYearHx)) IS NOT NULL AND LTRIM(RTRIM(PackYearHx))<>'' UNION SELECT PatientHistoryFactID, PatientDimID, Coid, 74 AS Family_History_Query_Id, LTRIM(RTRIM(CAST(TakingEstrogen AS VARCHAR(1000)))) AS Family_History_Value_Text, concat('0x', CONVERT(VARCHAR(50), HBSource, 2)) AS HBSource FROM navadhoc.dbo.patienthistory (NOLOCK) WHERE LTRIM(RTRIM(TakingEstrogen)) IS NOT NULL AND LTRIM(RTRIM(TakingEstrogen))<>'' UNION SELECT PatientHistoryFactID, PatientDimID, Coid, 75 AS Family_History_Query_Id, LTRIM(RTRIM(CAST(TakingProgesterone AS VARCHAR(1000)))) AS Family_History_Value_Text, concat('0x', CONVERT(VARCHAR(50), HBSource, 2)) AS HBSource FROM navadhoc.dbo.patienthistory (NOLOCK) WHERE LTRIM(RTRIM(TakingProgesterone)) IS NOT NULL AND LTRIM(RTRIM(TakingProgesterone))<>'' UNION SELECT PatientHistoryFactID, PatientDimID, Coid, 76 AS Family_History_Query_Id, LTRIM(RTRIM(CAST(ReceptorsER AS VARCHAR(1000)))) AS Family_History_Value_Text, concat('0x', CONVERT(VARCHAR(50), HBSource, 2)) AS HBSource FROM navadhoc.dbo.patienthistory (NOLOCK) WHERE LTRIM(RTRIM(ReceptorsER)) IS NOT NULL AND LTRIM(RTRIM(ReceptorsER))<>'' UNION SELECT PatientHistoryFactID, PatientDimID, Coid, 77 AS Family_History_Query_Id, LTRIM(RTRIM(CAST(ReceptorsPR AS VARCHAR(1000)))) AS Family_History_Value_Text, concat('0x', CONVERT(VARCHAR(50), HBSource, 2)) AS HBSource FROM navadhoc.dbo.patienthistory (NOLOCK) WHERE LTRIM(RTRIM(ReceptorsPR)) IS NOT NULL AND LTRIM(RTRIM(ReceptorsPR))<>'' UNION SELECT PatientHistoryFactID, PatientDimID, Coid, 78 AS Family_History_Query_Id, LTRIM(RTRIM(CAST(AdvisedToQuitER AS VARCHAR(1000)))) AS Family_History_Value_Text, concat('0x', CONVERT(VARCHAR(50), HBSource, 2)) AS HBSource FROM navadhoc.dbo.patienthistory (NOLOCK) WHERE LTRIM(RTRIM(AdvisedToQuitER)) IS NOT NULL AND LTRIM(RTRIM(AdvisedToQuitER))<>'' UNION SELECT PatientHistoryFactID, PatientDimID, Coid, 79 AS Family_History_Query_Id, LTRIM(RTRIM(CAST(AdvisedToQuitPR AS VARCHAR(1000)))) AS Family_History_Value_Text, concat('0x', CONVERT(VARCHAR(50), HBSource, 2)) AS HBSource FROM navadhoc.dbo.patienthistory (NOLOCK) WHERE LTRIM(RTRIM(AdvisedToQuitPR)) IS NOT NULL AND LTRIM(RTRIM(AdvisedToQuitPR))<>'' UNION SELECT PatientHistoryFactID, PatientDimID, Coid, 80 AS Family_History_Query_Id, LTRIM(RTRIM(CAST(OnOrAboutDateER AS VARCHAR(1000)))) AS Family_History_Value_Text, concat('0x', CONVERT(VARCHAR(50), HBSource, 2)) AS HBSource FROM navadhoc.dbo.patienthistory (NOLOCK) WHERE LTRIM(RTRIM(OnOrAboutDateER)) IS NOT NULL AND LTRIM(RTRIM(OnOrAboutDateER))<>'' UNION SELECT PatientHistoryFactID, PatientDimID, Coid, 81 AS Family_History_Query_Id, LTRIM(RTRIM(CAST(OnOrAboutDatePR AS VARCHAR(1000)))) AS Family_History_Value_Text, concat('0x', CONVERT(VARCHAR(50), HBSource, 2)) AS HBSource FROM navadhoc.dbo.patienthistory (NOLOCK) WHERE LTRIM(RTRIM(RiskFactorNotes)) IS NOT NULL AND LTRIM(RTRIM(RiskFactorNotes))<>'' UNION SELECT PatientHistoryFactID, PatientDimID, Coid, 86 AS Family_History_Query_Id, LTRIM(RTRIM(CAST(OnOrAboutDatePR AS VARCHAR(1000)))) AS Family_History_Value_Text, concat('0x', CONVERT(VARCHAR(50), HBSource, 2)) AS HBSource FROM navadhoc.dbo.patienthistory (NOLOCK) WHERE LTRIM(RTRIM(RiskFactorNotes)) IS NOT NULL AND LTRIM(RTRIM(RiskFactorNotes))<>'' ) source_query~250000"
]

tblist9: [
  "62~navadhoc.dbo.patientcoreadherence~v_cr_stage_dataset_name.cn_patient_core_adherence_stg~append~select  coalesce(PatientCoreAdherenceFactID,0) as cn_patient_core_adherence_sid ,coalesce(PatientDimID,0) as nav_patient_id,coalesce(TumorTypeDimID,0) as tumor_type_id,coalesce(DiagnosisResultID,0) as diagnosis_result_id,coalesce(DiagnosisDimID,0) as nav_diagnosis_id,coalesce(NavigatorDimID,0) as navigator_id,case  when ltrim(rtrim(MeasureValue)) = 'CoreImaging' then 50  when ltrim(rtrim(MeasureValue)) = 'CoreBiopsy' then 51 when ltrim(rtrim(MeasureValue)) = 'CoreSurgery' then 52 when ltrim(rtrim(MeasureValue)) = 'CoreMedicalOncology' then 53 when ltrim(rtrim(MeasureValue)) = 'CoreRadiationOncology' then 54 when ltrim(rtrim(MeasureValue)) = 'CoreProcedures' then 55 when ltrim(rtrim(MeasureValue)) = 'CoreComplications' then 56 when ltrim(rtrim(MeasureValue)) = 'CoreLabs' then 57 when ltrim(rtrim(MeasureValue)) = 'CoreAssessments' then 58 when ltrim(rtrim(MeasureValue)) = 'CoreClinicalTrials' then 59  when ltrim(rtrim(MeasureValue)) = 'CoreMDM' then 60 end as core_adherence_measure_id,REPLACE(REPLACE(ltrim(rtrim(cast(result as varchar(255)))), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) as core_adherence_measure_text,coid,'H' as company_code,coalesce(concat('0x',convert(varchar(50),HBSource,2)),'') as hashbite_ssk,'N' as source_system_code,'v_currtimestamp' as dw_last_update_date_time from navadhoc.dbo.patientcoreadherence (NOLOCK) cross apply  ( values  ('CoreImaging',CoreImaging),('CoreBiopsy',CoreBiopsy),('CoreSurgery',CoreSurgery),('CoreMedicalOncology',CoreMedicalOncology),('CoreRadiationOncology',CoreRadiationOncology),('CoreProcedures',CoreProcedures),('CoreComplications',CoreComplications),('CoreLabs',CoreLabs),('CoreAssessments',CoreAssessments),('CoreClinicalTrials',CoreClinicalTrials),('CoreMDM',CoreMDM) ) c (MeasureValue,result) where result is not null and ltrim(rtrim(result)) != ''~250000"
]

tblist10: [
  "63~navadhoc.dbo.patientcommunication~v_cr_stage_dataset_name.cn_patient_contact_detail_stg~append~select coalesce(PatientComunicationFactID,0) as cn_patient_contact_sid,case when ltrim(rtrim(MeasureValue)) = 'AppointmentTopics' then 26 when ltrim(rtrim(MeasureValue)) = 'EducationFocus' then 27 when ltrim(rtrim(MeasureValue)) = 'OtherEducationFocus' then 28 when ltrim(rtrim(MeasureValue)) = 'EducationSource' then 29 when ltrim(rtrim(MeasureValue)) = 'OtherEducationSource' then 30 when ltrim(rtrim(MeasureValue)) = 'FollowupType' then 31 when ltrim(rtrim(MeasureValue)) = 'OtherFollowupType' then 32 when ltrim(rtrim(MeasureValue)) = 'PrimaryConcernTypes' then 33 when ltrim(rtrim(MeasureValue)) = 'OtherConcern' then 34 when ltrim(rtrim(MeasureValue)) = 'Score' then 35 when ltrim(rtrim(MeasureValue)) = 'ScorePct' then 36 when ltrim(rtrim(MeasureValue)) = 'DistressAssessmentDate' then 37 when ltrim(rtrim(MeasureValue)) = 'NextStep' then 38 when ltrim(rtrim(MeasureValue)) = 'OutCome' then 39 when ltrim(rtrim(MeasureValue)) = 'ContactInitiatedBy' then 40 when ltrim(rtrim(MeasureValue)) = 'ReferralMade' then 41 when ltrim(rtrim(MeasureValue)) = 'ReferralType' then 42 when ltrim(rtrim(MeasureValue)) = 'TraditionalReferral' then 43 when ltrim(rtrim(MeasureValue)) = 'NonTraditionalReferral' then 44 when ltrim(rtrim(MeasureValue)) = 'CommunityResource' then 45 when ltrim(rtrim(MeasureValue)) = 'ReferralDate' then 46 when ltrim(rtrim(MeasureValue)) = 'ReferralFacility' then 47 when ltrim(rtrim(MeasureValue)) = 'Reason' then 48 when ltrim(rtrim(MeasureValue)) = 'OtherAppointmentTopics' then 49 end as contact_detail_measure_type_id ,REPLACE(REPLACE(ltrim(rtrim(cast(result as varchar(255)))), NCHAR(8211), NCHAR(32)), NCHAR(8217), NCHAR(32)) contact_detail_measure_val_txt,coalesce(concat('0x',convert(varchar(50),HBSource,2)),'') as hashbite_ssk ,'N' as source_system_code ,'v_currtimestamp' as dw_last_update_date_time from navadhoc.dbo.patientcommunication (NOLOCK) cross apply ( values ('AppointmentTopics',AppointmentTopics), ('EducationFocus',EducationFocus), ('OtherEducationFocus',OtherEducationFocus), ('EducationSource',EducationSource), ('OtherEducationSource',OtherEducationSource), ('FollowupType',FollowupType), ('OtherFollowupType',OtherFollowupType), ('PrimaryConcernTypes',PrimaryConcernTypes), ('OtherConcern',OtherConcern), ('Score',Score), ('ScorePct',cast(ScorePct as varchar(255))), ('DistressAssessmentDate',cast(DistressAssessmentDate as varchar(255))), ('NextStep',NextStep), ('OutCome',OutCome), ('ContactInitiatedBy',ContactInitiatedBy), ('ReferralMade',ReferralMade), ('ReferralType',ReferralType), ('TraditionalReferral',TraditionalReferral), ('NonTraditionalReferral',NonTraditionalReferral), ('CommunityResource',CommunityResource), ('ReferralDate',cast(ReferralDate as varchar(255))), ('ReferralFacility',ReferralFacility), ('Reason',Reason), ('OtherAppointmentTopics',OtherAppointmentTopics) ) c (MeasureValue,result) where result is not null and ltrim(rtrim(result)) != ''~250000"
]


#DAG_3

tblist11: [
  "64~navadhoc.dbo.dimreferringmd~v_cr_stage_dataset_name.ref_referring_physician~append~select coalesce(ReferringMDDimID,0) as referring_physician_id,coalesce(ReferringMDName,'') as referring_physician_name,cast(ReferredToNavigation as CHAR(2)) as navigation_referred_ind,cast(ReferredToBiopsy as CHAR(2)) as biopsy_referred_ind,cast(ReferredToSurgery as CHAR(2)) as surgery_referred_ind,'N' as source_system_code,'v_currtimestamp' as dw_last_update_date_time from navadhoc.dbo.dimreferringmd (NOLOCK)~100000"
]

#DAG_4

tblist12: [
  "65~navadhoc.dbo.hemeclinicaltrial~v_cr_stage_dataset_name.cn_patient_heme_clinical_trial_stg~append~SELECT coalesce(PatientClinicalTrialFactID,0) as patientclinicaltrialfactid,coalesce(PatientDimID,0) as patientdimid,coalesce(TumorTypeDimID,0) as tumortypedimid,coalesce(DiagnosisDimID,0) as diagnosisdimid,coalesce(FacilityDimID,0) as facilitydimid,coalesce(NavigatorDimID,0) as navigatordimid,coalesce(DiagnosisResultID,0) as diagnosisresultid,coid,HemeEvaluated_ScreenedIndicator as hemeevaluated_screenedind,cast(HemeEvaluated_ScreenedDate as varchar(20)) as hemeevaluated_screeneddate,HemeOfferedClinicalTrialIndicator as hemeofferedclinicaltrialind,cast(HemeOfferedClinicalTrialDate as varchar(20)) as hemeofferedclinicaltrialdate,hemepatientenrolledinclinicaltrial,cast(HemeEnrolledInClinicalTrialDate as varchar(20)) as hemeenrolledinclinicaltrialdate,hemeclinicaltrialname,hemeclinicaltrialothername,hemetrialnotoffered,hemetrialnotofferedother,hemenotscreened,hemenotscreenedother,coalesce(concat('0x',CONVERT(varchar(50),HBSource,2)),'') as HBSource,'v_currtimestamp' as DW_Last_Update_Date_Time FROM NavAdhoc.dbo.hemeclinicaltrial (NOLOCK)~100000",
  "66~navadhoc.dbo.patienthemefunctionalassess~v_cr_stage_dataset_name.cn_patient_heme_functional_assess_stg~append~select coalesce(PatientHemeFunctionalAssessFactID,0) as patienthemefuncassessfactid,coalesce(PatientDimID,0) as patientdimid,coalesce(TumorTypeDimID,0) as tumortypedimid,coalesce(DiagnosisResultID,0) as diagnosisresultid,coalesce(DiagnosisDimID,0) as diagnosisdimid,coalesce(FacilityDimID,0) as facilitydimid,coid,coalesce(NavigatorDimID,0) as navigatordimid,cast(FunctionalAssessmentDate as date) as functionalassessmentdate,testtype,testtyperesults,coalesce(concat('0x',convert(varchar(50),HBSource,2)),'') as hbsource,cast(LastUpdateDateTime as datetime2(6)) as source_lastupdatedatetime,'v_currtimestamp' as dw_last_update_date_time from navadhoc.dbo.patienthemefunctionalassess (NOLOCK)~100000",
  "67~navadhoc.dbo.patienthemetreatmentregimen~v_cr_stage_dataset_name.patient_heme_treatment_regimen_stg~append~select  coalesce(PatientHemeDiagnosisFactID,0) as patienthemediagnosisfactid,coalesce(PatientDimID,0) as patientdimid,coalesce(TumorTypeDimID,0) as tumortypedimid,coalesce(DiagnosisResultID,0) as diagnosisresultid,coalesce(DiagnosisDimID,0) as diagnosisdimid,coalesce(FacilityDimID,0) as facilitydimid,coid,coalesce(NavigatorDimID,0) as navigatordimid,regimen,treatmentphase,coalesce(cast(PlannedStartDate as datetime),0) as plannedstartdate,coalesce(cast(ActualStartDate as datetime),0) as actualstartdate,drugs,cycles,cyclelength,cyclelengthinterval,cyclenumber,pathwayyesno,pathwayname,pathwaycompliant,pathwayvariancereason,otherpathwayreason,coalesce(cast(TreatmentPlanDoccumentDate as datetime),0) as treatmentplandoccumentdate,plandocumentedtimeframe,treatmentregimencoments,coalesce(concat('0x',convert(varchar(50),HBSource,2)),'') as hbsource, cast(LastUpdateDateTime as varchar) as lastupdatedatetime from navadhoc.dbo.patienthemetreatmentregimen (NOLOCK)~100000",
  "68~navadhoc.dbo.PatientHemeDiseaseAssessment~v_cr_stage_dataset_name.ref_test_type_stg~append~SELECT test_sub_type_desc,test_type_desc,dw_last_update_date_time FROM (SELECT [TestType]  AS test_sub_type_desc, 'Disease Assessment' AS test_type_desc,'v_currtimestamp' AS dw_last_update_date_time FROM navadhoc.dbo.patienthemediseaseassessment (NOLOCK) UNION SELECT [TestType] AS test_sub_type_desc, 'Functional Assessment' AS test_type_desc,'v_currtimestamp' AS dw_last_update_date_time FROM navadhoc.dbo.patienthemefunctionalassess (NOLOCK))sub_query~100",
  "69~navadhoc.dbo.patienthemetransplant~v_cr_stage_dataset_name.stg_patienthemetransplant~append~select coalesce(PatientHemeFactID,0) as patienthemefactid,coalesce(PatientDimID,0) as patientdimid,coalesce(TumorTypeDimID,0) as tumortypedimid,coalesce(DiagnosisResultID,0) as diagnosisresultid,coalesce(DiagnosisDimID,0) as diagnosisdimid,coalesce(FacilityDimID,0) as facilitydimid,coid,coalesce(NavigatorDimID,0) as navigatordimid,ltrim(rtrim(TransplantCandidacyStatus)) as transplantcandidacystatus,ltrim(rtrim(cast(StatusDate as varchar(20)))) as statusdate,ltrim(rtrim(CandidacyComment)) as candidacycomment,ltrim(rtrim(Type)) as type_type,ltrim(rtrim(cast(TransplantDate as varchar(20)))) as transplantdate,coalesce(MedicalSpecialistDimID,0) as medicalspecialistdimid,ltrim(rtrim(TransplantComments)) as transplantcomments,coalesce(ltrim(rtrim(concat('0x',convert(varchar(50),HBSource,2)))),'') as hbsource,ltrim(rtrim(cast(TransferDate as varchar(20)))) as transferdate,'v_currtimestamp' as dw_last_update_date_time from navadhoc.dbo.patienthemetransplant (NOLOCK)~100000",
  "70~navadhoc.dbo.patienthemediseaseassessment~v_cr_stage_dataset_name.patient_heme_disease_assessment_stg~append~select  coalesce(PatientHemeFactID,0) as patienthemefactid,coalesce(PatientDimID,0) as patientdimid,coalesce(TumorTypeDimID,0) as tumortypedimid,coalesce(DiagnosisResultID,0) as diagnosisresultid,coalesce(DiagnosisDimID,0) as diagnosisdimid,coalesce(FacilityDimID,0) as facilitydimid,coid,navigatordimid,ltrim(rtrim(convert(varchar,CollectionDate,20))) as collectiondate,ltrim(rtrim(Source)) as source,ltrim(rtrim(SampleSourceType)) as samplesourcetype,ltrim(rtrim(TestType)) as testtype,ltrim(rtrim(FacilityName)) as facilityname,ltrim(rtrim(Comments)) as comments,ltrim(rtrim(InitialDiagnosis)) as initialdiagnosis,ltrim(rtrim(DiseaseMonitoring)) as diseasemonitoring,ltrim(rtrim(DiseaseStatus)) as diseasestatus,ltrim(rtrim(TreatementStatus)) as treatementstatus,ltrim(rtrim(Karyotype)) as karyotype,cast(Cytogenetic as varchar) as cytogenetic,cast(Immunophenotype as varchar) as immunophenotype,ltrim(rtrim(OtherMolecularMarker)) as othermolecularmarker,ltrim(rtrim(OtherMolecularMarkerResult)) as othermolecularmarkerresult,ltrim(rtrim(IHC)) as ihc,ltrim(rtrim(CBC_WBC)) as cbc_wbc,ltrim(rtrim(CBC_Hgb)) as cbc_hgb,ltrim(rtrim(CBC_Plt)) as cbc_plt,ltrim(rtrim(CBC_ANC)) as cbc_anc,ltrim(rtrim(CBC_Seg)) as cbc_seg,ltrim(rtrim(CBC_Bands)) as cbc_bands,ltrim(rtrim(CBC_Monocyte)) as cbc_monocyte,ltrim(rtrim(CBC_Blast)) as cbc_blast,ltrim(rtrim(Cellularity)) as cellularity,ltrim(rtrim(CMP_Creatinine)) as cmp_creatinine,ltrim(rtrim(CMP_UricAcid)) as cmp_uricacid,ltrim(rtrim(CMP_LDH)) as cmp_ldh,ltrim(rtrim(CMP_TotalProtein)) as cmp_totalprotein,ltrim(rtrim(CMP_Albumiun)) as cmp_albumiun,ltrim(rtrim(CMP_Calcium)) as cmp_calcium,ltrim(rtrim(CMP_Bilirubin)) as cmp_bilirubin,ltrim(rtrim(CMP_AST)) as cmp_ast,ltrim(rtrim(CMP_ALT)) as cmp_alt,ltrim(rtrim(CMP_NTproBMPResults)) as cmp_ntprobmpresults,ltrim(rtrim(CMP_TroponinResults)) as cmp_troponinresults,ltrim(rtrim(BetaMicroglobulin)) as betamicroglobulin,ltrim(rtrim(SFLCKappa)) as sflckappa,ltrim(rtrim(SFLCLambda)) as sflclambda,ltrim(rtrim(SFLC_Ratio)) as sflc_ratio,ltrim(rtrim(UPEPSPEP_MProteinResuls)) as upepspep_mproteinresuls,ltrim(rtrim(MERatio)) as meratio,ltrim(rtrim(MP_CEBPA)) as mp_cebpa,ltrim(rtrim(MP_CKITResult)) as mp_ckitresult,ltrim(rtrim(MP_DNMT3A)) as mp_dnmt3a,ltrim(rtrim(MP_FLT3Method)) as mp_flt3method,ltrim(rtrim(MP_FLT3Result)) as mp_flt3result,ltrim(rtrim(MP_KIT)) as mp_kit,ltrim(rtrim(MP_NPM1)) as mp_npm1,ltrim(rtrim(MP_OtherMolecularMarkers)) as mp_othermolecularmarkers,ltrim(rtrim(CSF_CSFResults)) as csf_csfresults,ltrim(rtrim(UPEPSPEP_IFEResults)) as upepspep_iferesults,ltrim(rtrim(BMPlasmaCell)) as bmplasmacell,ltrim(rtrim(BMDay)) as bmday,ltrim(rtrim(FISH_MolecularMarkers)) as fish_molecularmarkers,ltrim(rtrim(FISH_PhiladelphiaChromosome)) as fish_philadelphiachromosome,ltrim(rtrim(FISH_OtherMolecularMarkers)) as fish_othermolecularmarkers,ltrim(rtrim(FISH_MolecularMarkersSign)) as fish_molecularmarkerssign,ltrim(rtrim(Hepatitis_HepAResult)) as hepatitis_heparesult,ltrim(rtrim(Hepatitis_HepBResult)) as hepatitis_hepbresult,ltrim(rtrim(Hepatitis_HepCResult)) as hepatitis_hepcresult,ltrim(rtrim(HIVTest_HIVResults)) as hivtest_hivresults,ltrim(rtrim(NodalLocation)) as nodallocation,ltrim(rtrim(LymphNode_IHCResults)) as lymphnode_ihcresults,ltrim(rtrim(LymphNode_LymphNodeResults)) as lymphnode_lymphnoderesults,ltrim(rtrim(Immunoglobulins_IgA)) as immunoglobulins_iga,ltrim(rtrim(Immunoglobulins_IgD)) as immunoglobulins_igd,ltrim(rtrim(Immunoglobulins_IgE)) as immunoglobulins_ige ,ltrim(rtrim(Immunoglobulins_IgG)) as immunoglobulins_igg,ltrim(rtrim(Immunoglobulins_IgM)) as immunoglobulins_igm ,ltrim(rtrim(Other_OtherSource)) as other_othersource,ltrim(rtrim(Other_DiseaseAssessmentTest)) as other_diseaseassessmenttest,ltrim(rtrim(Other_Result)) as other_result,coalesce(ltrim(rtrim(concat('0x',convert(varchar(50),HBSource,2)))),'') as hbsource,convert(varchar,LastUpdateDateTime,20) as lastupdatedatetime from navadhoc.dbo.patienthemediseaseassessment (NOLOCK)~100000",
  "71~navadhoc.dbo.patienthemediagnosis~v_cr_stage_dataset_name.stg_patienthemediagnosis~append~select coalesce(PatientHemeDiagnosisFactID,0) as patienthemediagnosisfactid,coalesce(PatientDimID,0) as patientdimid,ltrim(rtrim(DiseaseStatus)) as diseasestatus,coalesce(TumorTypeDimID,0) as tumortypedimid,coalesce(DiagnosisResultID,0) as diagnosisresultid,coalesce(DiagnosisDimID,0) as diagnosisdimid,coalesce(NavigatorDimID,0) as navigatordimid,coalesce(FacilityDimID,0) as facilitydimid,coid,ltrim(rtrim(cast(SpecimanDate as varchar(20)))) as specimandate,ltrim(rtrim(DiseaseDiagnosis)) as diseasediagnosis,ltrim(rtrim(TherapyRelated)) as therapyrelated,ltrim(rtrim(TransformedFromMDS)) as transformedfrommds,ltrim(rtrim(MIPI)) as mipi,ltrim(rtrim(IPI)) as ipi,ltrim(rtrim(FLIPI)) as flipi,ltrim(rtrim(AIDSRelated)) as aidsrelated,ltrim(rtrim(Comments)) as comments,ltrim(rtrim(Classification)) as classification,ltrim(rtrim(SubClassification)) as subclassification,ltrim(rtrim(NHLType)) as nhltype,ltrim(rtrim(OtherNHLType)) as othernhltype,ltrim(rtrim(TransformedDisease)) as transformeddisease,ltrim(rtrim(NonMalignantType)) as nonmalignanttype,ltrim(rtrim(Features)) as features,ltrim(rtrim(Risk)) as risk,ltrim(rtrim(RiskRIPSS)) as riskripss,ltrim(rtrim(StagingField1)) as stagingfield1,ltrim(rtrim(stagingfield2))as stagingfield2,coalesce(ltrim(rtrim(concat('0x',convert(varchar(50),HBSource,2)))),'') as hbsource from navadhoc.dbo.patienthemediagnosis (NOLOCK)~100000",
  "72~navadhoc.dbo.patienthemeriskfactor~v_cr_stage_dataset_name.patient_heme_risk_factor_stg~append~select coalesce(PatientHemeDiagnosisFactID,0) as patienthemediagnosisfactid,coalesce(PatientDimID,0) as patientdimid,coalesce(TumorTypeDimID,0) as tumortypedimid,coalesce(DiagnosisResultID,0) as diagnosisresultid,coalesce(DiagnosisDimID,0) as diagnosisdimid,coalesce(FacilityDimID,0) as facilitydimid,coid,coalesce(NavigatorDimID,0) as navigatordimid,riskfactor,otherriskfactor,tumordiseasesite,othertumordiseasesite,cast(concat('0x',convert(varchar(50),[HBSource],2)) as varchar(60)) as hashbite_ssk,'v_currtimestamp' as dw_last_update_date_time from navadhoc.dbo.patienthemeriskfactor (NOLOCK)~100000",
  "73~navadhoc.dbo.dimmedicalspecialist~v_cr_stage_dataset_name.cn_physician_role_stg~append~select physician_id,physician_role_code,source_system_code,dw_last_update_date_time from (select coalesce(MedicalSpecialistDimId,0) as physician_id,'BP' as physician_role_code,'N' as source_system_code,'v_currtimestamp' as dw_last_update_date_time from navadhoc.dbo.dimmedicalspecialist (NOLOCK) where BiopsyPhysician=1 union select coalesce(MedicalSpecialistDimId,0) as physician_id,'CP' as physician_role_code,'N' as source_system_code,'v_currtimestamp' as dw_last_update_date_time from navadhoc.dbo.dimmedicalspecialist (NOLOCK) where ConsultPhysician=1	 union select coalesce(MedicalSpecialistDimId,0) as physician_id,'IP' as physician_role_code,'N' as source_system_code,'v_currtimestamp' as dw_last_update_date_time from navadhoc.dbo.dimmedicalspecialist (NOLOCK) where ImagingPhysician=1	union select coalesce(MedicalSpecialistDimId,0) as physician_id,'RSU' as physician_role_code,'N' as source_system_code,'v_currtimestamp' as dw_last_update_date_time from navadhoc.dbo.dimmedicalspecialist (NOLOCK) where ReconSurgeon=1	union select coalesce(MedicalSpecialistDimId,0) as physician_id, 'SGN' as physician_role_code, 'N' as source_system_code,'v_currtimestamp' as dw_last_update_date_time	from navadhoc.dbo.dimmedicalspecialist (NOLOCK) where Surgeon=1	 union select coalesce(MedicalSpecialistDimId,0) as physician_id,'MO' as physician_role_code,'N' as source_system_code,'v_currtimestamp' as dw_last_update_date_time from navadhoc.dbo.dimmedicalspecialist (NOLOCK) where MedicalOncologist=1	 union select coalesce(MedicalSpecialistDimId,0) as physician_id,'RO'as physician_role_code,'N' as source_system_code,'v_currtimestamp' as dw_last_update_date_time from navadhoc.dbo.dimmedicalspecialist (NOLOCK) where RadiationOncologist=1)source_query~100000"
]

schedule:
  - schedule_interval: None
    start_date: pendulum.datetime(2023, 11, 19, tz=timezone)
    frequency: daily
    dag_id_suffix: 1
    done_file: NONE
    has_sensor: 'No'
    trigger_dag_ids: ['dag_integrate_navadhoc_sqlserver_daily_01']
    tblist: [tblist1]
    truncatetablelist: ['ref_status_stg','ref_contact_method_stg','ref_breast_cancer_type_stg','therapy_type_stg','ref_site_location_stg','procedure_type_stg','ref_physician_specialty_stg','ref_result_stg','contact_person_stg','contact_purpose_stg','ref_diagnosis_detail_stg','ref_side_stg','ref_lung_lobe_location_stg','ref_facility_stg','ref_imaging_mode_stg','ref_tumor_type_stg','v_cr_core_dataset_name.ref_treatment_type','v_cr_core_dataset_name.ref_surgery_type','v_cr_core_dataset_name.ref_navigator','v_cr_core_dataset_name.ref_lab_type','v_cr_core_dataset_name.ref_imaging_type','v_cr_core_dataset_name.ref_diagnosis_result','v_cr_core_dataset_name.ref_diagnosis_navigation','v_cr_core_dataset_name.ref_core_record_type','v_cr_core_dataset_name.ref_biopsy_type','v_cr_core_dataset_name.ref_biopsy_result','v_cr_core_dataset_name.ref_consult_type']    
  
  - schedule_interval: None
    start_date: pendulum.datetime(2023, 11, 19, tz=timezone)
    frequency: daily
    dag_id_suffix: 2
    done_file: NONE
    has_sensor: 'No'
    trigger_dag_ids: [dag_integrate_navadhoc_sqlserver_daily_02]
    tblist: [tblist2,tblist3,tblist4,tblist5,tblist6,tblist7,tblist8,tblist9,tblist10]
    truncatetablelist: ['v_cr_core_dataset_name.ref_navque_action','v_cr_stage_dataset_name.ref_housing_type_stg','v_cr_core_dataset_name.ref_navque_reason','cn_patient_complication_stg','cn_patient_heme_stg','cn_patient_surgery_reconstruction_stg','cn_patient_radiation_oncology_stg','cn_patient_mltp_disciplinary_meeting_stg','cn_patient_lab_result_stg','cn_physician_detail_stg','cn_patient_genetics_testing_stg','cn_patient_clinical_trial_stg','cn_patient_brca_screening_assessment_stg','cn_patient_procedure_stg','cn_patient_phone_num_stg','cn_patient_test_result_stg','cn_patient_survivorship_plan_task_stg','cn_patient_medical_oncology_stg','cn_patient_biopsy_stg','cn_patient_consultation_stg','cn_patient_diagnosis_stg','cn_patient_address_stg','cn_patient_procedure_pathology_result_stg','cn_patient_imaging_stg','cn_patient_stg','cn_patient_tumor_stg','cn_patient_timeline_stg','cn_person_stg','cn_patient_surgery_stg','navque_history_stg','cn_patient_staging_stg','cn_patient_contact_stg','cn_patient_pathology_result_stg','cn_patient_family_history_stg','cn_patient_core_adherence_stg','cn_patient_contact_detail_stg']

  - schedule_interval: None
    start_date: pendulum.datetime(2023, 11, 19, tz=timezone)
    frequency: daily
    dag_id_suffix: 3
    done_file: NONE
    has_sensor: 'No'
    trigger_dag_ids: [dag_integrate_navadhoc_sqlserver_daily_03]
    tblist: [tblist11]
    truncatetablelist: ['ref_referring_physician']


  - schedule_interval: None
    start_date: pendulum.datetime(2023, 11, 19, tz=timezone)
    frequency: daily
    dag_id_suffix: 4
    done_file: NONE
    has_sensor: 'No'
    trigger_dag_ids: [dag_integrate_navadhoc_sqlserver_daily_04]
    tblist: [tblist12]
    truncatetablelist: ['patient_heme_treatment_regimen_stg','ref_test_type_stg','stg_patienthemetransplant','patient_heme_disease_assessment_stg','stg_patienthemediagnosis','patient_heme_risk_factor_stg','cn_patient_heme_functional_assess_stg','cn_physician_role_stg','cn_patient_heme_clinical_trial_stg']