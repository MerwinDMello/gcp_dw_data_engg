#source system specific configuration values

v_sourcesysnm: ra
v_databasetype: oracle
v_user: RPT_EXTRACT
hostname: xrps5-scan1.unix.medcity.net:1551
servicename_p1: ccmnasp1_gcp
servicename_p2: ccmnasp2_gcp
v_pwd_secret_name_p1: oracle_concuity_ha_pwd_p1/versions/latest
v_pwd_secret_name_p2: oracle_concuity_ha_pwd_p2/versions/latest
v_jdbc_class_name: oracle.jdbc.driver.OracleDriver
v_jdbc_jar: ojdbc8.jar
v_jdkfile: jre-8u351-linux-x64.tar.gz
v_jdkversion: jre1.8.0_351
v_jdbcbqpytemplate: Oracle_to_BigQuery_PythonTemplate_weekly_monthly.py
v_machine_type: n2-highmem-4 #n2-standard-4 
v_audittablename: audit_control

tblist1: [
  "0~concuity.mon_account_payer~v_parallon_ra_stage_dataset_name.cc_remit_recon_aggregated~delete~Select /*+ PARALLEL */ $SchemaID as Schema_ID, Unit_Num as Unit_Num, Count(Ra_Pat_Acct_Num) as Ra_Pat_Acct_Num, Sum(Ra_Covered_Days_Num) as Ra_Covered_Days_Num, Sum(Ra_Visit_Cnt) as Ra_Visit_Cnt, Sum(Ra_Covered_Days_Visit_Cnt) as Ra_Covered_Days_Visit_Cnt, Sum(Ra_Non_Replaced_Blood_Unit_Qty) as Ra_Non_Replaced_Blood_Unit_Qty, Sum(Ra_Prescription_Qty) as Ra_Prescription_Qty, Sum(Ra_Total_Charge_Amt) as Ra_Total_Charge_Amt, Sum(Ra_Non_Covered_Charge_Amt) as Ra_Non_Covered_Charge_Amt, Sum(Ra_Net_Billed_Charge_Amt) as Ra_Net_Billed_Charge_Amt, Sum(Ra_Deductible_Amt) as Ra_Deductible_Amt, Sum(Ra_Coinsurance_Amt) as Ra_Coinsurance_Amt, Sum(Ra_Net_Benefit_Amt) as Ra_Net_Benefit_Amt, Sum(Ra_Insurance_Payment_Amt) as Ra_Insurance_Payment_Amt, Sum(Ra_Patient_Responsible_Amt) as Ra_Patient_Responsible_Amt, CURRENT_DATE AS DW_LAST_UPDATE_DATE_TIME From ( Select OG.Short_Name AS Unit_Num, MA.Account_No AS RA_Pat_Acct_Num, COALESCE( RACP.Actual_Covered_Days, RACP.COVERED_DAYS_VISITS_COUNT ) AS RA_Covered_Days_Num, RACP.Visits AS RA_Visit_Cnt, RACP.COVERED_DAYS_VISITS_COUNT AS RA_Covered_Days_Visit_Cnt, RACP.NOT_REPLACED_BLOOD_UNITS AS RA_Non_Replaced_Blood_Unit_Qty, RACP.PRESCRIPTION AS RA_Prescription_Qty, RACP.TTL_CLAIM_CHARGE_AMOUNT AS RA_Total_Charge_Amt, COALESCE(RAAggCat400.RAAggCat400Amount, 0) AS RA_Non_Covered_Charge_Amt, COALESCE( RACP.TTL_CLAIM_CHARGE_AMOUNT - COALESCE(RAAggCat400.RAAggCat400Amount, 0), 0 ) AS RA_Net_Billed_Charge_Amt, COALESCE(RAAggCat550.RAAggCat550Amount, 0) AS RA_Deductible_Amt, COALESCE(RAAggCat510.RAAggCat510Amount, 0) AS RA_Coinsurance_Amt, CASE WHEN MPYR.Rank = 1 THEN COALESCE(RACP.TTL_CLAIM_CHARGE_AMOUNT, 0) - COALESCE(RAAggCat500.RAAggCat500Amount, 0) - COALESCE(RACP.Claim_Payment_Amount, 0) ELSE COALESCE( ( COALESCE( RACP.TTL_CLAIM_CHARGE_AMOUNT - COALESCE(RAAggCat400.RAAggCat400Amount, 0), 0 ) ), 0 ) - COALESCE(RAAggCat500.RAAggCat500Amount, 0) END AS RA_Net_Benefit_Amt, RACP.Claim_Payment_Amount AS RA_Insurance_Payment_Amt, COALESCE(RAAggCat500.RAAggCat500Amount, 0) AS RA_Patient_Responsible_Amt, CASE WHEN RACP.IS_DELETED = 1 THEN 'N' ELSE 'Y' END AS Active_Ind FROM Concuity.RA_Claim_Payment RACP LEFT OUTER JOIN ( SELECT SUM(COALESCE(Amount, 0)) AS RAAggCat400Amount, RA_Claim_Payment_Id, 1 as Schema_Id FROM Concuity.RA_835_CATEGORY_AGGREGATED WHERE RA_Category_Id BETWEEN 400 AND 499 GROUP BY RA_Claim_Payment_Id ) RAAggCat400 ON RACP.Id = RAAggCat400.RA_CLAIM_PAYMENT_ID LEFT OUTER JOIN ( SELECT SUM(COALESCE(Amount, 0)) AS RAAggCat500Amount, RA_Claim_Payment_Id, 1 as Schema_Id FROM Concuity.RA_835_CATEGORY_AGGREGATED WHERE RA_Category_Id BETWEEN 500 AND 599 GROUP BY RA_Claim_Payment_Id ) RAAggCat500 ON RACP.Id = RAAggCat500.RA_CLAIM_PAYMENT_ID LEFT OUTER JOIN ( SELECT SUM(COALESCE(Amount, 0)) AS RAAggCat510Amount, RA_Claim_Payment_Id, 1 as Schema_Id FROM Concuity.RA_835_CATEGORY_AGGREGATED WHERE RA_Category_Id = 510 GROUP BY RA_Claim_Payment_Id ) RAAggCat510 ON RACP.Id = RAAggCat510.RA_CLAIM_PAYMENT_ID LEFT OUTER JOIN ( SELECT SUM(COALESCE(Amount, 0)) AS RAAggCat550Amount, RA_Claim_Payment_Id, 1 as Schema_Id FROM Concuity.RA_835_CATEGORY_AGGREGATED WHERE RA_Category_Id = 550 GROUP BY RA_Claim_Payment_Id ) RAAggCat550 ON RACP.Id = RAAggCat550.RA_CLAIM_PAYMENT_ID LEFT OUTER JOIN ( SELECT SUM(COALESCE(Supplement_Amount, 0)) AS RAClaimSupplementAmt, RA_Claim_Payment_Id, 1 as Schema_Id FROM Concuity.RA_Claim_Supplement WHERE Supplement_Type = 'ZM' GROUP BY RA_Claim_Payment_Id ) RACS ON RACP.Id = RACS.RA_Claim_Payment_Id JOIN Concuity.RA_Group_Header RAGH ON RAGH.Id = RACP.RA_Group_Header_Id JOIN Concuity.Mon_Account MA ON RACP.mon_account_id = MA.ID JOIN Concuity.Org OG ON MA.Org_Id_Provider = OG.Org_Id JOIN Concuity.Mon_Patient_Type MPT ON MPT.Id = MA.Mon_Patient_Type_Id AND MPT.Org_Id = MA.Org_Id_Provider LEFT OUTER JOIN Concuity.Mon_Account_Payer MPYR ON RACP.mon_account_payer_id = MPYR.Id LEFT OUTER JOIN Concuity.Mon_Payer PYR ON PYR.ID = MPYR.mon_payer_id LEFT OUTER JOIN ( SELECT procedure_code, ra_claim_payment_id, 1 as Schema_Id FROM Concuity.RA_Service WHERE Procedure_Code_Type = 'ZZ' GROUP BY ra_claim_payment_id, procedure_code ) RASVCode ON RACP.Id = RASVCode.RA_Claim_Payment_Id LEFT OUTER JOIN Concuity.RA_Claim_Identifier RACI ON RACI.RA_Claim_Payment_Id = RACP.Id AND RACI.identifier_type = '9C' LEFT OUTER JOIN Concuity.RA_Claim_Identifier RACICE ON RACICE.Ra_Claim_Payment_Id = RACP.Id AND RACICE.identifier_type = 'CE' WHERE trunc(RACP.DATE_CREATED) < sysdate ) A GROUP BY Unit_num~100000"
]  

tblist2: [
  "0~concuity.mon_appeal~v_parallon_ra_stage_dataset_name.denial_eow_wrk1~delete~select $SchemaID as schema_id , acctapl.mon_account_id , acctapl.mon_payer_id , trunc(sysdate) as rpt_run_date , actp.start_date as rpt_start_date , actp.end_date as rpt_end_date , org.short_name as unit_num , to_number(ma.account_no) as pat_acct_num , to_number(trim(replace(pay.code, '-'))) as iplan_id , max_apl.payer_rank as iplan_insurance_order_num , a.external_code as external_code , ma.misc_char08 as patient_code , ma.financial_class as financial_class , map.misc_char01 as payer_finclass_code , coalesce(map.first_denial_date, mapl.lifecycle_date, min_apl.date_created) as min_denial_date , case when trunc(max_apl.appeal_close_date) > actp.end_date and trunc(max_apl.appeal_close_date) <= actp.close_date + 1 then 1 when d.code = 'OUNWO' then 7 when d.code = 'COTNL' then 8 when d.code = 'CUNL' then 9 when d.code = 'COTFL' then 10 when d.code = 'CBTHR' then 12 when d.code = 'IINND' then 13 when d.code = 'CUXNP' then 14 when d.code = 'CNOAP' then 15 when d.code = 'OWMR' then 16 when d.code = 'CNORP' then 17 when d.code = 'OXLGL' then 18 when d.code = 'OPPTP' then 20 when d.code = 'OSENT' then 21 when d.code = 'OBILL' then 23 when d.code = 'OCOND' then 24 when d.code = 'OARB' then 25 when d.code = 'OICRW' then 26 when d.code = 'OIWRW' then 27 when d.code = 'OMRPA' then 28 when d.code = 'OPMC' then 32 when d.code = 'OPMR' then 33 when d.code = 'ORBLD' then 34 when d.code = 'OSOPP' then 36 when d.code = 'OTFAP' then 37 when d.code = 'OTOVD' then 38 when d.code = 'CUFTA' then 42 when d.code = 'CSAPS' then 44 when d.code = 'OOTNL' then 47 when d.code = 'OSMAC' then 50 when d.code = 'OSQIC' then 51 when d.code = 'OSALJ' then 52 when d.code = 'OSDAB' then 53 when d.code = 'OSUSD' then 54 when d.code = 'COMAC' then 55 when d.code = 'COQIC' then 56 when d.code = 'COALJ' then 57 when d.code = 'CODAB' then 58 when d.code = 'COUSD' then 59 when d.code = 'CUMAC' then 65 when d.code = 'CUQIC' then 66 when d.code = 'CUALJ' then 67 when d.code = 'CUDAB' then 68 when d.code = 'CUUSD' then 69 when d.code = 'OWDR' then 71 when d.code = 'ODISR' then 72 when d.code = 'CDRT' then 73 when d.code = 'CUPTP' then 74 when d.code = 'CUIRO' then 75 when d.code = 'CUFRE' then 76 when d.code = 'CUFEX' then 77 when d.code = 'CUFSP' then 78 when d.code = 'CNAFS' then 79 when d.code = 'CUFSA' then 80 when d.code = 'CUFEA' then 81 when d.code = 'CUF' then 83 when d.code = 'CNAPP' then 85 when d.code = 'OCMS' then 86 when d.code = 'CCMS' then 87 when d.code = 'OICMR' then 88 when d.code = 'OIHIM' then 89 when d.code = 'ORPA' then 90 when d.code = 'OIFUP' then 91 when d.code = 'OCTFU' then 92 when d.code = 'ORCN' then 93 when d.code = 'OSIRF' then 94 when d.code = 'OSEFU' then 95 when d.code = 'CUFNP' then 100 when d.code = 'OEA' then 101 when d.code = 'OEM' then 102 when d.code = 'OER' then 103 when d.code = 'OEP' then 104 when d.code = 'OED' then 105 when d.code = 'OEG' then 106 when d.code = 'OES' then 107 when d.code = 'OEH' then 108 when d.code = 'OEU' then 109 when d.Code = 'ORNA' THEN 110 when trim(d.code) is null then 7 else 0 end as Web_Denial_Disp_Code , nvl(tbl_seq_cnt.appeal_seq_cnt,1) as appeal_cnt , max_apl_seq.sequence_no as sequence_no , max_apl.appeal_no as appeal_no , max_apl_seq.date_created as Max_Seq_Create_Date , case when prior_apl.prior_appeal_flag = 1 then 1 when trunc(min_apl.date_created) between trunc(actp.start_date) and trunc(actp.end_date) then 0 when trunc(min_apl.date_created) > trunc(actp.end_date) and trunc(min_apl.appeal_close_date) <= trunc(actp.end_date) then 0 else 1 end as Existing_account , min_apl_first_seq.appeal_balance_amt_begin as min_appeal_bal_amt_beg , case when (trunc(min_apl.date_created) between trunc(actp.start_date) and trunc(actp.end_date)) or (trunc(min_apl.date_created) > trunc(actp.end_date) and trunc(min_apl.appeal_close_date) <= trunc(actp.end_date)) then min_apl_seq.APPEALED_AMT else 0 end as new_amt , case when prior_apl.prior_appeal_flag = 1 then 0 when trunc(min_apl.date_created) between actp.start_date and actp.end_date then 1 when trunc(min_apl.date_created) > actp.end_date and trunc(min_apl.appeal_close_date) <= actp.end_date then 1 else 0 end as new_account , case when nvl(max_apl.appeal_close_date, to_date('01/01/1800', 'mm/dd/yyyy')) > actp.end_date then null else max_apl.appeal_close_date end as Max_Appeal_Date_Closed , CAST(trunc(max_apl_seq.deadline_date)AS VARCHAR(100)) as deadline_date, case when rtrim(ltrim(d.code)) = 'IINND' then max_apl_seq.appeal_balance_amt_begin else 0 end as not_true_denial_amt , case when trunc(max_apl.appeal_close_date) is not null and trunc(max_apl.appeal_close_date) between actp.start_date and actp.end_date then 1 else 0 end as resolved_account , ma.total_charges as total_charges , trim(ma.attending_physician_name) as attending_phys_name , ma.attending_physician_id as attending_phys_id , nvl(ma.total_charges, 0) - nvl(mat_balance.tot_trxnamt, 0) as account_balance , ma.service_date_end as discharge_date , ma.misc_char01 as service_code , ma.medical_record_number as medical_rec_num , usr.login_id as login_id , max_apl.date_modified as appeal_date_modified , rc.code as root_cause_code , replace(replace(rc.description, chr(13)), chr(10)) as root_cause_description , pv.display_text as denial_code_category , case when (trunc(max_apl.appeal_close_date) is not null and (trunc(max_apl.appeal_close_date) > actp.end_date and trunc(max_apl.appeal_close_date) <= actp.close_date + 1)) then 'PEND' when trim(d.code) is null then 'OUNWO' else rtrim(ltrim(d.code)) end as disposition_code , a.code as appeal_code , a.description as appeal_description , case when rtrim(ltrim(d.code)) = 'IINND' then 0 else nvl(max_apl_seq.appeal_balance_amt, 0) end as max_appeal_bal_amt , nvl(trans.corrections_amt,0) as corrections_amt , nvl(trans.xfer_next_party_amt,0) as xfer_next_party_amt , nvl(trans.cash_adj_amt,0) as cash_adj_amt , nvl(trans.contractual_allowance_amt,0) as contractual_allowance_amt , nvl(trans.overturned_amt,0) as overturned_amt , nvl(trans.writeoff_amt,0) as writeoff_amt , sysdate as last_update_date_time , vnd.Code as Vendor_Cd from (select v.accounting_period_id , v.mon_account_id , v.mon_payer_id , max(case when v.appeal_no = v.max_appeal_no then v.appeal_id end) as max_apl_id , max(case when v.appeal_no = v.min_appeal_no then v.appeal_id end) as min_apl_id , max(case when v.appeal_no = v.max_appeal_no and v.sequence_no = v.max_appeal_seq_no then v.appeal_seq_id end) as max_appeal_seq_id , max(case when v.appeal_no = v.min_appeal_no and v.sequence_no = v.min_appeal_seq_no then v.appeal_seq_id end) as min_appeal_seq_id , max(v.max_appeal_close_date) as max_appeal_close_date from (select ap.id as accounting_period_id , apl.mon_account_id , apl.mon_payer_id , apl.appeal_no , apl.id as appeal_id , aplseq.sequence_no , aplseq.id as appeal_seq_id , max(apl.appeal_no) over (partition by apl.mon_account_id, apl.mon_payer_id) as max_appeal_no , min(apl.appeal_no) over (partition by apl.mon_account_id, apl.mon_payer_id) as min_appeal_no , max(aplseq.sequence_no) over (partition by apl.mon_account_id, apl.mon_payer_id, apl.appeal_no) as max_appeal_seq_no , min(aplseq.sequence_no) over (partition by apl.mon_account_id, apl.mon_payer_id, apl.appeal_no) as min_appeal_seq_no , max(apl.appeal_close_date) over (partition by apl.mon_account_id, apl.mon_payer_id) as max_appeal_close_date from Concuity.mon_appeal apl inner join Concuity.mon_accounting_period ap on trunc(ap.start_date) = add_months(trunc(sysdate,'mm'),0) inner join Concuity.mon_appeal_sequence aplseq on aplseq.mon_appeal_id = apl.id inner join Concuity.mon_payer pay on apl.mon_payer_id = pay.id inner join Concuity.mon_account_payer map on map.mon_account_id = apl.mon_account_id and map.mon_payer_id = apl.mon_payer_id and map.rank = apl.payer_rank and map.rank < 51 where trim(pay.code) <> 'NO INS' and (((trunc(apl.appeal_close_date) is null or trunc(apl.appeal_close_date) > trunc(ap.end_date)) and trunc(apl.date_created) <= trunc(ap.end_date)) or (trunc(apl.appeal_close_date) between trunc(ap.start_date) and trunc(ap.end_date) and trunc(apl.date_created) <= trunc(ap.end_date))) and (((trunc(aplseq.sequence_close_date) is null or trunc(aplseq.sequence_close_date) > trunc(ap.end_date)) and trunc(aplseq.date_created) <= trunc(ap.close_date) + 1) or (trunc(aplseq.sequence_close_date) between trunc(ap.start_date) and trunc(ap.end_date) and trunc(aplseq.date_created) <= trunc(ap.close_date) + 1)) and apl.payer_rank < 51 and not ((trunc(nvl(apl.date_created, to_date('01/01/1800', 'MM/DD/YYYY'))) = trunc(nvl(apl.appeal_close_date, to_date('01/01/1800', 'MM/DD/YYYY'))) and apl.appeal_no = 1 and aplseq.sequence_no = 1 and aplseq.appealed_amt = 0 and aplseq.appeal_balance_amt = 0)) and not (apl.appeal_no = 1 and trunc(apl.date_created) >= trunc(ap.start_date) and trunc(apl.appeal_close_date) between trunc(ap.start_date) and trunc(ap.end_date) and trunc(apl.appeal_close_date) is not null and exists (select 1 from Concuity.mon_appeal_sequence s join Concuity.apl_disposition d on d.id = s.apl_disposition_id where s.mon_appeal_id = apl.id and s.sequence_no = 1 and d.code = 'IINND' and s.appeal_balance_amt = 0)) ) v group by v.accounting_period_id, v.mon_account_id, v.mon_payer_id) acctapl inner join Concuity.mon_accounting_period actp on actp.id = acctapl.accounting_period_id inner join Concuity.mon_payer pay on pay.id = acctapl.mon_payer_id and trim(pay.code) <> 'NO INS' inner join Concuity.mon_account ma on ma.id = acctapl.mon_account_id inner join Concuity.org org on ma.org_id_provider = org.org_id inner join hca_reporting.group_stack_unit gsu on org.org_id = gsu.org_id inner join Concuity.mon_appeal max_apl on max_apl.id = acctapl.max_apl_id inner join Concuity.mon_appeal_sequence max_apl_seq on max_apl_seq.id = acctapl.max_appeal_seq_id left join Concuity.vendor vnd on vnd.vendor_id = max_apl_seq.vendor_id inner join Concuity.mon_appeal min_apl on min_apl.id = acctapl.min_apl_id inner join Concuity.mon_appeal_sequence min_apl_seq on min_apl_seq.id = acctapl.min_appeal_seq_id inner join ( select mon_appeal_id, min(appeal_balance_amt_begin) as appeal_balance_amt_begin from Concuity.mon_appeal_sequence where sequence_no = 1 group by mon_appeal_id ) min_apl_first_seq on min_apl_first_seq.mon_appeal_id = acctapl.min_apl_id left join Concuity.apl_appeal a on a.id = max_apl_seq.apl_appeal_id left join Concuity.mon_account_payer map on map.mon_account_id = max_apl.mon_account_id and map.mon_payer_id = max_apl.mon_payer_id and map.rank = max_apl.payer_rank and map.rank < 51 left join ( select lc.mon_account_payer_id, min(lc.lifecycle_date) as lifecycle_date from Concuity.mon_account_payer_lifecycle lc where lc.lifecycle_event = 2666583 group by lc.mon_account_payer_id ) mapl on mapl.mon_account_payer_id = map.id left outer join Concuity.apl_disposition d on d.id = max_apl_seq.apl_disposition_id left outer join (select a.mon_account_id, a.mon_payer_id, 1 as prior_appeal_flag from Concuity.mon_appeal a inner join Concuity.mon_appeal_sequence ms on ms.mon_appeal_id = a.id left join Concuity.apl_disposition ad on ad.id = ms.apl_disposition_id where trunc(a.date_created) < add_months(trunc(sysdate,'mm'),0) and not (trunc(nvl(a.date_created, to_date('01/01/1800', 'MM/DD/YYYY'))) = trunc(nvl(a.appeal_close_date, to_date('01/01/1800', 'MM/DD/YYYY'))) and ms.appeal_balance_amt = 0 and ms.appealed_amt = 0 and a.appeal_no = 1 and ms.sequence_no = 1) and not (a.appeal_no = 1 and ms.sequence_no = 1 and trunc(a.date_created, 'mm') = trunc(a.appeal_close_date, 'mm') and ad.code = 'IINND' and ms.Appeal_Balance_Amt = 0) group by a.mon_account_id, a.mon_payer_id) prior_apl on prior_apl.mon_account_id = acctapl.mon_account_id and prior_apl.mon_payer_id = acctapl.mon_payer_id left outer join (select sum(nvl(matbal.amount, 0)) as tot_trxnamt, matbal.mon_account_id from Concuity.mon_account_transaction matbal inner join Concuity.mon_transaction_master tm on matbal.mon_transaction_master_id = tm.id where tm.type in ('A', 'P') group by matbal.mon_account_id) mat_balance on mat_balance.mon_account_id = acctapl.mon_account_id left outer join Concuity.users usr on usr.user_id = max_apl.user_id_modified_by left outer join Concuity.apl_root_cause rc on rc.id = max_apl_seq.apl_root_cause_id left outer join Concuity.preset_value pv on pv.id = a.denial_category_id left outer join (select a.mon_account_id, a.mon_payer_id, count(*) as appeal_seq_cnt from Concuity.mon_appeal a inner join Concuity.mon_appeal_sequence ms on ms.mon_appeal_id = a.id inner join Concuity.mon_accounting_period ap on trunc(ap.start_date) = add_months(trunc(sysdate,'mm'),0) left join Concuity.apl_disposition ad on ad.id = ms.apl_disposition_id where not (trunc(nvl(a.date_created, to_date('01/01/1800', 'MM/DD/YYYY'))) = trunc(nvl(a.appeal_close_date, to_date('01/01/1800', 'MM/DD/YYYY'))) and ms.appeal_balance_amt = 0 and ms.appealed_amt = 0 and a.appeal_no = 1 and ms.sequence_no = 1) and not (a.appeal_no = 1 and ms.sequence_no = 1 and trunc(a.date_created, 'mm') = trunc(a.appeal_close_date, 'mm') and ad.code = 'IINND' and ms.Appeal_Balance_Amt = 0) and ad.code not in ('IINND', 'CBTHR') and (trunc(a.date_created) <= trunc(ap.end_date)) and (trunc(ms.date_created) <= trunc(ap.close_date) + 1) group by a.mon_account_id, a.mon_payer_id) tbl_seq_cnt on tbl_seq_cnt.mon_account_id = acctapl.mon_account_id and tbl_seq_cnt.mon_payer_id = acctapl.mon_payer_id left join (select mat.mon_account_id , coalesce(mat.mon_payer_id,pyr.mon_payer_id) as mon_payer_id , sum(case when tm.type = 'A' and pv2.display_text in ('Cash Adjustment', 'Contractual Allowance Adjustment') then td.category_amount else 0 end) as writeoff_amt , sum(case when tm.type = 'P' and pv2.display_text in ('Overturned Denial') then td.category_amount else 0 end) as overturned_amt , sum(case when tm.type = 'V' and tm.description like '%[COR]%' then mat.amount else 0 end) as corrections_amt , sum(case when tm.type = 'V' and tm.description like '%[XFR]%' then mat.amount else 0 end) as xfer_next_party_amt , sum(case when tm.type = 'A' and pv2.display_text = 'Cash Adjustment' then mat.amount else 0 end) as cash_adj_amt , sum(case when tm.type = 'A' and pv2.display_text = 'Contractual Allowance Adjustment' then mat.amount else 0 end) as contractual_allowance_amt from Concuity.mon_account_transaction mat inner join Concuity.mon_accounting_period ap on ap.start_date = add_months(trunc(sysdate,'mm'),0) and trunc(mat.date_created) between trunc(ap.start_date) and trunc(ap.close_date) + 1 and mat.mon_accounting_period_id = ap.id inner join Concuity.mon_transaction_master tm on tm.id = mat.mon_transaction_master_id left join Concuity.mon_account_transaction_dist td on td.mon_account_transaction_id = mat.id left join Concuity.preset_value pv2 on pv2.id = td.apl_transaction_category_id left join ( select distinct p.mon_account_id, p.mon_payer_id from Concuity.mon_account_payer p where p.rank < 51 ) pyr on pyr.mon_account_id = mat.mon_account_id and mat.mon_payer_id is null where tm.type in ('A', 'P', 'V') group by mat.mon_account_id, coalesce(mat.mon_payer_id,pyr.mon_payer_id) ) trans on trans.mon_account_id = acctapl.mon_account_id and trans.mon_payer_id = acctapl.mon_payer_id~100000"
]

tblist3: [
  "0~concuity.mon_account_activity~v_parallon_ra_stage_dataset_name.mon_acct_actvty_rcn_pass1~delete~Select SUBSTR (OG.CLIENT_ID, 7, 5) AS COID, TO_CHAR(MAA.CREATED_DATETIME,'YYYY-MM-DD') as CREATED_DATETIME, $SchemaID as Schema_id, count(*) as Cnt FROM Concuity.MON_ACCOUNT_ACTIVITY MAA Inner join Concuity.MON_ACCOUNT MA on MAA.MON_Account_ID=MA.ID Inner JOIN ( SELECT ORG.ORG_ID, $SchemaID as Schema_ID ,ORG.CUSTOMER_ORG_ID ,ORG.NAME ,ORG.ACCT_ID ,ORG.ORG_STATUS ,ORG.ORG_ROLE ,ORG.ORG_TYPE ,ORG.IS_CONTRACTOR ,ORG.IS_PUBLIC ,ORG.PASSWORD_THRESHOLD_DAYS ,ORG.PURCHASED_PRODUCTS ,ORG.MANUAL_ENTRY_FL ,ORG.CLIENT_ID ,ORG.COMMENTS ,ORG.DEGREE_ID ,ORG.IS_PRACTITIONER ,ORG.MARKET ,ORG.ORG_AFFILIATION ,ORG.PRACT_FIRST_NAME ,ORG.PRACT_LAST_NAME ,ORG.PRACT_MIDDLE_NAME ,ORG.PRACT_TITLE ,ORG.GENDER ,ORG.WEBSITE ,ORG.SHORT_NAME ,ORG.IS_REASSIGNABLE ,TO_DATE('$JobStartDateTime', 'YYYY-MM-DD HH24:MI:SS') as DW_Last_Update_Date FROM concuity.ORG JOIN HCA_REPORTING.GROUP_STACK_UNIT GSU ON GSU.ORG_ID = concuity.ORG.ORG_ID WHERE ORG.org_status = 'active' and ORG.org_type = 'HOSP') OG on MA.Org_Id_Provider = OG.ORG_ID where trunc(MAA.CREATED_DATETIME) <= trunc(current_date) -1 and trunc(MAA.CREATED_DATETIME) >= trunc(current_date) -30 and MA.MISC_CHAR06 <>'A' group by SUBSTR (OG.CLIENT_ID, 7, 5),TO_CHAR(MAA.CREATED_DATETIME,'YYYY-MM-DD') order by COID,CREATED_DATETIME~100000"
]

tblist4: [
  "0~concuity.mon_appeal~v_parallon_ra_stage_dataset_name.denial_eom_wrk1~delete~select $SchemaID as schema_id , acctapl.mon_account_id , acctapl.mon_payer_id , trunc(sysdate) as rpt_run_date , actp.start_date as rpt_start_date , actp.end_date as rpt_end_date , org.short_name as unit_num , to_number(ma.account_no) as pat_acct_num , to_number(trim(replace(pay.code, '-'))) as iplan_id , max_apl.payer_rank as iplan_insurance_order_num , a.external_code as external_code , ma.misc_char08 as patient_code , ma.financial_class as financial_class , map.misc_char01 as payer_finclass_code , coalesce(map.first_denial_date, mapl.lifecycle_date, min_apl.date_created) as min_denial_date , case when trunc(max_apl.appeal_close_date) > actp.end_date and trunc(max_apl.appeal_close_date) <= actp.close_date + 1 then 1 when d.code = 'OUNWO' then 7 when d.code = 'COTNL' then 8 when d.code = 'CUNL' then 9 when d.code = 'COTFL' then 10 when d.code = 'CBTHR' then 12 when d.code = 'IINND' then 13 when d.code = 'CUXNP' then 14 when d.code = 'CNOAP' then 15 when d.code = 'OWMR' then 16 when d.code = 'CNORP' then 17 when d.code = 'OXLGL' then 18 when d.code = 'OPPTP' then 20 when d.code = 'OSENT' then 21 when d.code = 'OBILL' then 23 when d.code = 'OCOND' then 24 when d.code = 'OARB' then 25 when d.code = 'OICRW' then 26 when d.code = 'OIWRW' then 27 when d.code = 'OMRPA' then 28 when d.code = 'OPMC' then 32 when d.code = 'OPMR' then 33 when d.code = 'ORBLD' then 34 when d.code = 'OSOPP' then 36 when d.code = 'OTFAP' then 37 when d.code = 'OTOVD' then 38 when d.code = 'CUFTA' then 42 when d.code = 'CSAPS' then 44 when d.code = 'OOTNL' then 47 when d.code = 'OSMAC' then 50 when d.code = 'OSQIC' then 51 when d.code = 'OSALJ' then 52 when d.code = 'OSDAB' then 53 when d.code = 'OSUSD' then 54 when d.code = 'COMAC' then 55 when d.code = 'COQIC' then 56 when d.code = 'COALJ' then 57 when d.code = 'CODAB' then 58 when d.code = 'COUSD' then 59 when d.code = 'CUMAC' then 65 when d.code = 'CUQIC' then 66 when d.code = 'CUALJ' then 67 when d.code = 'CUDAB' then 68 when d.code = 'CUUSD' then 69 when d.code = 'OWDR' then 71 when d.code = 'ODISR' then 72 when d.code = 'CDRT' then 73 when d.code = 'CUPTP' then 74 when d.code = 'CUIRO' then 75 when d.code = 'CUFRE' then 76 when d.code = 'CUFEX' then 77 when d.code = 'CUFSP' then 78 when d.code = 'CNAFS' then 79 when d.code = 'CUFSA' then 80 when d.code = 'CUFEA' then 81 when d.code = 'CUF' then 83 when d.code = 'CNAPP' then 85 when d.code = 'OCMS' then 86 when d.code = 'CCMS' then 87 when d.code = 'OICMR' then 88 when d.code = 'OIHIM' then 89 when d.code = 'ORPA' then 90 when d.code = 'OIFUP' then 91 when d.code = 'OCTFU' then 92 when d.code = 'ORCN' then 93 when d.code = 'OSIRF' then 94 when d.code = 'OSEFU' then 95 when d.code = 'CUFNP' then 100 when d.code = 'OEA' then 101 when d.code = 'OEM' then 102 when d.code = 'OER' then 103 when d.code = 'OEP' then 104 when d.code = 'OED' then 105 when d.code = 'OEG' then 106 when d.code = 'OES' then 107 when d.code = 'OEH' then 108 when d.code = 'OEU' then 109 when d.Code = 'ORNA' THEN 110 when d.code = 'OPPSU' then 111 when trim(d.code) is null then 7 else 0 end as Web_Denial_Disp_Code , nvl(tbl_seq_cnt.appeal_seq_cnt,1) as appeal_cnt , max_apl_seq.sequence_no as sequence_no , max_apl.appeal_no as appeal_no , max_apl_seq.date_created as Max_Seq_Create_Date , case when prior_apl.prior_appeal_flag = 1 then 1 when trunc(min_apl.date_created) between trunc(actp.start_date) and trunc(actp.end_date) then 0 when trunc(min_apl.date_created) > trunc(actp.end_date) and trunc(min_apl.appeal_close_date) <= trunc(actp.end_date) then 0 else 1 end as Existing_account , min_apl_first_seq.appeal_balance_amt_begin as min_appeal_bal_amt_beg , case when (trunc(min_apl.date_created) between trunc(actp.start_date) and trunc(actp.end_date)) or (trunc(min_apl.date_created) > trunc(actp.end_date) and trunc(min_apl.appeal_close_date) <= trunc(actp.end_date)) then min_apl_seq.APPEALED_AMT else 0 end as new_amt , case when prior_apl.prior_appeal_flag = 1 then 0 when trunc(min_apl.date_created) between actp.start_date and actp.end_date then 1 when trunc(min_apl.date_created) > actp.end_date and trunc(min_apl.appeal_close_date) <= actp.end_date then 1 else 0 end as new_account , case when nvl(max_apl.appeal_close_date, to_date('01/01/1800', 'mm/dd/yyyy')) > actp.end_date then null else max_apl.appeal_close_date end as Max_Appeal_Date_Closed , CAST (trunc(max_apl_seq.deadline_date)AS VARCHAR(100)) as deadline_date, case when rtrim(ltrim(d.code)) = 'IINND' then max_apl_seq.appeal_balance_amt_begin else 0 end as not_true_denial_amt , case when trunc(max_apl.appeal_close_date) is not null and trunc(max_apl.appeal_close_date) between actp.start_date and actp.end_date then 1 else 0 end as resolved_account , ma.total_charges as total_charges , trim(ma.attending_physician_name) as attending_phys_name , ma.attending_physician_id as attending_phys_id , nvl(ma.total_charges, 0) - nvl(mat_balance.tot_trxnamt, 0) as account_balance , ma.service_date_end as discharge_date , ma.misc_char01 as service_code , ma.medical_record_number as medical_rec_num , usr.login_id as login_id , max_apl.date_modified as appeal_date_modified , rc.code as root_cause_code , replace(replace(rc.description, chr(13)), chr(10)) as root_cause_description , pv.display_text as denial_code_category , case when (trunc(max_apl.appeal_close_date) is not null and (trunc(max_apl.appeal_close_date) > actp.end_date and trunc(max_apl.appeal_close_date) <= actp.close_date + 1)) then 'PEND' when trim(d.code) is null then 'OUNWO' else rtrim(ltrim(d.code)) end as disposition_code , a.code as appeal_code , a.description as appeal_description , case when rtrim(ltrim(d.code)) = 'IINND' then 0 else nvl(max_apl_seq.appeal_balance_amt, 0) end as max_appeal_bal_amt , nvl(trans.corrections_amt,0) as corrections_amt , nvl(trans.xfer_next_party_amt,0) as xfer_next_party_amt , nvl(trans.cash_adj_amt,0) as cash_adj_amt , nvl(trans.contractual_allowance_amt,0) as contractual_allowance_amt , nvl(trans.overturned_amt,0) as overturned_amt , nvl(trans.writeoff_amt,0) as writeoff_amt , sysdate as last_update_date_time , vnd.code as Vendor_cd from (select v.accounting_period_id , v.mon_account_id , v.mon_payer_id , max(case when v.appeal_no = v.max_appeal_no then v.appeal_id end) as max_apl_id , max(case when v.appeal_no = v.min_appeal_no then v.appeal_id end) as min_apl_id , max(case when v.appeal_no = v.max_appeal_no and v.sequence_no = v.max_appeal_seq_no then v.appeal_seq_id end) as max_appeal_seq_id , max(case when v.appeal_no = v.min_appeal_no and v.sequence_no = v.min_appeal_seq_no then v.appeal_seq_id end) as min_appeal_seq_id , max(v.max_appeal_close_date) as max_appeal_close_date from (select ap.id as accounting_period_id , apl.mon_account_id , apl.mon_payer_id , apl.appeal_no , apl.id as appeal_id , aplseq.sequence_no , aplseq.id as appeal_seq_id , max(apl.appeal_no) over (partition by apl.mon_account_id, apl.mon_payer_id) as max_appeal_no , min(apl.appeal_no) over (partition by apl.mon_account_id, apl.mon_payer_id) as min_appeal_no , max(aplseq.sequence_no) over (partition by apl.mon_account_id, apl.mon_payer_id, apl.appeal_no) as max_appeal_seq_no , min(aplseq.sequence_no) over (partition by apl.mon_account_id, apl.mon_payer_id, apl.appeal_no) as min_appeal_seq_no , max(apl.appeal_close_date) over (partition by apl.mon_account_id, apl.mon_payer_id) as max_appeal_close_date from Concuity.mon_appeal apl inner join Concuity.mon_accounting_period ap on trunc(ap.start_date) = add_months(trunc(sysdate,'mm'),-1) inner join Concuity.mon_appeal_sequence aplseq on aplseq.mon_appeal_id = apl.id inner join Concuity.mon_payer pay on apl.mon_payer_id = pay.id inner join Concuity.mon_account_payer map on map.mon_account_id = apl.mon_account_id and map.mon_payer_id = apl.mon_payer_id and map.rank = apl.payer_rank and map.rank < 51 where trim(pay.code) <> 'NO INS' and (((trunc(apl.appeal_close_date) is null or trunc(apl.appeal_close_date) > trunc(ap.end_date)) and trunc(apl.date_created) <= trunc(ap.end_date)) or (trunc(apl.appeal_close_date) between trunc(ap.start_date) and trunc(ap.end_date) and trunc(apl.date_created) <= trunc(ap.end_date))) and (((trunc(aplseq.sequence_close_date) is null or trunc(aplseq.sequence_close_date) > trunc(ap.end_date)) and trunc(aplseq.date_created) <= trunc(ap.close_date) + 1) or (trunc(aplseq.sequence_close_date) between trunc(ap.start_date) and trunc(ap.end_date) and trunc(aplseq.date_created) <= trunc(ap.close_date) + 1)) and apl.payer_rank < 51 and not ((trunc(nvl(apl.date_created, to_date('01/01/1800', 'MM/DD/YYYY'))) = trunc(nvl(apl.appeal_close_date, to_date('01/01/1800', 'MM/DD/YYYY'))) and apl.appeal_no = 1 and aplseq.sequence_no = 1 and aplseq.appealed_amt = 0 and aplseq.appeal_balance_amt = 0)) and not (apl.appeal_no = 1 and trunc(apl.date_created) >= trunc(ap.start_date) and trunc(apl.appeal_close_date) between trunc(ap.start_date) and trunc(ap.end_date) and trunc(apl.appeal_close_date) is not null and exists (select 1 from Concuity.mon_appeal_sequence s join Concuity.apl_disposition d on d.id = s.apl_disposition_id where s.mon_appeal_id = apl.id and s.sequence_no = 1 and d.code = 'IINND' and s.appeal_balance_amt = 0)) ) v group by v.accounting_period_id, v.mon_account_id, v.mon_payer_id) acctapl inner join Concuity.mon_accounting_period actp on actp.id = acctapl.accounting_period_id inner join Concuity.mon_payer pay on pay.id = acctapl.mon_payer_id and trim(pay.code) <> 'NO INS' inner join Concuity.mon_account ma on ma.id = acctapl.mon_account_id inner join Concuity.org org on ma.org_id_provider = org.org_id inner join hca_reporting.group_stack_unit gsu on org.org_id = gsu.org_id inner join Concuity.mon_appeal max_apl on max_apl.id = acctapl.max_apl_id inner join Concuity.mon_appeal_sequence max_apl_seq on max_apl_seq.id = acctapl.max_appeal_seq_id left join Concuity.vendor vnd on vnd.vendor_id = max_apl_seq.vendor_id inner join Concuity.mon_appeal min_apl on min_apl.id = acctapl.min_apl_id inner join Concuity.mon_appeal_sequence min_apl_seq on min_apl_seq.id = acctapl.min_appeal_seq_id inner join ( select mon_appeal_id, min(appeal_balance_amt_begin) as appeal_balance_amt_begin from Concuity.mon_appeal_sequence where sequence_no = 1 group by mon_appeal_id ) min_apl_first_seq on min_apl_first_seq.mon_appeal_id = acctapl.min_apl_id left join Concuity.apl_appeal a on a.id = max_apl_seq.apl_appeal_id left join Concuity.mon_account_payer map on map.mon_account_id = max_apl.mon_account_id and map.mon_payer_id = max_apl.mon_payer_id and map.rank = max_apl.payer_rank and map.rank < 51 left join ( select lc.mon_account_payer_id, min(lc.lifecycle_date) as lifecycle_date from Concuity.mon_account_payer_lifecycle lc where lc.lifecycle_event = 2666583 group by lc.mon_account_payer_id ) mapl on mapl.mon_account_payer_id = map.id left outer join Concuity.apl_disposition d on d.id = max_apl_seq.apl_disposition_id left outer join (select a.mon_account_id, a.mon_payer_id, 1 as prior_appeal_flag from Concuity.mon_appeal a inner join Concuity.mon_appeal_sequence ms on ms.mon_appeal_id = a.id left join Concuity.apl_disposition ad on ad.id = ms.apl_disposition_id where trunc(a.date_created) < add_months(trunc(sysdate,'mm'),-1) and not (trunc(nvl(a.date_created, to_date('01/01/1800', 'MM/DD/YYYY'))) = trunc(nvl(a.appeal_close_date, to_date('01/01/1800', 'MM/DD/YYYY'))) and ms.appeal_balance_amt = 0 and ms.appealed_amt = 0 and a.appeal_no = 1 and ms.sequence_no = 1) and not (a.appeal_no = 1 and ms.sequence_no = 1 and trunc(a.date_created, 'mm') = trunc(a.appeal_close_date, 'mm') and ad.code = 'IINND' and ms.Appeal_Balance_Amt = 0) group by a.mon_account_id, a.mon_payer_id) prior_apl on prior_apl.mon_account_id = acctapl.mon_account_id and prior_apl.mon_payer_id = acctapl.mon_payer_id left outer join (select sum(nvl(matbal.amount, 0)) as tot_trxnamt, matbal.mon_account_id from Concuity.mon_account_transaction matbal inner join Concuity.mon_transaction_master tm on matbal.mon_transaction_master_id = tm.id where tm.type in ('A', 'P') group by matbal.mon_account_id) mat_balance on mat_balance.mon_account_id = acctapl.mon_account_id left outer join Concuity.users usr on usr.user_id = max_apl.user_id_modified_by left outer join Concuity.apl_root_cause rc on rc.id = max_apl_seq.apl_root_cause_id left outer join Concuity.preset_value pv on pv.id = a.denial_category_id left outer join (select a.mon_account_id, a.mon_payer_id, count(*) as appeal_seq_cnt from Concuity.mon_appeal a inner join Concuity.mon_appeal_sequence ms on ms.mon_appeal_id = a.id inner join Concuity.mon_accounting_period ap on trunc(ap.start_date) = add_months(trunc(sysdate,'mm'),-1) left join Concuity.apl_disposition ad on ad.id = ms.apl_disposition_id where not (trunc(nvl(a.date_created, to_date('01/01/1800', 'MM/DD/YYYY'))) = trunc(nvl(a.appeal_close_date, to_date('01/01/1800', 'MM/DD/YYYY'))) and ms.appeal_balance_amt = 0 and ms.appealed_amt = 0 and a.appeal_no = 1 and ms.sequence_no = 1) and not (a.appeal_no = 1 and ms.sequence_no = 1 and trunc(a.date_created, 'mm') = trunc(a.appeal_close_date, 'mm') and ad.code = 'IINND' and ms.Appeal_Balance_Amt = 0) and ad.code not in ('IINND', 'CBTHR') and (trunc(a.date_created) <= trunc(ap.end_date)) and (trunc(ms.date_created) <= trunc(ap.close_date) + 1) group by a.mon_account_id, a.mon_payer_id) tbl_seq_cnt on tbl_seq_cnt.mon_account_id = acctapl.mon_account_id and tbl_seq_cnt.mon_payer_id = acctapl.mon_payer_id left join (select mat.mon_account_id , coalesce(mat.mon_payer_id,pyr.mon_payer_id) as mon_payer_id , sum(case when tm.type = 'A' and pv2.display_text in ('Cash Adjustment', 'Contractual Allowance Adjustment') then td.category_amount else 0 end) as writeoff_amt , sum(case when tm.type = 'P' and pv2.display_text in ('Overturned Denial') then td.category_amount else 0 end) as overturned_amt , sum(case when tm.type = 'V' and tm.description like '%[COR]%' then mat.amount else 0 end) as corrections_amt , sum(case when tm.type = 'V' and tm.description like '%[XFR]%' then mat.amount else 0 end) as xfer_next_party_amt , sum(case when tm.type = 'A' and pv2.display_text = 'Cash Adjustment' then mat.amount else 0 end) as cash_adj_amt , sum(case when tm.type = 'A' and pv2.display_text = 'Contractual Allowance Adjustment' then mat.amount else 0 end) as contractual_allowance_amt from Concuity.mon_account_transaction mat inner join Concuity.mon_accounting_period ap on ap.start_date = add_months(trunc(sysdate,'mm'),-1) and trunc(mat.date_created) between trunc(ap.start_date) and trunc(ap.close_date) + 1 and mat.mon_accounting_period_id = ap.id inner join Concuity.mon_transaction_master tm on tm.id = mat.mon_transaction_master_id left join Concuity.mon_account_transaction_dist td on td.mon_account_transaction_id = mat.id left join Concuity.preset_value pv2 on pv2.id = td.apl_transaction_category_id left join ( select distinct p.mon_account_id, p.mon_payer_id from Concuity.mon_account_payer p where p.rank < 51 ) pyr on pyr.mon_account_id = mat.mon_account_id and mat.mon_payer_id is null where tm.type in ('A', 'P', 'V') group by mat.mon_account_id, coalesce(mat.mon_payer_id,pyr.mon_payer_id) ) trans on trans.mon_account_id = acctapl.mon_account_id and trans.mon_payer_id = acctapl.mon_payer_id~100000"
]

tblist5: [
"0~concuity.mon_account_payer~v_parallon_ra_stage_dataset_name.cc_eom~delete~WITH MAT AS (SELECT   /*+parallel(8)*/ MAT.MON_ACCOUNT_ID, SUM(CASE WHEN MTM.TYPE = 'P' THEN MAT.AMOUNT ELSE 0 END) AS TOTAL_PAYMENTS,SUM(CASE WHEN MTM.TYPE = 'A' AND (MAT.COMMENTS LIKE 'TYPE 5%' OR MTM.Description LIKE '5%') THEN MAT.AMOUNT ELSE 0 END) AS TOTAL_CONTRACT_ALLOW_AMT,SUM(CASE WHEN MTM.TYPE = 'A' AND (MAT.COMMENTS NOT LIKE 'TYPE 5%' AND MTM.Description NOT LIKE '5%') THEN MAT.AMOUNT ELSE 0 END) AS TOTAL_ADJUSTMENT_AMT FROM CONCUITY.MON_ACCOUNT_TRANSACTION MAT INNER JOIN CONCUITY.MON_TRANSACTION_MASTER MTM ON MAT.MON_TRANSACTION_MASTER_ID = MTM.ID WHERE MTM.TYPE IN ('A','P') AND MAT.EFFECTIVE_DATE < TRUNC(SYSDATE, 'MM') AND TRUNC(MAT.TRANSACTION_DATE)< TRUNC(SYSDATE, 'MM')+4 AND TRUNC(MAT.DATE_CREATED)<=TRUNC(SYSDATE, 'MM')+4 GROUP BY MAT.MON_ACCOUNT_ID) SELECT /*+parallel(8)*/ $SchemaID AS Schema_ID,CAST(MA.ID AS DECIMAL(18)) AS ACCOUNT_ID, SUBSTR(ORG.CLIENT_ID,7,5) AS COID,ORG.SHORT_NAME AS UNIT_NUM,CAST(TO_CHAR(ADD_MONTHS(TRUNC(SYSDATE),-1),'YYYYMM') AS CHAR(6)) AS RPTG_PERIOD,CAST(MA.ACCOUNT_NO AS DECIMAL(12)) AS PAT_ACCT_NUM,MA.SERVICE_DATE_BEGIN AS ADMISSION_DATE,MA.SERVICE_DATE_END AS DISCHARGE_DATE,MA.MISC_DATE01 AS FINAL_BILL_DATE,MA.MISC_DATE02 AS AR_BILL_THRU_DATE,MA.BILLING_STATUS AS BILLING_STATUS_CODE,CAST(CASE WHEN MA.FINANCIAL_CLASS IS NULL THEN '99' WHEN MA.FINANCIAL_CLASS = 0 THEN '99' ELSE MA.FINANCIAL_CLASS END AS DECIMAL(3)) AS FINANCIAL_CLASS_CODE,MPT.CODE AS PATIENT_TYPE_CODE,MA.MISC_CHAR02 AS ACCOUNT_STATUS_CODE,NVL(SUM(MACD.AMOUNT),0) AS TOTAL_BILLED_CHARGES_AMT,NVL(MAT.TOTAL_CONTRACT_ALLOW_AMT,0) AS TOTAL_CONTRACT_ALLOW_AMT,NVL(MAT.TOTAL_ADJUSTMENT_AMT,0) AS TOTAL_ADJUSTMENT_AMT,NVL(MAT.TOTAL_PAYMENTS,0) AS TOTAL_PAYMENT_AMT,NVL(SUM(MACD.AMOUNT),0)-(NVL(MAT.TOTAL_PAYMENTS,0)+NVL(MAT.TOTAL_CONTRACT_ALLOW_AMT,0)+NVL(MAT.TOTAL_ADJUSTMENT_AMT,0)) AS TOTAL_ACCOUNT_BALANCE_AMT,CURRENT_DATE AS DW_LAST_UPDATE_DATE_TIME,'N' AS SOURCE_SYSTEM_CODE FROM CONCUITY.MON_ACCOUNT MA JOIN CONCUITY.ORG ON ORG.ORG_ID = MA.ORG_ID_PROVIDER JOIN HCA_REPORTING.GROUP_STACK_UNIT GSU ON GSU.UNIT_NUM = CAST(ORG.SHORT_NAME AS INT) AND ORG.ORG_STATUS = 'active' AND ORG.org_type IN ('HOSP','HOSPA','HHEAL') JOIN CONCUITY.MON_PATIENT_TYPE MPT ON MA.MON_PATIENT_TYPE_ID = MPT.ID LEFT JOIN MAT ON MA.id = MAT.MON_ACCOUNT_ID left join CONCUITY.MON_ACCOUNT_CHARGE_DETAIL MACD ON MA.id = MACD.MON_ACCOUNT_ID and MACD.Service_DATE < TRUNC(SYSDATE, 'MM') AND MACD.Is_System_Reversal = 0 WHERE MA.MISC_CHAR02 <> 'BD' AND MA.IS_ARCHIVED = 0  group by MA.ID, SUBSTR(ORG.CLIENT_ID,7,5), ORG.SHORT_NAME, MA.ACCOUNT_NO,MA.SERVICE_DATE_BEGIN ,MA.SERVICE_DATE_END ,MA.MISC_DATE01 ,MA.MISC_DATE02 , MA.BILLING_STATUS ,CASE WHEN MA.FINANCIAL_CLASS IS NULL THEN '99' WHEN MA.FINANCIAL_CLASS = 0 THEN '99' ELSE MA.FINANCIAL_CLASS END, MPT.CODE , MA.MISC_CHAR02 , NVL(MAT.TOTAL_CONTRACT_ALLOW_AMT,0) , NVL(MAT.TOTAL_ADJUSTMENT_AMT,0) ,NVL(MAT.TOTAL_PAYMENTS,0)~100000"
]

tblist6: [
"0~concuity.mon_accounting_cost_period~v_parallon_ra_stage_dataset_name.gl_report_year_temp~delete~SELECT $SchemaID AS SCHEMA_ID, ME.SSC_NAME, SUBSTR(ME.CLIENT_ID, 7, 5) AS COID, ME.SHORT_NAME AS UNIT_NUM, ME.NAME AS FACILITY_NAME, MACP.COST_REPORT_ORG_ID AS ORG_ID, MACP.COST_REPORT_YEAR AS COST_EXPORT_YEAR, MIN (MAP.START_DATE) AS RPT_YR_START_DATE, MAX (MAP.END_DATE) AS RPT_YR_END_DATE, CURRENT_DATE AS DW_LAST_UPDATE_DATE FROM CONCUITY.MON_ACCOUNTING_COST_PERIOD MACP INNER JOIN HCA_REPORTING.GSU_ME_ORG ME ON ME.ORG_ID = MACP.COST_REPORT_ORG_ID INNER JOIN CONCUITY.MON_ACCOUNTING_PERIOD Map ON MACP.MON_ACCOUNTING_PERIOD_ID = MAP.ID GROUP BY ME.SSC_NAME, ME.CLIENT_ID, ME.SHORT_NAME, ME.NAME, MACP.COST_REPORT_ORG_ID, MACP.COST_REPORT_YEAR HAVING MAX ( CASE WHEN TRUNC(LAST_DAY(ADD_MONTHS(SYSDATE, -1))) BETWEEN MAP.START_DATE AND MAP.END_DATE THEN 1 ELSE 0 END) = 1~100000"
]

schedule:
  - v_schedule_interval: 0 7 * * 0
    start_date: pendulum.datetime(2022, 12, 20, tz=timezone)
    frequency: weekly
    src_instance: ['p1','p2']
    tblist: [tblist1]
    has_sensor: "Yes"
    done_files: None
    sensor:
    - dag_id: dag_ingest_ra_p1_oracle_daily_04.20
      task_id: end_dag
      schedule: 20 4 * * *
    - dag_id: dag_ingest_ra_p2_oracle_daily_04.20
      task_id: end_dag
      schedule: 20 4 * * *
    truncate: True
  
  - v_schedule_interval: 0 21 12-31 * 0
    start_date: pendulum.datetime(2022, 12, 20, tz=timezone)
    frequency: weekly
    src_instance: ['p1','p2']
    tblist: [tblist2]
    has_sensor: "No"
    done_files: None
    truncate: True

  - v_schedule_interval: 0 12 * * 0
    start_date: pendulum.datetime(2022, 12, 20, tz=timezone)
    frequency: weekly
    src_instance: ['p1','p2']
    tblist: [tblist3]
    has_sensor: "Yes"
    done_files: None
    sensor:
    - dag_id: dag_ingest_ra_p1_oracle_daily_03.30
      task_id: end_dag
      schedule: 30 3 * * *
    - dag_id: dag_ingest_ra_p2_oracle_daily_03.30
      task_id: end_dag
      schedule: 30 3 * * *
    truncate: True

  - v_schedule_interval: 15 8 5 * *           #updated schedule to 8:15 AM CST
    start_date: pendulum.datetime(2022, 12, 20, tz=timezone)
    frequency: monthly
    src_instance: ['p1','p2']
    tblist: [tblist4]
    has_sensor: "No"
    done_files: [oracle_core_load_YYYYMMDD.done]
    truncate: True

  - v_schedule_interval: 15 4 5 * *
    start_date: pendulum.datetime(2022, 12, 20, tz=timezone)
    frequency: monthly
    src_instance: ['p1','p2']
    tblist: [tblist5]
    has_sensor: "No"
    done_files: [oracle_core_load_YYYYMMDD.done]
    truncate: True

  - v_schedule_interval: 0 9 6 * *  #CTMN0023 Step 10 & 20
    start_date: pendulum.datetime(2025, 1, 20, tz=timezone)
    frequency: monthly
    src_instance: ['p1','p2']
    tblist: [tblist6]
    has_sensor: "No"
    done_files: None
    truncate: True
    trigger_dag_ids: []