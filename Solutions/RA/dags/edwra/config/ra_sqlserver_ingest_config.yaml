v_sourcesysnm: ra
v_databasetype: sqlserver
v_user: DMX_CR_User
v_pwd_secret_name: sql_web_tools_pwd/versions/latest
v_jdbc_class_name: com.microsoft.sqlserver.jdbc.SQLServerDriver
v_jdbc_jar: mssql-jdbc-12.4.0.jre8.jar
v_jdkfile: jre-8u351-linux-x64.tar.gz
v_jdkversion: jre1.8.0_351
v_jdbcbqpytemplate: Jdbc_to_BigQuery_PythonTemplate_ra.py
v_machine_type: n1-standard-2

#srctablelist srctableid~srctablename~tgttablename~tgttableloadtype~primarykeys~srctablequery~rowcommitsize

tblist1: [
  "1~rcomcreditrefund.dbo.tblheader~v_parallon_ra_stage_dataset_name.cr_balance_refund_header~append~~select coalesce(headerid,0) as id,unitnum as unit_num,cast(patnum as decimal(18)) as pat_acct_num,totaccountbal as total_acct_bal_amt,totcharge as total_charge_amt,totcashpay as total_cash_pay_amt,totallow as total_allow_amt,totpolicyadj as total_policy_adj_amt,totwriteoff as total_write_off_amt,coalesce(finclass,0) as financial_class,case when finclass in (1,2,3,6) then 'Government' else 'Managed Care' end as payor_category_name,ins1aa1plan as ins_1_aa_iplan,ins2aa1plan as ins_2_aa_iplan,ins3aa1plan as ins_3_aa_iplan,acctstatus as acct_status, aa6admitdate as aa6_admit_date,aa7dischdate as aa7_disch_date,adrname as addr_name,adraddr1 as addr_1,adraddr2 as addr_2,adrcitystate as addr_city_state,adrstate as addr_state,rtrim(adrzip) as addr_zip,adrcountry as addr_country, refundtype as refund_type,case when refundtype = 1 then 'Primary Insurance Refund' when refundtype = 2 then 'Secondary/Tertiary Refund' when refundtype = 3 then 'Patient Refund' end as refund_type_desc,refundamount as refund_amt,refundreason as refund_reason,memberid as member_id,refundinsiplan as refund_iplan,datelastactivity as last_activity_date,refname as ref_name,refaddr1 as ref_addr_1,refaddr2 as ref_addr_2,refcity as ref_city,refstate as ref_state,refzip as ref_zip,refcountry as ref_country,lastupdate as last_update_date_time,lastupdateby as last_update_user,rtrim(cast(refspecial as char(6))) as ref_special,refproccode as ref_proc_code,refglacct as ref_gl_acct,case when logged = '1' then 'Y' else 'N' end as logged_ind,entereddate as entered_date,status,dtmapproved as approved_date_time,approvedby as approved_by_user,NULL as transmitted_date,rtrim(patienttype) as patient_type,billthroughdate as bill_through_date,autorefundcreateddate as auto_refund_create_date,curgrvamt as current_grv_amt, dtfinalbilled as final_billed_date,case when blnEligibleTransfer = '1' then 'Y' else 'N' end as eligible_transfer_ind,case when blnlatecharge = '1' then 'Y' else 'N' end as late_charge_ind, dtrefundcreated as refund_create_date,strrefundcreateduser as refund_create_user,restoredate as restore_date,rtrim(restoreindicator) as restore_ind, getdate() as extract_date,createddate as credit_bal_date_established from rcomcreditrefund.dbo.tblheader a where totaccountbal < 0~100000",
  "2~rcomcreditrefund.dbo.tbltransmittedheaders~v_parallon_ra_stage_dataset_name.cr_refund_transmitted~merge~id~select coalesce(headerid,0) as id,unitnum as unit_num,cast(patnum as decimal(12)) as pat_acct_num,totaccountbal as total_acct_bal_amt,totcharge as total_charge_amt,totcashpay as total_cash_pay_amt,totallow as total_allow_amt,totpolicyadj as total_policy_adj_amt,totwriteoff as total_write_off_amt,coalesce(finclass,0) as financial_class,ins1aa1plan as ins_1_aa_iplan,ins2aa1plan as ins_2_aa_iplan,ins3aa1plan as ins_3_aa_iplan,acctstatus as acct_status, aa6admitdate as aa6_admit_date, aa7dischdate as aa7_disch_date,adrname as addr_name,adraddr1 as addr_1,adraddr2 as addr_2,adrcitystate as addr_city_state,adrstate as addr_state,rtrim(adrzip) as addr_zip,adrcountry as addr_country,coalesce(refundtype,0) as refund_type,case when refundtype = 1 then 'Primary Insurance Refund' when refundtype = 2 then 'Secondary/Tertiary Refund' when refundtype = 3 then 'Patient Refund' end as refund_type_desc,refundamount as refund_amt,refundreason as refund_reason,memberid as member_id,refundinsiplan as refund_iplan,datelastactivity as last_activity_date,refname as ref_name,refaddr1 as ref_addr_1,refaddr2 as ref_addr_2,refcity as ref_city,refstate as ref_state,refzip as ref_zip,refcountry as ref_country,lastupdate as last_update_date_time,lastupdateby as last_update_user,case when refspecial = 0 then 'N' else 'Y' end as ref_special,refproccode as ref_proc_code,refglacct as ref_gl_acct,case when Logged = 0 then 'N' else 'Y' end as logged_ind,entereddate as entered_date,status,dtmapproved as approved_date_time,approvedby as approved_by_user,transmitteddate as transmitted_date,rtrim(patienttype) as patient_type,billthroughdate as bill_through_date,totplines as total_plines,autorefundcreateddate as auto_refund_create_date,curgrvamt as current_grv_amt,dtfinalbilled as final_billed_date,case when blneligibletransfer = 0 then 'N' else 'Y' end as eligible_transfer_ind,case when blnlatecharge = 0 then 'N' else 'Y' end as late_charge_ind,dtrefundcreated as refund_create_date,strrefundcreateduser as refund_create_user,restoredate as restore_date,rtrim(restoreindicator) as restore_ind,case when finclass in (1,2,3,6) then 'Government' else 'Managed Care' end as payor_category_name,getdate() as extract_date from rcomcreditrefund.dbo.tbltransmittedheaders where refundtype in (1,2,3)~100000" 
 ]
tblist2: [
  "3~rebilllog.dbo.vwAllOpenCRT~v_parallon_ra_stage_dataset_name.crt_open_gov_overpayment~merge~log_id~SELECT lngLogID as log_id, strUnitID as unit_num ,strCoID as coid ,strRequestTypeDesc as request_type_desc ,datRequestDate as request_date ,case when ltrim(rtrim(substring(strAccount,1,1))) in ('H','D') then ltrim(rtrim(substring(strAccount,2,50))) else strAccount end as account_no ,strFinancialClass as fin_class ,datDateLastActivity as last_activity_date, strStatusDesc as status_desc, datDiscDate as disc_date, strDiscSourceDesc as discsourcedesc, strReimbursementImpact as reimbursementimpact, strReprReasons as reprreasons, strQueueName as queuename, getdate() as extract_date FROM rebillLog.dbo.vwAllOpenCRT~100000"
 ]

tblist3: [
  "4~PayerAnalysisTrendHub.dbo.Issue_IssueInformation~v_parallon_ra_stage_dataset_name.path_issue~append~~Select distinct 0 as schema_id, A.Issue_IssueInformation_ID as issue_issueinformation_id, A.IssueID as issueid, rtrim(A.IssueSummary) as issuesummary, rtrim(A.IssueDetail) as issuedetail, A.OperationalGuidance as operationalguidance, A.CreatedBy as createdby, cast(A.CreatedDate as Datetime) as createddate, A.LastModifiedBy as lastmodifiedby, cast(A.LastModifiedDate as Datetime) as lastmodifieddate, CURRENT_TIMESTAMP as extract_date FROM PayerAnalysisTrendHub.dbo.Issue_IssueInformation A JOIN  PayerAnalysisTrendHub..Issue_Status B ON  A.IssueID = B.IssueID WHERE B.StatusID = 4~100000" 
]

tblist4: [
  "5~rcomDenials.dbo.appAppeal~v_parallon_ra_stage_dataset_name.legacy_daily_denials~append~~select 0 as schema_id ,cast(facility.Coid + substring(mainApp.PatNum,6,15) + cast(mainApp.Iplan as varchar(20)) + cast(mainApp.insOrder as varchar(20)) as varchar(200)) as mon_account_payer_id ,0 as pass_type ,facility.coid ,mainApp.PatNum as account_no ,111111111 as ssc_id ,NULL as rate_schedule_name ,NULL as ssc_name ,facility.HospName as facility_name ,facility.unitNum as unit_num ,NULL as rate_schedule_eff_begin_date ,NULL as rate_schedule_eff_end_date ,mainDen.PatName as Patient_Name ,replace(convert(varchar, mainDen.AdrBirthDate, 111), '/','-') as patient_dob ,mainApp.Iplan as iplan_id ,rtrim(mainIns.GroupName) as insurance_provider_name 	 ,case when len(mainIns.IPlan)<5 then substring(RIGHT('00000'+mainIns.IPlan,5),1,3)+'-'+substring(RIGHT('00000'+mainIns.IPlan,5),4,2)+'-'+mainIns.InsName else substring(mainIns.IPlan,1,3)+'-'+substring(mainIns.IPlan,4,2)+'-'+mainIns.InsName end as payer_group_name ,nullif(mainIns.InsName, '') as billing_name ,nullif(appIPln.Contact,'') as billing_contact_person ,NULL as authorization_code ,rtrim(mainIns.PolicyNo) as payer_patient_id ,mainApp.insOrder as payer_rank ,COALESCE(ins.PA_FinClass,appi.FinClass) AS pa_financial_class ,appi.FinClass AS payor_financial_class ,NULL as accounting_period ,mainIns.GroupNo as major_payer_grp ,NULL as reason_code ,NULL as billing_status ,mainDen.ServiceCode as pa_service_code ,mainDen.AccountStatus as pa_account_status ,NULL as cc_patient_type ,patStatus.PatStatus as pa_discharge_status ,mainDen.PatType as pa_patient_type ,NULL as cancel_bill_ind ,NULL as admit_source ,NULL as admit_type ,mainDen.Drg as pa_drg ,cast(mainDen.AttnDrNo as char) as attending_physician_id ,mainDen.AttnDrFullName as attending_physician_name ,cast(mainDen.AdmitDate as Date) as service_date_begin ,cast(mainDen.DischDate as Date) as discharge_date ,NULL as comparison_method ,VEN.PAVendor as project_name ,NULL as work_queue_name ,NULL as status_category_desc ,NULL as status_desc ,NULL as status_phase_desc ,NULL as calc_date ,coalesce(mainDen.TotCharge,0) as total_charges ,coalesce(mainDen.PatLos,0) as pa_actual_los ,0 as total_billed_charges ,cast(mainDen.TotCharge as decimal(18,2)) - cast(mainDen.INS1AmtPymtRcvd as decimal(18,2)) as covered_charges ,0 as total_expected_payment ,0 as total_expected_adjustment ,coalesce(mainDen.PatAmtEstLiab,0) as total_pt_responsibility_actual ,0 as total_variance_adjustment ,Case mainApp.insOrder when 1 then coalesce(mainDen.INS1AmtPymtRcvd,0) when 2 then coalesce(mainDen.INS2AmtPymtRcvd,0) when 3 then coalesce(mainDen.INS3AmtPymtRcvd,0) else 0 end as total_payments ,coalesce(minAppeals.minAppealAmount,0) as total_denial_amt ,Case mainApp.insOrder when 1 then coalesce(mainDen.INS1AmtBalDue,0) when 2 then coalesce(mainDen.INS2AmtBalDue,0) when 3 then coalesce(mainDen.INS3AmtBalDue,0) else 0 end as payor_due_amt ,coalesce(mainDen.AccountBal,0) as pa_total_account_bal ,coalesce(mainDen.AccountBal,0) as ar_amount ,coalesce(accAppeals.accOverturnedAmtCollected,0) as otd_to_date_amount ,coalesce(accAppeals.accOverturnedAmtCollected,0) as otd_amt ,coalesce(accAppeals.accWriteoffAmount,0) as writeoff_amt ,coalesce(accAppeals.accWriteoffAmount,0) as cash_adj_amt ,coalesce(accAppeals.accOverturnedAmtCollected,0) as otd_to_date_amt, coalesce(accAppeals.accOverturnedAmtCollected,0) - coalesce(accAppealsMTD.accOverturnedAmtCollectedMTD,0) as otd_to_date_amt_mtd ,coalesce(accAppeals.accWriteoffAmount,0) - coalesce(accAppealsMTD.accWriteoffAmountMTD,0) as writeoff_amt_mtd ,coalesce(accAppeals.accWriteoffAmount,0) - coalesce(accAppealsMTD.accWriteoffAmountMTD,0) as cash_adj_amt_mtd ,maxAppeals.maxAppealLevel as appeal_level  ,CASE WHEN newAppeal.PatNum is null THEN 1 ELSE CASE WHEN newAppeal.AppealClosingDate <> '1900-01-01' THEN 1 ELSE CASE WHEN mainApp.Iplan <> newAppeal.IPlan then 1 ELSE 0 END END END	AS new_appeal_flag ,maxAppeals.maxAppealLevel as max_aplno ,maxAppeals.maxAppealLevel as max_seqno ,coalesce(mainAppLvl1.AppealAmount,0) as appeal_orig_amt ,coalesce(mainApp.AppealAmount,0) as current_appealed_amt ,coalesce(mainApp.AppealAmount,0) as current_appeal_balance ,cast(maxAppeals.AppealLevelOrigination as Date) as appeal_date_created ,cast(maxAppeals.AppealLevelOrigination as Date) as sequence_date_created ,cast(mainApp.AppealClosingDate as Date) as close_date ,cast(maxAppeals.maxDeadlineDate as Date) as max_seq_deadline_date ,NULL as sequence_creator ,mainApp.AssignedTo as appeal_owner ,NULL as appeal_modifier ,cast(Disp.DispCode as char) as disp_code ,Disp.DispDescription as disp_desc ,mainApp.Disposition as web_disp_code ,disp.DispType as web_disposition_type ,refRC.strRootCauseCode as root_code ,refRC.strRootCauseDesc as root_cause_description ,NULLIF(mainApp.RootCauseDetail,'') as root_cause_dtl ,nullif(mainApp.DenialCode, '') as external_appeal_code ,mainApp.DenialCode as apl_appeal_code ,NULLIF(replace(dcode.DenialCodeDesc,'&nbsp',''),'') as apl_appeal_desc ,cast(appIns.AppealOrigination as Date) as first_denial_date ,datediff(dd,minAppeals.minAppealLevelOrigination,getdate()) as denial_age ,cast(appDen.LastUpdateDate as Date) as pa_denial_update_date ,cast(NotesLine.FirstActivityDate as Date) as first_activity_create_date ,cast(NotesLine.LastDateEntered as Date) as last_activity_completion_date ,datediff(dd,NotesLine.LastDateEntered,getdate()) as last_activity_completion_age ,datediff(dd,NotesLine.LastDateEntered,getdate()) as last_user_activity_create_age ,NULL as last_reason_change_date ,NULL as last_status_change_date ,NULL as last_project_change_date ,NULL as last_owner_change_date ,cast(mainApp.WorkAgain as Date) as activity_due_date ,snLines.Comment as activity_desc ,NULL as activity_subject ,snLines.RACFID as activity_owner ,NULL as appeal_sent_activity_ownr ,cast(MaxAppealInit as Date) as appeal_initiation_date ,case when mainApp.Appeallevel = maxAppeals.maxAppealLevel then case when mainApp.Disposition <> '13' then case when cast(mainapp.Appealinitiated as date) <> cast(mainapp.AppealLevelOrigination as date) then cast(mainapp.Appealinitiated as Date) when (cast(mainapp.Appealinitiated as date) = cast(mainapp.AppealLevelOrigination as date) and snLines.Comment = 'Expedited appeal letter and medical record shipped' and snLines.RACFID = 'AAssist') then cast(mainapp.Appealinitiated as Date) else NULL END else NULL END else NULL END as appeal_sent_activity_date ,datediff(dd,case when mainApp.Appeallevel = maxAppeals.maxAppealLevel then case when mainApp.Disposition <> '13' then case when cast(mainapp.Appealinitiated as date) <> cast(mainapp.AppealLevelOrigination as date) then mainapp.Appealinitiated when (cast(mainapp.Appealinitiated as date) = cast(mainapp.AppealLevelOrigination as date) and snLines.Comment = 'Expedited appeal letter and medical record shipped' and snLines.RACFID = 'AAssist') then mainapp.Appealinitiated else NULL END else NULL END else NULL END, getdate()) as appeal_sent_activity_age ,NULL as last_status_change_age ,datediff(dd,mainApp.WorkAgain, getdate()) as activity_due_date_age ,datediff(dd,maxAppeals.AppealLevelOrigination, getdate()) as latest_seq_creation_date_age ,datediff(dd,getdate(),maxAppeals.maxDeadlineDate) as appeal_deadline_days_remaining ,NULL as appeal_sent_activity_subj ,NULL as appeal_sent_activity_desc ,NULL as stratification ,NULL as status_kpi ,NULL as followup_kpi ,NULL as appealsent_kpi ,NULL as deadline_kpi ,getdate() as extract_date ,CASE WHEN mainIns.FinClass IN (1, 2, 3, 6) THEN 'Government' ELSE 'Managed Care' END AS payer_category ,'L' as source_system_code ,mainApp.Appeallevel as seq_no ,getdate() as dw_last_update_date ,COUNT (1) OVER () as row_count ,NULL as expeted_amt from ( select appi.UnitNum, appi.PatNum, appi.Iplan,appi.insOrder, appi.appealclosingdate,appi.Appeallevel, appi.AppealDeadline, appi.nextAction, appi.Appealinitiated, appi.AssignedTo, appi.AppealAmount, appi.WorkAgain, appi.RootCauseDetail, appi.DeniedCharges, appi.AppealLevelOrigination, appi.Disposition, appi.intRootCauseID, appi.OverturnedCharges, appi.OverturnedAmtCollected, appi.DenialCode,appi.PAVendorID, appi.WriteOffAmount From ( select appi.UnitNum, appi.PatNum, appi.Iplan,appi.insOrder, appi.appealclosingdate,appi.Appeallevel, appi.AppealDeadline, appi.nextAction, appi.Appealinitiated, appi.AssignedTo, appi.AppealAmount, appi.WorkAgain, appi.RootCauseDetail, appi.DeniedCharges, appi.AppealLevelOrigination, appi.Disposition, appi.intRootCauseID, appi.OverturnedCharges, appi.OverturnedAmtCollected, appi.DenialCode,appi.PAVendorID, appi.WriteOffAmount, ROW_NUMBER() OVER( PARTITION BY UnitNum ,PatNum ,Iplan,InsOrder ORDER BY AppealLevelOrigination DESC) AS Row from rcomDenials.dbo.appAppeal appi Where appi.appealclosingdate IS NULL ) appi Where appi.Row = 1 ) mainApp JOIN rcomDenials.dbo.tblFacility facility on facility.unitnum = mainApp.UnitNum LEFT JOIN (select x.UnitNum, x.PatNum, x.Iplan, x.insOrder, x.Appealinitiated as MaxAppealInit, x.AppealID as maxApplId,x.AppealLevelOrigination as AppealLevelOrigination, x.AppealDeadline as maxDeadlineDate, x.Appeallevel as maxAppealLevel,x.Disposition as Disposition from rcomDenials.dbo.appAppeal x inner join (select UnitNum, PatNum, insOrder, max(AppealLevelOrigination)as AppealLevelOrigination,max(Appeallevel) as MaxAppeallevel from rcomDenials.dbo.appAppeal where appealclosingdate IS NULL group by UnitNum, PatNum, insOrder ) y on  x.UnitNum = y.UnitNum and x.PatNum = y.PatNum and x.insOrder = y.insOrder and x.AppealLevelOrigination = y.AppealLevelOrigination and x.Appeallevel=y.MaxAppeallevel ) maxAppeals on mainApp.UnitNum = maxAppeals.UnitNum and mainApp.PatNum = maxAppeals.PatNum and mainApp.IPlan = maxAppeals.Iplan and mainApp.InsOrder = maxAppeals.InsOrder LEFT JOIN (select x.UnitNum, x.PatNum, x.Iplan, x.insOrder,x.Appealinitiated as minAppealInit, x.AppealID as minApplId, x.AppealDeadline as minDeadlineDate, x.Appeallevel as minAppealLevel, x.AppealClosingDate as minCloseDate, x.AppealLevelOrigination as minAppealLevelOrigination, x.AppealAmount as minAppealAmount from rcomDenials.dbo.appAppeal x inner join (select UnitNum, PatNum, insOrder,min(AppealLevelOrigination) as AppealLevelOrigination,min(Appeallevel) as MinAppeallevel from rcomDenials.dbo.appAppeal x where appealclosingdate IS NULL group by UnitNum, PatNum, insOrder) z on	x.UnitNum = z.UnitNum and x.PatNum = z.PatNum and x.insOrder = z.insOrder and x.AppealLevelOrigination = z.AppealLevelOrigination and x.Appeallevel=z.MinAppeallevel ) minAppeals on mainApp.UnitNum = minAppeals.UnitNum and mainApp.PatNum = minAppeals.PatNum and mainApp.IPlan = minAppeals.Iplan and mainApp.InsOrder = minAppeals.InsOrder LEFT JOIN (select x.UnitNum, x.PatNum, x.insOrder, sum(OverturnedAmtCollected) as accOverturnedAmtCollected, sum(WriteoffAmount) as accWriteoffAmount from rcomDenials.dbo.appAppeal x group by x.UnitNum, x.PatNum, x.insOrder ) accAppeals on mainApp.UnitNum = accAppeals.UnitNum and mainApp.PatNum = accAppeals.PatNum and mainApp.InsOrder = accAppeals.InsOrder LEFT JOIN (select x.UnitNum, x.PatNum, x.insOrder, sum([TotalOverturnedAmt]) as accOverturnedAmtCollectedMTD, sum([TotalWriteOffAmt]) as accWriteoffAmountMTD from rcomDenials.[dbo].[appMESnapShot] x group by x.UnitNum, x.PatNum, x.insOrder ) accAppealsMTD on mainApp.UnitNum = accAppealsMTD.UnitNum and mainApp.PatNum = accAppealsMTD.PatNum and mainApp.InsOrder = accAppealsMTD.InsOrder LEFT JOIN (select x.UnitNum, x.PatNum, x.insOrder, x.AppealOriginationDate,x.IPlan, max(isnull(x.AppealClosingDate,'1900-01-01')) as AppealClosingDate from rcomDenials.[dbo].[appMESnapShot] x Inner Join (select UnitNum, PatNum, insOrder, IPlan,max(AppealOriginationDate) as MaxAppealOriginationDate from rcomDenials.[dbo].[appMESnapShot] group by UnitNum, PatNum, insOrder,IPlan) y on x.UnitNum = y.UnitNum and x.PatNum = y.PatNum and x.insOrder = y.insOrder and x.AppealOriginationDate = y.MaxAppealOriginationDate and x.IPlan=y.IPlan group by x.UnitNum, x.PatNum, x.insOrder, x.AppealOriginationDate,x.IPlan) newAppeal on mainApp.UnitNum = newAppeal.UnitNum and mainApp.PatNum = newAppeal.PatNum and mainApp.insOrder = newAppeal.insOrder and mainApp.Iplan = newAppeal.IPlan LEFT JOIN (select appi.UnitNum, appi.PatNum, appi.Iplan,appi.insOrder, appi.appealclosingdate,appi.Appeallevel, appi.AppealDeadline, appi.nextAction, appi.Appealinitiated, appi.AssignedTo, appi.AppealAmount, appi.WorkAgain, appi.RootCauseDetail, appi.DeniedCharges, appi.AppealLevelOrigination, appi.Disposition from rcomDenials.dbo.appAppeal appi where appi.Appeallevel = 1 ) mainAppLvl1 on mainApp.UnitNum = mainAppLvl1.UnitNum and mainApp.PatNum = mainAppLvl1.PatNum and mainApp.IPlan = mainAppLvl1.Iplan and mainApp.InsOrder = mainAppLvl1.InsOrder LEFT JOIN (select a.UnitNum, a.PatNum, max(a.SNLineId) as SNLineId, max(a.DateEntered) as LastDateEntered, min(a.DateEntered) as FirstActivityDate from rcomDenials.dbo.appSNLine a group by a.UnitNum, a.PatNum ) NotesLine on mainApp.UnitNum = NotesLine.UnitNum and mainApp.PatNum = NotesLine.PatNum LEFT join rcomDenials.dbo.appSNLine snLines on snLines.SNLineId = NotesLine.SNLineId and snLines.UnitNum = NotesLine.UnitNum and snLines.PatNum = NotesLine.PatNum LEFT JOIN rcomDenials.dbo.refRootCause refRC on refRC.intRootCauseID = mainApp.intRootCauseID LEFT JOIN rcomDenials.dbo.appInsurance appIns on appIns.UnitNum = mainApp.UnitNum and appIns.PatNum = mainApp.PatNum and appIns.IPlan = mainApp.Iplan and appIns.InsOrder = mainApp.InsOrder LEFT JOIN rcomDenials.dbo.mainDenial mainDen on mainDen.UnitNum = mainApp.UnitNum and mainDen.PatNum = mainApp.PatNum LEFT JOIN rcomDenials.dbo.tblPatStatus patStatus on mainDen.PatStatus = patStatus.PatStatus LEFT JOIN rcomDenials.dbo.appDenial appDen on appDen.UnitNum = mainDen.UnitNum and appDen.PatNum = mainDen.PatNum LEFT JOIN rcomDenials.dbo.appIPlan appIPln on appIPln.UnitNum = mainApp.UnitNum and appIPln.IPlan = mainApp.IPlan LEFT JOIN rcomDenials.dbo.mainInsurance mainIns on mainIns.UnitNum = mainApp.UnitNum and mainIns.PatNum = mainApp.PatNum and mainIns.IPlan = mainApp.IPlan and mainIns.InsOrder = mainApp.InsOrder LEFT JOIN ( select appi.UnitNum, appi.PatNum, appi.Iplan,appi.insOrder, ins.FinClass, appi.appealclosingdate, appi.AppealLevelOrigination From ( select appi.UnitNum, appi.PatNum, appi.Iplan,appi.insOrder, appi.appealclosingdate, appi.AppealLevelOrigination, ROW_NUMBER() OVER( PARTITION BY UnitNum ,PatNum ,Iplan,InsOrder ORDER BY AppealLevelOrigination DESC) AS Row from rcomDenials.dbo.appAppeal appi Where appi.appealclosingdate IS NULL ) appi INNER JOIN rcomDenials.dbo.mainInsurance ins ON appi.UnitNum = ins.UnitNum and appi.PatNum = ins.PatNum and appi.IPlan = ins.IPlan and appi.InsOrder = ins.InsOrder Where appi.Row = 1 ) appi on mainApp.UnitNum = appi.UnitNum and mainApp.PatNum = appi.PatNum and mainApp.IPlan = appi.IPlan and mainApp.InsOrder = appi.InsOrder LEFT JOIN ( select appi.UnitNum, appi.PatNum, ins.FinClass AS PA_FinClass From ( select appi.UnitNum, appi.PatNum, appi.Iplan,appi.insOrder, ROW_NUMBER() OVER( PARTITION BY UnitNum ,PatNum ,InsOrder ORDER BY AppealLevelOrigination DESC) AS Row from rcomDenials.dbo.appAppeal appi Where appi.appealclosingdate IS NULL ) appi INNER JOIN rcomDenials.dbo.mainInsurance ins ON appi.UnitNum = ins.UnitNum and appi.PatNum = ins.PatNum and appi.IPlan = ins.IPlan and appi.InsOrder = ins.InsOrder Where appi.Row = 1 AND appi.insOrder = 1 ) ins ON mainApp.UnitNum = ins.UnitNum and mainApp.PatNum = ins.PatNum LEFT JOIN rcomDenials.dbo.tblDisposition disp on disp.DispCode = maxAppeals.Disposition LEFT JOIN rcomDenials.dbo.tbldenialcode dcode on dcode.Denialcode = mainApp.Denialcode LEFT JOIN [RCOMDenials].[dbo].[refPAVendor] VEN on VEN.PAVendorID=mainApp.PAVendorID where cast(facility.Coid + substring(mainApp.PatNum,6,15) + cast(mainApp.Iplan as varchar(20)) + cast(mainApp.insOrder as varchar(20)) as varchar(200)) is NOT NULL and facility.Coid is NOT NULL~100000", 
  "6~rcomDenials.dbo.appAppeal~v_parallon_ra_stage_dataset_name.legacy_ssc_denials~append~~select 0 as schema_id ,cast(facility.Coid + substring(mainApp.PatNum,6,15) + cast(mainApp.Iplan as varchar(20)) + cast(mainApp.insOrder as varchar(20)) as varchar(200)) as mon_account_payer_id ,0 as pass_type ,facility.coid ,mainApp.PatNum as account_no ,111111111 as ssc_id ,NULL as rate_schedule_name ,NULL as ssc_name ,facility.HospName as facility_name ,facility.unitNum as unit_num ,NULL as rate_schedule_eff_begin_date ,NULL as rate_schedule_eff_end_date ,mainDen.PatName as patient_name ,replace(convert(varchar, mainDen.AdrBirthDate, 111), '/','-') as patient_dob ,mainApp.Iplan as iplan_id ,rtrim(mainIns.Iplan + ' - ' + mainIns.InsName) as insurance_provider_name ,rtrim(mainIns.GroupName) as payer_group_name ,nullif(appIPln.Addr1, '') as billing_name ,nullif(appIPln.Contact,'') as billing_contact_person ,NULL as authorization_code ,rtrim(mainIns.PolicyNo) as payer_patient_id ,mainApp.insOrder as payer_rank ,mainIns.FinClass as pa_financial_class ,mainIns.FinClass as payor_financial_class ,NULL as accounting_period ,mainIns.GroupNo as major_payer_grp ,NULL as reason_code ,mainDen.AccountStatus as billing_status ,mainDen.ServiceCode as pa_service_code ,mainDen.AccountStatus as pa_account_status ,mainDen.PatType as cc_patient_type ,patStatus.PatStatus as pa_discharge_status ,mainDen.PatType as pa_patient_type ,NULL as cancel_bill_ind ,NULL as admit_source ,NULL as admit_type ,mainDen.Drg as pa_drg ,cast(mainDen.AttnDrNo as char) as attending_physician_id ,mainDen.AttnDrFullName as attending_physician_name ,cast(mainDen.AdmitDate as Date) as service_date_begin ,cast(mainDen.DischDate as Date) as discharge_date ,NULL as comparison_method ,NULL as project_name ,NULL as work_queue_name ,case when maxAppeals.MaxAppealInit IS NULL then 'Closed' else 'Active' end as status_category_desc ,NULL as status_desc ,NULL as status_phase_desc ,NULL as calc_date ,cast(mainDen.TotCharge as decimal(18,2)) as total_charges ,mainDen.PatLos as pa_actual_los ,cast(mainDen.TotCharge as decimal(18,2)) as total_billed_charges ,cast(mainDen.TotCharge as decimal(18,2)) - cast(mainDen.INS1AmtPymtRcvd as decimal(18,2)) as covered_charges ,cast(mainDen.PatAmtEstLiab as decimal(18,2)) as total_expected_payment ,cast(mainDen.PatAmtAdjRcvd as decimal(18,2)) as total_expected_adjustment ,cast(mainDen.PatAmtEstLiab as decimal(18,2)) as total_pt_responsibility_actual ,cast(mainDen.PatAmtAdjRcvd as decimal(18,2)) as total_variance_adjustment ,cast(mainDen.PatAmtPymtRcvd as decimal(18,2)) as total_payments ,cast(mainApp.DeniedCharges as decimal(18,2)) as total_denial_amt ,NULL as payor_due_amt ,cast(mainDen.AccountBal as decimal(18,2)) as pa_total_account_bal ,cast(mainDen.AccountBal as decimal(18,2)) as ar_amount ,mainApp.OverturnedCharges as otd_to_date_amount ,mainApp.Writeoffamount as writeoff_amt ,mainApp.Writeoffamount as cash_adj_amt ,maxAppeals.maxAppealLevel as max_aplno ,mainApp.Appeallevel as max_seqno ,mainAppLvl1.AppealAmount as appeal_orig_amt ,mainApp.AppealAmount as current_appealed_amt ,mainApp.AppealAmount as current_appeal_balance ,cast(mainApp.AppealLevelOrigination as Date) as appeal_date_created ,cast(mainApp.AppealLevelOrigination as Date) as sequence_date_created ,cast(mainApp.AppealClosingDate as Date) as close_date ,NULL as max_seq_deadline_date ,NULL as sequence_creator ,mainApp.AssignedTo as appeal_owner ,NULL as appeal_modifier ,mainApp.Disposition as disp_code ,Disp.DispDescription as disp_desc ,NULL as web_disp_code ,refRC.strRootCauseCode as root_code ,refRC.strRootCauseDesc as root_cause_description ,NULLIF(mainApp.RootCauseDetail, '') as root_cause_dtl ,nullif(mainApp.DenialCode, '') as external_appeal_code ,cast(minAppeals.minAppealInit as Date) as first_denial_date ,datediff(dd,mainApp.Appealinitiated,getdate()) as denial_age ,cast(appDen.LastUpdateDate as Date) as pa_denial_update_date ,cast(NotesLine.FirstActivityDate as Date) as first_activity_create_date ,cast(NotesLine.LastDateEntered as Date) as last_activity_completion_date ,datediff(dd,NotesLine.LastDateEntered,getdate()) as last_activity_completion_age ,datediff(dd,NotesLine.LastDateEntered,getdate()) as last_user_activity_create_age ,NULL as last_reason_change_date ,NULL as last_status_change_date ,NULL as last_project_change_date ,NULL as last_owner_change_date ,cast(mainApp.WorkAgain as Date) as activity_due_date ,snLines.Comment as activity_desc ,NULL as activity_subject ,snLines.RACFID as activity_owner ,mainApp.DenialCode as apl_appeal_code ,NULLIF(replace(mainApp.NextAction,'&nbsp',''),'') as apl_appeal_desc ,NULL as appeal_sent_activity_ownr ,NULL as appeal_sent_activity_date ,NULL as appeal_sent_activity_age ,NULL as appeal_sent_activity_subj ,NULL as appeal_sent_activity_desc ,NULL as stratification ,NULL as status_kpi ,NULL as followup_kpi ,NULL as appealsent_kpi ,NULL as deadline_kpi ,getdate() as extract_date ,CASE WHEN mainIns.FinClass IN (1, 2, 3, 6) THEN 'Government' ELSE 'Managed Care' END AS payer_category ,'L' as Source_System_Code ,getdate() as dw_last_update_date from (select appi.UnitNum, appi.PatNum, appi.Iplan,appi.insOrder, appi.appealclosingdate,appi.Appeallevel, appi.AppealDeadline, appi.nextAction, appi.Appealinitiated, appi.AssignedTo, appi.AppealAmount, appi.WorkAgain, appi.RootCauseDetail, appi.DeniedCharges, appi.AppealLevelOrigination, appi.Disposition, appi.intRootCauseID, appi.OverturnedCharges, appi.OverturnedAmtCollected, appi.DenialCode, appi.WriteOffAmount from rcomDenials.dbo.appAppeal appi where appi.appealclosingdate IS NULL ) mainApp JOIN rcomDenials.dbo.tblFacility facility on facility.unitnum = mainApp.UnitNum LEFT JOIN (select x.UnitNum, x.PatNum, x.Iplan, x.insOrder, max(x.Appealinitiated) as MaxAppealInit, max(x.AppealID) as maxApplId, max(x.AppealDeadline) as maxDeadlineDate, max(x.Appeallevel) as maxAppealLevel from rcomDenials.dbo.appAppeal x group by x.UnitNum, x.PatNum, x.Iplan, x.insOrder ) maxAppeals on mainApp.UnitNum = maxAppeals.UnitNum and mainApp.PatNum = maxAppeals.PatNum and mainApp.IPlan = maxAppeals.Iplan and mainApp.InsOrder = maxAppeals.InsOrder LEFT JOIN (select x.UnitNum, x.PatNum, x.Iplan, x.insOrder,min(x.Appealinitiated) as minAppealInit, min(x.AppealID) as minApplId, min(x.AppealDeadline) as minDeadlineDate, min(x.Appeallevel) as minAppealLevel, min(x.AppealClosingDate) as minCloseDate from rcomDenials.dbo.appAppeal x group by x.UnitNum, x.PatNum, x.Iplan, x.insOrder ) minAppeals on mainApp.UnitNum = minAppeals.UnitNum and mainApp.PatNum = minAppeals.PatNum and mainApp.IPlan = minAppeals.Iplan and mainApp.InsOrder = minAppeals.InsOrder LEFT JOIN (select appi.UnitNum, appi.PatNum, appi.Iplan,appi.insOrder, appi.appealclosingdate,appi.Appeallevel, appi.AppealDeadline, appi.nextAction, appi.Appealinitiated, appi.AssignedTo, appi.AppealAmount, appi.WorkAgain, appi.RootCauseDetail, appi.DeniedCharges, appi.AppealLevelOrigination, appi.Disposition from rcomDenials.dbo.appAppeal appi where appi.Appeallevel = 1 ) mainAppLvl1 on mainApp.UnitNum = mainAppLvl1.UnitNum and mainApp.PatNum = mainAppLvl1.PatNum and mainApp.IPlan = mainAppLvl1.Iplan and mainApp.InsOrder = mainAppLvl1.InsOrder LEFT JOIN (select a.UnitNum, a.PatNum, max(a.SNLineId) as SNLineId, max(a.DateEntered) as LastDateEntered, min(a.DateEntered) as FirstActivityDate from rcomDenials.dbo.appSNLine a group by a.UnitNum, a.PatNum ) NotesLine on mainApp.UnitNum = NotesLine.UnitNum and mainApp.PatNum = NotesLine.PatNum LEFT join rcomDenials.dbo.appSNLine snLines on snLines.SNLineId = NotesLine.SNLineId and snLines.UnitNum = NotesLine.UnitNum and snLines.PatNum = NotesLine.PatNum LEFT JOIN rcomDenials.dbo.refRootCause refRC on refRC.intRootCauseID = mainApp.intRootCauseID LEFT JOIN rcomDenials.dbo.appInsurance appIns on appIns.UnitNum = mainApp.UnitNum and appIns.PatNum = mainApp.PatNum and appIns.IPlan = mainApp.Iplan and appIns.InsOrder = mainApp.InsOrder LEFT JOIN rcomDenials.dbo.mainDenial mainDen on mainDen.UnitNum = mainApp.UnitNum and mainDen.PatNum = mainApp.PatNum and mainDen.AccountStatus = 'AR' LEFT JOIN rcomDenials.dbo.tblPatStatus patStatus on mainDen.PatStatus = patStatus.PatStatus LEFT JOIN rcomDenials.dbo.appDenial appDen on appDen.UnitNum = mainDen.UnitNum and appDen.PatNum = mainDen.PatNum LEFT JOIN rcomDenials.dbo.appIPlan appIPln on appIPln.UnitNum = mainApp.UnitNum and appIPln.IPlan = mainApp.IPlan LEFT JOIN rcomDenials.dbo.mainInsurance mainIns on mainIns.UnitNum = mainApp.UnitNum and mainIns.PatNum = mainApp.PatNum and mainIns.IPlan = mainApp.IPlan and mainIns.InsOrder = mainApp.InsOrder LEFT JOIN rcomDenials.dbo.tblDisposition disp on disp.DispCode = mainApp.Disposition where cast(facility.Coid + substring(mainApp.PatNum,6,15) + cast(mainApp.Iplan as varchar(20)) + cast(mainApp.insOrder as varchar(20)) as varchar(200)) is NOT NULL and facility.Coid is NOT NULL~100000"
]

# List to update and ingest new denials
denials-new: [
  "7~rcomDenials.dbo.appAppeal~v_parallon_ra_stage_dataset_name.legacy_daily_denials~append~~select 0 as schema_id ,cast(facility.Coid + substring(mainApp.PatNum,6,15) + cast(mainApp.Iplan as varchar(20)) + cast(mainApp.insOrder as varchar(20)) as varchar(200)) as mon_account_payer_id ,0 as pass_type ,facility.coid ,mainApp.PatNum as account_no ,111111111 as ssc_id ,NULL as rate_schedule_name ,NULL as ssc_name ,facility.HospName as facility_name ,facility.unitNum as unit_num ,NULL as rate_schedule_eff_begin_date ,NULL as rate_schedule_eff_end_date ,mainDen.PatName as Patient_Name ,replace(convert(varchar, mainDen.AdrBirthDate, 111), '/','-') as patient_dob ,mainApp.Iplan as iplan_id ,rtrim(mainIns.GroupName) as insurance_provider_name 	 ,case when len(mainIns.IPlan)<5 then substring(RIGHT('00000'+mainIns.IPlan,5),1,3)+'-'+substring(RIGHT('00000'+mainIns.IPlan,5),4,2)+'-'+mainIns.InsName else substring(mainIns.IPlan,1,3)+'-'+substring(mainIns.IPlan,4,2)+'-'+mainIns.InsName end as payer_group_name ,mainIns.InsName as billing_name ,nullif(appIPln.Contact,'') as billing_contact_person ,NULL as authorization_code ,rtrim(mainIns.PolicyNo) as payer_patient_id ,mainApp.insOrder as payer_rank ,COALESCE(ins.PA_FinClass,appi.FinClass) AS pa_financial_class ,appi.FinClass AS payor_financial_class ,NULL as accounting_period ,mainIns.GroupNo as major_payer_grp ,NULL as reason_code ,NULL as billing_status ,mainDen.ServiceCode as pa_service_code ,mainDen.AccountStatus as pa_account_status ,NULL as cc_patient_type ,patStatus.PatStatus as pa_discharge_status ,mainDen.PatType as pa_patient_type ,NULL as cancel_bill_ind ,NULL as admit_source ,NULL as admit_type ,mainDen.Drg as pa_drg ,cast(mainDen.AttnDrNo as char) as attending_physician_id ,mainDen.AttnDrFullName as attending_physician_name ,cast(mainDen.AdmitDate as Date) as service_date_begin ,cast(mainDen.DischDate as Date) as discharge_date ,NULL as comparison_method ,VEN.PAVendor as project_name ,NULL as work_queue_name ,NULL as status_category_desc ,NULL as status_desc ,NULL as status_phase_desc ,NULL as calc_date ,coalesce(mainDen.TotCharge,0) as total_charges ,coalesce(mainDen.PatLos,0) as pa_actual_los ,0 as total_billed_charges ,coalesce(mainden.totcharge,0) - cast(mainden.ins1amtpymtrcvd as decimal(18,2)) as covered_charges ,0 as total_expected_payment ,0 as total_expected_adjustment ,coalesce(mainDen.PatAmtEstLiab,0) as total_pt_responsibility_actual ,0 as total_variance_adjustment ,Case mainApp.insOrder when 1 then coalesce(mainDen.INS1AmtPymtRcvd,0) when 2 then coalesce(mainDen.INS2AmtPymtRcvd,0) when 3 then coalesce(mainDen.INS3AmtPymtRcvd,0) else 0 end as total_payments ,coalesce(minAppeals.minAppealAmount,0) as total_denial_amt ,Case mainApp.insOrder when 1 then coalesce(mainDen.INS1AmtBalDue,0) when 2 then coalesce(mainDen.INS2AmtBalDue,0) when 3 then coalesce(mainDen.INS3AmtBalDue,0) else 0 end as payor_due_amt ,coalesce(mainDen.AccountBal,0) as pa_total_account_bal ,coalesce(mainDen.AccountBal,0) as ar_amount ,coalesce(accAppeals.accOverturnedAmtCollected,0) as otd_to_date_amount ,coalesce(accAppeals.accOverturnedAmtCollected,0) as otd_amt ,coalesce(accAppeals.accWriteoffAmount,0) as writeoff_amt ,coalesce(accAppeals.accWriteoffAmount,0) as cash_adj_amt ,coalesce(accAppeals.accOverturnedAmtCollected,0) as otd_to_date_amt,coalesce(accappeals.accoverturnedamtcollected,0) - coalesce(accappealsmtd.accoverturnedamtcollectedmtd,0) as otd_to_date_amt_mtd ,coalesce(accAppeals.accWriteoffAmount,0) - coalesce(accAppealsMTD.accWriteoffAmountMTD,0) as writeoff_amt_mtd ,coalesce(accAppeals.accWriteoffAmount,0) - coalesce(accAppealsMTD.accWriteoffAmountMTD,0) as cash_adj_amt_mtd ,coalesce(maxAppeals.maxAppealLevel,0) as appeal_level  ,CASE WHEN newAppeal.PatNum is null THEN 1 ELSE CASE WHEN newAppeal.AppealClosingDate <> '1900-01-01' THEN 1 ELSE CASE WHEN mainApp.Iplan <> newAppeal.IPlan then 1 ELSE 0 END END END	AS new_appeal_flag ,maxAppeals.maxAppealLevel as max_aplno ,maxAppeals.maxAppealLevel as max_seqno ,coalesce(mainAppLvl1.AppealAmount,0) as appeal_orig_amt ,coalesce(mainApp.AppealAmount,0) as current_appealed_amt ,coalesce(mainApp.AppealAmount,0) as current_appeal_balance ,cast(maxAppeals.AppealLevelOrigination as Date) as appeal_date_created ,cast(maxAppeals.AppealLevelOrigination as Date) as sequence_date_created ,cast(mainApp.AppealClosingDate as Date) as close_date ,cast(maxAppeals.maxDeadlineDate as Date) as max_seq_deadline_date ,NULL as sequence_creator ,mainApp.AssignedTo as appeal_owner ,NULL as appeal_modifier ,cast(Disp.DispCode as char) as disp_code ,Disp.DispDescription as disp_desc ,mainApp.Disposition as web_disp_code ,disp.DispType as web_disposition_type ,refRC.strRootCauseCode as root_code ,refRC.strRootCauseDesc as root_cause_description ,NULLIF(mainApp.RootCauseDetail, '') as root_cause_dtl ,nullif(mainApp.DenialCode, '') as external_appeal_code ,mainApp.DenialCode as apl_appeal_code ,NULLIF(replace(dcode.DenialCodeDesc,'&nbsp',''),'') as apl_appeal_desc ,cast(appIns.AppealOrigination as Date) as first_denial_date ,datediff(dd,minAppeals.minAppealLevelOrigination,getdate()) as denial_age ,cast(appDen.LastUpdateDate as Date) as pa_denial_update_date ,cast(NotesLine.FirstActivityDate as Date) as first_activity_create_date ,cast(NotesLine.LastDateEntered as Date) as last_activity_completion_date ,datediff(dd,NotesLine.LastDateEntered,getdate()) as last_activity_completion_age ,datediff(dd,NotesLine.LastDateEntered,getdate()) as last_user_activity_create_age ,NULL as last_reason_change_date ,NULL as last_status_change_date ,NULL as last_project_change_date ,NULL as last_owner_change_date ,cast(mainApp.WorkAgain as Date) as activity_due_date ,snLines.Comment as activity_desc ,NULL as activity_subject ,snLines.RACFID as activity_owner ,NULL as appeal_sent_activity_ownr ,cast(MaxAppealInit as Date) as appeal_initiation_date ,case when mainApp.Appeallevel = maxAppeals.maxAppealLevel then case when mainApp.Disposition <> '13' then case when cast(mainapp.Appealinitiated as date) <> cast(mainapp.AppealLevelOrigination as date) then cast(mainapp.Appealinitiated as Date) when (cast(mainapp.Appealinitiated as date) = cast(mainapp.AppealLevelOrigination as date) and snLines.Comment = 'Expedited appeal letter and medical record shipped' and snLines.RACFID = 'AAssist') then cast(mainapp.Appealinitiated as Date) else NULL END else NULL END else NULL END as appeal_sent_activity_date ,datediff(dd,case when mainApp.Appeallevel = maxAppeals.maxAppealLevel then case when mainApp.Disposition <> '13' then case when cast(mainapp.Appealinitiated as date) <> cast(mainapp.AppealLevelOrigination as date) then mainapp.Appealinitiated when (cast(mainapp.Appealinitiated as date) = cast(mainapp.AppealLevelOrigination as date) and snLines.Comment = 'Expedited appeal letter and medical record shipped' and snLines.RACFID = 'AAssist') then mainapp.Appealinitiated else NULL END else NULL END else NULL END, getdate()) as appeal_sent_activity_age ,NULL as last_status_change_age ,datediff(dd,mainApp.WorkAgain, getdate()) as activity_due_date_age ,datediff(dd,maxAppeals.AppealLevelOrigination, getdate()) as latest_seq_creation_date_age ,datediff(dd,getdate(),maxAppeals.maxDeadlineDate) as appeal_deadline_days_remaining ,NULL as appeal_sent_activity_subj ,NULL as appeal_sent_activity_desc ,NULL as stratification ,NULL as status_kpi ,NULL as followup_kpi ,NULL as appealsent_kpi ,NULL as deadline_kpi ,getdate() as extract_date ,CASE WHEN mainIns.FinClass IN (1, 2, 3, 6) THEN 'Government' ELSE 'Managed Care' END AS payer_category ,'L' as source_system_code ,mainApp.Appeallevel as seq_no ,getdate() as dw_last_update_date ,COUNT (1) OVER () as row_count ,NULL as expeted_amt from ( select appi.UnitNum, appi.PatNum, appi.Iplan,appi.insOrder, appi.appealclosingdate,appi.Appeallevel, appi.AppealDeadline, appi.nextAction, appi.Appealinitiated, appi.AssignedTo, appi.AppealAmount, appi.WorkAgain, appi.RootCauseDetail, appi.DeniedCharges, appi.AppealLevelOrigination, appi.Disposition, appi.intRootCauseID, appi.OverturnedCharges, appi.OverturnedAmtCollected, appi.DenialCode,appi.PAVendorID, appi.WriteOffAmount From ( select appi.UnitNum, appi.PatNum, appi.Iplan,appi.insOrder, appi.appealclosingdate,appi.Appeallevel, appi.AppealDeadline, appi.nextAction, appi.Appealinitiated, appi.AssignedTo, appi.AppealAmount, appi.WorkAgain, appi.RootCauseDetail, appi.DeniedCharges, appi.AppealLevelOrigination, appi.Disposition, appi.intRootCauseID, appi.OverturnedCharges, appi.OverturnedAmtCollected, appi.DenialCode,appi.PAVendorID, appi.WriteOffAmount, ROW_NUMBER() OVER( PARTITION BY UnitNum ,PatNum ,Iplan,InsOrder ORDER BY AppealLevelOrigination DESC) AS Row from rcomDenials.dbo.appAppeal appi) appi Where appi.Row = 1 and (datediff(dd, appi.appealclosingdate, getdate()) <= 40 ) and appi.Disposition in (Select dispcode from rcomDenials.dbo.tbldisposition where disptype in ('O','C','I')) and appi.Appeallevel = (Select max(appo.Appeallevel) from rcomDenials.dbo.appAppeal appo where appi.unitnum = appo.unitnum and appi.patnum = appo.patnum and appi.iplan=appo.iplan and appi.insOrder = appo.insOrder) ) mainApp JOIN rcomDenials.dbo.tblFacility facility on facility.unitnum = mainApp.UnitNum LEFT JOIN (select x.UnitNum, x.PatNum, x.Iplan, x.insOrder, x.Appealinitiated as MaxAppealInit, x.AppealID as maxApplId,x.AppealLevelOrigination as AppealLevelOrigination, x.AppealDeadline as maxDeadlineDate, x.Appeallevel as maxAppealLevel,x.Disposition as Disposition from rcomDenials.dbo.appAppeal x inner join (select UnitNum, PatNum, insOrder, max(AppealLevelOrigination) as AppealLevelOrigination,max(Appeallevel) as MaxAppeallevel from rcomDenials.dbo.appAppeal where (datediff(dd, appealclosingdate, getdate()) <= 40 ) group by UnitNum, PatNum, insOrder) y on x.UnitNum = y.UnitNum and x.PatNum = y.PatNum and x.insOrder = y.insOrder and x.AppealLevelOrigination = y.AppealLevelOrigination and x.Appeallevel=y.MaxAppeallevel ) maxAppeals on mainApp.UnitNum = maxAppeals.UnitNum and mainApp.PatNum = maxAppeals.PatNum and mainApp.IPlan = maxAppeals.Iplan and mainApp.InsOrder = maxAppeals.InsOrder LEFT JOIN (select x.UnitNum, x.PatNum, x.Iplan, x.insOrder,x.Appealinitiated as minAppealInit, x.AppealID as minApplId, x.AppealDeadline as minDeadlineDate, x.Appeallevel as minAppealLevel, x.AppealClosingDate as minCloseDate, x.AppealLevelOrigination as minAppealLevelOrigination, x.AppealAmount as minAppealAmount from rcomDenials.dbo.appAppeal x inner join (select UnitNum, PatNum, insOrder,min(AppealLevelOrigination) as AppealLevelOrigination,min(Appeallevel) as MinAppeallevel from rcomDenials.dbo.appAppeal x where (datediff(dd, appealclosingdate, getdate()) <= 40 ) group by UnitNum, PatNum, insOrder) z on x.UnitNum = z.UnitNum and x.PatNum = z.PatNum and x.insOrder = z.insOrder and x.AppealLevelOrigination = z.AppealLevelOrigination and x.Appeallevel=z.MinAppeallevel ) minAppeals on mainApp.UnitNum = minAppeals.UnitNum and mainApp.PatNum = minAppeals.PatNum and mainApp.IPlan = minAppeals.Iplan and mainApp.InsOrder = minAppeals.InsOrder LEFT JOIN (select x.UnitNum, x.PatNum, x.insOrder, sum(OverturnedAmtCollected) as accOverturnedAmtCollected, sum(WriteoffAmount) as accWriteoffAmount from rcomDenials.dbo.appAppeal x group by x.UnitNum, x.PatNum, x.insOrder ) accAppeals on mainApp.UnitNum = accAppeals.UnitNum and mainApp.PatNum = accAppeals.PatNum and mainApp.InsOrder = accAppeals.InsOrder LEFT JOIN (select x.UnitNum, x.PatNum, x.insOrder, sum([TotalOverturnedAmt]) as accOverturnedAmtCollectedMTD, sum([TotalWriteOffAmt]) as accWriteoffAmountMTD from rcomDenials.[dbo].[appMESnapShot] x group by x.UnitNum, x.PatNum, x.insOrder ) accAppealsMTD on mainApp.UnitNum = accAppealsMTD.UnitNum and mainApp.PatNum = accAppealsMTD.PatNum and mainApp.InsOrder = accAppealsMTD.InsOrder LEFT JOIN (select x.UnitNum, x.PatNum, x.insOrder, x.AppealOriginationDate,x.IPlan, max(isnull(x.AppealClosingDate,'1900-01-01')) as AppealClosingDate from rcomDenials.[dbo].[appMESnapShot] x Inner Join (select UnitNum, PatNum, insOrder, IPlan,max(AppealOriginationDate) as MaxAppealOriginationDate from rcomDenials.[dbo].[appMESnapShot] group by UnitNum, PatNum, insOrder,IPlan) y on x.UnitNum = y.UnitNum and x.PatNum = y.PatNum and x.insOrder = y.insOrder and x.AppealOriginationDate = y.MaxAppealOriginationDate and x.IPlan=y.IPlan group by x.UnitNum, x.PatNum, x.insOrder, x.AppealOriginationDate,x.IPlan) newAppeal on mainApp.UnitNum = newAppeal.UnitNum and mainApp.PatNum = newAppeal.PatNum and mainApp.insOrder = newAppeal.insOrder and mainApp.Iplan = newAppeal.IPlan LEFT JOIN (select appi.UnitNum, appi.PatNum, appi.Iplan,appi.insOrder, appi.appealclosingdate,appi.Appeallevel, appi.AppealDeadline, appi.nextAction, appi.Appealinitiated, appi.AssignedTo, appi.AppealAmount, appi.WorkAgain, appi.RootCauseDetail, appi.DeniedCharges, appi.AppealLevelOrigination, appi.Disposition from rcomDenials.dbo.appAppeal appi where appi.Appeallevel = 1 ) mainAppLvl1 on mainApp.UnitNum = mainAppLvl1.UnitNum and mainApp.PatNum = mainAppLvl1.PatNum and mainApp.IPlan = mainAppLvl1.Iplan and mainApp.InsOrder = mainAppLvl1.InsOrder LEFT JOIN (select a.UnitNum, a.PatNum, max(a.SNLineId) as SNLineId, max(a.DateEntered) as LastDateEntered, min(a.DateEntered) as FirstActivityDate from rcomDenials.dbo.appSNLine a group by a.UnitNum, a.PatNum ) NotesLine on mainApp.UnitNum = NotesLine.UnitNum and mainApp.PatNum = NotesLine.PatNum LEFT join rcomDenials.dbo.appSNLine snLines on snLines.SNLineId = NotesLine.SNLineId and snLines.UnitNum = NotesLine.UnitNum and snLines.PatNum = NotesLine.PatNum LEFT JOIN rcomDenials.dbo.refRootCause refRC on refRC.intRootCauseID = mainApp.intRootCauseID LEFT JOIN rcomDenials.dbo.appInsurance appIns on appIns.UnitNum = mainApp.UnitNum and appIns.PatNum = mainApp.PatNum and appIns.IPlan = mainApp.Iplan and appIns.InsOrder = mainApp.InsOrder LEFT JOIN rcomDenials.dbo.mainDenial mainDen on mainDen.UnitNum = mainApp.UnitNum and mainDen.PatNum = mainApp.PatNum LEFT JOIN rcomDenials.dbo.tblPatStatus patStatus on mainDen.PatStatus = patStatus.PatStatus LEFT JOIN rcomDenials.dbo.appDenial appDen on appDen.UnitNum = mainDen.UnitNum and appDen.PatNum = mainDen.PatNum LEFT JOIN rcomDenials.dbo.appIPlan appIPln on appIPln.UnitNum = mainApp.UnitNum and appIPln.IPlan = mainApp.IPlan LEFT JOIN rcomDenials.dbo.mainInsurance mainIns on mainIns.UnitNum = mainApp.UnitNum and mainIns.PatNum = mainApp.PatNum and mainIns.IPlan = mainApp.IPlan and mainIns.InsOrder = mainApp.InsOrder LEFT JOIN ( select appi.UnitNum, appi.PatNum, appi.Iplan,appi.insOrder, ins.FinClass, appi.appealclosingdate, appi.AppealLevelOrigination From ( select appi.UnitNum, appi.PatNum, appi.Iplan,appi.insOrder, appi.appealclosingdate, appi.AppealLevelOrigination, ROW_NUMBER() OVER( PARTITION BY UnitNum ,PatNum ,Iplan,InsOrder ORDER BY AppealLevelOrigination DESC) AS Row from rcomDenials.dbo.appAppeal appi Where (datediff(dd, appi.appealclosingdate, getdate()) <= 40 ) ) appi INNER JOIN rcomDenials.dbo.mainInsurance ins ON appi.UnitNum = ins.UnitNum and appi.PatNum = ins.PatNum and appi.IPlan = ins.IPlan and appi.InsOrder = ins.InsOrder Where appi.Row = 1 ) appi on mainApp.UnitNum = appi.UnitNum and mainApp.PatNum = appi.PatNum and mainApp.IPlan = appi.IPlan and mainApp.InsOrder = appi.InsOrder LEFT JOIN ( select appi.UnitNum, appi.PatNum, ins.FinClass AS PA_FinClass From ( select appi.UnitNum, appi.PatNum, appi.Iplan,appi.insOrder, ROW_NUMBER() OVER( PARTITION BY UnitNum ,PatNum ,InsOrder ORDER BY AppealLevelOrigination DESC) AS Row from rcomDenials.dbo.appAppeal appi Where (datediff(dd, appi.appealclosingdate, getdate()) <= 40 ) ) appi INNER JOIN rcomDenials.dbo.mainInsurance ins ON appi.UnitNum = ins.UnitNum and appi.PatNum = ins.PatNum and appi.IPlan = ins.IPlan and appi.InsOrder = ins.InsOrder Where appi.Row = 1 AND appi.insOrder = 1 ) ins ON mainApp.UnitNum = ins.UnitNum and mainApp.PatNum = ins.PatNum LEFT JOIN rcomDenials.dbo.tblDisposition disp on disp.DispCode = maxAppeals.Disposition LEFT JOIN rcomDenials.dbo.tbldenialcode dcode on dcode.Denialcode = mainApp.Denialcode LEFT JOIN [RCOMDenials].[dbo].[refPAVendor] VEN on VEN.PAVendorID=mainApp.PAVendorID where cast(facility.Coid + substring(mainApp.PatNum,6,15) + cast(mainApp.Iplan as varchar(20)) + cast(mainApp.insOrder as varchar(20)) as varchar(200)) is NOT NULL and facility.Coid is NOT NULL~100000", 
  "8~rcomDenials.dbo.appAppeal~v_parallon_ra_stage_dataset_name.legacy_ssc_denials~append~~select 0 as schema_id ,cast(facility.Coid + substring(mainApp.PatNum,6,15) + cast(mainApp.Iplan as varchar(20)) + cast(mainApp.insOrder as varchar(20)) as varchar(200)) as mon_account_payer_id ,0 as pass_type ,facility.coid ,mainApp.PatNum as account_no ,111111111 as ssc_id ,NULL as rate_schedule_name ,NULL as ssc_name ,facility.HospName as facility_name ,facility.unitNum as unit_num ,NULL as rate_schedule_eff_begin_date ,NULL as rate_schedule_eff_end_date ,mainDen.PatName as patient_name ,replace(convert(varchar, mainDen.AdrBirthDate, 111), '/','-') as patient_dob ,mainApp.Iplan as iplan_id ,rtrim(mainIns.Iplan + ' - ' + mainIns.InsName) as insurance_provider_name ,rtrim(mainIns.GroupName) as payer_group_name ,nullif(appIPln.Addr1, '') as billing_name ,nullif(appIPln.Contact,'') as billing_contact_person ,NULL as authorization_code ,rtrim(mainIns.PolicyNo) as payer_patient_id ,mainApp.insOrder as payer_rank ,mainIns.FinClass as pa_financial_class ,mainIns.FinClass as payor_financial_class ,NULL as accounting_period ,mainIns.GroupNo as major_payer_grp ,NULL as reason_code ,mainDen.AccountStatus as billing_status ,mainDen.ServiceCode as pa_service_code ,mainDen.AccountStatus as pa_account_status ,mainDen.PatType as cc_patient_type ,patStatus.PatStatus as pa_discharge_status ,mainDen.PatType as pa_patient_type ,NULL as cancel_bill_ind ,NULL as admit_source ,NULL as admit_type ,mainDen.Drg as pa_drg ,cast(mainDen.AttnDrNo as char) as attending_physician_id ,mainDen.AttnDrFullName as attending_physician_name ,cast(mainDen.AdmitDate as Date) as service_date_begin ,cast(mainDen.DischDate as Date) as discharge_date ,NULL as comparison_method ,NULL as project_name ,NULL as work_queue_name ,case when maxAppeals.MaxAppealInit IS NULL then 'Closed' else 'Active' end as status_category_desc ,NULL as status_desc ,NULL as status_phase_desc ,NULL as calc_date ,cast(mainDen.TotCharge as decimal(18,2)) as total_charges ,mainDen.PatLos as pa_actual_los ,cast(mainDen.TotCharge as decimal(18,2)) as total_billed_charges ,cast(mainDen.TotCharge as decimal(18,2)) - cast(mainDen.INS1AmtPymtRcvd as decimal(18,2)) as covered_charges ,cast(mainDen.PatAmtEstLiab as decimal(18,2)) as total_expected_payment ,cast(mainDen.PatAmtAdjRcvd as decimal(18,2)) as total_expected_adjustment ,cast(mainDen.PatAmtEstLiab as decimal(18,2)) as total_pt_responsibility_actual ,cast(mainDen.PatAmtAdjRcvd as decimal(18,2)) as total_variance_adjustment ,cast(mainDen.PatAmtPymtRcvd as decimal(18,2)) as total_payments ,cast(mainApp.DeniedCharges as decimal(18,2)) as total_denial_amt ,NULL as payor_due_amt ,cast(mainDen.AccountBal as decimal(18,2)) as pa_total_account_bal ,cast(mainDen.AccountBal as decimal(18,2)) as ar_amount ,mainApp.OverturnedCharges as otd_to_date_amount ,mainApp.Writeoffamount as writeoff_amt ,mainApp.Writeoffamount as cash_adj_amt ,maxAppeals.maxAppealLevel as max_aplno ,null as max_seqno ,mainAppLvl1.AppealAmount as appeal_orig_amt ,mainApp.AppealAmount as current_appealed_amt ,mainApp.AppealAmount as current_appeal_balance ,cast(mainApp.AppealLevelOrigination as Date) as appeal_date_created ,cast(mainApp.AppealLevelOrigination as Date) as sequence_date_created ,cast(mainApp.AppealClosingDate as Date) as close_date ,NULL as max_seq_deadline_date ,NULL as sequence_creator ,mainApp.AssignedTo as appeal_owner ,NULL as appeal_modifier ,mainApp.Disposition as disp_code ,Disp.DispDescription as disp_desc ,NULL as web_disp_code ,refRC.strRootCauseCode as root_code ,refRC.strRootCauseDesc as root_cause_description ,NULLIF(mainApp.RootCauseDetail, '') as root_cause_dtl ,nullif(mainApp.DenialCode, '') as external_appeal_code ,cast(minAppeals.minAppealInit as Date) as first_denial_date ,datediff(dd,mainApp.Appealinitiated,getdate()) as denial_age ,cast(appDen.LastUpdateDate as Date) as pa_denial_update_date ,cast(NotesLine.FirstActivityDate as Date) as first_activity_create_date ,cast(NotesLine.LastDateEntered as Date) as last_activity_completion_date ,datediff(dd,NotesLine.LastDateEntered,getdate()) as last_activity_completion_age ,datediff(dd,NotesLine.LastDateEntered,getdate()) as last_user_activity_create_age ,NULL as last_reason_change_date ,NULL as last_status_change_date ,NULL as last_project_change_date ,NULL as last_owner_change_date ,cast(mainApp.WorkAgain as Date) as activity_due_date ,snLines.Comment as activity_desc ,NULL as activity_subject ,snLines.RACFID as activity_owner ,mainApp.DenialCode as apl_appeal_code ,NULLIF(replace(mainApp.NextAction,'&nbsp',''),'') as apl_appeal_desc ,NULL as appeal_sent_activity_ownr ,NULL as appeal_sent_activity_date ,NULL as appeal_sent_activity_age ,NULL as appeal_sent_activity_subj ,NULL as appeal_sent_activity_desc ,NULL as stratification ,NULL as status_kpi ,NULL as followup_kpi ,NULL as appealsent_kpi ,NULL as deadline_kpi ,getdate() as extract_date ,CASE WHEN mainIns.FinClass IN (1, 2, 3, 6) THEN 'Government' ELSE 'Managed Care' END AS payer_category ,'L' as Source_System_Code ,getdate() as dw_last_update_date from (select appi.UnitNum, appi.PatNum, appi.Iplan,appi.insOrder, appi.appealclosingdate,appi.Appeallevel, appi.AppealDeadline, appi.nextAction, appi.Appealinitiated, appi.AssignedTo, appi.AppealAmount, appi.WorkAgain, appi.RootCauseDetail, appi.DeniedCharges, appi.AppealLevelOrigination, appi.Disposition, appi.intRootCauseID, appi.OverturnedCharges, appi.OverturnedAmtCollected, appi.DenialCode, appi.WriteOffAmount from rcomDenials.dbo.appAppeal appi where (datediff(dd, appi.appealclosingdate, getdate()) <= 30 ) and appi.Disposition in (Select dispcode from rcomDenials.dbo.tbldisposition where disptype in ('O','C','I')) and appi.Appeallevel = (Select max(appo.Appeallevel) from rcomDenials.dbo.appAppeal appo where appi.unitnum = appo.unitnum and appi.patnum = appo.patnum and appi.iplan=appo.iplan and appi.insOrder = appo.insOrder) ) mainApp JOIN rcomDenials.dbo.tblFacility facility on facility.unitnum = mainApp.UnitNum LEFT JOIN (select x.UnitNum, x.PatNum, x.Iplan, x.insOrder, max(x.Appealinitiated) as MaxAppealInit, max(x.AppealID) as maxApplId, max(x.AppealDeadline) as maxDeadlineDate, max(x.Appeallevel) as maxAppealLevel from rcomDenials.dbo.appAppeal x group by x.UnitNum, x.PatNum, x.Iplan, x.insOrder ) maxAppeals on mainApp.UnitNum = maxAppeals.UnitNum and mainApp.PatNum = maxAppeals.PatNum and mainApp.IPlan = maxAppeals.Iplan and mainApp.InsOrder = maxAppeals.InsOrder LEFT JOIN (select x.UnitNum, x.PatNum, x.Iplan, x.insOrder,min(x.Appealinitiated) as minAppealInit, min(x.AppealID) as minApplId, min(x.AppealDeadline) as minDeadlineDate, min(x.Appeallevel) as minAppealLevel, min(x.AppealClosingDate) as minCloseDate from rcomDenials.dbo.appAppeal x group by x.UnitNum, x.PatNum, x.Iplan, x.insOrder ) minAppeals on mainApp.UnitNum = minAppeals.UnitNum and mainApp.PatNum = minAppeals.PatNum and mainApp.IPlan = minAppeals.Iplan and mainApp.InsOrder = minAppeals.InsOrder LEFT JOIN (select appi.UnitNum, appi.PatNum, appi.Iplan,appi.insOrder, appi.appealclosingdate,appi.Appeallevel, appi.AppealDeadline, appi.nextAction, appi.Appealinitiated, appi.AssignedTo, appi.AppealAmount, appi.WorkAgain, appi.RootCauseDetail, appi.DeniedCharges, appi.AppealLevelOrigination, appi.Disposition from rcomDenials.dbo.appAppeal appi where appi.Appeallevel = 1 ) mainAppLvl1 on mainApp.UnitNum = mainAppLvl1.UnitNum and mainApp.PatNum = mainAppLvl1.PatNum and mainApp.IPlan = mainAppLvl1.Iplan and mainApp.InsOrder = mainAppLvl1.InsOrder LEFT JOIN (select a.UnitNum, a.PatNum, max(a.SNLineId) as SNLineId, max(a.DateEntered) as LastDateEntered, min(a.DateEntered) as FirstActivityDate from rcomDenials.dbo.appSNLine a group by a.UnitNum, a.PatNum ) NotesLine on mainApp.UnitNum = NotesLine.UnitNum and mainApp.PatNum = NotesLine.PatNum LEFT join rcomDenials.dbo.appSNLine snLines on snLines.SNLineId = NotesLine.SNLineId and snLines.UnitNum = NotesLine.UnitNum and snLines.PatNum = NotesLine.PatNum LEFT JOIN rcomDenials.dbo.refRootCause refRC on refRC.intRootCauseID = mainApp.intRootCauseID LEFT JOIN rcomDenials.dbo.appInsurance appIns on appIns.UnitNum = mainApp.UnitNum and appIns.PatNum = mainApp.PatNum and appIns.IPlan = mainApp.Iplan and appIns.InsOrder = mainApp.InsOrder LEFT JOIN rcomDenials.dbo.mainDenial mainDen on mainDen.UnitNum = mainApp.UnitNum and mainDen.PatNum = mainApp.PatNum and mainDen.AccountStatus = 'AR' LEFT JOIN rcomDenials.dbo.tblPatStatus patStatus on mainDen.PatStatus = patStatus.PatStatus LEFT JOIN rcomDenials.dbo.appDenial appDen on appDen.UnitNum = mainDen.UnitNum and appDen.PatNum = mainDen.PatNum LEFT JOIN rcomDenials.dbo.appIPlan appIPln on appIPln.UnitNum = mainApp.UnitNum and appIPln.IPlan = mainApp.IPlan LEFT JOIN rcomDenials.dbo.mainInsurance mainIns on mainIns.UnitNum = mainApp.UnitNum and mainIns.PatNum = mainApp.PatNum and mainIns.IPlan = mainApp.IPlan and mainIns.InsOrder = mainApp.InsOrder LEFT JOIN rcomDenials.dbo.tblDisposition disp on disp.DispCode = mainApp.Disposition where cast(facility.Coid + substring(mainApp.PatNum,6,15) + cast(mainApp.Iplan as varchar(20)) + cast(mainApp.insOrder as varchar(20)) as varchar(200)) is NOT NULL and facility.Coid is NOT NULL~100000"
]

schedule:
  - schedule_interval: 0 5 * * *
    start_date: pendulum.datetime(2024, 3, 19, tz=timezone)
    frequency: daily
    done_file: parallon_credit_refund_YYYYMMDD.done
    has_sensor: "No"
    source: webtools
    tblist: [tblist1]
    truncatetablelist: ['cr_balance_refund_header']
    server: ["XRPSWPRPTFSG02.hca.corpad.net"]
    schema: 
      - name: ["1433","RcomCreditRefund",""]
    has_file_extract: True
    source_file_name: done_file
    destination_file_name: CR_CB_Job_Complete.done

  - schedule_interval: 0 8 * * *
    start_date: pendulum.datetime(2024, 3, 19, tz=timezone)
    frequency: daily
    done_file: ssc_denials_YYYYMMDD.done
    has_sensor: "No"
    has_file_extract: False
    source: webtools
    tblist: [tblist4]
    truncatetablelist: ['legacy_daily_denials', 'legacy_ssc_denials']
    server: ["XRPSWPRPTFSG02.hca.corpad.net"]
    schema: 
      - name: ["1433","RcomDenials",""]

  - schedule_interval: 0 5 * * *
    start_date: pendulum.datetime(2024, 3, 19, tz=timezone)
    frequency: daily
    done_file: NONE 
    has_sensor: "No"
    has_file_extract: False
    source: crt
    tblist: [tblist2]
    truncatetablelist: []
    server: ["XRPSWPDBSMCC01.hca.corpad.net"]
    schema: 
      - name: ["1433","rebillLog",""]

  - schedule_interval: 0 5 * * *
    start_date: pendulum.datetime(2024, 3, 19, tz=timezone)
    frequency: daily
    done_file: NONE 
    has_sensor: "No"
    has_file_extract: False
    source: path_issue
    tblist: [tblist3]
    truncatetablelist: ["path_issue"]
    server: ["XRPSWPDBSRCT02.hca.corpad.net"]
    schema: 
      - name: ["1433","PayerAnalysisTrendHub",""]

  - schedule_interval: 0 8 * * *
    start_date: pendulum.datetime(2024, 3, 19, tz=timezone)
    frequency: daily
    done_file: NONE
    has_sensor: "Yes"
    has_file_extract: False
    source: webtools_denials
    tblist: [denials-new]
    truncatetablelist: []
    server: ["XRPSWPRPTFSG02.hca.corpad.net"]
    schema: 
      - name: ["1433","RcomDenials",""]
    sensor:
    - dag_id: dag_ingest_ra_sqlserver_webtools_daily_08.00
      task_id: end_dag
      schedule: 0 8 * * *
    sqls: ["cc_legacy_ssc_denials_update.sql", "legacy_daily_denials_update.sql"]