
delete from hca-hin-prod-cur-parallon.`edwra_staging.edw_daily_discrepancy_bthr` a
where exists ( select 1 from hca-hin-qa-cur-parallon.`edwra_staging.edw_daily_discrepancy_bthr_08072025` b
                where a.schema_id = b.schema_id AND a.mon_account_payer_id = b.mon_account_payer_id);


INSERT INTO hca-hin-prod-cur-parallon.`edwra_staging.edw_daily_discrepancy_bthr` 
(schema_id, mon_account_payer_id, coid, account_no, payer_rank, ssc_name, facility_name, sec_establishment_id, unit_num, rate_schedule_name, rate_schedule_eff_begin_date, rate_schedule_eff_end_date, patient_name, patient_dob, iplan_id, insurance_provider_name, payer_group_name, billing_name, billing_contact_name, authorization_code, payer_patient_id, pa_financial_class, payor_financial_class, reason_code, reason_code_2, reason_code_3, reason_code_4, billing_status, pa_service_code, pa_account_status, cc_patient_type, pa_discharge_status, pa_patient_type, cancel_bill_ind, admit_source, pa_drg, attending_physician_id, attending_physician_name, service_date_begin, discharge_date, comparison_method, project_name, work_queue_name, status_category_desc, status_desc, status_phase_desc, calc_date, overpayment_date, overpayment_age, underpayment_date, underpayment_age, non_fin_disc_date, non_fin_disc_age, variance_creation_date, variance_creation_age, variance_resolution_date, variance_resolution_age, first_activity_create_date, last_activity_completion_date, last_activity_completion_age, last_reason_change_date, last_reason_change_date_2, last_reason_change_date_3, last_reason_change_date_4, last_status_change_date, last_project_change_date, last_owner_change_date, activity_due_date, activity_description, activity_subject, activity_owner, crt_placed_activity_date, total_charges, pa_actual_los, total_billed_charges, total_expected_payment, total_expected_adjustment, total_pt_responsibility, total_variance_adjustment, total_payments, total_denial_amount, payor_due_amount, ar_amount, pa_total_account_bal, user_completed_activity_date, user_completed_activity_age, user_completed_activity_subj, user_completed_activity_desc, user_completed_activity_ownr, valid_overpymnt_activity_dt, valid_overpymnt_activity_age, valid_overpymnt_activity_subj, valid_overpymnt_activity_desc, valid_overpymnt_activity_ownr, valid_underpymnt_activity_date, valid_underpymnt_activity_age, valid_underpymnt_activity_subj, valid_underpymnt_activity_desc, valid_underpymnt_activity_ownr, validation_grp, discrepancy_group, credit, payer_category, model_issue, credit_balance_age, extract_date, collection_amt, collection_date, source_system_code, max_type5_trans_dt, dw_last_update_date, remit_drg_code, calc_base, last_remit_received_date)
SELECT schema_id, mon_account_payer_id, coid, account_no, payer_rank, ssc_name, facility_name, sec_establishment_id, unit_num, rate_schedule_name, rate_schedule_eff_begin_date, rate_schedule_eff_end_date, patient_name, patient_dob, iplan_id, insurance_provider_name, payer_group_name, billing_name, billing_contact_name, authorization_code, payer_patient_id, pa_financial_class, payor_financial_class, reason_code, reason_code_2, reason_code_3, reason_code_4, billing_status, pa_service_code, pa_account_status, cc_patient_type, pa_discharge_status, pa_patient_type, cancel_bill_ind, admit_source, pa_drg, attending_physician_id, attending_physician_name, service_date_begin, discharge_date, comparison_method, project_name, work_queue_name, status_category_desc, status_desc, status_phase_desc, calc_date, overpayment_date, overpayment_age, underpayment_date, underpayment_age, non_fin_disc_date, non_fin_disc_age, variance_creation_date, variance_creation_age, variance_resolution_date, variance_resolution_age, first_activity_create_date, last_activity_completion_date, last_activity_completion_age, last_reason_change_date, last_reason_change_date_2, last_reason_change_date_3, last_reason_change_date_4, last_status_change_date, last_project_change_date, last_owner_change_date, activity_due_date, activity_description, activity_subject, activity_owner, crt_placed_activity_date, total_charges, pa_actual_los, total_billed_charges, total_expected_payment, total_expected_adjustment, total_pt_responsibility, total_variance_adjustment, total_payments, total_denial_amount, payor_due_amount, ar_amount, pa_total_account_bal, user_completed_activity_date, user_completed_activity_age, user_completed_activity_subj, user_completed_activity_desc, user_completed_activity_ownr, valid_overpymnt_activity_dt, valid_overpymnt_activity_age, valid_overpymnt_activity_subj, valid_overpymnt_activity_desc, valid_overpymnt_activity_ownr, valid_underpymnt_activity_date, valid_underpymnt_activity_age, valid_underpymnt_activity_subj, valid_underpymnt_activity_desc, valid_underpymnt_activity_ownr, validation_grp, discrepancy_group, credit, payer_category, model_issue, credit_balance_age, extract_date, collection_amt, collection_date, source_system_code, max_type5_trans_dt, dw_last_update_date, remit_drg_code, calc_base, last_remit_received_date
FROM hca-hin-qa-cur-parallon.`edwra_staging.edw_daily_discrepancy_bthr_08072025`;