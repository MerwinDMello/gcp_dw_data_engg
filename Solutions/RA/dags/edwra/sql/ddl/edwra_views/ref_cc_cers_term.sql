-- Translation time: 2024-02-16T20:48:08.013760Z
-- Translation job ID: 825ffe95-5d09-4d28-9bed-a2d58826a821
-- Source: internal_metastore/db_hca-hin-dev-cur-parallon/schema_edwra_views/ref_cc_cers_term.memory
-- Translated from: Teradata
-- Translated to: BigQuery

CREATE OR REPLACE VIEW {{ params.param_parallon_ra_views_dataset_name }}.ref_cc_cers_term
   OPTIONS(description='Concuity\'s calculation engine rate schedule term.')
  AS SELECT
      a.company_code,
      a.coid,
      a.cers_term_id,
      a.cers_profile_id,
      a.effective_date_method_id,
      a.cers_profile_comparison_id,
      a.comparison_calc_method_id,
      a.ipf_transition_calc_method_id,
      a.inpatient_reimb_method_id,
      a.outpatient_reimb_method_id,
      a.owner_user_id,
      a.asc_ranking_method_id,
      a.validated_by_user_id,
      a.drg_calc_method_id,
      a.gov_capital_method_id,
      a.ce_apc_profile_id,
      a.status_id,
      a.ce_profile_fee_schedule_id,
      a.cers_parent_term_id,
      a.irf_reimb_method_id,
      a.ce_irf_profile_id,
      a.ce_ipf_profile_id,
      a.drg_transfer_profile_id,
      a.snf_reimb_method_id,
      a.cob_method_id,
      a.apc_code_source_id,
      a.comparison_calc_level_id,
      a.gov_newtech_profile_id,
      a.ce_coins_fs_profile_id,
      a.ce_snf_profile_id,
      a.ce_state_tax_profile_id,
      a.ce_hierarchy_profile_id,
      a.inpatient_accrual_method_id,
      a.outpatient_accrual_method_id,
      a.ce_tri_er_profile_id,
      a.ce_tri_apc_profile_id,
      a.ce_atp_profile_id,
      a.ce_tri_drg_code_profile_id,
      a.coins_calc_pct_sel_id,
      a.gov_ime_component_id,
      a.cst_share_calc_pct_sel_id,
      a.drg_profile_id,
      a.icd_version_desc,
      a.cob_capped_ind,
      a.model_ind,
      a.validated_ind,
      a.generate_contractual_ind,
      a.generate_acct_calc_detail_ind,
      a.drg_breakout_transfer_ind,
      a.drg_breakout_expired_ind,
      a.drg_breakout_ama_ind,
      a.gov_dsh_ime_cst_outlr_ind,
      a.gov_include_scp_ind,
      a.ipf_inc_fsc_in_outlier_ind,
      a.ipf_inc_fsa_in_outlier_ind,
      a.xfer_drg_capped_std_rate_ind,
      a.apc_exclude_outlier_ind,
      a.include_gaf_ind,
      a.irf_rural_facility_ind,
      a.irf_teaching_facility_ind,
      a.tri_apc_sole_comm_hosp_ind,
      a.apc_rural_sole_comm_hosp_ind,
      a.gov_transfer_excluded_ind,
      a.gov_outlier_excluded_ind,
      a.gov_disregard_subterm_ind,
      a.valuated_ind,
      a.copay_ind,
      a.pat_resp_used_for_cob_ind,
      a.apc_rural_hosp_ind,
      a.effective_begin_date,
      a.effective_end_date,
      a.validated_date_time,
      a.cers_term_create_date,
      a.cers_term_update_date,
      a.drg_version,
      a.drg_type_code,
      a.comparison_calc_modifier_amt,
      a.gov_base_rate_amt,
      a.gov_labor_rate_amt,
      a.gov_wage_index_amt,
      a.gov_nonlabor_index_amt,
      a.gov_capital_federal_rate_amt,
      a.gov_geographical_factor_qty,
      a.gov_urban_add_on_factor_qty,
      a.gov_cst_liv_addon_factor_qty,
      a.gov_disp_share_oper_adj_amt,
      a.gov_disp_share_capital_adj_amt,
      a.gov_ind_med_edu_oper_adj_amt,
      a.gov_ind_med_edu_cap_adj_amt,
      a.gov_oper_cst_charge_ratio_qty,
      a.gov_cap_cst_charge_ratio_qty,
      a.gov_drg_threshold_adj_amt,
      a.gov_labor_share_amt,
      a.gov_disprpr_share_red_adj_amt,
      a.gov_oper_cost_of_livng_adj_amt,
      a.apc_federal_rate_amt,
      a.apc_wage_index_amt,
      a.apc_labor_percent_amt,
      a.apc_cost_charge_ratio_amt,
      a.apc_cost_threshold_amt,
      a.apc_cost_outlier_percent_amt,
      a.apc_pro_rata_adj_amt,
      a.apc_coinsurance_limit_amt,
      a.apc_deductible_amt,
      a.gov_scp_rate_amt,
      a.apc_fixed_threshold_amt,
      a.ipf_labor_share_amt,
      a.ipf_nonlabor_share_amt,
      a.ipf_labor_share_percent_amt,
      a.ipf_wage_index_amt,
      a.ipf_teaching_adj_factor_amt,
      a.ipf_cola_adj_factor_amt,
      a.ipf_fixed_loss_amt,
      a.ipf_cost_charge_ratio_amt,
      a.ipf_tefra_amt,
      a.ipf_pps_federal_percent_amt,
      a.ipf_tefra_hosp_percent_amt,
      a.gov_noscaasotc_adj_amt,
      a.irf_std_pmt_conv_factor_amt,
      a.irf_labor_share_amt,
      a.irf_cbsa_wage_index_amt,
      a.irf_lip_adj_amt,
      a.irf_cost_to_charge_ratio_amt,
      a.irf_adj_threshold_amt,
      a.irf_teaching_adj_amt,
      a.snf_cbsa_wage_index_amt,
      a.snf_icd9_042_multiplier_amt,
      a.xfer_add_los_qty,
      a.inpatient_accrual_value_amt,
      a.outpatient_accrual_value_amt,
      a.apc_bilateral_disc_fract_amt,
      a.apc_rural_sch_adj_amt,
      a.apc_terminated_dc_fract_amt,
      a.irf_outlier_percent_amt,
      a.tri_asa_labor_rel_prtn_amt,
      a.tri_asa_nonlabor_rel_prtn_amt,
      a.tri_wage_index_amt,
      a.tri_idme_adj_factor_amt,
      a.tri_shrt_stay_mar_cst_fctr_amt,
      a.tri_er_wage_index_amt,
      a.tri_er_labor_portion_amt,
      a.tri_er_nonlabor_portion_amt,
      a.tri_er_cost_share_percent_amt,
      a.tri_cost_to_chrg_ratio_amt,
      a.tri_noscastic_amt,
      a.tri_labor_share_percent_amt,
      a.tri_nonlabor_share_percent_amt,
      a.tri_apc_wage_index_amt,
      a.tri_apc_cost_chrg_ratio_amt,
      a.tri_apc_sch_adj_amt,
      a.tri_neonate_factor_amt,
      a.gov_subterm_outlier_pct_amt,
      a.copay_amt,
      a.gov_readm_adj_factor_amt,
      a.gov_vbj_adj_factor_amt,
      a.dsh_uncmps_care_addon_amt,
      a.implant_ccr_amt,
      a.low_vol_adj_fctr_amt,
      a.mdh_amt,
      a.irf_rural_adj_fctr_amt,
      a.ipf_rural_adj_fctr_amt,
      a.calc_base_choice_set_by_usr_nm,
      a.loa_profile_desc,
      a.comparison_calc_method_user_id,
      a.cers_term_activated_date_time,
      a.cers_term_updated_by_user_id,
      a.source_system_code,
      a.dw_last_update_date_time
    FROM
      {{ params.param_parallon_ra_base_views_dataset_name }}.ref_cc_cers_term AS a
      INNER JOIN {{ params.param_parallon_ra_base_views_dataset_name }}.secref_facility AS b ON rtrim(a.company_code) = rtrim(b.company_code)
       AND rtrim(a.coid) = rtrim(b.co_id)
       AND rtrim(b.user_id) = rtrim(session_user())
  ;
