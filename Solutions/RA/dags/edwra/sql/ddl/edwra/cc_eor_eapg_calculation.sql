-- Translation time: 2024-02-16T20:48:08.013760Z
-- Translation job ID: 825ffe95-5d09-4d28-9bed-a2d58826a821
-- Source: internal_metastore/db_hca-hin-dev-cur-parallon/schema_edwra/cc_eor_eapg_calculation.memory
-- Translated from: Teradata
-- Translated to: BigQuery

CREATE TABLE IF NOT EXISTS {{ params.param_parallon_ra_core_dataset_name }}.cc_eor_eapg_calculation
(
  patient_dw_id NUMERIC(29) NOT NULL OPTIONS(description='Unique ID for patient generated in EDW.'),
  payor_dw_id NUMERIC(29) NOT NULL OPTIONS(description='Used to distinguish one PAYOR from another.'),
  insurance_order_num INT64 NOT NULL OPTIONS(description='Indicates the precedence of payment liability for insurance plans associated with a patient:  primary, secondary, etc.'),
  eor_log_date DATE NOT NULL OPTIONS(description='First date (Month day and year) that this plan information became valid.'),
  log_id STRING NOT NULL OPTIONS(description='Code that indicates where to log estimated and actual payment information for the insured\'s associated insurance plan.'),
  log_sequence_num INT64 NOT NULL OPTIONS(description='Sequence number assigned to a record in logging.'),
  eff_from_date DATE NOT NULL OPTIONS(description='Concuity reimbursement calc date'),
  apg_calc_num BIGNUMERIC(38) NOT NULL OPTIONS(description='Unique ID generated by Concuity app for each calc output line item.'),
  adjustment_eapg_wgt NUMERIC(35, 6) OPTIONS(description='EAPG weight after discounting and consolidation.'),
  adjustment_factor_qty NUMERIC(34, 5) OPTIONS(description='The adjusted factor quantity with a given EAPG calculation.'),
  agency_edit_code STRING OPTIONS(description='A ten digit code that identifies the editing agency.'),
  ancillary_eapg_rate_amt NUMERIC(32, 3) OPTIONS(description='Ancillary EAPG Rate is the base rate to be used for significant diagnostic procedures and ancillary services. This rate will be used under certain circumstances starting with EAPG grouper version 3.12.'),
  auto_rate_ehnc_splmt_amt NUMERIC(32, 3) OPTIONS(description='The auto rate enhancement supplement applied to a given EAPG calculation.'),
  base_rate_amt NUMERIC(32, 3) OPTIONS(description='Base dollar amount for an EAPG rate.'),
  calc_method_id BIGNUMERIC(38) OPTIONS(description='The internal id relating the calculation to a given method.'),
  calc_profile_id BIGNUMERIC(38) OPTIONS(description='The internal id relating the calculation to a given profile.'),
  ce_rule_id BIGNUMERIC(38) OPTIONS(description='The internal id relating the calculation to a given calculation engine rule.'),
  ce_service_id BIGNUMERIC(38) OPTIONS(description='The internal id relating the calculation to a given calculation engine service.'),
  cers_term_id BIGNUMERIC(38) OPTIONS(description='A foregin key that establishes a relationship to a given rate schedule.'),
  claim_payment_status_code STRING OPTIONS(description='A ten digit code that represents the current status of a claim.'),
  claim_process_code STRING OPTIONS(description='Flag indicating the claim process status'),
  company_code STRING NOT NULL OPTIONS(description='Part of the unique identifier that identifies the company with which a facility is affiliated for application processing purposes.'),
  coid STRING NOT NULL OPTIONS(description='The company identifier which uniquely identifies a facility to corporate and all other facilities.'),
  cost_to_charge_ratio NUMERIC(34, 5) OPTIONS(description='The cost to charge ratio is the ratio between a hospital\'s expenses and what they charge. The closer the cost to charge ratio is to 1, the less difference there is between the actual costs incurred and the hospital\'s charges.'),
  creation_date DATE OPTIONS(description='The date when the EAPG calculation record was created.'),
  eapg_action_code STRING OPTIONS(description='Ties the action code to reference concuity enhanced all payer grouping action code to get the action description.'),
  eapg_bilateral_discount_code STRING OPTIONS(description='Ties the bilateral discount row from reference concuity enhanced all payer grouping bilateral discount code table for the description.'),
  eapg_cah_wgt NUMERIC(35, 6) OPTIONS(description='Line Item EAPG weight for critical access hospitals.Relative weight used in the EAPG payment calculation.'),
  eapg_category_code STRING OPTIONS(description='Final APG category number for the line item.'),
  eapg_code STRING OPTIONS(description='Final EAPG assignment for the line item.'),
  eapg_code_version_text STRING OPTIONS(description='Grouper version used during grouping\rGrouper version code used during calculation.'),
  eapg_payment_action_code STRING OPTIONS(description='Line item payment category.'),
  eapg_unassigned_code STRING OPTIONS(description='All unassigned codes for calculations grouped via the enhanced all payer grouping, 3M product.'),
  eapg_type_code STRING OPTIONS(description='Type of EAPG assignment associated with the Final EAPG.'),
  eapg_wgt NUMERIC(35, 6) OPTIONS(description='Relative weight used in EAPG Payment calculation.'),
  fee_file_id BIGNUMERIC(38) OPTIONS(description='A numeric identifier that ties an EAPG calculation to a specific fee.'),
  full_eapg_wgt NUMERIC(35, 6) OPTIONS(description='Unadjusted EAPG weigh for a given calculation.'),
  grouper_version_code STRING OPTIONS(description='Identifies the grouper type and version used for processing. The first 2 digits identify the grouper type. The last 3 digits identify the grouper version.'),
  hospital_type_text STRING OPTIONS(description='The type of hospital associated with the calculation.'),
  icd_version_desc STRING OPTIONS(description='Descriptive text of the International Classification of Diseases Version'),
  iplan_id INT64 OPTIONS(description='An identification code assigned to an insurance plan.  The first three digits identify the payor.  The last two uniquely identify a specific plan belonging to that payor.'),
  jw_modifier_ind STRING OPTIONS(description='JW Modifier Indicator identifies drug HCPCS line items reported with modifier. '),
  lab_payment_amt NUMERIC(32, 3) OPTIONS(description='Lab Payment Amount is the portion of the total payment associated with laboratory tests, after agency discounting is applied.'),
  li_adj_eapg_wgt NUMERIC(35, 6) OPTIONS(description='Line item adjusted EAPG weight is the relative weight used in the payment calculation.'),
  li_alternate_payment_amt NUMERIC(32, 3) OPTIONS(description='Payment based on alternate reimbursement methodology like HCPCS fee, HCPCS percent of charges, Revenue Code percent of charges.'),
  li_eapg_payment_amt NUMERIC(32, 3) OPTIONS(description='The relative calculated payment amount from the calculation.'),
  li_lab_payment_amt NUMERIC(32, 3) OPTIONS(description='The portion of the line item payment associated with laboratory tests, after agency discounting is applied.'),
  li_procedure_fee_amt NUMERIC(32, 3) OPTIONS(description='The fee contained in the HCPCS tables for the lab procedure.'),
  li_redistributed_charge_amt NUMERIC(32, 3) OPTIONS(description='Line Item Redistributed Charge Amount is used in determining the final line level payment based on the lesser of this value and the EAPG payment.'),
  li_user_defined_adj_amt NUMERIC(32, 3) OPTIONS(description='The adjustment to the total line item payment due to the user defined adjustment factor.'),
  modifier_1_code STRING OPTIONS(description='Modifier code associated with EAPG line item one.'),
  modifier_2_code STRING OPTIONS(description='Modifier code associated with EAPG line item two.'),
  modifier_3_code STRING OPTIONS(description='Modifier code associated with EAPG line item three.'),
  modifier_4_code STRING OPTIONS(description='Modifier code associated with EAPG line item four.'),
  modifier_5_code STRING OPTIONS(description='Modifier code associated with EAPG line item five.'),
  no_outlier_payment_amt NUMERIC(32, 3) OPTIONS(description='The outlier payment amount for a given calculation related to EAPG.'),
  noncov_charge_rank_1_amt NUMERIC(32, 3) OPTIONS(description='The noncovered charge amount for rank one.'),
  noncov_charge_rank_2_amt NUMERIC(32, 3) OPTIONS(description='The noncovered charge amount for rank two.'),
  noncov_charge_rank_3_amt NUMERIC(32, 3) OPTIONS(description='The noncovered charge amount for rank three.'),
  noncov_rank_1_qty INT64 OPTIONS(description='The noncovered charge quantity for rank one.'),
  noncov_rank_2_qty INT64 OPTIONS(description='The noncovered charge quantity for rank two.'),
  noncov_rank_3_qty INT64 OPTIONS(description='The noncovered charge quantity for rank three.'),
  outlier_adj_amt NUMERIC(34, 5) OPTIONS(description='The outlier adjustment applied to a calculation.'),
  pape_outlier_component_amt NUMERIC(32, 3) OPTIONS(description='The PAPE outlier component amount is the sum of the PAPE outlier component line item amounts.'),
  pape_payment_amt NUMERIC(32, 3) OPTIONS(description='The portion of the claim payment that is for qualifying non-lab charges on the per episode payment.'),
  pape_rate_amt NUMERIC(32, 3) OPTIONS(description='The rate for each hospital based on the statewide efficiency adjusted outpatient cost for MassHealth members and the intensity of MassHealth outpatient visits. MassHealth calculates this rate and provides it to hospitals.'),
  pat_acct_num NUMERIC(29) OPTIONS(description='Unique identification number assigned by the facility to a patient at admit/registration time.\r[F: 12-N]'),
  payment_pct NUMERIC(33, 4) OPTIONS(description='Indicates percentage of full payment.'),
  pkg_ind STRING OPTIONS(description='Packaging status derived from grouper logic.'),
  pkg_per_diem_ind STRING OPTIONS(description='Indicates whether or not the line item was packaged as part of the Per Diem EAPG logic.\r'),
  procedure_code STRING OPTIONS(description='HCPCS or CPT procedure code used in the calc.'),
  provider_policy_adj_amt NUMERIC(34, 5) OPTIONS(description='The adjusted amount billed based on the provider policy.'),
  reimbursement_type_code STRING OPTIONS(description='A ten digit field used to tie the type of reimbursement associated with a calculation record.'),
  repeat_anclry_discount_code STRING OPTIONS(description='Numeric indicator showing whether discounting is applied for repeated ancillary procedures.'),
  revenue_code STRING OPTIONS(description='Revenue code for the line item.'),
  service_date DATE OPTIONS(description='The date of service for an account based on the APG calculation.'),
  service_unit_paid_qty INT64 OPTIONS(description='The number of service units as a paid quantity.'),
  service_unit_qty INT64 OPTIONS(description='The number of service units as a quantity.'),
  sgnf_clnc_proc_csdt_ind STRING OPTIONS(description='Flag indicating whether consolidation applied for clinically significant procedures.'),
  sgnf_proc_csdt_ind STRING OPTIONS(description='Indicates whether or not same significant procedure consolidation applies for the line item.'),
  sgnf_proc_dc_cand_ind STRING OPTIONS(description='A one character field that indicates if a calculation qualifies for a procedure discount. Possible values are Y or N.'),
  state_file_id BIGNUMERIC(38) OPTIONS(description='The internal identifier used to relate an EAPG calculation to a state file record.'),
  termn_proc_dc_ind STRING OPTIONS(description='A one character field that indicates if a calculation qualifies for a terminated procedure discount. Possible values are Y or N.'),
  total_charge_amt NUMERIC(32, 3) OPTIONS(description='The total charge amount from the calculation.'),
  total_claim_payment_amt NUMERIC(32, 3) OPTIONS(description='The total claim payment amount from the calculation.'),
  total_covered_charge_amt NUMERIC(32, 3) OPTIONS(description='Total covered charges from the calculation.'),
  total_eapg_payment_amt NUMERIC(32, 3) OPTIONS(description='The total EAPG payment amount from the calculation.'),
  total_expected_payment_amt NUMERIC(32, 3) OPTIONS(description='The total expected payment amount derivied from the calculation.'),
  total_payment_amt NUMERIC(32, 3) OPTIONS(description='The total amount received in payments for a given calculated record.'),
  unit_num STRING OPTIONS(description='4-digit corporate assigned number which uniquely identifies each facility.\r[F:4/N]'),
  user_defined_adj_amt NUMERIC(32, 3) OPTIONS(description='The adjustment to the claim total payment due to the user-defined adjustment factor.'),
  visit_adj_eapg_wgt NUMERIC(35, 6) OPTIONS(description='EAPG weight after discounting and consolidation.'),
  visit_adj_pape_otlr_cmpnt_amt NUMERIC(32, 3) OPTIONS(description='Visit adjusted PAPE outlier component amount is the PAPE cost outlier payment for the visit.  PAPE is the abbreviation for payment per episode.'),
  visit_adj_pape_payment_amt NUMERIC(32, 3) OPTIONS(description='Visit adjusted PAPE payment amount is the total PAPE payment for the visit.  PAPE is the abbreviation for payment per episode.'),
  visit_atp_code STRING OPTIONS(description='ATP code used for payment in the event there is a lab panel payment for the date of service.'),
  visit_atp_payment_amt NUMERIC(32, 3) OPTIONS(description='The lab panel test payment for the date of service.'),
  visit_eapg_payment_amt NUMERIC(32, 3) OPTIONS(description='EAPG payment amount broken out by a single visit.'),
  visit_full_eapg_wgt NUMERIC(35, 6) OPTIONS(description='Weight(s) obtained directly from the weight file before adjustment.'),
  visit_id BIGNUMERIC(38) OPTIONS(description='Internal identifier of a related visit record.'),
  visit_no_outlier_payment_amt NUMERIC(32, 3) OPTIONS(description='Claim payment before cost outlier and add-on payments.'),
  smart_act_red_fac_ind INT64 OPTIONS(description='Act Reduction Facility Indicator indicates if\rthe facility is a SMART Act reduction facility. A\rvalue of 1 represents that the facility is a SMART\rAct reduction facility and a value of 0 indicates that\rit is not\r'),
  hcd_dvc_add_on_pymt_ind INT64 OPTIONS(description='High Cost Drug and Device Add On Payment\rIndicator indicates if the claim is eligible for high\rcost drug and/or device add-on payment. A value of\r1 represents that the claim is eligible for the\rpayment and a value of 0 indicates that it is not\r'),
  smart_actl_red_amt NUMERIC(32, 3) OPTIONS(description='SMART Act Reduction Amount is the dollar amount\rby which the claim payment is reduced via rules\rwithin the SMART Act.'),
  cost_otlr_pymt_amt NUMERIC(32, 3) OPTIONS(description='Cost Outlier Payment Amount is the sum of drug\rand device cost outlier payments on the claim.'),
  li_cost_otlr_pymt_amt NUMERIC(32, 3) OPTIONS(description='Line Item Cost Outlier Payment Amount is an\radditional line item payment for high cost cases.'),
  li_cost_otlr_thld_amt NUMERIC(32, 3) OPTIONS(description='Line Item Cost Outlier Threshold Amount is the\rsum of line item payment plus the cost add-on\rpayment fixed loss amount.'),
  li_eapg_cost NUMERIC(32, 3) OPTIONS(description='Line Item EAPG Cost is the total of the line item\rcharges multiplied by the cost-to-charge ratio.\r'),
  rehab_base_rate NUMERIC(35, 6) OPTIONS(description='Rehabilitation Base Rate is used for calculating\rrehab claims when a rehabilitation hospital or\rrehabilitation unit taxonomy code is present.'),
  psych_base_rate NUMERIC(35, 6) OPTIONS(description='Psychiatric Base Rate is used for calculating\rpsychiatric claims when a psychiatric hospital or\rpsychiatric unit taxonomy code is present.'),
  clm_rec_type_code STRING OPTIONS(description='Claim Record Type Code is a codified value that\rrepresents the overall record type for claims\rprocessed for the payer and is obtained from\rEAPG Grouping. The value of the 3M EAPG GPS\rattribute named Eapgsin_ClaimRecordType is\rstored in this column.'),
  source_system_code STRING OPTIONS(description='Identifies the system source for a given record.'),
  dw_last_update_date_time DATETIME OPTIONS(description='The last timestamp for an update in the EDW.')
)
CLUSTER BY patient_dw_id
OPTIONS(
  description='Concuity APG calculation output for calculations using enhanced all payer grouping or EAPG.'
);
