DECLARE DUP_COUNT INT64;

-- Translation time: 2025-03-24T19:00:36.316296Z
-- Translation job ID: a06adffd-7255-4680-b150-d2aa709466dc
-- Source: gs://eim-parallon-cs-datamig-dev-0002/ra_ddls_bulk_conversion/nm59fE/input/gr_eom.sql
-- Translated from: bteq
-- Translated to: BigQuery
 DECLARE _ERROR_CODE INT64;

DECLARE _ERROR_MSG STRING DEFAULT '';

---- bteq << EOF > /etl/ST/MC/CC_EDW/TgtFiles/GR_EOM.out;;
BEGIN
SET _ERROR_CODE = 0;

TRUNCATE TABLE `{{ params.param_parallon_ra_core_dataset_name }}`.cc_gr_eom;


EXCEPTION WHEN ERROR THEN
SET _ERROR_CODE = 1;


SET _ERROR_MSG = @@error.message;

END;

IF _ERROR_CODE <> 0 THEN RAISE USING MESSAGE = concat('Script terminated with return code: ', _ERROR_CODE, ' ', _ERROR_MSG);

END IF;

BEGIN
SET _ERROR_CODE = 0;

BEGIN TRANSACTION;


MERGE INTO `{{ params.param_parallon_ra_core_dataset_name }}`.cc_gr_eom AS mt USING
  (SELECT DISTINCT CAST(sum(cw_win_ss.patient_dw_id) OVER (ROWS UNBOUNDED PRECEDING) AS NUMERIC) AS patient_dw_id,
                   cw_win_ss.col0,
                   cw_win_ss.account_status_code,
                   cw_win_ss.col1,
                   cw_win_ss.col2,
                   cw_win_ss.col3,
                   cw_win_ss.col4,
                   cw_win_ss.col5,
                   cw_win_ss.auto_posted_flag,
                   cw_win_ss.col6,
                   cw_win_ss.claim_submit_date,
                   cw_win_ss.col7,
                   cw_win_ss.col8,
                   cw_win_ss.cmg_code,
                   cw_win_ss.col9,
                   cw_win_ss.col10,
                   cw_win_ss.coid,
                   cw_win_ss.col11,
                   cw_win_ss.company_code,
                   cw_win_ss.col12,
                   cw_win_ss.col13,
                   cw_win_ss.cost_report_year,
                   cw_win_ss.col14,
                   cw_win_ss.covered_days_los_cnt,
                   cw_win_ss.days_billed_cnt,
                   cw_win_ss.discharge_admit_date,
                   cw_win_ss.discharge_days_cnt,
                   cw_win_ss.col15,
                   cw_win_ss.drg_code,
                   cw_win_ss.col16,
                   cw_win_ss.col17,
                   cw_win_ss.dw_last_update_date_time,
                   cw_win_ss.col18,
                   cw_win_ss.col19,
                   cw_win_ss.exp_hipps_cmg_code,
                   cw_win_ss.facility_name,
                   cw_win_ss.col20,
                   cw_win_ss.col21,
                   cw_win_ss.col22,
                   cw_win_ss.col23,
                   cw_win_ss.col24,
                   cw_win_ss.col25,
                   cw_win_ss.col26,
                   cw_win_ss.col27,
                   cw_win_ss.col28,
                   cw_win_ss.col29,
                   cw_win_ss.col30,
                   cw_win_ss.col31,
                   cw_win_ss.col32,
                   cw_win_ss.pat_acct_num,
                   cw_win_ss.patient_name,
                   cw_win_ss.col33,
                   cw_win_ss.period_end_date,
                   cw_win_ss.col34,
                   cw_win_ss.col35,
                   cw_win_ss.col36,
                   cw_win_ss.col37,
                   cw_win_ss.ra_covered_days_cnt,
                   cw_win_ss.col38,
                   cw_win_ss.col39,
                   cw_win_ss.ra_drg_code,
                   cw_win_ss.ra_hipps_cmg_code,
                   cw_win_ss.col40,
                   cw_win_ss.col41,
                   cw_win_ss.col42,
                   cw_win_ss.col43,
                   cw_win_ss.col44,
                   cw_win_ss.col45,
                   cw_win_ss.ra_payment_date,
                   cw_win_ss.col46,
                   cw_win_ss.col47,
                   cw_win_ss.col48,
                   cw_win_ss.rate_schedule_name,
                   cw_win_ss.remit_cnt,
                   cw_win_ss.col49,
                   cw_win_ss.report_name,
                   cw_win_ss.report_run_date_time,
                   cw_win_ss.reporting_period,
                   cw_win_ss.col50,
                   cw_win_ss.section_month,
                   cw_win_ss.section_name,
                   cw_win_ss.col51,
                   cw_win_ss.col52,
                   cw_win_ss.col53,
                   cw_win_ss.col54,
                   cw_win_ss.col55,
                   cw_win_ss.col56,
                   cw_win_ss.col57,
                   cw_win_ss.col58,
                   cw_win_ss.col59,
                   cw_win_ss.col60,
                   cw_win_ss.col61,
                   cw_win_ss.unit_num,
                   cw_win_ss.var_cmg_flag,
                   cw_win_ss.col62,
                   cw_win_ss.col63,
                   cw_win_ss.col64,
                   cw_win_ss.var_covered_days_cnt,
                   cw_win_ss.col65,
                   cw_win_ss.var_drg_flag,
                   cw_win_ss.col66,
                   cw_win_ss.col67,
                   cw_win_ss.col68,
                   cw_win_ss.col69,
                   cw_win_ss.col70,
                   cw_win_ss.col71,
                   cw_win_ss.col72,
                   cw_win_ss.col73,
                   cw_win_ss.col74
   FROM
     (SELECT 1 AS patient_dw_id,
             CAST(ROUND(sum(b.account_balance_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col0,
             max(b.account_status_code) AS account_status_code,
             CAST(ROUND(sum(b.accrued_capital_subtotal_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col1,
             CAST(ROUND(sum(b.accrued_operating_subtotal_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col2,
             CAST(ROUND(sum(b.accrued_payment_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col3,
             CAST(ROUND(sum(b.apc_charges_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col4,
             CAST(ROUND(sum(b.apc_payment_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col5,
             max(b.auto_posted_flag) AS auto_posted_flag,
             CAST(ROUND(sum(b.capital_payment_subtotal_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col6,
             b.claim_submit_date,
             CAST(ROUND(sum(b.cmac_charge_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col7,
             CAST(ROUND(sum(b.cmac_payment_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col8,
             max(b.cmg_code) AS cmg_code,
             CAST(ROUND(sum(b.cmg_payment_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col9,
             CAST(ROUND(sum(b.cmg_weight_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col10,
             max(b.coid) AS coid,
             CAST(ROUND(sum(b.coinsurance_deductible_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col11,
             max(b.company_code) AS company_code,
             CAST(ROUND(sum(b.computed_reimb_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col12,
             CAST(ROUND(sum(b.cost_outlier_payment_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col13,
             max(b.cost_report_year) AS cost_report_year,
             CAST(ROUND(sum(b.covered_charges_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col14,
             b.covered_days_los_cnt,
             b.days_billed_cnt,
             b.discharge_admit_date,
             b.discharge_days_cnt,
             CAST(ROUND(sum(b.drg_arithmetic_los_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col15,
             max(b.drg_code) AS drg_code,
             CAST(ROUND(sum(b.drg_payment_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col16,
             CAST(ROUND(sum(b.drg_weight_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col17,
             b.dw_last_update_date_time,
             CAST(ROUND(sum(b.ect_payment_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col18,
             CAST(ROUND(sum(b.education_payment_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col19,
             max(b.exp_hipps_cmg_code) AS exp_hipps_cmg_code,
             max(b.facility_name) AS facility_name,
             CAST(ROUND(sum(b.fee_based_payment_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col20,
             CAST(ROUND(sum(b.idme_payment_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col21,
             CAST(ROUND(sum(b.lab_charge_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col22,
             CAST(ROUND(sum(b.lab_payment_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col23,
             CAST(ROUND(sum(b.lip_payment_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col24,
             CAST(ROUND(sum(b.non_covered_charges_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col25,
             CAST(ROUND(sum(b.operating_cost_outlier_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col26,
             CAST(ROUND(sum(b.operating_drg_payment_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col27,
             CAST(ROUND(sum(b.operating_dsh_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col28,
             CAST(ROUND(sum(b.operating_outlier_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col29,
             CAST(ROUND(sum(b.other_service_charge_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col30,
             CAST(ROUND(sum(b.other_service_payment_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col31,
             CAST(ROUND(sum(b.outlier_payment_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col32,
             b.pat_acct_num,
             max(b.patient_name) AS patient_name,
             CAST(ROUND(sum(b.payment_adj_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col33,
             b.period_end_date,
             CAST(ROUND(sum(b.prorated_drg_weight_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col34,
             CAST(ROUND(sum(b.ra_coinsurance_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col35,
             CAST(ROUND(sum(b.ra_contractual_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col36,
             CAST(ROUND(sum(b.ra_covered_charge_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col37,
             b.ra_covered_days_cnt,
             CAST(ROUND(sum(b.ra_deductible_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col38,
             CAST(ROUND(sum(b.ra_drg_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col39,
             max(b.ra_drg_code) AS ra_drg_code,
             max(b.ra_hipps_cmg_code) AS ra_hipps_cmg_code,
             CAST(ROUND(sum(b.ra_idme_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col40,
             CAST(ROUND(sum(b.ra_lab_payment_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col41,
             CAST(ROUND(sum(b.ra_operating_dsh_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col42,
             CAST(ROUND(sum(b.ra_operating_idme_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col43,
             CAST(ROUND(sum(b.ra_operating_outlier_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col44,
             CAST(ROUND(sum(b.ra_outlier_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col45,
             b.ra_payment_date,
             CAST(ROUND(sum(b.ra_therapy_payment_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col46,
             CAST(ROUND(sum(b.ra_total_capital_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col47,
             CAST(ROUND(sum(b.ra_total_payment_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col48,
             max(b.rate_schedule_name) AS rate_schedule_name,
             b.remit_cnt,
             CAST(ROUND(sum(b.replace_device_reduction_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col49,
             max(b.report_name) AS report_name,
             b.report_run_date_time,
             max(b.reporting_period) AS reporting_period,
             CAST(ROUND(sum(b.rug_payment_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col50,
             max(b.section_month) AS section_month,
             max(b.section_name) AS section_name,
             CAST(ROUND(sum(b.sequestration_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col51,
             CAST(ROUND(sum(b.short_stay_outlier_payment_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col52,
             CAST(ROUND(sum(b.tech_add_on_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col53,
             CAST(ROUND(sum(b.tech_add_on_payment_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col54,
             CAST(ROUND(sum(b.therapy_charge_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col55,
             CAST(ROUND(sum(b.therapy_payment_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col56,
             CAST(ROUND(sum(b.total_charge_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col57,
             CAST(ROUND(sum(b.total_expected_payment_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col58,
             CAST(ROUND(sum(b.total_opr_cptl_payment_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col59,
             CAST(ROUND(sum(b.total_payment_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col60,
             CAST(ROUND(sum(b.transfer_payment_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col61,
             max(b.unit_num) AS unit_num,
             max(b.var_cmg_flag) AS var_cmg_flag,
             CAST(ROUND(sum(b.var_coinsurance_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col62,
             CAST(ROUND(sum(b.var_contractual_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col63,
             CAST(ROUND(sum(b.var_covered_charges_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col64,
             b.var_covered_days_cnt,
             CAST(ROUND(sum(b.var_deductible_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col65,
             max(b.var_drg_flag) AS var_drg_flag,
             CAST(ROUND(sum(b.var_imed_educ_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col66,
             CAST(ROUND(sum(b.var_lab_payment_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col67,
             CAST(ROUND(sum(b.var_operating_dsh_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col68,
             CAST(ROUND(sum(b.var_operating_ime_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col69,
             CAST(ROUND(sum(b.var_operating_outlier_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col70,
             CAST(ROUND(sum(b.var_outlier_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col71,
             CAST(ROUND(sum(b.var_therapy_payment_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col72,
             CAST(ROUND(sum(b.var_total_capital_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col73,
             CAST(ROUND(sum(b.var_total_payment_amt), 3, 'ROUND_HALF_EVEN') AS NUMERIC) AS col74,
             upper(b.coid) AS cw_win_part_0,
             upper(b.company_code) AS cw_win_part_1
      FROM
        (SELECT NUMERIC '0.000' AS account_balance_amt,
                '' AS account_status_code,
                NUMERIC '0.000' AS accrued_capital_subtotal_amt,
                NUMERIC '0.000' AS accrued_operating_subtotal_amt,
                NUMERIC '0.000' AS accrued_payment_amt,
                NUMERIC '0.000' AS apc_charges_amt,
                NUMERIC '0.000' AS apc_payment_amt,
                'N' AS auto_posted_flag,
                ROUND(cclog24mcrip.capital_payment_subtotal, 3, 'ROUND_HALF_EVEN') AS capital_payment_subtotal_amt,
                parse_date('%Y-%m-%d', '1900-01-01') AS claim_submit_date,
                NUMERIC '0.000' AS cmac_charge_amt,
                NUMERIC '0.000' AS cmac_payment_amt,
                '' AS cmg_code,
                NUMERIC '0.000' AS cmg_payment_amt,
                NUMERIC '0.000' AS cmg_weight_amt,
                cclog24mcrip.coid AS coid,
                NUMERIC '0.000' AS coinsurance_deductible_amt,
                'N' AS company_code,
                NUMERIC '0.000' AS computed_reimb_amt,
                NUMERIC '0.000' AS cost_outlier_payment_amt,
                '' AS cost_report_year,
                ROUND(cclog24mcrip.covered_charges, 3, 'ROUND_HALF_EVEN') AS covered_charges_amt,
                cclog24mcrip.covered_days AS covered_days_los_cnt,
                0 AS days_billed_cnt,
                parse_date('%Y-%m-%d', '1900-01-01') AS discharge_admit_date,
                0 AS discharge_days_cnt,
                NUMERIC '0.000' AS drg_arithmetic_los_amt,
                '' AS drg_code,
                NUMERIC '0.000' AS drg_payment_amt,
                ROUND(cclog24mcrip.drg_weight, 3, 'ROUND_HALF_EVEN') AS drg_weight_amt,
                datetime_trunc(current_datetime('US/Central'), SECOND) AS dw_last_update_date_time,
                NUMERIC '0.000' AS ect_payment_amt,
                NUMERIC '0.000' AS education_payment_amt,
                '' AS exp_hipps_cmg_code,
                TRIM(substr(cclog24mcrip.facility_name, 1, 50)) AS facility_name,
                ROUND(cclog24mcrip.fee_based_payment, 3, 'ROUND_HALF_EVEN') AS fee_based_payment_amt,
                NUMERIC '0.000' AS idme_payment_amt,
                NUMERIC '0.000' AS lab_charge_amt,
                NUMERIC '0.000' AS lab_payment_amt,
                NUMERIC '0.000' AS lip_payment_amt,
                NUMERIC '0.000' AS non_covered_charges_amt,
                NUMERIC '0.000' AS operating_cost_outlier_amt,
                ROUND(cclog24mcrip.operating_drg_payment, 3, 'ROUND_HALF_EVEN') AS operating_drg_payment_amt,
                NUMERIC '0.000' AS operating_dsh_amt,
                ROUND(cclog24mcrip.operating_outlier_payment, 3, 'ROUND_HALF_EVEN') AS operating_outlier_amt,
                NUMERIC '0.000' AS other_service_charge_amt,
                NUMERIC '0.000' AS other_service_payment_amt,
                NUMERIC '0.000' AS outlier_payment_amt,
                ROUND(CAST(`{{ params.param_bqutil_fns_dataset_name }}`.cw_td_normalize_number(CASE
                                                                                                 WHEN cclog24mcrip.account_number LIKE '%*%' THEN translate(cclog24mcrip.account_number, '*', '')
                                                                                                 ELSE cclog24mcrip.account_number
                                                                                             END) AS NUMERIC), 0, 'ROUND_HALF_EVEN') AS pat_acct_num, -- CAST( '0.00' as DECIMAL(18,3)) as Patient_DW_Id,
 TRIM(substr(cclog24mcrip.patient_name, 1, 50)) AS patient_name,
 NUMERIC '0.000' AS payment_adj_amt,
 LAST_DAY(parse_date('%B %Y', cclog24mcrip.period_end_date)) AS period_end_date,
 NUMERIC '0.000' AS prorated_drg_weight_amt,
 NUMERIC '0.000' AS ra_coinsurance_amt,
 NUMERIC '0.000' AS ra_contractual_amt,
 NUMERIC '0.000' AS ra_covered_charge_amt,
 0 AS ra_covered_days_cnt,
 NUMERIC '0.000' AS ra_deductible_amt,
 NUMERIC '0.000' AS ra_drg_amt,
 '' AS ra_drg_code,
 '' AS ra_hipps_cmg_code,
 NUMERIC '0.000' AS ra_idme_amt,
 NUMERIC '0.000' AS ra_lab_payment_amt,
 NUMERIC '0.000' AS ra_operating_dsh_amt,
 NUMERIC '0.000' AS ra_operating_idme_amt,
 NUMERIC '0.000' AS ra_operating_outlier_amt,
 NUMERIC '0.000' AS ra_outlier_amt,
 parse_date('%Y-%m-%d', '1900-01-01') AS ra_payment_date,
 NUMERIC '0.000' AS ra_therapy_payment_amt,
 NUMERIC '0.000' AS ra_total_capital_amt,
 NUMERIC '0.000' AS ra_total_payment_amt,
 TRIM(substr(cclog24mcrip.rate_schedule_name, 1, 100)) AS rate_schedule_name,
 0 AS remit_cnt,
 ROUND(cclog24mcrip.replace_device_reduction, 3, 'ROUND_HALF_EVEN') AS replace_device_reduction_amt,
 TRIM(substr(cclog24mcrip.report_name, 1, 100)) AS report_name,
 datetime_trunc(current_datetime('US/Central'), SECOND) AS report_run_date_time,
 substr(cclog24mcrip.reporting_period, 1, 25) AS reporting_period,
 NUMERIC '0.000' AS rug_payment_amt,
 '' AS section_month,
 TRIM(substr(cclog24mcrip.section_name, 1, 100)) AS section_name,
 ROUND(cclog24mcrip.seq, 3, 'ROUND_HALF_EVEN') AS sequestration_amt,
 NUMERIC '0.000' AS short_stay_outlier_payment_amt, -- CAST( '0.00' as DECIMAL(18,3)) as Source_System_Code,
 NUMERIC '0.000' AS tech_add_on_amt,
 ROUND(cclog24mcrip.tech_add_on_payment, 3, 'ROUND_HALF_EVEN') AS tech_add_on_payment_amt,
 NUMERIC '0.000' AS therapy_charge_amt,
 NUMERIC '0.000' AS therapy_payment_amt,
 ROUND(cclog24mcrip.total_charges, 3, 'ROUND_HALF_EVEN') AS total_charge_amt,
 NUMERIC '0.000' AS total_expected_payment_amt,
 NUMERIC '0.000' AS total_opr_cptl_payment_amt,
 NUMERIC '0.000' AS total_payment_amt,
 NUMERIC '0.000' AS transfer_payment_amt,
 cclog24mcrip.unit_number AS unit_num,
 'N' AS var_cmg_flag,
 NUMERIC '0.000' AS var_coinsurance_amt,
 NUMERIC '0.000' AS var_contractual_amt,
 NUMERIC '0.000' AS var_covered_charges_amt,
 0 AS var_covered_days_cnt,
 NUMERIC '0.000' AS var_deductible_amt,
 'N' AS var_drg_flag,
 NUMERIC '0.000' AS var_imed_educ_amt,
 NUMERIC '0.000' AS var_lab_payment_amt,
 NUMERIC '0.000' AS var_operating_dsh_amt,
 NUMERIC '0.000' AS var_operating_ime_amt,
 NUMERIC '0.000' AS var_operating_outlier_amt,
 NUMERIC '0.000' AS var_outlier_amt,
 NUMERIC '0.000' AS var_therapy_payment_amt,
 NUMERIC '0.000' AS var_total_capital_amt,
 NUMERIC '0.000' AS var_total_payment_amt
         FROM `{{ params.param_parallon_ra_stage_dataset_name }}`.cclog24mcrip
         UNION DISTINCT SELECT NUMERIC '0.000' AS account_balance_amt,
                               '' AS account_status_code,
                               NUMERIC '0.000' AS accrued_capital_subtotal_amt,
                               NUMERIC '0.000' AS accrued_operating_subtotal_amt,
                               NUMERIC '0.000' AS accrued_payment_amt,
                               ROUND(cclog24mcripb.apc_charges, 3, 'ROUND_HALF_EVEN') AS apc_charges_amt,
                               ROUND(cclog24mcripb.apc_payments, 3, 'ROUND_HALF_EVEN') AS apc_payment_amt,
                               'N' AS auto_posted_flag,
                               NUMERIC '0.000' AS capital_payment_subtotal_amt,
                               parse_date('%Y-%m-%d', '1900-01-01') AS claim_submit_date,
                               NUMERIC '0.000' AS cmac_charge_amt,
                               NUMERIC '0.000' AS cmac_payment_amt,
                               '' AS cmg_code,
                               NUMERIC '0.000' AS cmg_payment_amt,
                               NUMERIC '0.000' AS cmg_weight_amt,
                               cclog24mcripb.coid AS coid,
                               NUMERIC '0.000' AS coinsurance_deductible_amt,
                               'N' AS company_code,
                               NUMERIC '0.000' AS computed_reimb_amt,
                               NUMERIC '0.000' AS cost_outlier_payment_amt,
                               '' AS cost_report_year,
                               ROUND(cclog24mcripb.covered_charges, 3, 'ROUND_HALF_EVEN') AS covered_charges_amt,
                               0 AS covered_days_los_cnt,
                               0 AS days_billed_cnt,
                               parse_date('%Y-%m-%d', '1900-01-01') AS discharge_admit_date,
                               0 AS discharge_days_cnt,
                               NUMERIC '0.000' AS drg_arithmetic_los_amt,
                               '' AS drg_code,
                               NUMERIC '0.000' AS drg_payment_amt,
                               NUMERIC '0.000' AS drg_weight_amt,
                               datetime_trunc(current_datetime('US/Central'), SECOND) AS dw_last_update_date_time,
                               NUMERIC '0.000' AS ect_payment_amt,
                               NUMERIC '0.000' AS education_payment_amt,
                               '' AS exp_hipps_cmg_code,
                               TRIM(substr(cclog24mcripb.facility_name, 1, 50)) AS facility_name,
                               NUMERIC '0.000' AS fee_based_payment_amt,
                               NUMERIC '0.000' AS idme_payment_amt,
                               ROUND(cclog24mcripb.lab_charges, 3, 'ROUND_HALF_EVEN') AS lab_charge_amt,
                               ROUND(cclog24mcripb.lab_payments, 3, 'ROUND_HALF_EVEN') AS lab_payment_amt,
                               NUMERIC '0.000' AS lip_payment_amt,
                               ROUND(cclog24mcripb.non_covered_charges, 3, 'ROUND_HALF_EVEN') AS non_covered_charges_amt,
                               NUMERIC '0.000' AS operating_cost_outlier_amt,
                               NUMERIC '0.000' AS operating_drg_payment_amt,
                               NUMERIC '0.000' AS operating_dsh_amt,
                               NUMERIC '0.000' AS operating_outlier_amt,
                               ROUND(cclog24mcripb.other_service_charges, 3, 'ROUND_HALF_EVEN') AS other_service_charge_amt,
                               ROUND(cclog24mcripb.other_service_payments, 3, 'ROUND_HALF_EVEN') AS other_service_payment_amt,
                               ROUND(cclog24mcripb.outlier_payments, 3, 'ROUND_HALF_EVEN') AS outlier_payment_amt,
                               ROUND(CAST(`{{ params.param_bqutil_fns_dataset_name }}`.cw_td_normalize_number(CASE
                                                                                                                WHEN cclog24mcripb.account_number LIKE '%*%' THEN translate(cclog24mcripb.account_number, '*', '')
                                                                                                                ELSE cclog24mcripb.account_number
                                                                                                            END) AS NUMERIC), 0, 'ROUND_HALF_EVEN') AS pat_acct_num, -- CAST( '0.00' as DECIMAL(18,3)) as Patient_DW_Id,
 TRIM(substr(cclog24mcripb.patient_name, 1, 50)) AS patient_name,
 ROUND(cclog24mcripb.payment_adjustments, 3, 'ROUND_HALF_EVEN') AS payment_adj_amt,
 LAST_DAY(parse_date('%B %Y', cclog24mcripb.period_end_date)) AS period_end_date,
 NUMERIC '0.000' AS prorated_drg_weight_amt,
 NUMERIC '0.000' AS ra_coinsurance_amt,
 NUMERIC '0.000' AS ra_contractual_amt,
 NUMERIC '0.000' AS ra_covered_charge_amt,
 0 AS ra_covered_days_cnt,
 NUMERIC '0.000' AS ra_deductible_amt,
 NUMERIC '0.000' AS ra_drg_amt,
 '' AS ra_drg_code,
 '' AS ra_hipps_cmg_code,
 NUMERIC '0.000' AS ra_idme_amt,
 NUMERIC '0.000' AS ra_lab_payment_amt,
 NUMERIC '0.000' AS ra_operating_dsh_amt,
 NUMERIC '0.000' AS ra_operating_idme_amt,
 NUMERIC '0.000' AS ra_operating_outlier_amt,
 NUMERIC '0.000' AS ra_outlier_amt,
 parse_date('%Y-%m-%d', '1900-01-01') AS ra_payment_date,
 NUMERIC '0.000' AS ra_therapy_payment_amt,
 NUMERIC '0.000' AS ra_total_capital_amt,
 NUMERIC '0.000' AS ra_total_payment_amt,
 TRIM(substr(cclog24mcripb.rate_schedule_name, 1, 100)) AS rate_schedule_name,
 0 AS remit_cnt,
 NUMERIC '0.000' AS replace_device_reduction_amt,
 TRIM(substr(cclog24mcripb.report_name, 1, 100)) AS report_name,
 datetime_trunc(current_datetime('US/Central'), SECOND) AS report_run_date_time,
 substr(cclog24mcripb.reporting_period, 1, 25) AS reporting_period,
 NUMERIC '0.000' AS rug_payment_amt,
 '' AS section_month,
 TRIM(substr(cclog24mcripb.section_name, 1, 100)) AS section_name,
 ROUND(cclog24mcripb.seq, 3, 'ROUND_HALF_EVEN') AS sequestration_amt,
 NUMERIC '0.000' AS short_stay_outlier_payment_amt, -- CAST( '0.00' as DECIMAL(18,3)) as Source_System_Code,
 NUMERIC '0.000' AS tech_add_on_amt,
 NUMERIC '0.000' AS tech_add_on_payment_amt,
 ROUND(cclog24mcripb.therapy_charges, 3, 'ROUND_HALF_EVEN') AS therapy_charge_amt,
 ROUND(cclog24mcripb.therapy_payments, 3, 'ROUND_HALF_EVEN') AS therapy_payment_amt,
 ROUND(cclog24mcripb.total_charges, 3, 'ROUND_HALF_EVEN') AS total_charge_amt,
 NUMERIC '0.000' AS total_expected_payment_amt,
 NUMERIC '0.000' AS total_opr_cptl_payment_amt,
 NUMERIC '0.000' AS total_payment_amt,
 NUMERIC '0.000' AS transfer_payment_amt,
 cclog24mcripb.unit_number AS unit_num,
 'N' AS var_cmg_flag,
 NUMERIC '0.000' AS var_coinsurance_amt,
 NUMERIC '0.000' AS var_contractual_amt,
 NUMERIC '0.000' AS var_covered_charges_amt,
 0 AS var_covered_days_cnt,
 NUMERIC '0.000' AS var_deductible_amt,
 'N' AS var_drg_flag,
 NUMERIC '0.000' AS var_imed_educ_amt,
 NUMERIC '0.000' AS var_lab_payment_amt,
 NUMERIC '0.000' AS var_operating_dsh_amt,
 NUMERIC '0.000' AS var_operating_ime_amt,
 NUMERIC '0.000' AS var_operating_outlier_amt,
 NUMERIC '0.000' AS var_outlier_amt,
 NUMERIC '0.000' AS var_therapy_payment_amt,
 NUMERIC '0.000' AS var_total_capital_amt,
 NUMERIC '0.000' AS var_total_payment_amt
         FROM `{{ params.param_parallon_ra_stage_dataset_name }}`.cclog24mcripb
         UNION DISTINCT SELECT NUMERIC '0.000' AS account_balance_amt,
                               '' AS account_status_code,
                               NUMERIC '0.000' AS accrued_capital_subtotal_amt,
                               NUMERIC '0.000' AS accrued_operating_subtotal_amt,
                               NUMERIC '0.000' AS accrued_payment_amt,
                               NUMERIC '0.000' AS apc_charges_amt,
                               NUMERIC '0.000' AS apc_payment_amt,
                               '' AS auto_posted_flag,
                               NUMERIC '0.000' AS capital_payment_subtotal_amt,
                               parse_date('%Y-%m-%d', '1900-01-01') AS claim_submit_date,
                               NUMERIC '0.000' AS cmac_charge_amt,
                               NUMERIC '0.000' AS cmac_payment_amt,
                               '' AS cmg_code,
                               NUMERIC '0.000' AS cmg_payment_amt,
                               NUMERIC '0.000' AS cmg_weight_amt,
                               '' AS coid,
                               NUMERIC '0.000' AS coinsurance_deductible_amt,
                               'N' AS company_code,
                               ROUND(cclog24mcripcah.computed_reimbursement, 3, 'ROUND_HALF_EVEN') AS computed_reimb_amt,
                               NUMERIC '0.000' AS cost_outlier_payment_amt,
                               '' AS cost_report_year,
                               ROUND(cclog24mcripcah.covered_charges, 3, 'ROUND_HALF_EVEN') AS covered_charges_amt,
                               CAST(`{{ params.param_bqutil_fns_dataset_name }}`.cw_td_normalize_number('0.00') AS INT64) AS covered_days_los_cnt,
                               0 AS days_billed_cnt,
                               parse_date('%Y-%m-%d', '1900-01-01') AS discharge_admit_date,
                               0 AS discharge_days_cnt,
                               NUMERIC '0.000' AS drg_arithmetic_los_amt,
                               '' AS drg_code,
                               NUMERIC '0.000' AS drg_payment_amt,
                               NUMERIC '0.000' AS drg_weight_amt,
                               datetime_trunc(current_datetime('US/Central'), SECOND) AS dw_last_update_date_time,
                               NUMERIC '0.000' AS ect_payment_amt,
                               NUMERIC '0.000' AS education_payment_amt,
                               '' AS exp_hipps_cmg_code,
                               TRIM(substr(cclog24mcripcah.facility_name, 1, 50)) AS facility_name,
                               NUMERIC '0.000' AS fee_based_payment_amt,
                               NUMERIC '0.000' AS idme_payment_amt,
                               NUMERIC '0.000' AS lab_charge_amt,
                               NUMERIC '0.000' AS lab_payment_amt,
                               NUMERIC '0.000' AS lip_payment_amt,
                               NUMERIC '0.000' AS non_covered_charges_amt,
                               NUMERIC '0.000' AS operating_cost_outlier_amt,
                               NUMERIC '0.000' AS operating_drg_payment_amt,
                               NUMERIC '0.000' AS operating_dsh_amt,
                               NUMERIC '0.000' AS operating_outlier_amt,
                               NUMERIC '0.000' AS other_service_charge_amt,
                               NUMERIC '0.000' AS other_service_payment_amt,
                               NUMERIC '0.000' AS outlier_payment_amt,
                               ROUND(CAST(`{{ params.param_bqutil_fns_dataset_name }}`.cw_td_normalize_number(CASE
                                                                                                                WHEN cclog24mcripcah.account_number LIKE '%*%' THEN translate(cclog24mcripcah.account_number, '*', '')
                                                                                                                ELSE cclog24mcripcah.account_number
                                                                                                            END) AS NUMERIC), 0, 'ROUND_HALF_EVEN') AS pat_acct_num, -- CAST( '0.00' as DECIMAL(18,3)) as Patient_DW_Id,
 TRIM(substr(cclog24mcripcah.patient_name, 1, 50)) AS patient_name,
 NUMERIC '0.000' AS payment_adj_amt,
 LAST_DAY(parse_date('%B %Y', cclog24mcripcah.period_end_date)) AS period_end_date,
 NUMERIC '0.000' AS prorated_drg_weight_amt,
 NUMERIC '0.000' AS ra_coinsurance_amt,
 NUMERIC '0.000' AS ra_contractual_amt,
 NUMERIC '0.000' AS ra_covered_charge_amt,
 0 AS ra_covered_days_cnt,
 NUMERIC '0.000' AS ra_deductible_amt,
 NUMERIC '0.000' AS ra_drg_amt,
 '' AS ra_drg_code,
 '' AS ra_hipps_cmg_code,
 NUMERIC '0.000' AS ra_idme_amt,
 NUMERIC '0.000' AS ra_lab_payment_amt,
 NUMERIC '0.000' AS ra_operating_dsh_amt,
 NUMERIC '0.000' AS ra_operating_idme_amt,
 NUMERIC '0.000' AS ra_operating_outlier_amt,
 NUMERIC '0.000' AS ra_outlier_amt,
 parse_date('%Y-%m-%d', '1900-01-01') AS ra_payment_date,
 NUMERIC '0.000' AS ra_therapy_payment_amt,
 NUMERIC '0.000' AS ra_total_capital_amt,
 NUMERIC '0.000' AS ra_total_payment_amt,
 TRIM(substr(cclog24mcripcah.rate_schedule_name, 1, 100)) AS rate_schedule_name,
 0 AS remit_cnt,
 NUMERIC '0.000' AS replace_device_reduction_amt,
 '0.00' AS report_name,
 datetime_trunc(current_datetime('US/Central'), SECOND) AS report_run_date_time,
 substr(cclog24mcripcah.reporting_period, 1, 25) AS reporting_period,
 NUMERIC '0.000' AS rug_payment_amt,
 '' AS section_month,
 TRIM(substr(cclog24mcripcah.section_name, 1, 100)) AS section_name,
 ROUND(cclog24mcripcah.seq, 3, 'ROUND_HALF_EVEN') AS sequestration_amt,
 NUMERIC '0.000' AS short_stay_outlier_payment_amt, -- CAST( '0.00' as DECIMAL(18,3)) as Source_System_Code,
 NUMERIC '0.000' AS tech_add_on_amt,
 NUMERIC '0.000' AS tech_add_on_payment_amt,
 NUMERIC '0.000' AS therapy_charge_amt,
 NUMERIC '0.000' AS therapy_payment_amt,
 ROUND(cclog24mcripcah.total_charges, 3, 'ROUND_HALF_EVEN') AS total_charge_amt,
 NUMERIC '0.000' AS total_expected_payment_amt,
 NUMERIC '0.000' AS total_opr_cptl_payment_amt,
 NUMERIC '0.000' AS total_payment_amt,
 NUMERIC '0.000' AS transfer_payment_amt,
 cclog24mcripcah.unit_number AS unit_num,
 'N' AS var_cmg_flag,
 NUMERIC '0.000' AS var_coinsurance_amt,
 NUMERIC '0.000' AS var_contractual_amt,
 NUMERIC '0.000' AS var_covered_charges_amt,
 0 AS var_covered_days_cnt,
 NUMERIC '0.000' AS var_deductible_amt,
 'N' AS var_drg_flag,
 NUMERIC '0.000' AS var_imed_educ_amt,
 NUMERIC '0.000' AS var_lab_payment_amt,
 NUMERIC '0.000' AS var_operating_dsh_amt,
 NUMERIC '0.000' AS var_operating_ime_amt,
 NUMERIC '0.000' AS var_operating_outlier_amt,
 NUMERIC '0.000' AS var_outlier_amt,
 NUMERIC '0.000' AS var_therapy_payment_amt,
 NUMERIC '0.000' AS var_total_capital_amt,
 NUMERIC '0.000' AS var_total_payment_amt
         FROM `{{ params.param_parallon_ra_stage_dataset_name }}`.cclog24mcripcah
         UNION DISTINCT SELECT NUMERIC '0.000' AS account_balance_amt,
                               '' AS account_status_code,
                               NUMERIC '0.000' AS accrued_capital_subtotal_amt,
                               NUMERIC '0.000' AS accrued_operating_subtotal_amt,
                               NUMERIC '0.000' AS accrued_payment_amt,
                               NUMERIC '0.000' AS apc_charges_amt,
                               NUMERIC '0.000' AS apc_payment_amt,
                               'N' AS auto_posted_flag,
                               NUMERIC '0.000' AS capital_payment_subtotal_amt,
                               parse_date('%Y-%m-%d', '1900-01-01') AS claim_submit_date,
                               NUMERIC '0.000' AS cmac_charge_amt,
                               NUMERIC '0.000' AS cmac_payment_amt,
                               '' AS cmg_code,
                               NUMERIC '0.000' AS cmg_payment_amt,
                               NUMERIC '0.000' AS cmg_weight_amt,
                               cclog24mcripbcah.coid AS coid,
                               NUMERIC '0.000' AS coinsurance_deductible_amt,
                               'N' AS company_code,
                               ROUND(cclog24mcripbcah.computed_reimbursement, 3, 'ROUND_HALF_EVEN') AS computed_reimb_amt,
                               NUMERIC '0.000' AS cost_outlier_payment_amt,
                               '' AS cost_report_year,
                               ROUND(cclog24mcripbcah.covered_charges, 3, 'ROUND_HALF_EVEN') AS covered_charges_amt,
                               CAST(`{{ params.param_bqutil_fns_dataset_name }}`.cw_td_normalize_number('0.00') AS INT64) AS covered_days_los_cnt,
                               0 AS days_billed_cnt,
                               parse_date('%Y-%m-%d', '1900-01-01') AS discharge_admit_date,
                               0 AS discharge_days_cnt,
                               NUMERIC '0.000' AS drg_arithmetic_los_amt,
                               '' AS drg_code,
                               NUMERIC '0.000' AS drg_payment_amt,
                               NUMERIC '0.000' AS drg_weight_amt,
                               datetime_trunc(current_datetime('US/Central'), SECOND) AS dw_last_update_date_time,
                               NUMERIC '0.000' AS ect_payment_amt,
                               NUMERIC '0.000' AS education_payment_amt,
                               '' AS exp_hipps_cmg_code,
                               TRIM(substr(cclog24mcripbcah.facility_name, 1, 50)) AS facility_name,
                               ROUND(cclog24mcripbcah.fee_based_payments, 3, 'ROUND_HALF_EVEN') AS fee_based_payment_amt,
                               NUMERIC '0.000' AS idme_payment_amt,
                               NUMERIC '0.000' AS lab_charge_amt,
                               NUMERIC '0.000' AS lab_payment_amt,
                               NUMERIC '0.000' AS lip_payment_amt,
                               ROUND(cclog24mcripbcah.non_covered_charges, 3, 'ROUND_HALF_EVEN') AS non_covered_charges_amt,
                               NUMERIC '0.000' AS operating_cost_outlier_amt,
                               NUMERIC '0.000' AS operating_drg_payment_amt,
                               NUMERIC '0.000' AS operating_dsh_amt,
                               NUMERIC '0.000' AS operating_outlier_amt,
                               NUMERIC '0.000' AS other_service_charge_amt,
                               NUMERIC '0.000' AS other_service_payment_amt,
                               NUMERIC '0.000' AS outlier_payment_amt,
                               ROUND(CAST(`{{ params.param_bqutil_fns_dataset_name }}`.cw_td_normalize_number(CASE
                                                                                                                WHEN cclog24mcripbcah.account_number LIKE '%*%' THEN translate(cclog24mcripbcah.account_number, '*', '')
                                                                                                                ELSE cclog24mcripbcah.account_number
                                                                                                            END) AS NUMERIC), 0, 'ROUND_HALF_EVEN') AS pat_acct_num, -- CAST( '0.00' as DECIMAL(18,3)) as Patient_DW_Id,
 TRIM(substr(cclog24mcripbcah.patient_name, 1, 50)) AS patient_name,
 NUMERIC '0.000' AS payment_adj_amt,
 LAST_DAY(parse_date('%B %Y', cclog24mcripbcah.period_end_date)) AS period_end_date,
 NUMERIC '0.000' AS prorated_drg_weight_amt,
 NUMERIC '0.000' AS ra_coinsurance_amt,
 NUMERIC '0.000' AS ra_contractual_amt,
 NUMERIC '0.000' AS ra_covered_charge_amt,
 0 AS ra_covered_days_cnt,
 NUMERIC '0.000' AS ra_deductible_amt,
 NUMERIC '0.000' AS ra_drg_amt,
 '' AS ra_drg_code,
 '' AS ra_hipps_cmg_code,
 NUMERIC '0.000' AS ra_idme_amt,
 NUMERIC '0.000' AS ra_lab_payment_amt,
 NUMERIC '0.000' AS ra_operating_dsh_amt,
 NUMERIC '0.000' AS ra_operating_idme_amt,
 NUMERIC '0.000' AS ra_operating_outlier_amt,
 NUMERIC '0.000' AS ra_outlier_amt,
 parse_date('%Y-%m-%d', '1900-01-01') AS ra_payment_date,
 NUMERIC '0.000' AS ra_therapy_payment_amt,
 NUMERIC '0.000' AS ra_total_capital_amt,
 NUMERIC '0.000' AS ra_total_payment_amt,
 TRIM(substr(cclog24mcripbcah.rate_schedule_name, 1, 100)) AS rate_schedule_name,
 0 AS remit_cnt,
 NUMERIC '0.000' AS replace_device_reduction_amt,
 TRIM(substr(cclog24mcripbcah.report_name, 1, 100)) AS report_name,
 datetime_trunc(current_datetime('US/Central'), SECOND) AS report_run_date_time,
 substr(cclog24mcripbcah.reporting_period, 1, 25) AS reporting_period,
 NUMERIC '0.000' AS rug_payment_amt,
 '' AS section_month,
 TRIM(substr(cclog24mcripbcah.section_name, 1, 100)) AS section_name,
 ROUND(cclog24mcripbcah.seq, 3, 'ROUND_HALF_EVEN') AS sequestration_amt,
 NUMERIC '0.000' AS short_stay_outlier_payment_amt, -- CAST( '0.00' as DECIMAL(18,3)) as Source_System_Code,
 NUMERIC '0.000' AS tech_add_on_amt,
 NUMERIC '0.000' AS tech_add_on_payment_amt,
 NUMERIC '0.000' AS therapy_charge_amt,
 NUMERIC '0.000' AS therapy_payment_amt,
 ROUND(cclog24mcripbcah.total_charges, 3, 'ROUND_HALF_EVEN') AS total_charge_amt,
 NUMERIC '0.000' AS total_expected_payment_amt,
 NUMERIC '0.000' AS total_opr_cptl_payment_amt,
 NUMERIC '0.000' AS total_payment_amt,
 NUMERIC '0.000' AS transfer_payment_amt,
 cclog24mcripbcah.unit_number AS unit_num,
 'N' AS var_cmg_flag,
 NUMERIC '0.000' AS var_coinsurance_amt,
 NUMERIC '0.000' AS var_contractual_amt,
 NUMERIC '0.000' AS var_covered_charges_amt,
 0 AS var_covered_days_cnt,
 NUMERIC '0.000' AS var_deductible_amt,
 'N' AS var_drg_flag,
 NUMERIC '0.000' AS var_imed_educ_amt,
 NUMERIC '0.000' AS var_lab_payment_amt,
 NUMERIC '0.000' AS var_operating_dsh_amt,
 NUMERIC '0.000' AS var_operating_ime_amt,
 NUMERIC '0.000' AS var_operating_outlier_amt,
 NUMERIC '0.000' AS var_outlier_amt,
 NUMERIC '0.000' AS var_therapy_payment_amt,
 NUMERIC '0.000' AS var_total_capital_amt,
 NUMERIC '0.000' AS var_total_payment_amt
         FROM `{{ params.param_parallon_ra_stage_dataset_name }}`.cclog24mcripbcah
         UNION DISTINCT SELECT NUMERIC '0.000' AS account_balance_amt,
                               '' AS account_status_code,
                               NUMERIC '0.000' AS accrued_capital_subtotal_amt,
                               NUMERIC '0.000' AS accrued_operating_subtotal_amt,
                               NUMERIC '0.000' AS accrued_payment_amt,
                               NUMERIC '0.000' AS apc_charges_amt,
                               NUMERIC '0.000' AS apc_payment_amt,
                               'N' AS auto_posted_flag,
                               NUMERIC '0.000' AS capital_payment_subtotal_amt,
                               parse_date('%Y-%m-%d', '1900-01-01') AS claim_submit_date,
                               NUMERIC '0.000' AS cmac_charge_amt,
                               NUMERIC '0.000' AS cmac_payment_amt,
                               '' AS cmg_code,
                               NUMERIC '0.000' AS cmg_payment_amt,
                               NUMERIC '0.000' AS cmg_weight_amt,
                               '' AS coid,
                               NUMERIC '0.000' AS coinsurance_deductible_amt,
                               'N' AS company_code,
                               NUMERIC '0.000' AS computed_reimb_amt,
                               NUMERIC '0.000' AS cost_outlier_payment_amt,
                               '' AS cost_report_year,
                               NUMERIC '0.000' AS covered_charges_amt,
                               cclog24mcripf.covered_days AS covered_days_los_cnt,
                               0 AS days_billed_cnt,
                               parse_date('%Y-%m-%d', '1900-01-01') AS discharge_admit_date,
                               0 AS discharge_days_cnt,
                               NUMERIC '0.000' AS drg_arithmetic_los_amt,
                               '' AS drg_code,
                               ROUND(cclog24mcripf.drg_payment, 3, 'ROUND_HALF_EVEN') AS drg_payment_amt,
                               ROUND(cclog24mcripf.drg_weight, 3, 'ROUND_HALF_EVEN') AS drg_weight_amt,
                               datetime_trunc(current_datetime('US/Central'), SECOND) AS dw_last_update_date_time,
                               ROUND(cclog24mcripf.ect_payment, 3, 'ROUND_HALF_EVEN') AS ect_payment_amt,
                               ROUND(cclog24mcripf.education_payment, 3, 'ROUND_HALF_EVEN') AS education_payment_amt,
                               '' AS exp_hipps_cmg_code,
                               TRIM(substr(cclog24mcripf.facility_name, 1, 50)) AS facility_name,
                               NUMERIC '0.000' AS fee_based_payment_amt,
                               NUMERIC '0.000' AS idme_payment_amt,
                               NUMERIC '0.000' AS lab_charge_amt,
                               NUMERIC '0.000' AS lab_payment_amt,
                               NUMERIC '0.000' AS lip_payment_amt,
                               NUMERIC '0.000' AS non_covered_charges_amt,
                               NUMERIC '0.000' AS operating_cost_outlier_amt,
                               NUMERIC '0.000' AS operating_drg_payment_amt,
                               NUMERIC '0.000' AS operating_dsh_amt,
                               NUMERIC '0.000' AS operating_outlier_amt,
                               NUMERIC '0.000' AS other_service_charge_amt,
                               NUMERIC '0.000' AS other_service_payment_amt,
                               ROUND(cclog24mcripf.outlier_payment, 3, 'ROUND_HALF_EVEN') AS outlier_payment_amt,
                               ROUND(CAST(`{{ params.param_bqutil_fns_dataset_name }}`.cw_td_normalize_number(CASE
                                                                                                                WHEN cclog24mcripf.account_number LIKE '%*%' THEN translate(cclog24mcripf.account_number, '*', '')
                                                                                                                ELSE cclog24mcripf.account_number
                                                                                                            END) AS NUMERIC), 0, 'ROUND_HALF_EVEN') AS pat_acct_num, -- CAST( '0.00' as DECIMAL(18,3)) as Patient_DW_Id,
 TRIM(substr(cclog24mcripf.patient_name, 1, 50)) AS patient_name,
 NUMERIC '0.000' AS payment_adj_amt,
 LAST_DAY(parse_date('%B %Y', cclog24mcripf.period_end_date)) AS period_end_date,
 NUMERIC '0.000' AS prorated_drg_weight_amt,
 NUMERIC '0.000' AS ra_coinsurance_amt,
 NUMERIC '0.000' AS ra_contractual_amt,
 CAST(0 AS NUMERIC) AS ra_covered_charge_amt,
 0 AS ra_covered_days_cnt,
 NUMERIC '0.000' AS ra_deductible_amt,
 NUMERIC '0.000' AS ra_drg_amt,
 '' AS ra_drg_code,
 '' AS ra_hipps_cmg_code,
 NUMERIC '0.000' AS ra_idme_amt,
 NUMERIC '0.000' AS ra_lab_payment_amt,
 NUMERIC '0.000' AS ra_operating_dsh_amt,
 NUMERIC '0.000' AS ra_operating_idme_amt,
 NUMERIC '0.000' AS ra_operating_outlier_amt,
 NUMERIC '0.000' AS ra_outlier_amt,
 parse_date('%Y-%m-%d', '1900-01-01') AS ra_payment_date,
 NUMERIC '0.000' AS ra_therapy_payment_amt,
 NUMERIC '0.000' AS ra_total_capital_amt,
 NUMERIC '0.000' AS ra_total_payment_amt,
 TRIM(substr(cclog24mcripf.rate_schedule_name, 1, 100)) AS rate_schedule_name,
 0 AS remit_cnt,
 NUMERIC '0.000' AS replace_device_reduction_amt,
 TRIM(substr(cclog24mcripf.report_name, 1, 100)) AS report_name,
 datetime_trunc(current_datetime('US/Central'), SECOND) AS report_run_date_time,
 substr(cclog24mcripf.reporting_period, 1, 25) AS reporting_period,
 NUMERIC '0.000' AS rug_payment_amt,
 '' AS section_month,
 TRIM(substr(cclog24mcripf.section_name, 1, 100)) AS section_name,
 ROUND(cclog24mcripf.seq, 3, 'ROUND_HALF_EVEN') AS sequestration_amt,
 NUMERIC '0.000' AS short_stay_outlier_payment_amt, -- CAST( '0.00' as DECIMAL(18,3)) as Source_System_Code,
 NUMERIC '0.000' AS tech_add_on_amt,
 NUMERIC '0.000' AS tech_add_on_payment_amt,
 NUMERIC '0.000' AS therapy_charge_amt,
 NUMERIC '0.000' AS therapy_payment_amt,
 ROUND(cclog24mcripf.total_charges, 3, 'ROUND_HALF_EVEN') AS total_charge_amt,
 NUMERIC '0.000' AS total_expected_payment_amt,
 NUMERIC '0.000' AS total_opr_cptl_payment_amt,
 NUMERIC '0.000' AS total_payment_amt,
 NUMERIC '0.000' AS transfer_payment_amt,
 cclog24mcripf.unit_number AS unit_num,
 'N' AS var_cmg_flag,
 NUMERIC '0.000' AS var_coinsurance_amt,
 NUMERIC '0.000' AS var_contractual_amt,
 NUMERIC '0.000' AS var_covered_charges_amt,
 0 AS var_covered_days_cnt,
 NUMERIC '0.000' AS var_deductible_amt,
 'N' AS var_drg_flag,
 NUMERIC '0.000' AS var_imed_educ_amt,
 NUMERIC '0.000' AS var_lab_payment_amt,
 NUMERIC '0.000' AS var_operating_dsh_amt,
 NUMERIC '0.000' AS var_operating_ime_amt,
 NUMERIC '0.000' AS var_operating_outlier_amt,
 NUMERIC '0.000' AS var_outlier_amt,
 NUMERIC '0.000' AS var_therapy_payment_amt,
 NUMERIC '0.000' AS var_total_capital_amt,
 NUMERIC '0.000' AS var_total_payment_amt
         FROM `{{ params.param_parallon_ra_stage_dataset_name }}`.cclog24mcripf
         UNION DISTINCT SELECT NUMERIC '0.000' AS account_balance_amt,
                               '' AS account_status_code,
                               NUMERIC '0.000' AS accrued_capital_subtotal_amt,
                               NUMERIC '0.000' AS accrued_operating_subtotal_amt,
                               NUMERIC '0.000' AS accrued_payment_amt,
                               NUMERIC '0.000' AS apc_charges_amt,
                               NUMERIC '0.000' AS apc_payment_amt,
                               'N' AS auto_posted_flag,
                               NUMERIC '0.000' AS capital_payment_subtotal_amt,
                               parse_date('%Y-%m-%d', '1900-01-01') AS claim_submit_date,
                               NUMERIC '0.000' AS cmac_charge_amt,
                               NUMERIC '0.000' AS cmac_payment_amt,
                               '' AS cmg_code,
                               NUMERIC '0.000' AS cmg_payment_amt,
                               NUMERIC '0.000' AS cmg_weight_amt,
                               cclog24mcripswb.coid AS coid,
                               NUMERIC '0.000' AS coinsurance_deductible_amt,
                               'N' AS company_code,
                               ROUND(cclog24mcripswb.computed_reimbursement, 3, 'ROUND_HALF_EVEN') AS computed_reimb_amt,
                               NUMERIC '0.000' AS cost_outlier_payment_amt,
                               '' AS cost_report_year,
                               ROUND(cclog24mcripswb.covered_charges, 3, 'ROUND_HALF_EVEN') AS covered_charges_amt,
                               0 AS covered_days_los_cnt,
                               0 AS days_billed_cnt,
                               parse_date('%Y-%m-%d', '1900-01-01') AS discharge_admit_date,
                               0 AS discharge_days_cnt,
                               NUMERIC '0.000' AS drg_arithmetic_los_amt,
                               '' AS drg_code,
                               NUMERIC '0.000' AS drg_payment_amt,
                               NUMERIC '0.000' AS drg_weight_amt,
                               datetime_trunc(current_datetime('US/Central'), SECOND) AS dw_last_update_date_time,
                               NUMERIC '0.000' AS ect_payment_amt,
                               NUMERIC '0.000' AS education_payment_amt,
                               '' AS exp_hipps_cmg_code,
                               TRIM(substr(cclog24mcripswb.facility_name, 1, 50)) AS facility_name,
                               NUMERIC '0.000' AS fee_based_payment_amt,
                               NUMERIC '0.000' AS idme_payment_amt,
                               NUMERIC '0.000' AS lab_charge_amt,
                               NUMERIC '0.000' AS lab_payment_amt,
                               NUMERIC '0.000' AS lip_payment_amt,
                               NUMERIC '0.000' AS non_covered_charges_amt,
                               NUMERIC '0.000' AS operating_cost_outlier_amt,
                               NUMERIC '0.000' AS operating_drg_payment_amt,
                               NUMERIC '0.000' AS operating_dsh_amt,
                               NUMERIC '0.000' AS operating_outlier_amt,
                               NUMERIC '0.000' AS other_service_charge_amt,
                               NUMERIC '0.000' AS other_service_payment_amt,
                               NUMERIC '0.000' AS outlier_payment_amt,
                               ROUND(CAST(`{{ params.param_bqutil_fns_dataset_name }}`.cw_td_normalize_number(CASE
                                                                                                                WHEN cclog24mcripswb.account_number LIKE '%*%' THEN translate(cclog24mcripswb.account_number, '*', '')
                                                                                                                ELSE cclog24mcripswb.account_number
                                                                                                            END) AS NUMERIC), 0, 'ROUND_HALF_EVEN') AS pat_acct_num, -- CAST( '0.00' as DECIMAL(18,3)) as Patient_DW_Id,
 TRIM(substr(cclog24mcripswb.patient_name, 1, 50)) AS patient_name,
 NUMERIC '0.000' AS payment_adj_amt,
 LAST_DAY(parse_date('%B %Y', cclog24mcripswb.period_end_date)) AS period_end_date,
 NUMERIC '0.000' AS prorated_drg_weight_amt,
 NUMERIC '0.000' AS ra_coinsurance_amt,
 NUMERIC '0.000' AS ra_contractual_amt,
 NUMERIC '0.000' AS ra_covered_charge_amt,
 0 AS ra_covered_days_cnt,
 NUMERIC '0.000' AS ra_deductible_amt,
 NUMERIC '0.000' AS ra_drg_amt,
 '' AS ra_drg_code,
 '' AS ra_hipps_cmg_code,
 NUMERIC '0.000' AS ra_idme_amt,
 NUMERIC '0.000' AS ra_lab_payment_amt,
 NUMERIC '0.000' AS ra_operating_dsh_amt,
 NUMERIC '0.000' AS ra_operating_idme_amt,
 NUMERIC '0.000' AS ra_operating_outlier_amt,
 NUMERIC '0.000' AS ra_outlier_amt,
 parse_date('%Y-%m-%d', '1900-01-01') AS ra_payment_date,
 NUMERIC '0.000' AS ra_therapy_payment_amt,
 NUMERIC '0.000' AS ra_total_capital_amt,
 NUMERIC '0.000' AS ra_total_payment_amt,
 TRIM(substr(cclog24mcripswb.rate_schedule_name, 1, 100)) AS rate_schedule_name,
 0 AS remit_cnt,
 NUMERIC '0.000' AS replace_device_reduction_amt,
 TRIM(substr(cclog24mcripswb.report_name, 1, 100)) AS report_name,
 datetime_trunc(current_datetime('US/Central'), SECOND) AS report_run_date_time,
 substr(cclog24mcripswb.reporting_period, 1, 25) AS reporting_period,
 NUMERIC '0.000' AS rug_payment_amt,
 '' AS section_month,
 TRIM(substr(cclog24mcripswb.section_name, 1, 100)) AS section_name,
 ROUND(cclog24mcripswb.seq, 3, 'ROUND_HALF_EVEN') AS sequestration_amt,
 NUMERIC '0.000' AS short_stay_outlier_payment_amt, -- CAST( '0.00' as DECIMAL(18,3)) as Source_System_Code,
 NUMERIC '0.000' AS tech_add_on_amt,
 NUMERIC '0.000' AS tech_add_on_payment_amt,
 NUMERIC '0.000' AS therapy_charge_amt,
 NUMERIC '0.000' AS therapy_payment_amt,
 ROUND(cclog24mcripswb.total_charges, 3, 'ROUND_HALF_EVEN') AS total_charge_amt,
 NUMERIC '0.000' AS total_expected_payment_amt,
 NUMERIC '0.000' AS total_opr_cptl_payment_amt,
 NUMERIC '0.000' AS total_payment_amt,
 NUMERIC '0.000' AS transfer_payment_amt,
 cclog24mcripswb.unit_number AS unit_num,
 'N' AS var_cmg_flag,
 NUMERIC '0.000' AS var_coinsurance_amt,
 NUMERIC '0.000' AS var_contractual_amt,
 NUMERIC '0.000' AS var_covered_charges_amt,
 0 AS var_covered_days_cnt,
 NUMERIC '0.000' AS var_deductible_amt,
 'N' AS var_drg_flag,
 NUMERIC '0.000' AS var_imed_educ_amt,
 NUMERIC '0.000' AS var_lab_payment_amt,
 NUMERIC '0.000' AS var_operating_dsh_amt,
 NUMERIC '0.000' AS var_operating_ime_amt,
 NUMERIC '0.000' AS var_operating_outlier_amt,
 NUMERIC '0.000' AS var_outlier_amt,
 NUMERIC '0.000' AS var_therapy_payment_amt,
 NUMERIC '0.000' AS var_total_capital_amt,
 NUMERIC '0.000' AS var_total_payment_amt
         FROM `{{ params.param_parallon_ra_stage_dataset_name }}`.cclog24mcripswb
         UNION DISTINCT SELECT NUMERIC '0.000' AS account_balance_amt,
                               '' AS account_status_code,
                               NUMERIC '0.000' AS accrued_capital_subtotal_amt,
                               NUMERIC '0.000' AS accrued_operating_subtotal_amt,
                               NUMERIC '0.000' AS accrued_payment_amt,
                               NUMERIC '0.000' AS apc_charges_amt,
                               NUMERIC '0.000' AS apc_payment_amt,
                               'N' AS auto_posted_flag,
                               NUMERIC '0.000' AS capital_payment_subtotal_amt,
                               parse_date('%Y-%m-%d', '1900-01-01') AS claim_submit_date,
                               NUMERIC '0.000' AS cmac_charge_amt,
                               NUMERIC '0.000' AS cmac_payment_amt,
                               '' AS cmg_code,
                               ROUND(cclog24mcrirf_d.cmg_payment, 3, 'ROUND_HALF_EVEN') AS cmg_payment_amt,
                               ROUND(cclog24mcrirf_d.cmg_weight, 3, 'ROUND_HALF_EVEN') AS cmg_weight_amt,
                               cclog24mcrirf_d.coid AS coid,
                               NUMERIC '0.000' AS coinsurance_deductible_amt,
                               'N' AS company_code,
                               NUMERIC '0.000' AS computed_reimb_amt,
                               NUMERIC '0.000' AS cost_outlier_payment_amt,
                               '' AS cost_report_year,
                               ROUND(cclog24mcrirf_d.covered_charges, 3, 'ROUND_HALF_EVEN') AS covered_charges_amt,
                               cclog24mcrirf_d.covered_days AS covered_days_los_cnt,
                               0 AS days_billed_cnt,
                               parse_date('%Y-%m-%d', '1900-01-01') AS discharge_admit_date,
                               0 AS discharge_days_cnt,
                               NUMERIC '0.000' AS drg_arithmetic_los_amt,
                               '' AS drg_code,
                               NUMERIC '0.000' AS drg_payment_amt,
                               NUMERIC '0.000' AS drg_weight_amt,
                               datetime_trunc(current_datetime('US/Central'), SECOND) AS dw_last_update_date_time,
                               NUMERIC '0.000' AS ect_payment_amt,
                               ROUND(cclog24mcrirf_d.education_payment, 3, 'ROUND_HALF_EVEN') AS education_payment_amt,
                               '' AS exp_hipps_cmg_code,
                               TRIM(substr(cclog24mcrirf_d.facility_name, 1, 50)) AS facility_name,
                               ROUND(cclog24mcrirf_d.fee_based_payment, 3, 'ROUND_HALF_EVEN') AS fee_based_payment_amt,
                               NUMERIC '0.000' AS idme_payment_amt,
                               NUMERIC '0.000' AS lab_charge_amt,
                               NUMERIC '0.000' AS lab_payment_amt,
                               ROUND(cclog24mcrirf_d.lip_payment, 3, 'ROUND_HALF_EVEN') AS lip_payment_amt,
                               NUMERIC '0.000' AS non_covered_charges_amt,
                               NUMERIC '0.000' AS operating_cost_outlier_amt,
                               NUMERIC '0.000' AS operating_drg_payment_amt,
                               NUMERIC '0.000' AS operating_dsh_amt,
                               NUMERIC '0.000' AS operating_outlier_amt,
                               NUMERIC '0.000' AS other_service_charge_amt,
                               NUMERIC '0.000' AS other_service_payment_amt,
                               ROUND(cclog24mcrirf_d.outlier_payment, 3, 'ROUND_HALF_EVEN') AS outlier_payment_amt,
                               ROUND(CAST(`{{ params.param_bqutil_fns_dataset_name }}`.cw_td_normalize_number(CASE
                                                                                                                WHEN cclog24mcrirf_d.account_number LIKE '%*%' THEN translate(cclog24mcrirf_d.account_number, '*', '')
                                                                                                                ELSE cclog24mcrirf_d.account_number
                                                                                                            END) AS NUMERIC), 0, 'ROUND_HALF_EVEN') AS pat_acct_num, -- CAST( '0.00' as DECIMAL(18,3)) as Patient_DW_Id,
 TRIM(substr(cclog24mcrirf_d.patient_name, 1, 50)) AS patient_name,
 NUMERIC '0.000' AS payment_adj_amt,
 LAST_DAY(parse_date('%B %Y', cclog24mcrirf_d.period_end_date)) AS period_end_date,
 NUMERIC '0.000' AS prorated_drg_weight_amt,
 NUMERIC '0.000' AS ra_coinsurance_amt,
 NUMERIC '0.000' AS ra_contractual_amt,
 NUMERIC '0.000' AS ra_covered_charge_amt,
 0 AS ra_covered_days_cnt,
 NUMERIC '0.000' AS ra_deductible_amt,
 NUMERIC '0.000' AS ra_drg_amt,
 '' AS ra_drg_code,
 '' AS ra_hipps_cmg_code,
 NUMERIC '0.000' AS ra_idme_amt,
 NUMERIC '0.000' AS ra_lab_payment_amt,
 NUMERIC '0.000' AS ra_operating_dsh_amt,
 NUMERIC '0.000' AS ra_operating_idme_amt,
 NUMERIC '0.000' AS ra_operating_outlier_amt,
 NUMERIC '0.000' AS ra_outlier_amt,
 parse_date('%Y-%m-%d', '1900-01-01') AS ra_payment_date,
 NUMERIC '0.000' AS ra_therapy_payment_amt,
 NUMERIC '0.000' AS ra_total_capital_amt,
 NUMERIC '0.000' AS ra_total_payment_amt,
 TRIM(substr(cclog24mcrirf_d.rate_schedule_name, 1, 100)) AS rate_schedule_name,
 0 AS remit_cnt,
 NUMERIC '0.000' AS replace_device_reduction_amt,
 TRIM(substr(cclog24mcrirf_d.report_name, 1, 100)) AS report_name,
 datetime_trunc(current_datetime('US/Central'), SECOND) AS report_run_date_time,
 substr(cclog24mcrirf_d.reporting_period, 1, 25) AS reporting_period,
 NUMERIC '0.000' AS rug_payment_amt,
 '' AS section_month,
 TRIM(substr(cclog24mcrirf_d.section_name, 1, 100)) AS section_name,
 ROUND(cclog24mcrirf_d.seq, 3, 'ROUND_HALF_EVEN') AS sequestration_amt,
 NUMERIC '0.000' AS short_stay_outlier_payment_amt, -- CAST( '0.00' as DECIMAL(18,3)) as Source_System_Code,
 NUMERIC '0.000' AS tech_add_on_amt,
 NUMERIC '0.000' AS tech_add_on_payment_amt,
 NUMERIC '0.000' AS therapy_charge_amt,
 NUMERIC '0.000' AS therapy_payment_amt,
 ROUND(cclog24mcrirf_d.total_charges, 3, 'ROUND_HALF_EVEN') AS total_charge_amt,
 NUMERIC '0.000' AS total_expected_payment_amt,
 NUMERIC '0.000' AS total_opr_cptl_payment_amt,
 NUMERIC '0.000' AS total_payment_amt,
 NUMERIC '0.000' AS transfer_payment_amt,
 cclog24mcrirf_d.unit_number AS unit_num,
 'N' AS var_cmg_flag,
 NUMERIC '0.000' AS var_coinsurance_amt,
 NUMERIC '0.000' AS var_contractual_amt,
 NUMERIC '0.000' AS var_covered_charges_amt,
 0 AS var_covered_days_cnt,
 NUMERIC '0.000' AS var_deductible_amt,
 'N' AS var_drg_flag,
 NUMERIC '0.000' AS var_imed_educ_amt,
 NUMERIC '0.000' AS var_lab_payment_amt,
 NUMERIC '0.000' AS var_operating_dsh_amt,
 NUMERIC '0.000' AS var_operating_ime_amt,
 NUMERIC '0.000' AS var_operating_outlier_amt,
 NUMERIC '0.000' AS var_outlier_amt,
 NUMERIC '0.000' AS var_therapy_payment_amt,
 NUMERIC '0.000' AS var_total_capital_amt,
 NUMERIC '0.000' AS var_total_payment_amt
         FROM `{{ params.param_parallon_ra_stage_dataset_name }}`.cclog24mcrirf_d
         UNION DISTINCT SELECT NUMERIC '0.000' AS account_balance_amt,
                               '' AS account_status_code,
                               NUMERIC '0.000' AS accrued_capital_subtotal_amt,
                               NUMERIC '0.000' AS accrued_operating_subtotal_amt,
                               NUMERIC '0.000' AS accrued_payment_amt,
                               NUMERIC '0.000' AS apc_charges_amt,
                               NUMERIC '0.000' AS apc_payment_amt,
                               'N' AS auto_posted_flag,
                               NUMERIC '0.000' AS capital_payment_subtotal_amt,
                               parse_date('%Y-%m-%d', '1900-01-01') AS claim_submit_date,
                               NUMERIC '0.000' AS cmac_charge_amt,
                               NUMERIC '0.000' AS cmac_payment_amt,
                               '' AS cmg_code,
                               NUMERIC '0.000' AS cmg_payment_amt,
                               NUMERIC '0.000' AS cmg_weight_amt,
                               cclog24mcrltch.coid AS coid,
                               NUMERIC '0.000' AS coinsurance_deductible_amt,
                               'N' AS company_code,
                               NUMERIC '0.000' AS computed_reimb_amt,
                               NUMERIC '0.000' AS cost_outlier_payment_amt,
                               '' AS cost_report_year,
                               ROUND(cclog24mcrltch.covered_charges, 3, 'ROUND_HALF_EVEN') AS covered_charges_amt,
                               cclog24mcrltch.covered_days AS covered_days_los_cnt,
                               0 AS days_billed_cnt,
                               parse_date('%Y-%m-%d', '1900-01-01') AS discharge_admit_date,
                               0 AS discharge_days_cnt,
                               NUMERIC '0.000' AS drg_arithmetic_los_amt,
                               '' AS drg_code,
                               NUMERIC '0.000' AS drg_payment_amt,
                               NUMERIC '0.000' AS drg_weight_amt,
                               datetime_trunc(current_datetime('US/Central'), SECOND) AS dw_last_update_date_time,
                               NUMERIC '0.000' AS ect_payment_amt,
                               NUMERIC '0.000' AS education_payment_amt,
                               '' AS exp_hipps_cmg_code,
                               TRIM(substr(cclog24mcrltch.facility_name, 1, 50)) AS facility_name,
                               ROUND(cclog24mcrltch.fee_based_payment, 3, 'ROUND_HALF_EVEN') AS fee_based_payment_amt,
                               NUMERIC '0.000' AS idme_payment_amt,
                               NUMERIC '0.000' AS lab_charge_amt,
                               NUMERIC '0.000' AS lab_payment_amt,
                               NUMERIC '0.000' AS lip_payment_amt,
                               NUMERIC '0.000' AS non_covered_charges_amt,
                               NUMERIC '0.000' AS operating_cost_outlier_amt,
                               NUMERIC '0.000' AS operating_drg_payment_amt,
                               NUMERIC '0.000' AS operating_dsh_amt,
                               NUMERIC '0.000' AS operating_outlier_amt,
                               NUMERIC '0.000' AS other_service_charge_amt,
                               NUMERIC '0.000' AS other_service_payment_amt,
                               ROUND(cclog24mcrltch.outlier_payment, 3, 'ROUND_HALF_EVEN') AS outlier_payment_amt,
                               ROUND(CAST(`{{ params.param_bqutil_fns_dataset_name }}`.cw_td_normalize_number(CASE
                                                                                                                WHEN cclog24mcrltch.account_number LIKE '%*%' THEN translate(cclog24mcrltch.account_number, '*', '')
                                                                                                                ELSE cclog24mcrltch.account_number
                                                                                                            END) AS NUMERIC), 0, 'ROUND_HALF_EVEN') AS pat_acct_num, -- CAST( '0.00' as DECIMAL(18,3)) as Patient_DW_Id,
 TRIM(substr(cclog24mcrltch.patient_name, 1, 50)) AS patient_name,
 NUMERIC '0.000' AS payment_adj_amt,
 LAST_DAY(parse_date('%B %Y', cclog24mcrltch.period_end_date)) AS period_end_date,
 NUMERIC '0.000' AS prorated_drg_weight_amt,
 NUMERIC '0.000' AS ra_coinsurance_amt,
 NUMERIC '0.000' AS ra_contractual_amt,
 CAST(0 AS NUMERIC) AS ra_covered_charge_amt,
 0 AS ra_covered_days_cnt,
 NUMERIC '0.000' AS ra_deductible_amt,
 NUMERIC '0.000' AS ra_drg_amt,
 '' AS ra_drg_code,
 '' AS ra_hipps_cmg_code,
 NUMERIC '0.000' AS ra_idme_amt,
 NUMERIC '0.000' AS ra_lab_payment_amt,
 NUMERIC '0.000' AS ra_operating_dsh_amt,
 NUMERIC '0.000' AS ra_operating_idme_amt,
 NUMERIC '0.000' AS ra_operating_outlier_amt,
 NUMERIC '0.000' AS ra_outlier_amt,
 parse_date('%Y-%m-%d', '1900-01-01') AS ra_payment_date,
 NUMERIC '0.000' AS ra_therapy_payment_amt,
 NUMERIC '0.000' AS ra_total_capital_amt,
 NUMERIC '0.000' AS ra_total_payment_amt,
 TRIM(substr(cclog24mcrltch.rate_schedule_name, 1, 100)) AS rate_schedule_name,
 0 AS remit_cnt,
 NUMERIC '0.000' AS replace_device_reduction_amt,
 TRIM(substr(cclog24mcrltch.report_name, 1, 100)) AS report_name,
 datetime_trunc(current_datetime('US/Central'), SECOND) AS report_run_date_time,
 substr(cclog24mcrltch.reporting_period, 1, 25) AS reporting_period,
 NUMERIC '0.000' AS rug_payment_amt,
 '' AS section_month,
 TRIM(substr(cclog24mcrltch.section_name, 1, 100)) AS section_name,
 ROUND(cclog24mcrltch.seq, 3, 'ROUND_HALF_EVEN') AS sequestration_amt,
 NUMERIC '0.000' AS short_stay_outlier_payment_amt, -- CAST( '0.00' as DECIMAL(18,3)) as Source_System_Code,
 NUMERIC '0.000' AS tech_add_on_amt,
 NUMERIC '0.000' AS tech_add_on_payment_amt,
 NUMERIC '0.000' AS therapy_charge_amt,
 NUMERIC '0.000' AS therapy_payment_amt,
 ROUND(cclog24mcrltch.total_charges, 3, 'ROUND_HALF_EVEN') AS total_charge_amt,
 NUMERIC '0.000' AS total_expected_payment_amt,
 NUMERIC '0.000' AS total_opr_cptl_payment_amt,
 NUMERIC '0.000' AS total_payment_amt,
 NUMERIC '0.000' AS transfer_payment_amt,
 cclog24mcrltch.unit_number AS unit_num,
 'N' AS var_cmg_flag,
 NUMERIC '0.000' AS var_coinsurance_amt,
 NUMERIC '0.000' AS var_contractual_amt,
 NUMERIC '0.000' AS var_covered_charges_amt,
 0 AS var_covered_days_cnt,
 NUMERIC '0.000' AS var_deductible_amt,
 'N' AS var_drg_flag,
 NUMERIC '0.000' AS var_imed_educ_amt,
 NUMERIC '0.000' AS var_lab_payment_amt,
 NUMERIC '0.000' AS var_operating_dsh_amt,
 NUMERIC '0.000' AS var_operating_ime_amt,
 NUMERIC '0.000' AS var_operating_outlier_amt,
 NUMERIC '0.000' AS var_outlier_amt,
 NUMERIC '0.000' AS var_therapy_payment_amt,
 NUMERIC '0.000' AS var_total_capital_amt,
 NUMERIC '0.000' AS var_total_payment_amt
         FROM `{{ params.param_parallon_ra_stage_dataset_name }}`.cclog24mcrltch
         UNION DISTINCT SELECT NUMERIC '0.000' AS account_balance_amt,
                               '' AS account_status_code,
                               NUMERIC '0.000' AS accrued_capital_subtotal_amt,
                               NUMERIC '0.000' AS accrued_operating_subtotal_amt,
                               NUMERIC '0.000' AS accrued_payment_amt,
                               ROUND(cclog24mcrop.apc_charges, 3, 'ROUND_HALF_EVEN') AS apc_charges_amt,
                               ROUND(cclog24mcrop.apc_payments, 3, 'ROUND_HALF_EVEN') AS apc_payment_amt,
                               'N' AS auto_posted_flag,
                               NUMERIC '0.000' AS capital_payment_subtotal_amt,
                               parse_date('%Y-%m-%d', '1900-01-01') AS claim_submit_date,
                               NUMERIC '0.000' AS cmac_charge_amt,
                               NUMERIC '0.000' AS cmac_payment_amt,
                               '' AS cmg_code,
                               NUMERIC '0.000' AS cmg_payment_amt,
                               NUMERIC '0.000' AS cmg_weight_amt,
                               cclog24mcrop.coid AS coid,
                               NUMERIC '0.000' AS coinsurance_deductible_amt,
                               'N' AS company_code,
                               NUMERIC '0.000' AS computed_reimb_amt,
                               NUMERIC '0.000' AS cost_outlier_payment_amt,
                               '' AS cost_report_year,
                               ROUND(cclog24mcrop.covered_charges, 3, 'ROUND_HALF_EVEN') AS covered_charges_amt,
                               CAST(`{{ params.param_bqutil_fns_dataset_name }}`.cw_td_normalize_number('0.00') AS INT64) AS covered_days_los_cnt,
                               0 AS days_billed_cnt,
                               parse_date('%Y-%m-%d', '1900-01-01') AS discharge_admit_date,
                               0 AS discharge_days_cnt,
                               NUMERIC '0.000' AS drg_arithmetic_los_amt,
                               '' AS drg_code,
                               NUMERIC '0.000' AS drg_payment_amt,
                               NUMERIC '0.000' AS drg_weight_amt,
                               datetime_trunc(current_datetime('US/Central'), SECOND) AS dw_last_update_date_time,
                               NUMERIC '0.000' AS ect_payment_amt,
                               NUMERIC '0.000' AS education_payment_amt,
                               '' AS exp_hipps_cmg_code,
                               TRIM(substr(cclog24mcrop.facility_name, 1, 50)) AS facility_name,
                               NUMERIC '0.000' AS fee_based_payment_amt,
                               NUMERIC '0.000' AS idme_payment_amt,
                               ROUND(cclog24mcrop.lab_charges, 3, 'ROUND_HALF_EVEN') AS lab_charge_amt,
                               ROUND(cclog24mcrop.lab_payments, 3, 'ROUND_HALF_EVEN') AS lab_payment_amt,
                               NUMERIC '0.000' AS lip_payment_amt,
                               ROUND(cclog24mcrop.non_covered_charges, 3, 'ROUND_HALF_EVEN') AS non_covered_charges_amt,
                               NUMERIC '0.000' AS operating_cost_outlier_amt,
                               NUMERIC '0.000' AS operating_drg_payment_amt,
                               NUMERIC '0.000' AS operating_dsh_amt,
                               NUMERIC '0.000' AS operating_outlier_amt,
                               ROUND(cclog24mcrop.other_service_charges, 3, 'ROUND_HALF_EVEN') AS other_service_charge_amt,
                               ROUND(cclog24mcrop.other_service_payments, 3, 'ROUND_HALF_EVEN') AS other_service_payment_amt,
                               NUMERIC '0.000' AS outlier_payment_amt,
                               ROUND(CAST(`{{ params.param_bqutil_fns_dataset_name }}`.cw_td_normalize_number(CASE
                                                                                                                WHEN cclog24mcrop.account_number LIKE '%*%' THEN translate(cclog24mcrop.account_number, '*', '')
                                                                                                                ELSE cclog24mcrop.account_number
                                                                                                            END) AS NUMERIC), 0, 'ROUND_HALF_EVEN') AS pat_acct_num, -- CAST( '0.00' as DECIMAL(18,3)) as Patient_DW_Id,
 TRIM(substr(cclog24mcrop.patient_name, 1, 50)) AS patient_name,
 ROUND(cclog24mcrop.payment_adjustments, 3, 'ROUND_HALF_EVEN') AS payment_adj_amt,
 LAST_DAY(parse_date('%B %Y', cclog24mcrop.period_end_date)) AS period_end_date,
 NUMERIC '0.000' AS prorated_drg_weight_amt,
 NUMERIC '0.000' AS ra_coinsurance_amt,
 NUMERIC '0.000' AS ra_contractual_amt,
 NUMERIC '0.000' AS ra_covered_charge_amt,
 0 AS ra_covered_days_cnt,
 NUMERIC '0.000' AS ra_deductible_amt,
 NUMERIC '0.000' AS ra_drg_amt,
 '' AS ra_drg_code,
 '' AS ra_hipps_cmg_code,
 NUMERIC '0.000' AS ra_idme_amt,
 NUMERIC '0.000' AS ra_lab_payment_amt,
 NUMERIC '0.000' AS ra_operating_dsh_amt,
 NUMERIC '0.000' AS ra_operating_idme_amt,
 NUMERIC '0.000' AS ra_operating_outlier_amt,
 NUMERIC '0.000' AS ra_outlier_amt,
 parse_date('%Y-%m-%d', '1900-01-01') AS ra_payment_date,
 NUMERIC '0.000' AS ra_therapy_payment_amt,
 NUMERIC '0.000' AS ra_total_capital_amt,
 NUMERIC '0.000' AS ra_total_payment_amt,
 TRIM(substr(cclog24mcrop.rate_schedule_name, 1, 100)) AS rate_schedule_name,
 0 AS remit_cnt,
 NUMERIC '0.000' AS replace_device_reduction_amt,
 TRIM(substr(cclog24mcrop.report_name, 1, 100)) AS report_name,
 datetime_trunc(current_datetime('US/Central'), SECOND) AS report_run_date_time,
 substr(cclog24mcrop.reporting_period, 1, 25) AS reporting_period,
 NUMERIC '0.000' AS rug_payment_amt,
 '' AS section_month,
 TRIM(substr(cclog24mcrop.section_name, 1, 100)) AS section_name,
 ROUND(cclog24mcrop.seq, 3, 'ROUND_HALF_EVEN') AS sequestration_amt,
 NUMERIC '0.000' AS short_stay_outlier_payment_amt, -- CAST( '0.00' as DECIMAL(18,3)) as Source_System_Code,
 NUMERIC '0.000' AS tech_add_on_amt,
 NUMERIC '0.000' AS tech_add_on_payment_amt,
 ROUND(cclog24mcrop.therapy_charges, 3, 'ROUND_HALF_EVEN') AS therapy_charge_amt,
 ROUND(cclog24mcrop.therapy_payments, 3, 'ROUND_HALF_EVEN') AS therapy_payment_amt,
 ROUND(cclog24mcrop.total_charges, 3, 'ROUND_HALF_EVEN') AS total_charge_amt,
 NUMERIC '0.000' AS total_expected_payment_amt,
 NUMERIC '0.000' AS total_opr_cptl_payment_amt,
 NUMERIC '0.000' AS total_payment_amt,
 NUMERIC '0.000' AS transfer_payment_amt,
 cclog24mcrop.unit_number AS unit_num,
 'N' AS var_cmg_flag,
 NUMERIC '0.000' AS var_coinsurance_amt,
 NUMERIC '0.000' AS var_contractual_amt,
 NUMERIC '0.000' AS var_covered_charges_amt,
 0 AS var_covered_days_cnt,
 NUMERIC '0.000' AS var_deductible_amt,
 'N' AS var_drg_flag,
 NUMERIC '0.000' AS var_imed_educ_amt,
 NUMERIC '0.000' AS var_lab_payment_amt,
 NUMERIC '0.000' AS var_operating_dsh_amt,
 NUMERIC '0.000' AS var_operating_ime_amt,
 NUMERIC '0.000' AS var_operating_outlier_amt,
 NUMERIC '0.000' AS var_outlier_amt,
 NUMERIC '0.000' AS var_therapy_payment_amt,
 NUMERIC '0.000' AS var_total_capital_amt,
 NUMERIC '0.000' AS var_total_payment_amt
         FROM `{{ params.param_parallon_ra_stage_dataset_name }}`.cclog24mcrop
         UNION DISTINCT SELECT NUMERIC '0.000' AS account_balance_amt,
                               '' AS account_status_code,
                               NUMERIC '0.000' AS accrued_capital_subtotal_amt,
                               NUMERIC '0.000' AS accrued_operating_subtotal_amt,
                               NUMERIC '0.000' AS accrued_payment_amt,
                               NUMERIC '0.000' AS apc_charges_amt,
                               NUMERIC '0.000' AS apc_payment_amt,
                               'N' AS auto_posted_flag,
                               NUMERIC '0.000' AS capital_payment_subtotal_amt,
                               parse_date('%Y-%m-%d', '1900-01-01') AS claim_submit_date,
                               NUMERIC '0.000' AS cmac_charge_amt,
                               NUMERIC '0.000' AS cmac_payment_amt,
                               '' AS cmg_code,
                               NUMERIC '0.000' AS cmg_payment_amt,
                               NUMERIC '0.000' AS cmg_weight_amt,
                               cclog24mcropcah.coid AS coid,
                               NUMERIC '0.000' AS coinsurance_deductible_amt,
                               'N' AS company_code,
                               ROUND(cclog24mcropcah.computed_reimbursement, 3, 'ROUND_HALF_EVEN') AS computed_reimb_amt,
                               NUMERIC '0.000' AS cost_outlier_payment_amt,
                               '' AS cost_report_year,
                               ROUND(cclog24mcropcah.covered_charges, 3, 'ROUND_HALF_EVEN') AS covered_charges_amt,
                               CAST(`{{ params.param_bqutil_fns_dataset_name }}`.cw_td_normalize_number('0.00') AS INT64) AS covered_days_los_cnt,
                               0 AS days_billed_cnt,
                               parse_date('%Y-%m-%d', '1900-01-01') AS discharge_admit_date,
                               0 AS discharge_days_cnt,
                               NUMERIC '0.000' AS drg_arithmetic_los_amt,
                               '' AS drg_code,
                               NUMERIC '0.000' AS drg_payment_amt,
                               NUMERIC '0.000' AS drg_weight_amt,
                               datetime_trunc(current_datetime('US/Central'), SECOND) AS dw_last_update_date_time,
                               NUMERIC '0.000' AS ect_payment_amt,
                               NUMERIC '0.000' AS education_payment_amt,
                               '' AS exp_hipps_cmg_code,
                               TRIM(substr(cclog24mcropcah.facility_name, 1, 50)) AS facility_name,
                               ROUND(cclog24mcropcah.fee_based_payments, 3, 'ROUND_HALF_EVEN') AS fee_based_payment_amt,
                               NUMERIC '0.000' AS idme_payment_amt,
                               NUMERIC '0.000' AS lab_charge_amt,
                               NUMERIC '0.000' AS lab_payment_amt,
                               NUMERIC '0.000' AS lip_payment_amt,
                               ROUND(cclog24mcropcah.non_covered_charges, 3, 'ROUND_HALF_EVEN') AS non_covered_charges_amt,
                               NUMERIC '0.000' AS operating_cost_outlier_amt,
                               NUMERIC '0.000' AS operating_drg_payment_amt,
                               NUMERIC '0.000' AS operating_dsh_amt,
                               NUMERIC '0.000' AS operating_outlier_amt,
                               NUMERIC '0.000' AS other_service_charge_amt,
                               NUMERIC '0.000' AS other_service_payment_amt,
                               NUMERIC '0.000' AS outlier_payment_amt,
                               ROUND(CAST(`{{ params.param_bqutil_fns_dataset_name }}`.cw_td_normalize_number(CASE
                                                                                                                WHEN cclog24mcropcah.account_number LIKE '%*%' THEN translate(cclog24mcropcah.account_number, '*', '')
                                                                                                                ELSE cclog24mcropcah.account_number
                                                                                                            END) AS NUMERIC), 0, 'ROUND_HALF_EVEN') AS pat_acct_num, -- CAST( '0.00' as DECIMAL(18,3)) as Patient_DW_Id,
 TRIM(substr(cclog24mcropcah.patient_name, 1, 50)) AS patient_name,
 NUMERIC '0.000' AS payment_adj_amt,
 LAST_DAY(parse_date('%B %Y', cclog24mcropcah.period_end_date)) AS period_end_date,
 NUMERIC '0.000' AS prorated_drg_weight_amt,
 NUMERIC '0.000' AS ra_coinsurance_amt,
 NUMERIC '0.000' AS ra_contractual_amt,
 NUMERIC '0.000' AS ra_covered_charge_amt,
 0 AS ra_covered_days_cnt,
 NUMERIC '0.000' AS ra_deductible_amt,
 NUMERIC '0.000' AS ra_drg_amt,
 '' AS ra_drg_code,
 '' AS ra_hipps_cmg_code,
 NUMERIC '0.000' AS ra_idme_amt,
 NUMERIC '0.000' AS ra_lab_payment_amt,
 NUMERIC '0.000' AS ra_operating_dsh_amt,
 NUMERIC '0.000' AS ra_operating_idme_amt,
 NUMERIC '0.000' AS ra_operating_outlier_amt,
 NUMERIC '0.000' AS ra_outlier_amt,
 parse_date('%Y-%m-%d', '1900-01-01') AS ra_payment_date,
 NUMERIC '0.000' AS ra_therapy_payment_amt,
 NUMERIC '0.000' AS ra_total_capital_amt,
 NUMERIC '0.000' AS ra_total_payment_amt,
 TRIM(substr(cclog24mcropcah.rate_schedule_name, 1, 100)) AS rate_schedule_name,
 0 AS remit_cnt,
 NUMERIC '0.000' AS replace_device_reduction_amt,
 TRIM(substr(cclog24mcropcah.report_name, 1, 100)) AS report_name,
 datetime_trunc(current_datetime('US/Central'), SECOND) AS report_run_date_time,
 substr(cclog24mcropcah.reporting_period, 1, 25) AS reporting_period,
 NUMERIC '0.000' AS rug_payment_amt,
 '' AS section_month,
 TRIM(substr(cclog24mcropcah.section_name, 1, 100)) AS section_name,
 ROUND(cclog24mcropcah.seq, 3, 'ROUND_HALF_EVEN') AS sequestration_amt,
 NUMERIC '0.000' AS short_stay_outlier_payment_amt, -- CAST( '0.00' as DECIMAL(18,3)) as Source_System_Code,
 NUMERIC '0.000' AS tech_add_on_amt,
 NUMERIC '0.000' AS tech_add_on_payment_amt,
 NUMERIC '0.000' AS therapy_charge_amt,
 NUMERIC '0.000' AS therapy_payment_amt,
 ROUND(cclog24mcropcah.total_charges, 3, 'ROUND_HALF_EVEN') AS total_charge_amt,
 NUMERIC '0.000' AS total_expected_payment_amt,
 NUMERIC '0.000' AS total_opr_cptl_payment_amt,
 NUMERIC '0.000' AS total_payment_amt,
 NUMERIC '0.000' AS transfer_payment_amt,
 cclog24mcropcah.unit_number AS unit_num,
 'N' AS var_cmg_flag,
 NUMERIC '0.000' AS var_coinsurance_amt,
 NUMERIC '0.000' AS var_contractual_amt,
 NUMERIC '0.000' AS var_covered_charges_amt,
 0 AS var_covered_days_cnt,
 NUMERIC '0.000' AS var_deductible_amt,
 'N' AS var_drg_flag,
 NUMERIC '0.000' AS var_imed_educ_amt,
 NUMERIC '0.000' AS var_lab_payment_amt,
 NUMERIC '0.000' AS var_operating_dsh_amt,
 NUMERIC '0.000' AS var_operating_ime_amt,
 NUMERIC '0.000' AS var_operating_outlier_amt,
 NUMERIC '0.000' AS var_outlier_amt,
 NUMERIC '0.000' AS var_therapy_payment_amt,
 NUMERIC '0.000' AS var_total_capital_amt,
 NUMERIC '0.000' AS var_total_payment_amt
         FROM `{{ params.param_parallon_ra_stage_dataset_name }}`.cclog24mcropcah
         UNION DISTINCT SELECT NUMERIC '0.000' AS account_balance_amt,
                               '' AS account_status_code,
                               NUMERIC '0.000' AS accrued_capital_subtotal_amt,
                               NUMERIC '0.000' AS accrued_operating_subtotal_amt,
                               NUMERIC '0.000' AS accrued_payment_amt,
                               NUMERIC '0.000' AS apc_charges_amt,
                               NUMERIC '0.000' AS apc_payment_amt,
                               'N' AS auto_posted_flag,
                               NUMERIC '0.000' AS capital_payment_subtotal_amt,
                               parse_date('%Y-%m-%d', '1900-01-01') AS claim_submit_date,
                               NUMERIC '0.000' AS cmac_charge_amt,
                               NUMERIC '0.000' AS cmac_payment_amt,
                               '' AS cmg_code,
                               NUMERIC '0.000' AS cmg_payment_amt,
                               NUMERIC '0.000' AS cmg_weight_amt,
                               cclog24mcrsnf.coid AS coid,
                               NUMERIC '0.000' AS coinsurance_deductible_amt,
                               'N' AS company_code,
                               NUMERIC '0.000' AS computed_reimb_amt,
                               NUMERIC '0.000' AS cost_outlier_payment_amt,
                               '' AS cost_report_year,
                               ROUND(cclog24mcrsnf.covered_charges, 3, 'ROUND_HALF_EVEN') AS covered_charges_amt,
                               cclog24mcrsnf.covered_days AS covered_days_los_cnt,
                               0 AS days_billed_cnt,
                               parse_date('%Y-%m-%d', '1900-01-01') AS discharge_admit_date,
                               0 AS discharge_days_cnt,
                               NUMERIC '0.000' AS drg_arithmetic_los_amt,
                               '' AS drg_code,
                               NUMERIC '0.000' AS drg_payment_amt,
                               NUMERIC '0.000' AS drg_weight_amt,
                               datetime_trunc(current_datetime('US/Central'), SECOND) AS dw_last_update_date_time,
                               NUMERIC '0.000' AS ect_payment_amt,
                               NUMERIC '0.000' AS education_payment_amt,
                               '' AS exp_hipps_cmg_code,
                               TRIM(substr(cclog24mcrsnf.facility_name, 1, 50)) AS facility_name,
                               NUMERIC '0.000' AS fee_based_payment_amt,
                               NUMERIC '0.000' AS idme_payment_amt,
                               NUMERIC '0.000' AS lab_charge_amt,
                               NUMERIC '0.000' AS lab_payment_amt,
                               NUMERIC '0.000' AS lip_payment_amt,
                               NUMERIC '0.000' AS non_covered_charges_amt,
                               NUMERIC '0.000' AS operating_cost_outlier_amt,
                               NUMERIC '0.000' AS operating_drg_payment_amt,
                               NUMERIC '0.000' AS operating_dsh_amt,
                               NUMERIC '0.000' AS operating_outlier_amt,
                               NUMERIC '0.000' AS other_service_charge_amt,
                               NUMERIC '0.000' AS other_service_payment_amt,
                               NUMERIC '0.000' AS outlier_payment_amt,
                               ROUND(CAST(`{{ params.param_bqutil_fns_dataset_name }}`.cw_td_normalize_number(cclog24mcrsnf.account_number) AS NUMERIC), 0, 'ROUND_HALF_EVEN') AS pat_acct_num, -- CAST( '0.00' as DECIMAL(18,3)) as Patient_DW_Id,
 TRIM(substr(cclog24mcrsnf.patient_name, 1, 50)) AS patient_name,
 NUMERIC '0.000' AS payment_adj_amt,
 LAST_DAY(parse_date('%B %Y', cclog24mcrsnf.period_end_date)) AS period_end_date,
 NUMERIC '0.000' AS prorated_drg_weight_amt,
 NUMERIC '0.000' AS ra_coinsurance_amt,
 NUMERIC '0.000' AS ra_contractual_amt,
 NUMERIC '0.000' AS ra_covered_charge_amt,
 0 AS ra_covered_days_cnt,
 NUMERIC '0.000' AS ra_deductible_amt,
 NUMERIC '0.000' AS ra_drg_amt,
 '' AS ra_drg_code,
 '' AS ra_hipps_cmg_code,
 NUMERIC '0.000' AS ra_idme_amt,
 NUMERIC '0.000' AS ra_lab_payment_amt,
 NUMERIC '0.000' AS ra_operating_dsh_amt,
 NUMERIC '0.000' AS ra_operating_idme_amt,
 NUMERIC '0.000' AS ra_operating_outlier_amt,
 NUMERIC '0.000' AS ra_outlier_amt,
 parse_date('%Y-%m-%d', '1900-01-01') AS ra_payment_date,
 NUMERIC '0.000' AS ra_therapy_payment_amt,
 NUMERIC '0.000' AS ra_total_capital_amt,
 NUMERIC '0.000' AS ra_total_payment_amt,
 TRIM(substr(cclog24mcrsnf.rate_schedule_name, 1, 100)) AS rate_schedule_name,
 0 AS remit_cnt,
 NUMERIC '0.000' AS replace_device_reduction_amt,
 TRIM(substr(cclog24mcrsnf.report_name, 1, 100)) AS report_name,
 datetime_trunc(current_datetime('US/Central'), SECOND) AS report_run_date_time,
 substr(cclog24mcrsnf.reporting_period, 1, 25) AS reporting_period,
 ROUND(cclog24mcrsnf.rug_payment, 3, 'ROUND_HALF_EVEN') AS rug_payment_amt,
 '' AS section_month,
 TRIM(substr(cclog24mcrsnf.section_name, 1, 100)) AS section_name,
 ROUND(cclog24mcrsnf.seq, 3, 'ROUND_HALF_EVEN') AS sequestration_amt,
 NUMERIC '0.000' AS short_stay_outlier_payment_amt, -- CAST( '0.00' as DECIMAL(18,3)) as Source_System_Code,
 NUMERIC '0.000' AS tech_add_on_amt,
 NUMERIC '0.000' AS tech_add_on_payment_amt,
 NUMERIC '0.000' AS therapy_charge_amt,
 NUMERIC '0.000' AS therapy_payment_amt,
 ROUND(cclog24mcrsnf.total_charges, 3, 'ROUND_HALF_EVEN') AS total_charge_amt,
 NUMERIC '0.000' AS total_expected_payment_amt,
 NUMERIC '0.000' AS total_opr_cptl_payment_amt,
 NUMERIC '0.000' AS total_payment_amt,
 NUMERIC '0.000' AS transfer_payment_amt,
 cclog24mcrsnf.unit_number AS unit_num,
 'N' AS var_cmg_flag,
 NUMERIC '0.000' AS var_coinsurance_amt,
 NUMERIC '0.000' AS var_contractual_amt,
 NUMERIC '0.000' AS var_covered_charges_amt,
 0 AS var_covered_days_cnt,
 NUMERIC '0.000' AS var_deductible_amt,
 'N' AS var_drg_flag,
 NUMERIC '0.000' AS var_imed_educ_amt,
 NUMERIC '0.000' AS var_lab_payment_amt,
 NUMERIC '0.000' AS var_operating_dsh_amt,
 NUMERIC '0.000' AS var_operating_ime_amt,
 NUMERIC '0.000' AS var_operating_outlier_amt,
 NUMERIC '0.000' AS var_outlier_amt,
 NUMERIC '0.000' AS var_therapy_payment_amt,
 NUMERIC '0.000' AS var_total_capital_amt,
 NUMERIC '0.000' AS var_total_payment_amt
         FROM `{{ params.param_parallon_ra_stage_dataset_name }}`.cclog24mcrsnf
         UNION DISTINCT SELECT NUMERIC '0.000' AS account_balance_amt,
                               '' AS account_status_code,
                               NUMERIC '0.000' AS accrued_capital_subtotal_amt,
                               NUMERIC '0.000' AS accrued_operating_subtotal_amt,
                               NUMERIC '0.000' AS accrued_payment_amt,
                               NUMERIC '0.000' AS apc_charges_amt,
                               NUMERIC '0.000' AS apc_payment_amt,
                               'N' AS auto_posted_flag,
                               NUMERIC '0.000' AS capital_payment_subtotal_amt,
                               parse_date('%Y-%m-%d', '1900-01-01') AS claim_submit_date,
                               NUMERIC '0.000' AS cmac_charge_amt,
                               NUMERIC '0.000' AS cmac_payment_amt,
                               '' AS cmg_code,
                               NUMERIC '0.000' AS cmg_payment_amt,
                               NUMERIC '0.000' AS cmg_weight_amt,
                               cclog65mcrip.coid AS coid,
                               NUMERIC '0.000' AS coinsurance_deductible_amt,
                               'N' AS company_code,
                               NUMERIC '0.000' AS computed_reimb_amt,
                               NUMERIC '0.000' AS cost_outlier_payment_amt,
                               '' AS cost_report_year,
                               NUMERIC '0.000' AS covered_charges_amt,
                               0 AS covered_days_los_cnt,
                               0 AS days_billed_cnt,
                               parse_date('%Y-%m-%d', '1900-01-01') AS discharge_admit_date,
                               0 AS discharge_days_cnt,
                               NUMERIC '0.000' AS drg_arithmetic_los_amt,
                               cclog65mcrip.exp_drg AS drg_code,
                               NUMERIC '0.000' AS drg_payment_amt,
                               NUMERIC '0.000' AS drg_weight_amt,
                               datetime_trunc(current_datetime('US/Central'), SECOND) AS dw_last_update_date_time,
                               NUMERIC '0.000' AS ect_payment_amt,
                               NUMERIC '0.000' AS education_payment_amt,
                               '' AS exp_hipps_cmg_code,
                               TRIM(substr(cclog65mcrip.facility_name, 1, 50)) AS facility_name,
                               NUMERIC '0.000' AS fee_based_payment_amt,
                               NUMERIC '0.000' AS idme_payment_amt,
                               NUMERIC '0.000' AS lab_charge_amt,
                               NUMERIC '0.000' AS lab_payment_amt,
                               NUMERIC '0.000' AS lip_payment_amt,
                               NUMERIC '0.000' AS non_covered_charges_amt,
                               NUMERIC '0.000' AS operating_cost_outlier_amt,
                               NUMERIC '0.000' AS operating_drg_payment_amt,
                               ROUND(cclog65mcrip.exp_operating_dsh, 3, 'ROUND_HALF_EVEN') AS operating_dsh_amt,
                               ROUND(cclog65mcrip.exp_operating_outlier_amt, 3, 'ROUND_HALF_EVEN') AS operating_outlier_amt,
                               NUMERIC '0.000' AS other_service_charge_amt,
                               NUMERIC '0.000' AS other_service_payment_amt,
                               NUMERIC '0.000' AS outlier_payment_amt,
                               NUMERIC '0' AS pat_acct_num, -- CAST( '0.00' as DECIMAL(18,3)) as Patient_DW_Id,
 TRIM(substr(cclog65mcrip.patient_name, 1, 50)) AS patient_name,
 NUMERIC '0.000' AS payment_adj_amt,
 LAST_DAY(parse_date('%B %Y', cclog65mcrip.period_end_date)) AS period_end_date,
 NUMERIC '0.000' AS prorated_drg_weight_amt,
 ROUND(cclog65mcrip.ra_coinsurance, 3, 'ROUND_HALF_EVEN') AS ra_coinsurance_amt,
 ROUND(cclog65mcrip.ra_contractual, 3, 'ROUND_HALF_EVEN') AS ra_contractual_amt,
 ROUND(cclog65mcrip.ra_covered_charges, 3, 'ROUND_HALF_EVEN') AS ra_covered_charge_amt,
 cclog65mcrip.ra_covered_days AS ra_covered_days_cnt,
 ROUND(cclog65mcrip.ra_deductible, 3, 'ROUND_HALF_EVEN') AS ra_deductible_amt,
 NUMERIC '0.000' AS ra_drg_amt,
 '' AS ra_drg_code,
 '' AS ra_hipps_cmg_code,
 NUMERIC '0.000' AS ra_idme_amt,
 NUMERIC '0.000' AS ra_lab_payment_amt,
 ROUND(cclog65mcrip.ra_operating_dsh, 3, 'ROUND_HALF_EVEN') AS ra_operating_dsh_amt,
 ROUND(cclog65mcrip.ra_operating_ime, 3, 'ROUND_HALF_EVEN') AS ra_operating_idme_amt,
 ROUND(cclog65mcrip.ra_operating_outlier_amt, 3, 'ROUND_HALF_EVEN') AS ra_operating_outlier_amt,
 NUMERIC '0.000' AS ra_outlier_amt,
 parse_date('%Y-%m-%d', '1900-01-01') AS ra_payment_date,
 NUMERIC '0.000' AS ra_therapy_payment_amt,
 ROUND(cclog65mcrip.ra_total_capital_amt, 3, 'ROUND_HALF_EVEN') AS ra_total_capital_amt,
 ROUND(cclog65mcrip.ra_total_payment, 3, 'ROUND_HALF_EVEN') AS ra_total_payment_amt,
 TRIM(substr(cclog65mcrip.rate_schedule_name, 1, 100)) AS rate_schedule_name,
 cclog65mcrip.number_of_remits AS remit_cnt,
 NUMERIC '0.000' AS replace_device_reduction_amt,
 TRIM(substr(cclog65mcrip.report_name, 1, 100)) AS report_name,
 datetime_trunc(current_datetime('US/Central'), SECOND) AS report_run_date_time,
 substr(cclog65mcrip.reporting_period, 1, 25) AS reporting_period,
 NUMERIC '0.000' AS rug_payment_amt,
 '' AS section_month,
 '' AS section_name,
 NUMERIC '0.000' AS sequestration_amt,
 NUMERIC '0.000' AS short_stay_outlier_payment_amt, -- CAST( '0.00' as DECIMAL(18,3)) as Source_System_Code,
 NUMERIC '0.000' AS tech_add_on_amt,
 NUMERIC '0.000' AS tech_add_on_payment_amt,
 NUMERIC '0.000' AS therapy_charge_amt,
 NUMERIC '0.000' AS therapy_payment_amt,
 NUMERIC '0.000' AS total_charge_amt,
 NUMERIC '0.000' AS total_expected_payment_amt,
 NUMERIC '0.000' AS total_opr_cptl_payment_amt,
 ROUND(cclog65mcrip.exp_total_payment, 3, 'ROUND_HALF_EVEN') AS total_payment_amt,
 NUMERIC '0.000' AS transfer_payment_amt,
 cclog65mcrip.unit_number AS unit_num,
 'N' AS var_cmg_flag,
 ROUND(cclog65mcrip.var_coinsurance, 3, 'ROUND_HALF_EVEN') AS var_coinsurance_amt,
 ROUND(cclog65mcrip.var_contractual, 3, 'ROUND_HALF_EVEN') AS var_contractual_amt,
 ROUND(cclog65mcrip.var_covered_charges, 3, 'ROUND_HALF_EVEN') AS var_covered_charges_amt,
 cclog65mcrip.var_covered_days AS var_covered_days_cnt,
 ROUND(cclog65mcrip.var_deductible, 3, 'ROUND_HALF_EVEN') AS var_deductible_amt,
 SUBSTR(TRIM(cclog65mcrip.var_drg),1,1) AS var_drg_flag,
 NUMERIC '0.000' AS var_imed_educ_amt,
 NUMERIC '0.000' AS var_lab_payment_amt,
 ROUND(cclog65mcrip.var_operating_dsh, 3, 'ROUND_HALF_EVEN') AS var_operating_dsh_amt,
 ROUND(cclog65mcrip.var_operating_ime, 3, 'ROUND_HALF_EVEN') AS var_operating_ime_amt,
 ROUND(cclog65mcrip.var_operating_outlier_amt, 3, 'ROUND_HALF_EVEN') AS var_operating_outlier_amt,
 NUMERIC '0.000' AS var_outlier_amt,
 NUMERIC '0.000' AS var_therapy_payment_amt,
 ROUND(cclog65mcrip.var_total_capital_amt, 3, 'ROUND_HALF_EVEN') AS var_total_capital_amt,
 ROUND(cclog65mcrip.var_total_payment, 3, 'ROUND_HALF_EVEN') AS var_total_payment_amt
         FROM `{{ params.param_parallon_ra_stage_dataset_name }}`.cclog65mcrip
         UNION DISTINCT SELECT NUMERIC '0.000' AS account_balance_amt,
                               '' AS account_status_code,
                               NUMERIC '0.000' AS accrued_capital_subtotal_amt,
                               NUMERIC '0.000' AS accrued_operating_subtotal_amt,
                               NUMERIC '0.000' AS accrued_payment_amt,
                               NUMERIC '0.000' AS apc_charges_amt,
                               NUMERIC '0.000' AS apc_payment_amt,
                               'N' AS auto_posted_flag,
                               NUMERIC '0.000' AS capital_payment_subtotal_amt,
                               parse_date('%Y-%m-%d', '1900-01-01') AS claim_submit_date,
                               NUMERIC '0.000' AS cmac_charge_amt,
                               NUMERIC '0.000' AS cmac_payment_amt,
                               '' AS cmg_code,
                               NUMERIC '0.000' AS cmg_payment_amt,
                               NUMERIC '0.000' AS cmg_weight_amt,
                               cclog65mcripb.coid AS coid,
                               NUMERIC '0.000' AS coinsurance_deductible_amt,
                               'N' AS company_code,
                               NUMERIC '0.000' AS computed_reimb_amt,
                               NUMERIC '0.000' AS cost_outlier_payment_amt,
                               '' AS cost_report_year,
                               NUMERIC '0.000' AS covered_charges_amt,
                               0 AS covered_days_los_cnt,
                               0 AS days_billed_cnt,
                               parse_date('%Y-%m-%d', '1900-01-01') AS discharge_admit_date,
                               0 AS discharge_days_cnt,
                               NUMERIC '0.000' AS drg_arithmetic_los_amt,
                               cclog65mcripb.exp_drg AS drg_code,
                               NUMERIC '0.000' AS drg_payment_amt,
                               NUMERIC '0.000' AS drg_weight_amt,
                               datetime_trunc(current_datetime('US/Central'), SECOND) AS dw_last_update_date_time,
                               NUMERIC '0.000' AS ect_payment_amt,
                               NUMERIC '0.000' AS education_payment_amt,
                               '' AS exp_hipps_cmg_code,
                               TRIM(substr(cclog65mcripb.facility_name, 1, 50)) AS facility_name,
                               NUMERIC '0.000' AS fee_based_payment_amt,
                               NUMERIC '0.000' AS idme_payment_amt,
                               NUMERIC '0.000' AS lab_charge_amt,
                               NUMERIC '0.000' AS lab_payment_amt,
                               NUMERIC '0.000' AS lip_payment_amt,
                               NUMERIC '0.000' AS non_covered_charges_amt,
                               NUMERIC '0.000' AS operating_cost_outlier_amt,
                               NUMERIC '0.000' AS operating_drg_payment_amt,
                               NUMERIC '0.000' AS operating_dsh_amt,
                               NUMERIC '0.000' AS operating_outlier_amt,
                               NUMERIC '0.000' AS other_service_charge_amt,
                               NUMERIC '0.000' AS other_service_payment_amt,
                               NUMERIC '0.000' AS outlier_payment_amt, -- CAST(Patient_Number as DECIMAL(12,0)) as Pat_Acct_Num,
 ROUND(CAST(`{{ params.param_bqutil_fns_dataset_name }}`.cw_td_normalize_number(CASE
                                                                                  WHEN cclog65mcripb.patient_number LIKE '%*%' THEN translate(cclog65mcripb.patient_number, '*', '')
                                                                                  ELSE cclog65mcripb.patient_number
                                                                              END) AS NUMERIC), 0, 'ROUND_HALF_EVEN') AS pat_acct_num, -- CAST( '0.00' as DECIMAL(18,3)) as Patient_DW_Id,
 TRIM(substr(cclog65mcripb.patient_name, 1, 50)) AS patient_name,
 NUMERIC '0.000' AS payment_adj_amt,
 LAST_DAY(parse_date('%B %Y', cclog65mcripb.period_end_date)) AS period_end_date,
 NUMERIC '0.000' AS prorated_drg_weight_amt,
 ROUND(cclog65mcripb.ra_coinsurance, 3, 'ROUND_HALF_EVEN') AS ra_coinsurance_amt,
 ROUND(cclog65mcripb.ra_contractual, 3, 'ROUND_HALF_EVEN') AS ra_contractual_amt,
 ROUND(cclog65mcripb.ra_covered_charges, 3, 'ROUND_HALF_EVEN') AS ra_covered_charge_amt,
 0 AS ra_covered_days_cnt,
 NUMERIC '0.000' AS ra_deductible_amt,
 NUMERIC '0.000' AS ra_drg_amt,
 '' AS ra_drg_code,
 '' AS ra_hipps_cmg_code,
 NUMERIC '0.000' AS ra_idme_amt,
 NUMERIC '0.000' AS ra_lab_payment_amt,
 NUMERIC '0.000' AS ra_operating_dsh_amt,
 NUMERIC '0.000' AS ra_operating_idme_amt,
 NUMERIC '0.000' AS ra_operating_outlier_amt,
 ROUND(cclog65mcripb.ra_outlier, 3, 'ROUND_HALF_EVEN') AS ra_outlier_amt,
 parse_date('%Y-%m-%d', '1900-01-01') AS ra_payment_date,
 NUMERIC '0.000' AS ra_therapy_payment_amt,
 NUMERIC '0.000' AS ra_total_capital_amt,
 ROUND(cclog65mcripb.ra_total_payment, 3, 'ROUND_HALF_EVEN') AS ra_total_payment_amt,
 TRIM(substr(cclog65mcripb.rate_schedule_name, 1, 100)) AS rate_schedule_name,
 cclog65mcripb.number_of_remits AS remit_cnt,
 NUMERIC '0.000' AS replace_device_reduction_amt,
 TRIM(substr(cclog65mcripb.report_name, 1, 100)) AS report_name,
 datetime_trunc(current_datetime('US/Central'), SECOND) AS report_run_date_time,
 substr(cclog65mcripb.reporting_period, 1, 25) AS reporting_period,
 NUMERIC '0.000' AS rug_payment_amt,
 '' AS section_month,
 '' AS section_name,
 NUMERIC '0.000' AS sequestration_amt,
 NUMERIC '0.000' AS short_stay_outlier_payment_amt, -- CAST( '0.00' as DECIMAL(18,3)) as Source_System_Code,
 NUMERIC '0.000' AS tech_add_on_amt,
 NUMERIC '0.000' AS tech_add_on_payment_amt,
 NUMERIC '0.000' AS therapy_charge_amt,
 NUMERIC '0.000' AS therapy_payment_amt,
 NUMERIC '0.000' AS total_charge_amt,
 NUMERIC '0.000' AS total_expected_payment_amt,
 NUMERIC '0.000' AS total_opr_cptl_payment_amt,
 ROUND(cclog65mcripb.exp_total_payment, 3, 'ROUND_HALF_EVEN') AS total_payment_amt,
 NUMERIC '0.000' AS transfer_payment_amt,
 cclog65mcripb.unit_number AS unit_num,
 'N' AS var_cmg_flag,
 ROUND(cclog65mcripb.var_coinsurance, 3, 'ROUND_HALF_EVEN') AS var_coinsurance_amt,
 ROUND(cclog65mcripb.var_contractual, 3, 'ROUND_HALF_EVEN') AS var_contractual_amt,
 ROUND(cclog65mcripb.var_covered_charges, 3, 'ROUND_HALF_EVEN') AS var_covered_charges_amt,
 0 AS var_covered_days_cnt,
 ROUND(cclog65mcripb.var_deductible, 3, 'ROUND_HALF_EVEN') AS var_deductible_amt,
 SUBSTR(TRIM(cclog65mcripb.var_drg),1,1) AS var_drg_flag,
 NUMERIC '0.000' AS var_imed_educ_amt,
 NUMERIC '0.000' AS var_lab_payment_amt,
 NUMERIC '0.000' AS var_operating_dsh_amt,
 NUMERIC '0.000' AS var_operating_ime_amt,
 NUMERIC '0.000' AS var_operating_outlier_amt,
 ROUND(cclog65mcripb.var_outlier, 3, 'ROUND_HALF_EVEN') AS var_outlier_amt,
 NUMERIC '0.000' AS var_therapy_payment_amt,
 NUMERIC '0.000' AS var_total_capital_amt,
 ROUND(cclog65mcripb.var_total_payment, 3, 'ROUND_HALF_EVEN') AS var_total_payment_amt
         FROM `{{ params.param_parallon_ra_stage_dataset_name }}`.cclog65mcripb
         UNION DISTINCT SELECT NUMERIC '0.000' AS account_balance_amt,
                               '' AS account_status_code,
                               NUMERIC '0.000' AS accrued_capital_subtotal_amt,
                               NUMERIC '0.000' AS accrued_operating_subtotal_amt,
                               NUMERIC '0.000' AS accrued_payment_amt,
                               NUMERIC '0.000' AS apc_charges_amt,
                               NUMERIC '0.000' AS apc_payment_amt,
                               'N' AS auto_posted_flag,
                               NUMERIC '0.000' AS capital_payment_subtotal_amt,
                               parse_date('%Y-%m-%d', '1900-01-01') AS claim_submit_date,
                               NUMERIC '0.000' AS cmac_charge_amt,
                               NUMERIC '0.000' AS cmac_payment_amt,
                               '' AS cmg_code,
                               NUMERIC '0.000' AS cmg_payment_amt,
                               NUMERIC '0.000' AS cmg_weight_amt,
                               cclog65mcripcah.coid AS coid,
                               NUMERIC '0.000' AS coinsurance_deductible_amt,
                               'N' AS company_code,
                               NUMERIC '0.000' AS computed_reimb_amt,
                               NUMERIC '0.000' AS cost_outlier_payment_amt,
                               '' AS cost_report_year,
                               NUMERIC '0.000' AS covered_charges_amt,
                               0 AS covered_days_los_cnt,
                               0 AS days_billed_cnt,
                               parse_date('%Y-%m-%d', '1900-01-01') AS discharge_admit_date,
                               0 AS discharge_days_cnt,
                               NUMERIC '0.000' AS drg_arithmetic_los_amt,
                               '' AS drg_code,
                               NUMERIC '0.000' AS drg_payment_amt,
                               NUMERIC '0.000' AS drg_weight_amt,
                               datetime_trunc(current_datetime('US/Central'), SECOND) AS dw_last_update_date_time,
                               NUMERIC '0.000' AS ect_payment_amt,
                               NUMERIC '0.000' AS education_payment_amt,
                               '' AS exp_hipps_cmg_code,
                               TRIM(substr(cclog65mcripcah.facility_name, 1, 50)) AS facility_name,
                               NUMERIC '0.000' AS fee_based_payment_amt,
                               NUMERIC '0.000' AS idme_payment_amt,
                               NUMERIC '0.000' AS lab_charge_amt,
                               NUMERIC '0.000' AS lab_payment_amt,
                               NUMERIC '0.000' AS lip_payment_amt,
                               NUMERIC '0.000' AS non_covered_charges_amt,
                               NUMERIC '0.000' AS operating_cost_outlier_amt,
                               NUMERIC '0.000' AS operating_drg_payment_amt,
                               NUMERIC '0.000' AS operating_dsh_amt,
                               NUMERIC '0.000' AS operating_outlier_amt,
                               NUMERIC '0.000' AS other_service_charge_amt,
                               NUMERIC '0.000' AS other_service_payment_amt,
                               NUMERIC '0.000' AS outlier_payment_amt,
                               ROUND(CAST(`{{ params.param_bqutil_fns_dataset_name }}`.cw_td_normalize_number(CASE
                                                                                                                WHEN cclog65mcripcah.patient_number LIKE '%*%' THEN translate(cclog65mcripcah.patient_number, '*', '')
                                                                                                                ELSE cclog65mcripcah.patient_number
                                                                                                            END) AS NUMERIC), 0, 'ROUND_HALF_EVEN') AS pat_acct_num, -- CAST( '0.00' as DECIMAL(18,3)) as Patient_DW_Id,
 TRIM(substr(cclog65mcripcah.patient_name, 1, 50)) AS patient_name,
 NUMERIC '0.000' AS payment_adj_amt,
 LAST_DAY(parse_date('%B %Y', cclog65mcripcah.period_end_date)) AS period_end_date,
 NUMERIC '0.000' AS prorated_drg_weight_amt,
 ROUND(cclog65mcripcah.ra_coinsurance, 3, 'ROUND_HALF_EVEN') AS ra_coinsurance_amt,
 ROUND(cclog65mcripcah.ra_contractual, 3, 'ROUND_HALF_EVEN') AS ra_contractual_amt,
 ROUND(cclog65mcripcah.ra_covered_charges, 3, 'ROUND_HALF_EVEN') AS ra_covered_charge_amt,
 cclog65mcripcah.ra_covered_days AS ra_covered_days_cnt,
 ROUND(cclog65mcripcah.ra_deductible, 3, 'ROUND_HALF_EVEN') AS ra_deductible_amt,
 NUMERIC '0.000' AS ra_drg_amt,
 '' AS ra_drg_code,
 '' AS ra_hipps_cmg_code,
 NUMERIC '0.000' AS ra_idme_amt,
 NUMERIC '0.000' AS ra_lab_payment_amt,
 NUMERIC '0.000' AS ra_operating_dsh_amt,
 NUMERIC '0.000' AS ra_operating_idme_amt,
 NUMERIC '0.000' AS ra_operating_outlier_amt,
 NUMERIC '0.000' AS ra_outlier_amt,
 parse_date('%Y-%m-%d', '1900-01-01') AS ra_payment_date,
 NUMERIC '0.000' AS ra_therapy_payment_amt,
 NUMERIC '0.000' AS ra_total_capital_amt,
 ROUND(cclog65mcripcah.ra_total_payment, 3, 'ROUND_HALF_EVEN') AS ra_total_payment_amt,
 TRIM(substr(cclog65mcripcah.rate_schedule_name, 1, 100)) AS rate_schedule_name,
 cclog65mcripcah.number_of_remits AS remit_cnt,
 NUMERIC '0.000' AS replace_device_reduction_amt,
 TRIM(substr(cclog65mcripcah.report_name, 1, 100)) AS report_name,
 datetime_trunc(current_datetime('US/Central'), SECOND) AS report_run_date_time,
 substr(cclog65mcripcah.reporting_period, 1, 25) AS reporting_period,
 NUMERIC '0.000' AS rug_payment_amt,
 '' AS section_month,
 '' AS section_name,
 NUMERIC '0.000' AS sequestration_amt,
 NUMERIC '0.000' AS short_stay_outlier_payment_amt, -- CAST( '0.00' as DECIMAL(18,3)) as Source_System_Code,
 NUMERIC '0.000' AS tech_add_on_amt,
 NUMERIC '0.000' AS tech_add_on_payment_amt,
 NUMERIC '0.000' AS therapy_charge_amt,
 NUMERIC '0.000' AS therapy_payment_amt,
 NUMERIC '0.000' AS total_charge_amt,
 NUMERIC '0.000' AS total_expected_payment_amt,
 NUMERIC '0.000' AS total_opr_cptl_payment_amt,
 ROUND(cclog65mcripcah.exp_total_payment, 3, 'ROUND_HALF_EVEN') AS total_payment_amt,
 NUMERIC '0.000' AS transfer_payment_amt,
 cclog65mcripcah.unit_number AS unit_num,
 'N' AS var_cmg_flag,
 ROUND(cclog65mcripcah.var_coinsurance, 3, 'ROUND_HALF_EVEN') AS var_coinsurance_amt,
 ROUND(cclog65mcripcah.var_contractual, 3, 'ROUND_HALF_EVEN') AS var_contractual_amt,
 ROUND(cclog65mcripcah.var_covered_charges, 3, 'ROUND_HALF_EVEN') AS var_covered_charges_amt,
 0 AS var_covered_days_cnt,
 ROUND(cclog65mcripcah.var_deductible, 3, 'ROUND_HALF_EVEN') AS var_deductible_amt,
 SUBSTR(TRIM(cclog65mcripcah.var_drg),1,1) AS var_drg_flag,
 NUMERIC '0.000' AS var_imed_educ_amt,
 NUMERIC '0.000' AS var_lab_payment_amt,
 NUMERIC '0.000' AS var_operating_dsh_amt,
 NUMERIC '0.000' AS var_operating_ime_amt,
 NUMERIC '0.000' AS var_operating_outlier_amt,
 ROUND(NUMERIC '0', 3, 'ROUND_HALF_EVEN') AS var_outlier_amt,
 NUMERIC '0.000' AS var_therapy_payment_amt,
 NUMERIC '0.000' AS var_total_capital_amt,
 ROUND(cclog65mcripcah.var_total_payment, 3, 'ROUND_HALF_EVEN') AS var_total_payment_amt
         FROM `{{ params.param_parallon_ra_stage_dataset_name }}`.cclog65mcripcah
         UNION DISTINCT SELECT NUMERIC '0.000' AS account_balance_amt,
                               '' AS account_status_code,
                               NUMERIC '0.000' AS accrued_capital_subtotal_amt,
                               NUMERIC '0.000' AS accrued_operating_subtotal_amt,
                               NUMERIC '0.000' AS accrued_payment_amt,
                               NUMERIC '0.000' AS apc_charges_amt,
                               NUMERIC '0.000' AS apc_payment_amt,
                               'N' AS auto_posted_flag,
                               NUMERIC '0.000' AS capital_payment_subtotal_amt,
                               parse_date('%Y-%m-%d', '1900-01-01') AS claim_submit_date,
                               NUMERIC '0.000' AS cmac_charge_amt,
                               NUMERIC '0.000' AS cmac_payment_amt,
                               '' AS cmg_code,
                               NUMERIC '0.000' AS cmg_payment_amt,
                               NUMERIC '0.000' AS cmg_weight_amt,
                               cclog65mcripbcah.coid AS coid,
                               NUMERIC '0.000' AS coinsurance_deductible_amt,
                               'N' AS company_code,
                               NUMERIC '0.000' AS computed_reimb_amt,
                               NUMERIC '0.000' AS cost_outlier_payment_amt,
                               '' AS cost_report_year,
                               ROUND(cclog65mcripbcah.exp_covered_charges, 3, 'ROUND_HALF_EVEN') AS covered_charges_amt,
                               CAST(`{{ params.param_bqutil_fns_dataset_name }}`.cw_td_normalize_number('0.00') AS INT64) AS covered_days_los_cnt,
                               0 AS days_billed_cnt,
                               parse_date('%Y-%m-%d', '1900-01-01') AS discharge_admit_date,
                               0 AS discharge_days_cnt,
                               NUMERIC '0.000' AS drg_arithmetic_los_amt,
                               '' AS drg_code,
                               NUMERIC '0.000' AS drg_payment_amt,
                               NUMERIC '0.000' AS drg_weight_amt,
                               datetime_trunc(current_datetime('US/Central'), SECOND) AS dw_last_update_date_time,
                               NUMERIC '0.000' AS ect_payment_amt,
                               NUMERIC '0.000' AS education_payment_amt,
                               '' AS exp_hipps_cmg_code,
                               TRIM(substr(cclog65mcripbcah.facility_name, 1, 50)) AS facility_name,
                               NUMERIC '0.000' AS fee_based_payment_amt,
                               NUMERIC '0.000' AS idme_payment_amt,
                               NUMERIC '0.000' AS lab_charge_amt,
                               NUMERIC '0.000' AS lab_payment_amt,
                               NUMERIC '0.000' AS lip_payment_amt,
                               NUMERIC '0.000' AS non_covered_charges_amt,
                               NUMERIC '0.000' AS operating_cost_outlier_amt,
                               NUMERIC '0.000' AS operating_drg_payment_amt,
                               NUMERIC '0.000' AS operating_dsh_amt,
                               NUMERIC '0.000' AS operating_outlier_amt,
                               NUMERIC '0.000' AS other_service_charge_amt,
                               NUMERIC '0.000' AS other_service_payment_amt,
                               NUMERIC '0.000' AS outlier_payment_amt, -- CAST(Patient_Number as DECIMAL(12,0)) as Pat_Acct_Num,
 ROUND(CAST(`{{ params.param_bqutil_fns_dataset_name }}`.cw_td_normalize_number(CASE
                                                                                  WHEN cclog65mcripbcah.patient_number LIKE '%*%' THEN translate(cclog65mcripbcah.patient_number, '*', '')
                                                                                  ELSE cclog65mcripbcah.patient_number
                                                                              END) AS NUMERIC), 0, 'ROUND_HALF_EVEN') AS pat_acct_num, -- CAST( '0.00' as DECIMAL(18,3)) as Patient_DW_Id,
 TRIM(substr(cclog65mcripbcah.patient_name, 1, 50)) AS patient_name,
 NUMERIC '0.000' AS payment_adj_amt,
 LAST_DAY(parse_date('%B %Y', cclog65mcripbcah.period_end_date)) AS period_end_date,
 NUMERIC '0.000' AS prorated_drg_weight_amt,
 ROUND(cclog65mcripbcah.ra_coinsurance, 3, 'ROUND_HALF_EVEN') AS ra_coinsurance_amt,
 ROUND(cclog65mcripbcah.ra_contractual, 3, 'ROUND_HALF_EVEN') AS ra_contractual_amt,
 ROUND(cclog65mcripbcah.ra_covered_charges, 3, 'ROUND_HALF_EVEN') AS ra_covered_charge_amt,
 0 AS ra_covered_days_cnt,
 ROUND(cclog65mcripbcah.ra_deductible, 3, 'ROUND_HALF_EVEN') AS ra_deductible_amt,
 NUMERIC '0.000' AS ra_drg_amt,
 '' AS ra_drg_code,
 '' AS ra_hipps_cmg_code,
 NUMERIC '0.000' AS ra_idme_amt,
 NUMERIC '0.000' AS ra_lab_payment_amt,
 NUMERIC '0.000' AS ra_operating_dsh_amt,
 NUMERIC '0.000' AS ra_operating_idme_amt,
 NUMERIC '0.000' AS ra_operating_outlier_amt,
 NUMERIC '0.000' AS ra_outlier_amt,
 parse_date('%Y-%m-%d', '1900-01-01') AS ra_payment_date,
 NUMERIC '0.000' AS ra_therapy_payment_amt,
 NUMERIC '0.000' AS ra_total_capital_amt,
 ROUND(cclog65mcripbcah.ra_total_payment, 3, 'ROUND_HALF_EVEN') AS ra_total_payment_amt,
 TRIM(substr(cclog65mcripbcah.rate_schedule_name, 1, 100)) AS rate_schedule_name,
 cclog65mcripbcah.number_of_remits AS remit_cnt,
 NUMERIC '0.000' AS replace_device_reduction_amt,
 TRIM(substr(cclog65mcripbcah.report_name, 1, 100)) AS report_name,
 datetime_trunc(current_datetime('US/Central'), SECOND) AS report_run_date_time,
 substr(cclog65mcripbcah.reporting_period, 1, 25) AS reporting_period,
 NUMERIC '0.000' AS rug_payment_amt,
 '' AS section_month,
 '' AS section_name,
 NUMERIC '0.000' AS sequestration_amt,
 NUMERIC '0.000' AS short_stay_outlier_payment_amt, -- CAST( '0.00' as DECIMAL(18,3)) as Source_System_Code,
 NUMERIC '0.000' AS tech_add_on_amt,
 NUMERIC '0.000' AS tech_add_on_payment_amt,
 NUMERIC '0.000' AS therapy_charge_amt,
 NUMERIC '0.000' AS therapy_payment_amt,
 NUMERIC '0.000' AS total_charge_amt,
 NUMERIC '0.000' AS total_expected_payment_amt,
 NUMERIC '0.000' AS total_opr_cptl_payment_amt,
 ROUND(cclog65mcripbcah.exp_total_payment, 3, 'ROUND_HALF_EVEN') AS total_payment_amt,
 NUMERIC '0.000' AS transfer_payment_amt,
 cclog65mcripbcah.unit_number AS unit_num,
 'N' AS var_cmg_flag,
 ROUND(cclog65mcripbcah.var_coinsurance, 3, 'ROUND_HALF_EVEN') AS var_coinsurance_amt,
 ROUND(cclog65mcripbcah.var_contractual, 3, 'ROUND_HALF_EVEN') AS var_contractual_amt,
 ROUND(cclog65mcripbcah.var_covered_charges, 3, 'ROUND_HALF_EVEN') AS var_covered_charges_amt,
 0 AS var_covered_days_cnt,
 ROUND(cclog65mcripbcah.var_deductible, 3, 'ROUND_HALF_EVEN') AS var_deductible_amt,
 'N' AS var_drg_flag,
 NUMERIC '0.000' AS var_imed_educ_amt,
 NUMERIC '0.000' AS var_lab_payment_amt,
 NUMERIC '0.000' AS var_operating_dsh_amt,
 NUMERIC '0.000' AS var_operating_ime_amt,
 NUMERIC '0.000' AS var_operating_outlier_amt,
 NUMERIC '0.000' AS var_outlier_amt,
 NUMERIC '0.000' AS var_therapy_payment_amt,
 NUMERIC '0.000' AS var_total_capital_amt,
 ROUND(cclog65mcripbcah.var_total_payment, 3, 'ROUND_HALF_EVEN') AS var_total_payment_amt
         FROM `{{ params.param_parallon_ra_stage_dataset_name }}`.cclog65mcripbcah
         UNION DISTINCT SELECT NUMERIC '0.000' AS account_balance_amt,
                               '' AS account_status_code,
                               NUMERIC '0.000' AS accrued_capital_subtotal_amt,
                               NUMERIC '0.000' AS accrued_operating_subtotal_amt,
                               NUMERIC '0.000' AS accrued_payment_amt,
                               NUMERIC '0.000' AS apc_charges_amt,
                               NUMERIC '0.000' AS apc_payment_amt,
                               'N' AS auto_posted_flag,
                               NUMERIC '0.000' AS capital_payment_subtotal_amt,
                               parse_date('%Y-%m-%d', '1900-01-01') AS claim_submit_date,
                               NUMERIC '0.000' AS cmac_charge_amt,
                               NUMERIC '0.000' AS cmac_payment_amt,
                               '' AS cmg_code,
                               NUMERIC '0.000' AS cmg_payment_amt,
                               NUMERIC '0.000' AS cmg_weight_amt,
                               cclog65mcripf.coid AS coid,
                               NUMERIC '0.000' AS coinsurance_deductible_amt,
                               'N' AS company_code,
                               NUMERIC '0.000' AS computed_reimb_amt,
                               NUMERIC '0.000' AS cost_outlier_payment_amt,
                               '' AS cost_report_year,
                               NUMERIC '0.000' AS covered_charges_amt,
                               0 AS covered_days_los_cnt,
                               0 AS days_billed_cnt,
                               parse_date('%Y-%m-%d', '1900-01-01') AS discharge_admit_date,
                               0 AS discharge_days_cnt,
                               NUMERIC '0.000' AS drg_arithmetic_los_amt,
                               '' AS drg_code,
                               NUMERIC '0.000' AS drg_payment_amt,
                               NUMERIC '0.000' AS drg_weight_amt,
                               datetime_trunc(current_datetime('US/Central'), SECOND) AS dw_last_update_date_time,
                               NUMERIC '0.000' AS ect_payment_amt,
                               NUMERIC '0.000' AS education_payment_amt,
                               '' AS exp_hipps_cmg_code,
                               TRIM(substr(cclog65mcripf.facility_name, 1, 50)) AS facility_name,
                               NUMERIC '0.000' AS fee_based_payment_amt,
                               NUMERIC '0.000' AS idme_payment_amt,
                               NUMERIC '0.000' AS lab_charge_amt,
                               NUMERIC '0.000' AS lab_payment_amt,
                               NUMERIC '0.000' AS lip_payment_amt,
                               NUMERIC '0.000' AS non_covered_charges_amt,
                               NUMERIC '0.000' AS operating_cost_outlier_amt,
                               NUMERIC '0.000' AS operating_drg_payment_amt,
                               NUMERIC '0.000' AS operating_dsh_amt,
                               NUMERIC '0.000' AS operating_outlier_amt,
                               NUMERIC '0.000' AS other_service_charge_amt,
                               NUMERIC '0.000' AS other_service_payment_amt,
                               NUMERIC '0.000' AS outlier_payment_amt, -- CAST(Patient_Number as DECIMAL(12,0)) as Pat_Acct_Num,
 ROUND(CAST(`{{ params.param_bqutil_fns_dataset_name }}`.cw_td_normalize_number(CASE
                                                                                  WHEN cclog65mcripf.patient_number LIKE '%*%' THEN translate(cclog65mcripf.patient_number, '*', '')
                                                                                  ELSE cclog65mcripf.patient_number
                                                                              END) AS NUMERIC), 0, 'ROUND_HALF_EVEN') AS pat_acct_num, -- CAST( '0.00' as DECIMAL(18,3)) as Patient_DW_Id,
 TRIM(substr(cclog65mcripf.patient_name, 1, 50)) AS patient_name,
 NUMERIC '0.000' AS payment_adj_amt,
 LAST_DAY(parse_date('%B %Y', cclog65mcripf.period_end_date)) AS period_end_date,
 NUMERIC '0.000' AS prorated_drg_weight_amt,
 ROUND(cclog65mcripf.ra_coinsurance, 3, 'ROUND_HALF_EVEN') AS ra_coinsurance_amt,
 ROUND(cclog65mcripf.ra_contractual, 3, 'ROUND_HALF_EVEN') AS ra_contractual_amt,
 ROUND(cclog65mcripf.ra_covered_charges, 3, 'ROUND_HALF_EVEN') AS ra_covered_charge_amt,
 cclog65mcripf.ra_covered_days AS ra_covered_days_cnt,
 ROUND(cclog65mcripf.ra_deductible, 3, 'ROUND_HALF_EVEN') AS ra_deductible_amt,
 NUMERIC '0.000' AS ra_drg_amt,
 '' AS ra_drg_code,
 '' AS ra_hipps_cmg_code,
 NUMERIC '0.000' AS ra_idme_amt,
 NUMERIC '0.000' AS ra_lab_payment_amt,
 NUMERIC '0.000' AS ra_operating_dsh_amt,
 NUMERIC '0.000' AS ra_operating_idme_amt,
 NUMERIC '0.000' AS ra_operating_outlier_amt,
 ROUND(cclog65mcripf.ra_outlier, 3, 'ROUND_HALF_EVEN') AS ra_outlier_amt,
 parse_date('%Y-%m-%d', '1900-01-01') AS ra_payment_date,
 NUMERIC '0.000' AS ra_therapy_payment_amt,
 NUMERIC '0.000' AS ra_total_capital_amt,
 ROUND(cclog65mcripf.ra_total_payment, 3, 'ROUND_HALF_EVEN') AS ra_total_payment_amt,
 TRIM(substr(cclog65mcripf.rate_schedule_name, 1, 100)) AS rate_schedule_name,
 cclog65mcripf.number_of_remits AS remit_cnt,
 NUMERIC '0.000' AS replace_device_reduction_amt,
 TRIM(substr(cclog65mcripf.report_name, 1, 100)) AS report_name,
 datetime_trunc(current_datetime('US/Central'), SECOND) AS report_run_date_time,
 substr(cclog65mcripf.reporting_period, 1, 25) AS reporting_period,
 NUMERIC '0.000' AS rug_payment_amt,
 '' AS section_month,
 '' AS section_name,
 NUMERIC '0.000' AS sequestration_amt,
 NUMERIC '0.000' AS short_stay_outlier_payment_amt, -- CAST( '0.00' as DECIMAL(18,3)) as Source_System_Code,
 NUMERIC '0.000' AS tech_add_on_amt,
 NUMERIC '0.000' AS tech_add_on_payment_amt,
 NUMERIC '0.000' AS therapy_charge_amt,
 NUMERIC '0.000' AS therapy_payment_amt,
 NUMERIC '0.000' AS total_charge_amt,
 NUMERIC '0.000' AS total_expected_payment_amt,
 NUMERIC '0.000' AS total_opr_cptl_payment_amt,
 ROUND(cclog65mcripf.exp_total_payment, 3, 'ROUND_HALF_EVEN') AS total_payment_amt,
 NUMERIC '0.000' AS transfer_payment_amt,
 cclog65mcripf.unit_number AS unit_num,
 'N' AS var_cmg_flag,
 ROUND(cclog65mcripf.var_coinsurance, 3, 'ROUND_HALF_EVEN') AS var_coinsurance_amt,
 ROUND(cclog65mcripf.var_contractual, 3, 'ROUND_HALF_EVEN') AS var_contractual_amt,
 ROUND(cclog65mcripf.var_covered_charges, 3, 'ROUND_HALF_EVEN') AS var_covered_charges_amt,
 cclog65mcripf.var_covered_days AS var_covered_days_cnt,
 ROUND(cclog65mcripf.var_deductible, 3, 'ROUND_HALF_EVEN') AS var_deductible_amt,
 SUBSTR(TRIM(cclog65mcripf.var_drg),1,1) AS var_drg_flag,
 NUMERIC '0.000' AS var_imed_educ_amt,
 NUMERIC '0.000' AS var_lab_payment_amt,
 NUMERIC '0.000' AS var_operating_dsh_amt,
 NUMERIC '0.000' AS var_operating_ime_amt,
 NUMERIC '0.000' AS var_operating_outlier_amt,
 ROUND(cclog65mcripf.var_outlier, 3, 'ROUND_HALF_EVEN') AS var_outlier_amt,
 NUMERIC '0.000' AS var_therapy_payment_amt,
 NUMERIC '0.000' AS var_total_capital_amt,
 ROUND(cclog65mcripf.var_total_payment, 3, 'ROUND_HALF_EVEN') AS var_total_payment_amt
         FROM `{{ params.param_parallon_ra_stage_dataset_name }}`.cclog65mcripf
         UNION DISTINCT SELECT NUMERIC '0.000' AS account_balance_amt,
                               '' AS account_status_code,
                               NUMERIC '0.000' AS accrued_capital_subtotal_amt,
                               NUMERIC '0.000' AS accrued_operating_subtotal_amt,
                               NUMERIC '0.000' AS accrued_payment_amt,
                               NUMERIC '0.000' AS apc_charges_amt,
                               NUMERIC '0.000' AS apc_payment_amt,
                               'N' AS auto_posted_flag,
                               NUMERIC '0.000' AS capital_payment_subtotal_amt,
                               parse_date('%Y-%m-%d', '1900-01-01') AS claim_submit_date,
                               NUMERIC '0.000' AS cmac_charge_amt,
                               NUMERIC '0.000' AS cmac_payment_amt,
                               '' AS cmg_code,
                               NUMERIC '0.000' AS cmg_payment_amt,
                               NUMERIC '0.000' AS cmg_weight_amt,
                               cclog65mcripswb.coid AS coid,
                               NUMERIC '0.000' AS coinsurance_deductible_amt,
                               'N' AS company_code,
                               NUMERIC '0.000' AS computed_reimb_amt,
                               NUMERIC '0.000' AS cost_outlier_payment_amt,
                               '' AS cost_report_year,
                               NUMERIC '0.000' AS covered_charges_amt,
                               0 AS covered_days_los_cnt,
                               0 AS days_billed_cnt,
                               parse_date('%Y-%m-%d', '1900-01-01') AS discharge_admit_date,
                               0 AS discharge_days_cnt,
                               NUMERIC '0.000' AS drg_arithmetic_los_amt,
                               '' AS drg_code,
                               NUMERIC '0.000' AS drg_payment_amt,
                               NUMERIC '0.000' AS drg_weight_amt,
                               datetime_trunc(current_datetime('US/Central'), SECOND) AS dw_last_update_date_time,
                               NUMERIC '0.000' AS ect_payment_amt,
                               NUMERIC '0.000' AS education_payment_amt,
                               '' AS exp_hipps_cmg_code,
                               TRIM(substr(cclog65mcripswb.facility_name, 1, 50)) AS facility_name,
                               NUMERIC '0.000' AS fee_based_payment_amt,
                               NUMERIC '0.000' AS idme_payment_amt,
                               NUMERIC '0.000' AS lab_charge_amt,
                               NUMERIC '0.000' AS lab_payment_amt,
                               NUMERIC '0.000' AS lip_payment_amt,
                               NUMERIC '0.000' AS non_covered_charges_amt,
                               NUMERIC '0.000' AS operating_cost_outlier_amt,
                               NUMERIC '0.000' AS operating_drg_payment_amt,
                               NUMERIC '0.000' AS operating_dsh_amt,
                               NUMERIC '0.000' AS operating_outlier_amt,
                               NUMERIC '0.000' AS other_service_charge_amt,
                               NUMERIC '0.000' AS other_service_payment_amt,
                               NUMERIC '0.000' AS outlier_payment_amt, -- CAST(Patient_Number as DECIMAL(12,0)) as Pat_Acct_Num,
 ROUND(CAST(`{{ params.param_bqutil_fns_dataset_name }}`.cw_td_normalize_number(CASE
                                                                                  WHEN cclog65mcripswb.patient_number LIKE '%*%' THEN translate(cclog65mcripswb.patient_number, '*', '')
                                                                                  ELSE cclog65mcripswb.patient_number
                                                                              END) AS NUMERIC), 0, 'ROUND_HALF_EVEN') AS pat_acct_num, -- -CAST( '0' as DECIMAL(18,3)) as Patient_DW_Id,
 TRIM(substr(cclog65mcripswb.patient_name, 1, 50)) AS patient_name,
 NUMERIC '0.000' AS payment_adj_amt,
 LAST_DAY(parse_date('%B %Y', cclog65mcripswb.period_end_date)) AS period_end_date,
 NUMERIC '0.000' AS prorated_drg_weight_amt,
 ROUND(cclog65mcripswb.ra_coinsurance, 3, 'ROUND_HALF_EVEN') AS ra_coinsurance_amt,
 ROUND(cclog65mcripswb.ra_contractual, 3, 'ROUND_HALF_EVEN') AS ra_contractual_amt,
 ROUND(cclog65mcripswb.ra_covered_charges, 3, 'ROUND_HALF_EVEN') AS ra_covered_charge_amt,
 cclog65mcripswb.ra_covered_days AS ra_covered_days_cnt,
 ROUND(cclog65mcripswb.ra_deductible, 3, 'ROUND_HALF_EVEN') AS ra_deductible_amt,
 NUMERIC '0.000' AS ra_drg_amt,
 '' AS ra_drg_code,
 '' AS ra_hipps_cmg_code,
 NUMERIC '0.000' AS ra_idme_amt,
 NUMERIC '0.000' AS ra_lab_payment_amt,
 NUMERIC '0.000' AS ra_operating_dsh_amt,
 NUMERIC '0.000' AS ra_operating_idme_amt,
 NUMERIC '0.000' AS ra_operating_outlier_amt,
 NUMERIC '0.000' AS ra_outlier_amt,
 parse_date('%Y-%m-%d', '1900-01-01') AS ra_payment_date,
 NUMERIC '0.000' AS ra_therapy_payment_amt,
 NUMERIC '0.000' AS ra_total_capital_amt,
 ROUND(cclog65mcripswb.ra_total_payment, 3, 'ROUND_HALF_EVEN') AS ra_total_payment_amt,
 TRIM(substr(cclog65mcripswb.rate_schedule_name, 1, 100)) AS rate_schedule_name,
 cclog65mcripswb.number_of_remits AS remit_cnt,
 NUMERIC '0.000' AS replace_device_reduction_amt,
 TRIM(substr(cclog65mcripswb.report_name, 1, 100)) AS report_name,
 datetime_trunc(current_datetime('US/Central'), SECOND) AS report_run_date_time,
 substr(cclog65mcripswb.reporting_period, 1, 25) AS reporting_period,
 NUMERIC '0.000' AS rug_payment_amt,
 '' AS section_month,
 '' AS section_name,
 NUMERIC '0.000' AS sequestration_amt,
 NUMERIC '0.000' AS short_stay_outlier_payment_amt, -- CAST( '0.00' as DECIMAL(18,3)) as Source_System_Code,
 NUMERIC '0.000' AS tech_add_on_amt,
 NUMERIC '0.000' AS tech_add_on_payment_amt,
 NUMERIC '0.000' AS therapy_charge_amt,
 NUMERIC '0.000' AS therapy_payment_amt,
 NUMERIC '0.000' AS total_charge_amt,
 NUMERIC '0.000' AS total_expected_payment_amt,
 NUMERIC '0.000' AS total_opr_cptl_payment_amt,
 ROUND(cclog65mcripswb.exp_total_payment, 3, 'ROUND_HALF_EVEN') AS total_payment_amt,
 NUMERIC '0.000' AS transfer_payment_amt,
 cclog65mcripswb.unit_number AS unit_num,
 'N' AS var_cmg_flag,
 ROUND(cclog65mcripswb.var_coinsurance, 3, 'ROUND_HALF_EVEN') AS var_coinsurance_amt,
 ROUND(cclog65mcripswb.var_contractual, 3, 'ROUND_HALF_EVEN') AS var_contractual_amt,
 ROUND(cclog65mcripswb.var_covered_charges, 3, 'ROUND_HALF_EVEN') AS var_covered_charges_amt,
 cclog65mcripswb.var_covered_days AS var_covered_days_cnt,
 ROUND(cclog65mcripswb.var_deductible, 3, 'ROUND_HALF_EVEN') AS var_deductible_amt,
 SUBSTR(TRIM(cclog65mcripswb.var_drg),1,1) AS var_drg_flag,
 NUMERIC '0.000' AS var_imed_educ_amt,
 NUMERIC '0.000' AS var_lab_payment_amt,
 NUMERIC '0.000' AS var_operating_dsh_amt,
 NUMERIC '0.000' AS var_operating_ime_amt,
 NUMERIC '0.000' AS var_operating_outlier_amt,
 NUMERIC '0.000' AS var_outlier_amt,
 NUMERIC '0.000' AS var_therapy_payment_amt,
 NUMERIC '0.000' AS var_total_capital_amt,
 ROUND(cclog65mcripswb.var_total_payment, 3, 'ROUND_HALF_EVEN') AS var_total_payment_amt
         FROM `{{ params.param_parallon_ra_stage_dataset_name }}`.cclog65mcripswb
         UNION DISTINCT SELECT NUMERIC '0.000' AS account_balance_amt,
                               '' AS account_status_code,
                               NUMERIC '0.000' AS accrued_capital_subtotal_amt,
                               NUMERIC '0.000' AS accrued_operating_subtotal_amt,
                               NUMERIC '0.000' AS accrued_payment_amt,
                               NUMERIC '0.000' AS apc_charges_amt,
                               NUMERIC '0.000' AS apc_payment_amt,
                               'N' AS auto_posted_flag,
                               NUMERIC '0.000' AS capital_payment_subtotal_amt,
                               parse_date('%Y-%m-%d', '1900-01-01') AS claim_submit_date,
                               NUMERIC '0.000' AS cmac_charge_amt,
                               NUMERIC '0.000' AS cmac_payment_amt,
                               '' AS cmg_code,
                               NUMERIC '0.000' AS cmg_payment_amt,
                               NUMERIC '0.000' AS cmg_weight_amt,
                               cclog65mcrirf.coid AS coid,
                               NUMERIC '0.000' AS coinsurance_deductible_amt,
                               'N' AS company_code,
                               NUMERIC '0.000' AS computed_reimb_amt,
                               NUMERIC '0.000' AS cost_outlier_payment_amt,
                               '' AS cost_report_year,
                               NUMERIC '0.000' AS covered_charges_amt,
                               0 AS covered_days_los_cnt,
                               0 AS days_billed_cnt,
                               parse_date('%Y-%m-%d', '1900-01-01') AS discharge_admit_date,
                               0 AS discharge_days_cnt,
                               NUMERIC '0.000' AS drg_arithmetic_los_amt,
                               '' AS drg_code,
                               NUMERIC '0.000' AS drg_payment_amt,
                               NUMERIC '0.000' AS drg_weight_amt,
                               datetime_trunc(current_datetime('US/Central'), SECOND) AS dw_last_update_date_time,
                               NUMERIC '0.000' AS ect_payment_amt,
                               NUMERIC '0.000' AS education_payment_amt,
                               cclog65mcrirf.exp_hipps_cmg AS exp_hipps_cmg_code,
                               TRIM(substr(cclog65mcrirf.facility_name, 1, 50)) AS facility_name,
                               NUMERIC '0.000' AS fee_based_payment_amt,
                               NUMERIC '0.000' AS idme_payment_amt,
                               NUMERIC '0.000' AS lab_charge_amt,
                               NUMERIC '0.000' AS lab_payment_amt,
                               NUMERIC '0.000' AS lip_payment_amt,
                               NUMERIC '0.000' AS non_covered_charges_amt,
                               NUMERIC '0.000' AS operating_cost_outlier_amt,
                               NUMERIC '0.000' AS operating_drg_payment_amt,
                               NUMERIC '0.000' AS operating_dsh_amt,
                               NUMERIC '0.000' AS operating_outlier_amt,
                               NUMERIC '0.000' AS other_service_charge_amt,
                               NUMERIC '0.000' AS other_service_payment_amt,
                               NUMERIC '0.000' AS outlier_payment_amt, -- CAST(Patient_Number as DECIMAL(12,0)) as Pat_Acct_Num,
 ROUND(CAST(`{{ params.param_bqutil_fns_dataset_name }}`.cw_td_normalize_number(CASE
                                                                                  WHEN cclog65mcrirf.patient_number LIKE '%*%' THEN translate(cclog65mcrirf.patient_number, '*', '')
                                                                                  ELSE cclog65mcrirf.patient_number
                                                                              END) AS NUMERIC), 0, 'ROUND_HALF_EVEN') AS pat_acct_num, -- CAST( '0.00' as DECIMAL(18,3)) as Patient_DW_Id,
 TRIM(substr(cclog65mcrirf.patient_name, 1, 50)) AS patient_name,
 NUMERIC '0.000' AS payment_adj_amt,
 LAST_DAY(parse_date('%B %Y', cclog65mcrirf.period_end_date)) AS period_end_date,
 NUMERIC '0.000' AS prorated_drg_weight_amt,
 ROUND(cclog65mcrirf.ra_coinsurance, 3, 'ROUND_HALF_EVEN') AS ra_coinsurance_amt,
 ROUND(cclog65mcrirf.ra_contractual, 3, 'ROUND_HALF_EVEN') AS ra_contractual_amt,
 ROUND(cclog65mcrirf.ra_covered_charges, 3, 'ROUND_HALF_EVEN') AS ra_covered_charge_amt,
 cclog65mcrirf.ra_covered_days AS ra_covered_days_cnt,
 ROUND(cclog65mcrirf.ra_deductible, 3, 'ROUND_HALF_EVEN') AS ra_deductible_amt,
 NUMERIC '0.000' AS ra_drg_amt,
 '' AS ra_drg_code,
 cclog65mcrirf.ra_hipps_cmg AS ra_hipps_cmg_code,
 NUMERIC '0.000' AS ra_idme_amt,
 NUMERIC '0.000' AS ra_lab_payment_amt,
 NUMERIC '0.000' AS ra_operating_dsh_amt,
 NUMERIC '0.000' AS ra_operating_idme_amt,
 NUMERIC '0.000' AS ra_operating_outlier_amt,
 ROUND(cclog65mcrirf.ra_total_outlier_amt, 3, 'ROUND_HALF_EVEN') AS ra_outlier_amt,
 parse_date('%Y-%m-%d', '1900-01-01') AS ra_payment_date,
 NUMERIC '0.000' AS ra_therapy_payment_amt,
 NUMERIC '0.000' AS ra_total_capital_amt,
 ROUND(cclog65mcrirf.ra_total_payment, 3, 'ROUND_HALF_EVEN') AS ra_total_payment_amt,
 TRIM(substr(cclog65mcrirf.rate_schedule_name, 1, 100)) AS rate_schedule_name,
 cclog65mcrirf.number_of_remits AS remit_cnt,
 NUMERIC '0.000' AS replace_device_reduction_amt,
 TRIM(substr(cclog65mcrirf.report_name, 1, 100)) AS report_name,
 datetime_trunc(current_datetime('US/Central'), SECOND) AS report_run_date_time,
 substr(cclog65mcrirf.reporting_period, 1, 25) AS reporting_period,
 NUMERIC '0.000' AS rug_payment_amt,
 '' AS section_month,
 '' AS section_name,
 NUMERIC '0.000' AS sequestration_amt,
 NUMERIC '0.000' AS short_stay_outlier_payment_amt, -- CAST( '0.00' as DECIMAL(18,3)) as Source_System_Code,
 NUMERIC '0.000' AS tech_add_on_amt,
 NUMERIC '0.000' AS tech_add_on_payment_amt,
 NUMERIC '0.000' AS therapy_charge_amt,
 NUMERIC '0.000' AS therapy_payment_amt,
 NUMERIC '0.000' AS total_charge_amt,
 NUMERIC '0.000' AS total_expected_payment_amt,
 NUMERIC '0.000' AS total_opr_cptl_payment_amt,
 ROUND(cclog65mcrirf.exp_total_payment, 3, 'ROUND_HALF_EVEN') AS total_payment_amt,
 NUMERIC '0.000' AS transfer_payment_amt,
 cclog65mcrirf.unit_number AS unit_num,
 SUBSTR(TRIM(cclog65mcrirf.var_cmg),1,1) AS var_cmg_flag,
 ROUND(cclog65mcrirf.var_coinsurance, 3, 'ROUND_HALF_EVEN') AS var_coinsurance_amt,
 ROUND(cclog65mcrirf.var_contractual, 3, 'ROUND_HALF_EVEN') AS var_contractual_amt,
 ROUND(cclog65mcrirf.var_covered_charges, 3, 'ROUND_HALF_EVEN') AS var_covered_charges_amt,
 cclog65mcrirf.var_covered_days AS var_covered_days_cnt,
 ROUND(cclog65mcrirf.var_deductible, 3, 'ROUND_HALF_EVEN') AS var_deductible_amt,
 'N' AS var_drg_flag,
 NUMERIC '0.000' AS var_imed_educ_amt,
 NUMERIC '0.000' AS var_lab_payment_amt,
 NUMERIC '0.000' AS var_operating_dsh_amt,
 NUMERIC '0.000' AS var_operating_ime_amt,
 NUMERIC '0.000' AS var_operating_outlier_amt,
 ROUND(cclog65mcrirf.var_tota_outlier_amt, 3, 'ROUND_HALF_EVEN') AS var_outlier_amt,
 NUMERIC '0.000' AS var_therapy_payment_amt,
 NUMERIC '0.000' AS var_total_capital_amt,
 ROUND(cclog65mcrirf.var_total_payment, 3, 'ROUND_HALF_EVEN') AS var_total_payment_amt
         FROM `{{ params.param_parallon_ra_stage_dataset_name }}`.cclog65mcrirf
         UNION DISTINCT SELECT NUMERIC '0.000' AS account_balance_amt,
                               '' AS account_status_code,
                               NUMERIC '0.000' AS accrued_capital_subtotal_amt,
                               NUMERIC '0.000' AS accrued_operating_subtotal_amt,
                               NUMERIC '0.000' AS accrued_payment_amt,
                               NUMERIC '0.000' AS apc_charges_amt,
                               NUMERIC '0.000' AS apc_payment_amt,
                               'N' AS auto_posted_flag,
                               NUMERIC '0.000' AS capital_payment_subtotal_amt,
                               parse_date('%Y-%m-%d', '1900-01-01') AS claim_submit_date,
                               NUMERIC '0.000' AS cmac_charge_amt,
                               NUMERIC '0.000' AS cmac_payment_amt,
                               '' AS cmg_code,
                               NUMERIC '0.000' AS cmg_payment_amt,
                               NUMERIC '0.000' AS cmg_weight_amt,
                               cclog65mcrltch.coid AS coid,
                               NUMERIC '0.000' AS coinsurance_deductible_amt,
                               'N' AS company_code,
                               NUMERIC '0.000' AS computed_reimb_amt,
                               NUMERIC '0.000' AS cost_outlier_payment_amt,
                               '' AS cost_report_year,
                               NUMERIC '0.000' AS covered_charges_amt,
                               0 AS covered_days_los_cnt,
                               0 AS days_billed_cnt,
                               parse_date('%Y-%m-%d', '1900-01-01') AS discharge_admit_date,
                               0 AS discharge_days_cnt,
                               NUMERIC '0.000' AS drg_arithmetic_los_amt,
                               '' AS drg_code,
                               NUMERIC '0.000' AS drg_payment_amt,
                               NUMERIC '0.000' AS drg_weight_amt,
                               datetime_trunc(current_datetime('US/Central'), SECOND) AS dw_last_update_date_time,
                               NUMERIC '0.000' AS ect_payment_amt,
                               NUMERIC '0.000' AS education_payment_amt,
                               '' AS exp_hipps_cmg_code,
                               TRIM(substr(cclog65mcrltch.facility_name, 1, 50)) AS facility_name,
                               NUMERIC '0.000' AS fee_based_payment_amt,
                               NUMERIC '0.000' AS idme_payment_amt,
                               NUMERIC '0.000' AS lab_charge_amt,
                               NUMERIC '0.000' AS lab_payment_amt,
                               NUMERIC '0.000' AS lip_payment_amt,
                               NUMERIC '0.000' AS non_covered_charges_amt,
                               NUMERIC '0.000' AS operating_cost_outlier_amt,
                               NUMERIC '0.000' AS operating_drg_payment_amt,
                               NUMERIC '0.000' AS operating_dsh_amt,
                               NUMERIC '0.000' AS operating_outlier_amt,
                               NUMERIC '0.000' AS other_service_charge_amt,
                               NUMERIC '0.000' AS other_service_payment_amt,
                               NUMERIC '0.000' AS outlier_payment_amt, -- CAST(Patient_Number as DECIMAL(12,0)) as Pat_Acct_Num,
 ROUND(CAST(`{{ params.param_bqutil_fns_dataset_name }}`.cw_td_normalize_number(CASE
                                                                                  WHEN cclog65mcrltch.patient_number LIKE '%*%' THEN translate(cclog65mcrltch.patient_number, '*', '')
                                                                                  ELSE cclog65mcrltch.patient_number
                                                                              END) AS NUMERIC), 0, 'ROUND_HALF_EVEN') AS pat_acct_num, -- CAST( '0.00' as DECIMAL(18,3)) as Patient_DW_Id,
 TRIM(substr(cclog65mcrltch.patient_name, 1, 50)) AS patient_name,
 NUMERIC '0.000' AS payment_adj_amt,
 LAST_DAY(parse_date('%B %Y', cclog65mcrltch.period_end_date)) AS period_end_date,
 NUMERIC '0.000' AS prorated_drg_weight_amt,
 ROUND(cclog65mcrltch.ra_coinsurance, 3, 'ROUND_HALF_EVEN') AS ra_coinsurance_amt,
 ROUND(cclog65mcrltch.ra_contractual, 3, 'ROUND_HALF_EVEN') AS ra_contractual_amt,
 CAST(CAST(cclog65mcrltch.ra_covered_charges AS INT64) AS NUMERIC) AS ra_covered_charge_amt,
 CAST(CAST(cclog65mcrltch.ra_covered_days AS NUMERIC) AS INT64) AS ra_covered_days_cnt,
 ROUND(cclog65mcrltch.ra_deductible, 3, 'ROUND_HALF_EVEN') AS ra_deductible_amt,
 NUMERIC '0.000' AS ra_drg_amt,
 '' AS ra_drg_code,
 '' AS ra_hipps_cmg_code,
 NUMERIC '0.000' AS ra_idme_amt,
 NUMERIC '0.000' AS ra_lab_payment_amt,
 NUMERIC '0.000' AS ra_operating_dsh_amt,
 NUMERIC '0.000' AS ra_operating_idme_amt,
 NUMERIC '0.000' AS ra_operating_outlier_amt,
 NUMERIC '0.000' AS ra_outlier_amt,
 parse_date('%Y-%m-%d', '1900-01-01') AS ra_payment_date,
 NUMERIC '0.000' AS ra_therapy_payment_amt,
 NUMERIC '0.000' AS ra_total_capital_amt,
 ROUND(cclog65mcrltch.ra_total_payment, 3, 'ROUND_HALF_EVEN') AS ra_total_payment_amt,
 TRIM(substr(cclog65mcrltch.rate_schedule_name, 1, 100)) AS rate_schedule_name,
 cclog65mcrltch.number_of_remits AS remit_cnt,
 NUMERIC '0.000' AS replace_device_reduction_amt,
 TRIM(substr(cclog65mcrltch.report_name, 1, 100)) AS report_name,
 datetime_trunc(current_datetime('US/Central'), SECOND) AS report_run_date_time,
 substr(cclog65mcrltch.reporting_period, 1, 25) AS reporting_period,
 NUMERIC '0.000' AS rug_payment_amt,
 '' AS section_month,
 '' AS section_name,
 NUMERIC '0.000' AS sequestration_amt,
 NUMERIC '0.000' AS short_stay_outlier_payment_amt, -- CAST( '0.00' as DECIMAL(18,3)) as Source_System_Code,
 NUMERIC '0.000' AS tech_add_on_amt,
 NUMERIC '0.000' AS tech_add_on_payment_amt,
 NUMERIC '0.000' AS therapy_charge_amt,
 NUMERIC '0.000' AS therapy_payment_amt,
 NUMERIC '0.000' AS total_charge_amt,
 NUMERIC '0.000' AS total_expected_payment_amt,
 NUMERIC '0.000' AS total_opr_cptl_payment_amt,
 ROUND(cclog65mcrltch.exp_total_payment, 3, 'ROUND_HALF_EVEN') AS total_payment_amt,
 NUMERIC '0.000' AS transfer_payment_amt,
 cclog65mcrltch.unit_number AS unit_num,
 'N' AS var_cmg_flag,
 ROUND(cclog65mcrltch.var_coinsurance, 3, 'ROUND_HALF_EVEN') AS var_coinsurance_amt,
 ROUND(cclog65mcrltch.var_contractual, 3, 'ROUND_HALF_EVEN') AS var_contractual_amt,
 ROUND(cclog65mcrltch.var_covered_charges, 3, 'ROUND_HALF_EVEN') AS var_covered_charges_amt,
 cclog65mcrltch.var_covered_days AS var_covered_days_cnt,
 ROUND(cclog65mcrltch.var_deductible, 3, 'ROUND_HALF_EVEN') AS var_deductible_amt,
 SUBSTR(TRIM(cclog65mcrltch.var_drg),1,1) AS var_drg_flag,
 NUMERIC '0.000' AS var_imed_educ_amt,
 NUMERIC '0.000' AS var_lab_payment_amt,
 NUMERIC '0.000' AS var_operating_dsh_amt,
 NUMERIC '0.000' AS var_operating_ime_amt,
 NUMERIC '0.000' AS var_operating_outlier_amt,
 NUMERIC '0.000' AS var_outlier_amt,
 NUMERIC '0.000' AS var_therapy_payment_amt,
 NUMERIC '0.000' AS var_total_capital_amt,
 ROUND(cclog65mcrltch.var_total_payment, 3, 'ROUND_HALF_EVEN') AS var_total_payment_amt
         FROM `{{ params.param_parallon_ra_stage_dataset_name }}`.cclog65mcrltch
         UNION DISTINCT SELECT NUMERIC '0.000' AS account_balance_amt,
                               '' AS account_status_code,
                               NUMERIC '0.000' AS accrued_capital_subtotal_amt,
                               NUMERIC '0.000' AS accrued_operating_subtotal_amt,
                               NUMERIC '0.000' AS accrued_payment_amt,
                               NUMERIC '0.000' AS apc_charges_amt,
                               NUMERIC '0.000' AS apc_payment_amt,
                               'N' AS auto_posted_flag,
                               NUMERIC '0.000' AS capital_payment_subtotal_amt,
                               parse_date('%Y-%m-%d', '1900-01-01') AS claim_submit_date,
                               NUMERIC '0.000' AS cmac_charge_amt,
                               NUMERIC '0.000' AS cmac_payment_amt,
                               '' AS cmg_code,
                               NUMERIC '0.000' AS cmg_payment_amt,
                               NUMERIC '0.000' AS cmg_weight_amt,
                               cclog65mcrop.coid AS coid,
                               NUMERIC '0.000' AS coinsurance_deductible_amt,
                               'N' AS company_code,
                               NUMERIC '0.000' AS computed_reimb_amt,
                               NUMERIC '0.000' AS cost_outlier_payment_amt,
                               '' AS cost_report_year,
                               NUMERIC '0.000' AS covered_charges_amt,
                               0 AS covered_days_los_cnt,
                               0 AS days_billed_cnt,
                               parse_date('%Y-%m-%d', '1900-01-01') AS discharge_admit_date,
                               0 AS discharge_days_cnt,
                               NUMERIC '0.000' AS drg_arithmetic_los_amt,
                               '' AS drg_code,
                               NUMERIC '0.000' AS drg_payment_amt,
                               NUMERIC '0.000' AS drg_weight_amt,
                               datetime_trunc(current_datetime('US/Central'), SECOND) AS dw_last_update_date_time,
                               NUMERIC '0.000' AS ect_payment_amt,
                               NUMERIC '0.000' AS education_payment_amt,
                               '' AS exp_hipps_cmg_code,
                               TRIM(substr(cclog65mcrop.facility_name, 1, 50)) AS facility_name,
                               NUMERIC '0.000' AS fee_based_payment_amt,
                               NUMERIC '0.000' AS idme_payment_amt,
                               NUMERIC '0.000' AS lab_charge_amt,
                               ROUND(cclog65mcrop.exp_lab_pymt, 3, 'ROUND_HALF_EVEN') AS lab_payment_amt,
                               NUMERIC '0.000' AS lip_payment_amt,
                               NUMERIC '0.000' AS non_covered_charges_amt,
                               NUMERIC '0.000' AS operating_cost_outlier_amt,
                               NUMERIC '0.000' AS operating_drg_payment_amt,
                               NUMERIC '0.000' AS operating_dsh_amt,
                               NUMERIC '0.000' AS operating_outlier_amt,
                               NUMERIC '0.000' AS other_service_charge_amt,
                               NUMERIC '0.000' AS other_service_payment_amt,
                               NUMERIC '0.000' AS outlier_payment_amt, -- CAST(Patient_Number as DECIMAL(12,0)) as Pat_Acct_Num,
 ROUND(CAST(`{{ params.param_bqutil_fns_dataset_name }}`.cw_td_normalize_number(CASE
                                                                                  WHEN cclog65mcrop.patient_number LIKE '%*%' THEN translate(cclog65mcrop.patient_number, '*', '')
                                                                                  ELSE cclog65mcrop.patient_number
                                                                              END) AS NUMERIC), 0, 'ROUND_HALF_EVEN') AS pat_acct_num, -- CAST( '0.00' as DECIMAL(18,3)) as Patient_DW_Id,
 TRIM(substr(cclog65mcrop.patient_name, 1, 50)) AS patient_name,
 NUMERIC '0.000' AS payment_adj_amt,
 LAST_DAY(parse_date('%B %Y', cclog65mcrop.period_end_date)) AS period_end_date,
 NUMERIC '0.000' AS prorated_drg_weight_amt,
 ROUND(cclog65mcrop.ra_coinsurance, 3, 'ROUND_HALF_EVEN') AS ra_coinsurance_amt,
 ROUND(cclog65mcrop.ra_contractual, 3, 'ROUND_HALF_EVEN') AS ra_contractual_amt,
 ROUND(cclog65mcrop.ra_covered_charges, 3, 'ROUND_HALF_EVEN') AS ra_covered_charge_amt,
 0 AS ra_covered_days_cnt,
 NUMERIC '0.000' AS ra_deductible_amt,
 NUMERIC '0.000' AS ra_drg_amt,
 '' AS ra_drg_code,
 '' AS ra_hipps_cmg_code,
 NUMERIC '0.000' AS ra_idme_amt,
 ROUND(cclog65mcrop.ra_lab_pymt, 3, 'ROUND_HALF_EVEN') AS ra_lab_payment_amt,
 NUMERIC '0.000' AS ra_operating_dsh_amt,
 NUMERIC '0.000' AS ra_operating_idme_amt,
 NUMERIC '0.000' AS ra_operating_outlier_amt,
 NUMERIC '0.000' AS ra_outlier_amt,
 parse_date('%Y-%m-%d', '1900-01-01') AS ra_payment_date,
 ROUND(cclog65mcrop.ra_therapy_pymt, 3, 'ROUND_HALF_EVEN') AS ra_therapy_payment_amt,
 NUMERIC '0.000' AS ra_total_capital_amt,
 ROUND(cclog65mcrop.ra_total_payment, 3, 'ROUND_HALF_EVEN') AS ra_total_payment_amt,
 TRIM(substr(cclog65mcrop.rate_schedule_name, 1, 100)) AS rate_schedule_name,
 cclog65mcrop.number_of_remits AS remit_cnt,
 NUMERIC '0.000' AS replace_device_reduction_amt,
 TRIM(substr(cclog65mcrop.report_name, 1, 100)) AS report_name,
 datetime_trunc(current_datetime('US/Central'), SECOND) AS report_run_date_time,
 substr(cclog65mcrop.reporting_period, 1, 25) AS reporting_period,
 NUMERIC '0.000' AS rug_payment_amt,
 '' AS section_month,
 '' AS section_name,
 NUMERIC '0.000' AS sequestration_amt,
 NUMERIC '0.000' AS short_stay_outlier_payment_amt, -- CAST( '0.00' as DECIMAL(18,3)) as Source_System_Code,
 NUMERIC '0.000' AS tech_add_on_amt,
 NUMERIC '0.000' AS tech_add_on_payment_amt,
 NUMERIC '0.000' AS therapy_charge_amt,
 ROUND(cclog65mcrop.exp_therapy_pymt, 3, 'ROUND_HALF_EVEN') AS therapy_payment_amt,
 NUMERIC '0.000' AS total_charge_amt,
 NUMERIC '0.000' AS total_expected_payment_amt,
 NUMERIC '0.000' AS total_opr_cptl_payment_amt,
 ROUND(cclog65mcrop.exp_total_payment, 3, 'ROUND_HALF_EVEN') AS total_payment_amt,
 NUMERIC '0.000' AS transfer_payment_amt,
 cclog65mcrop.unit_number AS unit_num,
 'N' AS var_cmg_flag,
 ROUND(cclog65mcrop.var_coinsurance, 3, 'ROUND_HALF_EVEN') AS var_coinsurance_amt,
 ROUND(cclog65mcrop.var_contractual, 3, 'ROUND_HALF_EVEN') AS var_contractual_amt,
 ROUND(cclog65mcrop.var_covered_charges, 3, 'ROUND_HALF_EVEN') AS var_covered_charges_amt,
 0 AS var_covered_days_cnt,
 ROUND(cclog65mcrop.var_deductible, 3, 'ROUND_HALF_EVEN') AS var_deductible_amt,
 'N' AS var_drg_flag,
 NUMERIC '0.000' AS var_imed_educ_amt,
 ROUND(cclog65mcrop.var_lab_pymt, 3, 'ROUND_HALF_EVEN') AS var_lab_payment_amt,
 NUMERIC '0.000' AS var_operating_dsh_amt,
 NUMERIC '0.000' AS var_operating_ime_amt,
 NUMERIC '0.000' AS var_operating_outlier_amt,
 ROUND(cclog65mcrop.var_outlier, 3, 'ROUND_HALF_EVEN') AS var_outlier_amt,
 ROUND(cclog65mcrop.var_therapy_pymt, 3, 'ROUND_HALF_EVEN') AS var_therapy_payment_amt,
 NUMERIC '0.000' AS var_total_capital_amt,
 ROUND(cclog65mcrop.var_total_payment, 3, 'ROUND_HALF_EVEN') AS var_total_payment_amt
         FROM `{{ params.param_parallon_ra_stage_dataset_name }}`.cclog65mcrop
         UNION DISTINCT SELECT NUMERIC '0.000' AS account_balance_amt,
                               '' AS account_status_code,
                               NUMERIC '0.000' AS accrued_capital_subtotal_amt,
                               NUMERIC '0.000' AS accrued_operating_subtotal_amt,
                               NUMERIC '0.000' AS accrued_payment_amt,
                               NUMERIC '0.000' AS apc_charges_amt,
                               NUMERIC '0.000' AS apc_payment_amt,
                               'N' AS auto_posted_flag,
                               NUMERIC '0.000' AS capital_payment_subtotal_amt,
                               parse_date('%Y-%m-%d', '1900-01-01') AS claim_submit_date,
                               NUMERIC '0.000' AS cmac_charge_amt,
                               NUMERIC '0.000' AS cmac_payment_amt,
                               '' AS cmg_code,
                               NUMERIC '0.000' AS cmg_payment_amt,
                               NUMERIC '0.000' AS cmg_weight_amt,
                               cclog65mcropcah.coid AS coid,
                               NUMERIC '0.000' AS coinsurance_deductible_amt,
                               'N' AS company_code,
                               NUMERIC '0.000' AS computed_reimb_amt,
                               NUMERIC '0.000' AS cost_outlier_payment_amt,
                               '' AS cost_report_year,
                               NUMERIC '0.000' AS covered_charges_amt,
                               0 AS covered_days_los_cnt,
                               0 AS days_billed_cnt,
                               parse_date('%Y-%m-%d', '1900-01-01') AS discharge_admit_date,
                               0 AS discharge_days_cnt,
                               NUMERIC '0.000' AS drg_arithmetic_los_amt,
                               '' AS drg_code,
                               NUMERIC '0.000' AS drg_payment_amt,
                               NUMERIC '0.000' AS drg_weight_amt,
                               datetime_trunc(current_datetime('US/Central'), SECOND) AS dw_last_update_date_time,
                               NUMERIC '0.000' AS ect_payment_amt,
                               NUMERIC '0.000' AS education_payment_amt,
                               '' AS exp_hipps_cmg_code,
                               TRIM(substr(cclog65mcropcah.facility_name, 1, 50)) AS facility_name,
                               NUMERIC '0.000' AS fee_based_payment_amt,
                               NUMERIC '0.000' AS idme_payment_amt,
                               NUMERIC '0.000' AS lab_charge_amt,
                               NUMERIC '0.000' AS lab_payment_amt,
                               NUMERIC '0.000' AS lip_payment_amt,
                               NUMERIC '0.000' AS non_covered_charges_amt,
                               NUMERIC '0.000' AS operating_cost_outlier_amt,
                               NUMERIC '0.000' AS operating_drg_payment_amt,
                               NUMERIC '0.000' AS operating_dsh_amt,
                               NUMERIC '0.000' AS operating_outlier_amt,
                               NUMERIC '0.000' AS other_service_charge_amt,
                               NUMERIC '0.000' AS other_service_payment_amt,
                               NUMERIC '0.000' AS outlier_payment_amt, -- CAST(Patient_Number as DECIMAL(12,0)) as Pat_Acct_Num,
 ROUND(CAST(`{{ params.param_bqutil_fns_dataset_name }}`.cw_td_normalize_number(CASE
                                                                                  WHEN cclog65mcropcah.patient_number LIKE '%*%' THEN translate(cclog65mcropcah.patient_number, '*', '')
                                                                                  ELSE cclog65mcropcah.patient_number
                                                                              END) AS NUMERIC), 0, 'ROUND_HALF_EVEN') AS pat_acct_num, -- CAST( '0.00' as DECIMAL(18,3)) as Patient_DW_Id,
 TRIM(substr(cclog65mcropcah.patient_name, 1, 50)) AS patient_name,
 NUMERIC '0.000' AS payment_adj_amt,
 LAST_DAY(parse_date('%B %Y', cclog65mcropcah.period_end_date)) AS period_end_date,
 NUMERIC '0.000' AS prorated_drg_weight_amt,
 ROUND(cclog65mcropcah.ra_coinsurance, 3, 'ROUND_HALF_EVEN') AS ra_coinsurance_amt,
 ROUND(cclog65mcropcah.ra_contractual, 3, 'ROUND_HALF_EVEN') AS ra_contractual_amt,
 ROUND(cclog65mcropcah.ra_covered_charges, 3, 'ROUND_HALF_EVEN') AS ra_covered_charge_amt,
 0 AS ra_covered_days_cnt,
 ROUND(cclog65mcropcah.ra_deductible, 3, 'ROUND_HALF_EVEN') AS ra_deductible_amt,
 NUMERIC '0.000' AS ra_drg_amt,
 '' AS ra_drg_code,
 '' AS ra_hipps_cmg_code,
 NUMERIC '0.000' AS ra_idme_amt,
 NUMERIC '0.000' AS ra_lab_payment_amt,
 NUMERIC '0.000' AS ra_operating_dsh_amt,
 NUMERIC '0.000' AS ra_operating_idme_amt,
 NUMERIC '0.000' AS ra_operating_outlier_amt,
 NUMERIC '0.000' AS ra_outlier_amt,
 parse_date('%Y-%m-%d', '1900-01-01') AS ra_payment_date,
 NUMERIC '0.000' AS ra_therapy_payment_amt,
 NUMERIC '0.000' AS ra_total_capital_amt,
 ROUND(cclog65mcropcah.ra_total_payment, 3, 'ROUND_HALF_EVEN') AS ra_total_payment_amt,
 TRIM(substr(cclog65mcropcah.rate_schedule_name, 1, 100)) AS rate_schedule_name,
 cclog65mcropcah.number_of_remits AS remit_cnt,
 NUMERIC '0.000' AS replace_device_reduction_amt,
 '0.00' AS report_name,
 datetime_trunc(current_datetime('US/Central'), SECOND) AS report_run_date_time,
 substr(cclog65mcropcah.reporting_period, 1, 25) AS reporting_period,
 NUMERIC '0.000' AS rug_payment_amt,
 '' AS section_month,
 '' AS section_name,
 NUMERIC '0.000' AS sequestration_amt,
 NUMERIC '0.000' AS short_stay_outlier_payment_amt, -- CAST( '0.00' as DECIMAL(18,3)) as Source_System_Code,
 NUMERIC '0.000' AS tech_add_on_amt,
 NUMERIC '0.000' AS tech_add_on_payment_amt,
 NUMERIC '0.000' AS therapy_charge_amt,
 NUMERIC '0.000' AS therapy_payment_amt,
 NUMERIC '0.000' AS total_charge_amt,
 NUMERIC '0.000' AS total_expected_payment_amt,
 NUMERIC '0.000' AS total_opr_cptl_payment_amt,
 ROUND(cclog65mcropcah.exp_total_payment, 3, 'ROUND_HALF_EVEN') AS total_payment_amt,
 NUMERIC '0.000' AS transfer_payment_amt,
 cclog65mcropcah.unit_number AS unit_num,
 'N' AS var_cmg_flag,
 ROUND(cclog65mcropcah.var_coinsurance, 3, 'ROUND_HALF_EVEN') AS var_coinsurance_amt,
 ROUND(cclog65mcropcah.var_contractual, 3, 'ROUND_HALF_EVEN') AS var_contractual_amt,
 ROUND(cclog65mcropcah.var_covered_charges, 3, 'ROUND_HALF_EVEN') AS var_covered_charges_amt,
 0 AS var_covered_days_cnt,
 ROUND(cclog65mcropcah.var_deductible, 3, 'ROUND_HALF_EVEN') AS var_deductible_amt,
 'N' AS var_drg_flag,
 NUMERIC '0.000' AS var_imed_educ_amt,
 NUMERIC '0.000' AS var_lab_payment_amt,
 NUMERIC '0.000' AS var_operating_dsh_amt,
 NUMERIC '0.000' AS var_operating_ime_amt,
 NUMERIC '0.000' AS var_operating_outlier_amt,
 NUMERIC '0.000' AS var_outlier_amt,
 NUMERIC '0.000' AS var_therapy_payment_amt,
 NUMERIC '0.000' AS var_total_capital_amt,
 ROUND(cclog65mcropcah.var_total_payment, 3, 'ROUND_HALF_EVEN') AS var_total_payment_amt
         FROM `{{ params.param_parallon_ra_stage_dataset_name }}`.cclog65mcropcah
         UNION DISTINCT SELECT NUMERIC '0.000' AS account_balance_amt,
                               '' AS account_status_code,
                               NUMERIC '0.000' AS accrued_capital_subtotal_amt,
                               NUMERIC '0.000' AS accrued_operating_subtotal_amt,
                               NUMERIC '0.000' AS accrued_payment_amt,
                               NUMERIC '0.000' AS apc_charges_amt,
                               NUMERIC '0.000' AS apc_payment_amt,
                               'N' AS auto_posted_flag,
                               NUMERIC '0.000' AS capital_payment_subtotal_amt,
                               parse_date('%Y-%m-%d', '1900-01-01') AS claim_submit_date,
                               NUMERIC '0.000' AS cmac_charge_amt,
                               NUMERIC '0.000' AS cmac_payment_amt,
                               '' AS cmg_code,
                               NUMERIC '0.000' AS cmg_payment_amt,
                               NUMERIC '0.000' AS cmg_weight_amt,
                               cclog65mcrsnf.coid AS coid,
                               NUMERIC '0.000' AS coinsurance_deductible_amt,
                               'N' AS company_code,
                               NUMERIC '0.000' AS computed_reimb_amt,
                               NUMERIC '0.000' AS cost_outlier_payment_amt,
                               '' AS cost_report_year,
                               NUMERIC '0.000' AS covered_charges_amt,
                               0 AS covered_days_los_cnt,
                               0 AS days_billed_cnt,
                               parse_date('%Y-%m-%d', '1900-01-01') AS discharge_admit_date,
                               0 AS discharge_days_cnt,
                               NUMERIC '0.000' AS drg_arithmetic_los_amt,
                               '' AS drg_code,
                               NUMERIC '0.000' AS drg_payment_amt,
                               NUMERIC '0.000' AS drg_weight_amt,
                               datetime_trunc(current_datetime('US/Central'), SECOND) AS dw_last_update_date_time,
                               NUMERIC '0.000' AS ect_payment_amt,
                               NUMERIC '0.000' AS education_payment_amt,
                               '' AS exp_hipps_cmg_code,
                               TRIM(substr(cclog65mcrsnf.facility_name, 1, 50)) AS facility_name,
                               NUMERIC '0.000' AS fee_based_payment_amt,
                               NUMERIC '0.000' AS idme_payment_amt,
                               NUMERIC '0.000' AS lab_charge_amt,
                               NUMERIC '0.000' AS lab_payment_amt,
                               NUMERIC '0.000' AS lip_payment_amt,
                               NUMERIC '0.000' AS non_covered_charges_amt,
                               NUMERIC '0.000' AS operating_cost_outlier_amt,
                               NUMERIC '0.000' AS operating_drg_payment_amt,
                               NUMERIC '0.000' AS operating_dsh_amt,
                               NUMERIC '0.000' AS operating_outlier_amt,
                               NUMERIC '0.000' AS other_service_charge_amt,
                               NUMERIC '0.000' AS other_service_payment_amt,
                               NUMERIC '0.000' AS outlier_payment_amt, -- CAST(Patient_Number as DECIMAL(12,0)) as Pat_Acct_Num,
 ROUND(CAST(`{{ params.param_bqutil_fns_dataset_name }}`.cw_td_normalize_number(CASE
                                                                                  WHEN cclog65mcrsnf.patient_number LIKE '%*%' THEN translate(cclog65mcrsnf.patient_number, '*', '')
                                                                                  ELSE cclog65mcrsnf.patient_number
                                                                              END) AS NUMERIC), 0, 'ROUND_HALF_EVEN') AS pat_acct_num, -- CAST( '0.00' as DECIMAL(18,3)) as Patient_DW_Id,
 TRIM(substr(cclog65mcrsnf.patient_name, 1, 50)) AS patient_name,
 NUMERIC '0.000' AS payment_adj_amt,
 LAST_DAY(parse_date('%B %Y', cclog65mcrsnf.period_end_date)) AS period_end_date,
 NUMERIC '0.000' AS prorated_drg_weight_amt,
 ROUND(cclog65mcrsnf.ra_coinsurance, 3, 'ROUND_HALF_EVEN') AS ra_coinsurance_amt,
 ROUND(cclog65mcrsnf.ra_contractual, 3, 'ROUND_HALF_EVEN') AS ra_contractual_amt,
 ROUND(cclog65mcrsnf.ra_covered_charges, 3, 'ROUND_HALF_EVEN') AS ra_covered_charge_amt,
 0 AS ra_covered_days_cnt,
 ROUND(cclog65mcrsnf.ra_deductible, 3, 'ROUND_HALF_EVEN') AS ra_deductible_amt,
 NUMERIC '0.000' AS ra_drg_amt,
 '' AS ra_drg_code,
 '' AS ra_hipps_cmg_code,
 NUMERIC '0.000' AS ra_idme_amt,
 NUMERIC '0.000' AS ra_lab_payment_amt,
 NUMERIC '0.000' AS ra_operating_dsh_amt,
 NUMERIC '0.000' AS ra_operating_idme_amt,
 NUMERIC '0.000' AS ra_operating_outlier_amt,
 NUMERIC '0.000' AS ra_outlier_amt,
 parse_date('%Y-%m-%d', '1900-01-01') AS ra_payment_date,
 NUMERIC '0.000' AS ra_therapy_payment_amt,
 NUMERIC '0.000' AS ra_total_capital_amt,
 ROUND(cclog65mcrsnf.ra_total_payment, 3, 'ROUND_HALF_EVEN') AS ra_total_payment_amt,
 TRIM(substr(cclog65mcrsnf.rate_schedule_name, 1, 100)) AS rate_schedule_name,
 cclog65mcrsnf.number_of_remits AS remit_cnt,
 NUMERIC '0.000' AS replace_device_reduction_amt,
 TRIM(substr(cclog65mcrsnf.report_name, 1, 100)) AS report_name,
 datetime_trunc(current_datetime('US/Central'), SECOND) AS report_run_date_time,
 substr(cclog65mcrsnf.reporting_period, 1, 25) AS reporting_period,
 NUMERIC '0.000' AS rug_payment_amt,
 '' AS section_month,
 '' AS section_name,
 NUMERIC '0.000' AS sequestration_amt,
 NUMERIC '0.000' AS short_stay_outlier_payment_amt, -- CAST( '0.00' as DECIMAL(18,3)) as Source_System_Code,
 NUMERIC '0.000' AS tech_add_on_amt,
 NUMERIC '0.000' AS tech_add_on_payment_amt,
 NUMERIC '0.000' AS therapy_charge_amt,
 NUMERIC '0.000' AS therapy_payment_amt,
 NUMERIC '0.000' AS total_charge_amt,
 NUMERIC '0.000' AS total_expected_payment_amt,
 NUMERIC '0.000' AS total_opr_cptl_payment_amt,
 NUMERIC '0.000' AS total_payment_amt,
 NUMERIC '0.000' AS transfer_payment_amt,
 cclog65mcrsnf.unit_number AS unit_num,
 'N' AS var_cmg_flag,
 ROUND(cclog65mcrsnf.var_coinsurance, 3, 'ROUND_HALF_EVEN') AS var_coinsurance_amt,
 ROUND(cclog65mcrsnf.var_contractual, 3, 'ROUND_HALF_EVEN') AS var_contractual_amt,
 ROUND(cclog65mcrsnf.var_covered_charges, 3, 'ROUND_HALF_EVEN') AS var_covered_charges_amt,
 cclog65mcrsnf.var_covered_days AS var_covered_days_cnt,
 ROUND(cclog65mcrsnf.var_deductible, 3, 'ROUND_HALF_EVEN') AS var_deductible_amt,
 'N' AS var_drg_flag,
 NUMERIC '0.000' AS var_imed_educ_amt,
 NUMERIC '0.000' AS var_lab_payment_amt,
 NUMERIC '0.000' AS var_operating_dsh_amt,
 NUMERIC '0.000' AS var_operating_ime_amt,
 NUMERIC '0.000' AS var_operating_outlier_amt,
 NUMERIC '0.000' AS var_outlier_amt,
 NUMERIC '0.000' AS var_therapy_payment_amt,
 NUMERIC '0.000' AS var_total_capital_amt,
 ROUND(cclog65mcrsnf.var_total_payment, 3, 'ROUND_HALF_EVEN') AS var_total_payment_amt
         FROM `{{ params.param_parallon_ra_stage_dataset_name }}`.cclog65mcrsnf) AS b
      WHERE b.pat_acct_num <> 0
      GROUP BY upper(b.account_status_code),
               upper(b.auto_posted_flag),
               11,
               upper(b.cmg_code),
               110,
               111,
               upper(b.cost_report_year),
               24,
               25,
               26,
               27,
               upper(b.drg_code),
               32,
               upper(b.exp_hipps_cmg_code),
               upper(b.facility_name),
               50,
               upper(b.patient_name),
               53,
               58,
               upper(b.ra_drg_code),
               upper(b.ra_hipps_cmg_code),
               69,
               upper(b.rate_schedule_name),
               74,
               upper(b.report_name),
               77,
               upper(b.reporting_period),
               upper(b.section_month),
               upper(b.section_name),
               upper(b.unit_num),
               upper(b.var_cmg_flag),
               98,
               upper(b.var_drg_flag)) AS cw_win_ss QUALIFY row_number() OVER (PARTITION BY cw_win_ss.pat_acct_num,
                                                                                           cw_win_ss.cw_win_part_0,
                                                                                           cw_win_ss.cw_win_part_1
                                                                              ORDER BY cw_win_ss.pat_acct_num,
                                                                                       cw_win_ss.cw_win_part_0,
                                                                                       cw_win_ss.cw_win_part_1) = cw_win_ss.patient_dw_id) AS ms ON mt.patient_dw_id = ms.patient_dw_id
AND (coalesce(mt.account_balance_amt, NUMERIC '0') = coalesce(ms.col0, NUMERIC '0')
     AND coalesce(mt.account_balance_amt, NUMERIC '1') = coalesce(ms.col0, NUMERIC '1'))
AND (upper(coalesce(mt.account_status_code, '0')) = upper(coalesce(ms.account_status_code, '0'))
     AND upper(coalesce(mt.account_status_code, '1')) = upper(coalesce(ms.account_status_code, '1')))
AND (coalesce(mt.accrued_capital_subtotal_amt, NUMERIC '0') = coalesce(ms.col1, NUMERIC '0')
     AND coalesce(mt.accrued_capital_subtotal_amt, NUMERIC '1') = coalesce(ms.col1, NUMERIC '1'))
AND (coalesce(mt.accrued_operating_subtotal_amt, NUMERIC '0') = coalesce(ms.col2, NUMERIC '0')
     AND coalesce(mt.accrued_operating_subtotal_amt, NUMERIC '1') = coalesce(ms.col2, NUMERIC '1'))
AND (coalesce(mt.accrued_payment_amt, NUMERIC '0') = coalesce(ms.col3, NUMERIC '0')
     AND coalesce(mt.accrued_payment_amt, NUMERIC '1') = coalesce(ms.col3, NUMERIC '1'))
AND (coalesce(mt.apc_charges_amt, NUMERIC '0') = coalesce(ms.col4, NUMERIC '0')
     AND coalesce(mt.apc_charges_amt, NUMERIC '1') = coalesce(ms.col4, NUMERIC '1'))
AND (coalesce(mt.apc_payment_amt, NUMERIC '0') = coalesce(ms.col5, NUMERIC '0')
     AND coalesce(mt.apc_payment_amt, NUMERIC '1') = coalesce(ms.col5, NUMERIC '1'))
AND (upper(coalesce(mt.auto_posted_flag, '0')) = upper(coalesce(ms.auto_posted_flag, '0'))
     AND upper(coalesce(mt.auto_posted_flag, '1')) = upper(coalesce(ms.auto_posted_flag, '1')))
AND (coalesce(mt.capital_payment_subtotal_amt, NUMERIC '0') = coalesce(ms.col6, NUMERIC '0')
     AND coalesce(mt.capital_payment_subtotal_amt, NUMERIC '1') = coalesce(ms.col6, NUMERIC '1'))
AND (coalesce(mt.claim_submit_date, DATE '1970-01-01') = coalesce(ms.claim_submit_date, DATE '1970-01-01')
     AND coalesce(mt.claim_submit_date, DATE '1970-01-02') = coalesce(ms.claim_submit_date, DATE '1970-01-02'))
AND (coalesce(mt.cmac_charge_amt, NUMERIC '0') = coalesce(ms.col7, NUMERIC '0')
     AND coalesce(mt.cmac_charge_amt, NUMERIC '1') = coalesce(ms.col7, NUMERIC '1'))
AND (coalesce(mt.cmac_payment_amt, NUMERIC '0') = coalesce(ms.col8, NUMERIC '0')
     AND coalesce(mt.cmac_payment_amt, NUMERIC '1') = coalesce(ms.col8, NUMERIC '1'))
AND (upper(coalesce(mt.cmg_code, '0')) = upper(coalesce(ms.cmg_code, '0'))
     AND upper(coalesce(mt.cmg_code, '1')) = upper(coalesce(ms.cmg_code, '1')))
AND (coalesce(mt.cmg_payment_amt, NUMERIC '0') = coalesce(ms.col9, NUMERIC '0')
     AND coalesce(mt.cmg_payment_amt, NUMERIC '1') = coalesce(ms.col9, NUMERIC '1'))
AND (coalesce(mt.cmg_weight_amt, NUMERIC '0') = coalesce(ms.col10, NUMERIC '0')
     AND coalesce(mt.cmg_weight_amt, NUMERIC '1') = coalesce(ms.col10, NUMERIC '1'))
AND mt.coid = ms.coid
AND (coalesce(mt.coinsurance_deductible_amt, NUMERIC '0') = coalesce(ms.col11, NUMERIC '0')
     AND coalesce(mt.coinsurance_deductible_amt, NUMERIC '1') = coalesce(ms.col11, NUMERIC '1'))
AND mt.company_code = ms.company_code
AND (coalesce(mt.computed_reimb_amt, NUMERIC '0') = coalesce(ms.col12, NUMERIC '0')
     AND coalesce(mt.computed_reimb_amt, NUMERIC '1') = coalesce(ms.col12, NUMERIC '1'))
AND (coalesce(mt.cost_outlier_payment_amt, NUMERIC '0') = coalesce(ms.col13, NUMERIC '0')
     AND coalesce(mt.cost_outlier_payment_amt, NUMERIC '1') = coalesce(ms.col13, NUMERIC '1'))
AND (upper(coalesce(mt.cost_report_year, '0')) = upper(coalesce(ms.cost_report_year, '0'))
     AND upper(coalesce(mt.cost_report_year, '1')) = upper(coalesce(ms.cost_report_year, '1')))
AND (coalesce(mt.covered_charges_amt, NUMERIC '0') = coalesce(ms.col14, NUMERIC '0')
     AND coalesce(mt.covered_charges_amt, NUMERIC '1') = coalesce(ms.col14, NUMERIC '1'))
AND (coalesce(mt.covered_days_los_cnt, 0) = coalesce(ms.covered_days_los_cnt, 0)
     AND coalesce(mt.covered_days_los_cnt, 1) = coalesce(ms.covered_days_los_cnt, 1))
AND (coalesce(mt.days_billed_cnt, 0) = coalesce(ms.days_billed_cnt, 0)
     AND coalesce(mt.days_billed_cnt, 1) = coalesce(ms.days_billed_cnt, 1))
AND (coalesce(mt.discharge_admit_date, DATE '1970-01-01') = coalesce(ms.discharge_admit_date, DATE '1970-01-01')
     AND coalesce(mt.discharge_admit_date, DATE '1970-01-02') = coalesce(ms.discharge_admit_date, DATE '1970-01-02'))
AND (coalesce(mt.discharge_days_cnt, 0) = coalesce(ms.discharge_days_cnt, 0)
     AND coalesce(mt.discharge_days_cnt, 1) = coalesce(ms.discharge_days_cnt, 1))
AND (coalesce(mt.drg_arithmetic_los_amt, NUMERIC '0') = coalesce(ms.col15, NUMERIC '0')
     AND coalesce(mt.drg_arithmetic_los_amt, NUMERIC '1') = coalesce(ms.col15, NUMERIC '1'))
AND (upper(coalesce(mt.drg_code, '0')) = upper(coalesce(ms.drg_code, '0'))
     AND upper(coalesce(mt.drg_code, '1')) = upper(coalesce(ms.drg_code, '1')))
AND (coalesce(mt.drg_payment_amt, NUMERIC '0') = coalesce(ms.col16, NUMERIC '0')
     AND coalesce(mt.drg_payment_amt, NUMERIC '1') = coalesce(ms.col16, NUMERIC '1'))
AND (coalesce(mt.drg_weight_amt, NUMERIC '0') = coalesce(ms.col17, NUMERIC '0')
     AND coalesce(mt.drg_weight_amt, NUMERIC '1') = coalesce(ms.col17, NUMERIC '1'))
AND (coalesce(mt.dw_last_update_date_time, DATETIME '1970-01-01 00:00:00') = coalesce(ms.dw_last_update_date_time, DATETIME '1970-01-01 00:00:00')
     AND coalesce(mt.dw_last_update_date_time, DATETIME '1970-01-01 00:00:01') = coalesce(ms.dw_last_update_date_time, DATETIME '1970-01-01 00:00:01'))
AND (coalesce(mt.ect_payment_amt, NUMERIC '0') = coalesce(ms.col18, NUMERIC '0')
     AND coalesce(mt.ect_payment_amt, NUMERIC '1') = coalesce(ms.col18, NUMERIC '1'))
AND (coalesce(mt.education_payment_amt, NUMERIC '0') = coalesce(ms.col19, NUMERIC '0')
     AND coalesce(mt.education_payment_amt, NUMERIC '1') = coalesce(ms.col19, NUMERIC '1'))
AND (upper(coalesce(mt.exp_hipps_cmg_code, '0')) = upper(coalesce(ms.exp_hipps_cmg_code, '0'))
     AND upper(coalesce(mt.exp_hipps_cmg_code, '1')) = upper(coalesce(ms.exp_hipps_cmg_code, '1')))
AND (upper(coalesce(mt.facility_name, '0')) = upper(coalesce(ms.facility_name, '0'))
     AND upper(coalesce(mt.facility_name, '1')) = upper(coalesce(ms.facility_name, '1')))
AND (coalesce(mt.fee_based_payment_amt, NUMERIC '0') = coalesce(ms.col20, NUMERIC '0')
     AND coalesce(mt.fee_based_payment_amt, NUMERIC '1') = coalesce(ms.col20, NUMERIC '1'))
AND (coalesce(mt.idme_payment_amt, NUMERIC '0') = coalesce(ms.col21, NUMERIC '0')
     AND coalesce(mt.idme_payment_amt, NUMERIC '1') = coalesce(ms.col21, NUMERIC '1'))
AND (coalesce(mt.lab_charge_amt, NUMERIC '0') = coalesce(ms.col22, NUMERIC '0')
     AND coalesce(mt.lab_charge_amt, NUMERIC '1') = coalesce(ms.col22, NUMERIC '1'))
AND (coalesce(mt.lab_payment_amt, NUMERIC '0') = coalesce(ms.col23, NUMERIC '0')
     AND coalesce(mt.lab_payment_amt, NUMERIC '1') = coalesce(ms.col23, NUMERIC '1'))
AND (coalesce(mt.lip_payment_amt, NUMERIC '0') = coalesce(ms.col24, NUMERIC '0')
     AND coalesce(mt.lip_payment_amt, NUMERIC '1') = coalesce(ms.col24, NUMERIC '1'))
AND (coalesce(mt.non_covered_charges_amt, NUMERIC '0') = coalesce(ms.col25, NUMERIC '0')
     AND coalesce(mt.non_covered_charges_amt, NUMERIC '1') = coalesce(ms.col25, NUMERIC '1'))
AND (coalesce(mt.operating_cost_outlier_amt, NUMERIC '0') = coalesce(ms.col26, NUMERIC '0')
     AND coalesce(mt.operating_cost_outlier_amt, NUMERIC '1') = coalesce(ms.col26, NUMERIC '1'))
AND (coalesce(mt.operating_drg_payment_amt, NUMERIC '0') = coalesce(ms.col27, NUMERIC '0')
     AND coalesce(mt.operating_drg_payment_amt, NUMERIC '1') = coalesce(ms.col27, NUMERIC '1'))
AND (coalesce(mt.operating_dsh_amt, NUMERIC '0') = coalesce(ms.col28, NUMERIC '0')
     AND coalesce(mt.operating_dsh_amt, NUMERIC '1') = coalesce(ms.col28, NUMERIC '1'))
AND (coalesce(mt.operating_outlier_amt, NUMERIC '0') = coalesce(ms.col29, NUMERIC '0')
     AND coalesce(mt.operating_outlier_amt, NUMERIC '1') = coalesce(ms.col29, NUMERIC '1'))
AND (coalesce(mt.other_service_charge_amt, NUMERIC '0') = coalesce(ms.col30, NUMERIC '0')
     AND coalesce(mt.other_service_charge_amt, NUMERIC '1') = coalesce(ms.col30, NUMERIC '1'))
AND (coalesce(mt.other_service_payment_amt, NUMERIC '0') = coalesce(ms.col31, NUMERIC '0')
     AND coalesce(mt.other_service_payment_amt, NUMERIC '1') = coalesce(ms.col31, NUMERIC '1'))
AND (coalesce(mt.outlier_payment_amt, NUMERIC '0') = coalesce(ms.col32, NUMERIC '0')
     AND coalesce(mt.outlier_payment_amt, NUMERIC '1') = coalesce(ms.col32, NUMERIC '1'))
AND mt.pat_acct_num = ms.pat_acct_num
AND (upper(coalesce(mt.patient_name, '0')) = upper(coalesce(ms.patient_name, '0'))
     AND upper(coalesce(mt.patient_name, '1')) = upper(coalesce(ms.patient_name, '1')))
AND (coalesce(mt.payment_adj_amt, NUMERIC '0') = coalesce(ms.col33, NUMERIC '0')
     AND coalesce(mt.payment_adj_amt, NUMERIC '1') = coalesce(ms.col33, NUMERIC '1'))
AND mt.period_end_date = ms.period_end_date
AND (coalesce(mt.prorated_drg_weight_amt, NUMERIC '0') = coalesce(ms.col34, NUMERIC '0')
     AND coalesce(mt.prorated_drg_weight_amt, NUMERIC '1') = coalesce(ms.col34, NUMERIC '1'))
AND (coalesce(mt.ra_coinsurance_amt, NUMERIC '0') = coalesce(ms.col35, NUMERIC '0')
     AND coalesce(mt.ra_coinsurance_amt, NUMERIC '1') = coalesce(ms.col35, NUMERIC '1'))
AND (coalesce(mt.ra_contractual_amt, NUMERIC '0') = coalesce(ms.col36, NUMERIC '0')
     AND coalesce(mt.ra_contractual_amt, NUMERIC '1') = coalesce(ms.col36, NUMERIC '1'))
AND (coalesce(mt.ra_covered_charge_amt, NUMERIC '0') = coalesce(ms.col37, NUMERIC '0')
     AND coalesce(mt.ra_covered_charge_amt, NUMERIC '1') = coalesce(ms.col37, NUMERIC '1'))
AND (coalesce(mt.ra_covered_days_cnt, 0) = coalesce(ms.ra_covered_days_cnt, 0)
     AND coalesce(mt.ra_covered_days_cnt, 1) = coalesce(ms.ra_covered_days_cnt, 1))
AND (coalesce(mt.ra_deductible_amt, NUMERIC '0') = coalesce(ms.col38, NUMERIC '0')
     AND coalesce(mt.ra_deductible_amt, NUMERIC '1') = coalesce(ms.col38, NUMERIC '1'))
AND (coalesce(mt.ra_drg_amt, NUMERIC '0') = coalesce(ms.col39, NUMERIC '0')
     AND coalesce(mt.ra_drg_amt, NUMERIC '1') = coalesce(ms.col39, NUMERIC '1'))
AND (upper(coalesce(mt.ra_drg_code, '0')) = upper(coalesce(ms.ra_drg_code, '0'))
     AND upper(coalesce(mt.ra_drg_code, '1')) = upper(coalesce(ms.ra_drg_code, '1')))
AND (upper(coalesce(mt.ra_hipps_cmg_code, '0')) = upper(coalesce(ms.ra_hipps_cmg_code, '0'))
     AND upper(coalesce(mt.ra_hipps_cmg_code, '1')) = upper(coalesce(ms.ra_hipps_cmg_code, '1')))
AND (coalesce(mt.ra_idme_amt, NUMERIC '0') = coalesce(ms.col40, NUMERIC '0')
     AND coalesce(mt.ra_idme_amt, NUMERIC '1') = coalesce(ms.col40, NUMERIC '1'))
AND (coalesce(mt.ra_lab_payment_amt, NUMERIC '0') = coalesce(ms.col41, NUMERIC '0')
     AND coalesce(mt.ra_lab_payment_amt, NUMERIC '1') = coalesce(ms.col41, NUMERIC '1'))
AND (coalesce(mt.ra_operating_dsh_amt, NUMERIC '0') = coalesce(ms.col42, NUMERIC '0')
     AND coalesce(mt.ra_operating_dsh_amt, NUMERIC '1') = coalesce(ms.col42, NUMERIC '1'))
AND (coalesce(mt.ra_operating_idme_amt, NUMERIC '0') = coalesce(ms.col43, NUMERIC '0')
     AND coalesce(mt.ra_operating_idme_amt, NUMERIC '1') = coalesce(ms.col43, NUMERIC '1'))
AND (coalesce(mt.ra_operating_outlier_amt, NUMERIC '0') = coalesce(ms.col44, NUMERIC '0')
     AND coalesce(mt.ra_operating_outlier_amt, NUMERIC '1') = coalesce(ms.col44, NUMERIC '1'))
AND (coalesce(mt.ra_outlier_amt, NUMERIC '0') = coalesce(ms.col45, NUMERIC '0')
     AND coalesce(mt.ra_outlier_amt, NUMERIC '1') = coalesce(ms.col45, NUMERIC '1'))
AND (coalesce(mt.ra_payment_date, DATE '1970-01-01') = coalesce(ms.ra_payment_date, DATE '1970-01-01')
     AND coalesce(mt.ra_payment_date, DATE '1970-01-02') = coalesce(ms.ra_payment_date, DATE '1970-01-02'))
AND (coalesce(mt.ra_therapy_payment_amt, NUMERIC '0') = coalesce(ms.col46, NUMERIC '0')
     AND coalesce(mt.ra_therapy_payment_amt, NUMERIC '1') = coalesce(ms.col46, NUMERIC '1'))
AND (coalesce(mt.ra_total_capital_amt, NUMERIC '0') = coalesce(ms.col47, NUMERIC '0')
     AND coalesce(mt.ra_total_capital_amt, NUMERIC '1') = coalesce(ms.col47, NUMERIC '1'))
AND (coalesce(mt.ra_total_payment_amt, NUMERIC '0') = coalesce(ms.col48, NUMERIC '0')
     AND coalesce(mt.ra_total_payment_amt, NUMERIC '1') = coalesce(ms.col48, NUMERIC '1'))
AND (upper(coalesce(mt.rate_schedule_name, '0')) = upper(coalesce(ms.rate_schedule_name, '0'))
     AND upper(coalesce(mt.rate_schedule_name, '1')) = upper(coalesce(ms.rate_schedule_name, '1')))
AND (coalesce(mt.remit_cnt, 0) = coalesce(ms.remit_cnt, 0)
     AND coalesce(mt.remit_cnt, 1) = coalesce(ms.remit_cnt, 1))
AND (coalesce(mt.replace_device_reduction_amt, NUMERIC '0') = coalesce(ms.col49, NUMERIC '0')
     AND coalesce(mt.replace_device_reduction_amt, NUMERIC '1') = coalesce(ms.col49, NUMERIC '1'))
AND mt.report_name = ms.report_name
AND mt.report_run_date_time = ms.report_run_date_time
AND mt.reporting_period = ms.reporting_period
AND (coalesce(mt.rug_payment_amt, NUMERIC '0') = coalesce(ms.col50, NUMERIC '0')
     AND coalesce(mt.rug_payment_amt, NUMERIC '1') = coalesce(ms.col50, NUMERIC '1'))
AND (upper(coalesce(mt.section_month, '0')) = upper(coalesce(ms.section_month, '0'))
     AND upper(coalesce(mt.section_month, '1')) = upper(coalesce(ms.section_month, '1')))
AND (upper(coalesce(mt.section_name, '0')) = upper(coalesce(ms.section_name, '0'))
     AND upper(coalesce(mt.section_name, '1')) = upper(coalesce(ms.section_name, '1')))
AND (coalesce(mt.sequestration_amt, NUMERIC '0') = coalesce(ms.col51, NUMERIC '0')
     AND coalesce(mt.sequestration_amt, NUMERIC '1') = coalesce(ms.col51, NUMERIC '1'))
AND (coalesce(mt.short_stay_outlier_payment_amt, NUMERIC '0') = coalesce(ms.col52, NUMERIC '0')
     AND coalesce(mt.short_stay_outlier_payment_amt, NUMERIC '1') = coalesce(ms.col52, NUMERIC '1'))
AND (coalesce(mt.tech_add_on_amt, NUMERIC '0') = coalesce(ms.col53, NUMERIC '0')
     AND coalesce(mt.tech_add_on_amt, NUMERIC '1') = coalesce(ms.col53, NUMERIC '1'))
AND (coalesce(mt.tech_add_on_payment_amt, NUMERIC '0') = coalesce(ms.col54, NUMERIC '0')
     AND coalesce(mt.tech_add_on_payment_amt, NUMERIC '1') = coalesce(ms.col54, NUMERIC '1'))
AND (coalesce(mt.therapy_charge_amt, NUMERIC '0') = coalesce(ms.col55, NUMERIC '0')
     AND coalesce(mt.therapy_charge_amt, NUMERIC '1') = coalesce(ms.col55, NUMERIC '1'))
AND (coalesce(mt.therapy_payment_amt, NUMERIC '0') = coalesce(ms.col56, NUMERIC '0')
     AND coalesce(mt.therapy_payment_amt, NUMERIC '1') = coalesce(ms.col56, NUMERIC '1'))
AND (coalesce(mt.total_charge_amt, NUMERIC '0') = coalesce(ms.col57, NUMERIC '0')
     AND coalesce(mt.total_charge_amt, NUMERIC '1') = coalesce(ms.col57, NUMERIC '1'))
AND (coalesce(mt.total_expected_payment_amt, NUMERIC '0') = coalesce(ms.col58, NUMERIC '0')
     AND coalesce(mt.total_expected_payment_amt, NUMERIC '1') = coalesce(ms.col58, NUMERIC '1'))
AND (coalesce(mt.total_opr_cptl_payment_amt, NUMERIC '0') = coalesce(ms.col59, NUMERIC '0')
     AND coalesce(mt.total_opr_cptl_payment_amt, NUMERIC '1') = coalesce(ms.col59, NUMERIC '1'))
AND (coalesce(mt.total_payment_amt, NUMERIC '0') = coalesce(ms.col60, NUMERIC '0')
     AND coalesce(mt.total_payment_amt, NUMERIC '1') = coalesce(ms.col60, NUMERIC '1'))
AND (coalesce(mt.transfer_payment_amt, NUMERIC '0') = coalesce(ms.col61, NUMERIC '0')
     AND coalesce(mt.transfer_payment_amt, NUMERIC '1') = coalesce(ms.col61, NUMERIC '1'))
AND (upper(coalesce(mt.unit_num, '0')) = upper(coalesce(ms.unit_num, '0'))
     AND upper(coalesce(mt.unit_num, '1')) = upper(coalesce(ms.unit_num, '1')))
AND (upper(coalesce(mt.var_cmg_flag, '0')) = upper(coalesce(ms.var_cmg_flag, '0'))
     AND upper(coalesce(mt.var_cmg_flag, '1')) = upper(coalesce(ms.var_cmg_flag, '1')))
AND (coalesce(mt.var_coinsurance_amt, NUMERIC '0') = coalesce(ms.col62, NUMERIC '0')
     AND coalesce(mt.var_coinsurance_amt, NUMERIC '1') = coalesce(ms.col62, NUMERIC '1'))
AND (coalesce(mt.var_contractual_amt, NUMERIC '0') = coalesce(ms.col63, NUMERIC '0')
     AND coalesce(mt.var_contractual_amt, NUMERIC '1') = coalesce(ms.col63, NUMERIC '1'))
AND (coalesce(mt.var_covered_charges_amt, NUMERIC '0') = coalesce(ms.col64, NUMERIC '0')
     AND coalesce(mt.var_covered_charges_amt, NUMERIC '1') = coalesce(ms.col64, NUMERIC '1'))
AND (coalesce(mt.var_covered_days_cnt, 0) = coalesce(ms.var_covered_days_cnt, 0)
     AND coalesce(mt.var_covered_days_cnt, 1) = coalesce(ms.var_covered_days_cnt, 1))
AND (coalesce(mt.var_deductible_amt, NUMERIC '0') = coalesce(ms.col65, NUMERIC '0')
     AND coalesce(mt.var_deductible_amt, NUMERIC '1') = coalesce(ms.col65, NUMERIC '1'))
AND (upper(coalesce(mt.var_drg_flag, '0')) = upper(coalesce(ms.var_drg_flag, '0'))
     AND upper(coalesce(mt.var_drg_flag, '1')) = upper(coalesce(ms.var_drg_flag, '1')))
AND (coalesce(mt.var_imed_educ_amt, NUMERIC '0') = coalesce(ms.col66, NUMERIC '0')
     AND coalesce(mt.var_imed_educ_amt, NUMERIC '1') = coalesce(ms.col66, NUMERIC '1'))
AND (coalesce(mt.var_lab_payment_amt, NUMERIC '0') = coalesce(ms.col67, NUMERIC '0')
     AND coalesce(mt.var_lab_payment_amt, NUMERIC '1') = coalesce(ms.col67, NUMERIC '1'))
AND (coalesce(mt.var_operating_dsh_amt, NUMERIC '0') = coalesce(ms.col68, NUMERIC '0')
     AND coalesce(mt.var_operating_dsh_amt, NUMERIC '1') = coalesce(ms.col68, NUMERIC '1'))
AND (coalesce(mt.var_operating_ime_amt, NUMERIC '0') = coalesce(ms.col69, NUMERIC '0')
     AND coalesce(mt.var_operating_ime_amt, NUMERIC '1') = coalesce(ms.col69, NUMERIC '1'))
AND (coalesce(mt.var_operating_outlier_amt, NUMERIC '0') = coalesce(ms.col70, NUMERIC '0')
     AND coalesce(mt.var_operating_outlier_amt, NUMERIC '1') = coalesce(ms.col70, NUMERIC '1'))
AND (coalesce(mt.var_outlier_amt, NUMERIC '0') = coalesce(ms.col71, NUMERIC '0')
     AND coalesce(mt.var_outlier_amt, NUMERIC '1') = coalesce(ms.col71, NUMERIC '1'))
AND (coalesce(mt.var_therapy_payment_amt, NUMERIC '0') = coalesce(ms.col72, NUMERIC '0')
     AND coalesce(mt.var_therapy_payment_amt, NUMERIC '1') = coalesce(ms.col72, NUMERIC '1'))
AND (coalesce(mt.var_total_capital_amt, NUMERIC '0') = coalesce(ms.col73, NUMERIC '0')
     AND coalesce(mt.var_total_capital_amt, NUMERIC '1') = coalesce(ms.col73, NUMERIC '1'))
AND (coalesce(mt.var_total_payment_amt, NUMERIC '0') = coalesce(ms.col74, NUMERIC '0')
     AND coalesce(mt.var_total_payment_amt, NUMERIC '1') = coalesce(ms.col74, NUMERIC '1')) WHEN NOT MATCHED BY TARGET THEN
INSERT (patient_dw_id,
        account_balance_amt,
        account_status_code,
        accrued_capital_subtotal_amt,
        accrued_operating_subtotal_amt,
        accrued_payment_amt,
        apc_charges_amt,
        apc_payment_amt,
        auto_posted_flag,
        capital_payment_subtotal_amt,
        claim_submit_date,
        cmac_charge_amt,
        cmac_payment_amt,
        cmg_code,
        cmg_payment_amt,
        cmg_weight_amt,
        coid,
        coinsurance_deductible_amt,
        company_code,
        computed_reimb_amt,
        cost_outlier_payment_amt,
        cost_report_year,
        covered_charges_amt,
        covered_days_los_cnt,
        days_billed_cnt,
        discharge_admit_date,
        discharge_days_cnt,
        drg_arithmetic_los_amt,
        drg_code,
        drg_payment_amt,
        drg_weight_amt,
        dw_last_update_date_time,
        ect_payment_amt,
        education_payment_amt,
        exp_hipps_cmg_code,
        facility_name,
        fee_based_payment_amt,
        idme_payment_amt,
        lab_charge_amt,
        lab_payment_amt,
        lip_payment_amt,
        non_covered_charges_amt,
        operating_cost_outlier_amt,
        operating_drg_payment_amt,
        operating_dsh_amt,
        operating_outlier_amt,
        other_service_charge_amt,
        other_service_payment_amt,
        outlier_payment_amt,
        pat_acct_num,
        patient_name,
        payment_adj_amt,
        period_end_date,
        prorated_drg_weight_amt,
        ra_coinsurance_amt,
        ra_contractual_amt,
        ra_covered_charge_amt,
        ra_covered_days_cnt,
        ra_deductible_amt,
        ra_drg_amt,
        ra_drg_code,
        ra_hipps_cmg_code,
        ra_idme_amt,
        ra_lab_payment_amt,
        ra_operating_dsh_amt,
        ra_operating_idme_amt,
        ra_operating_outlier_amt,
        ra_outlier_amt,
        ra_payment_date,
        ra_therapy_payment_amt,
        ra_total_capital_amt,
        ra_total_payment_amt,
        rate_schedule_name,
        remit_cnt,
        replace_device_reduction_amt,
        report_name,
        report_run_date_time,
        reporting_period,
        rug_payment_amt,
        section_month,
        section_name,
        sequestration_amt,
        short_stay_outlier_payment_amt,
        tech_add_on_amt,
        tech_add_on_payment_amt,
        therapy_charge_amt,
        therapy_payment_amt,
        total_charge_amt,
        total_expected_payment_amt,
        total_opr_cptl_payment_amt,
        total_payment_amt,
        transfer_payment_amt,
        unit_num,
        var_cmg_flag,
        var_coinsurance_amt,
        var_contractual_amt,
        var_covered_charges_amt,
        var_covered_days_cnt,
        var_deductible_amt,
        var_drg_flag,
        var_imed_educ_amt,
        var_lab_payment_amt,
        var_operating_dsh_amt,
        var_operating_ime_amt,
        var_operating_outlier_amt,
        var_outlier_amt,
        var_therapy_payment_amt,
        var_total_capital_amt,
        var_total_payment_amt)
VALUES (ms.patient_dw_id, ms.col0, ms.account_status_code, ms.col1, ms.col2, ms.col3, ms.col4, ms.col5, ms.auto_posted_flag, ms.col6, ms.claim_submit_date, ms.col7, ms.col8, ms.cmg_code, ms.col9, ms.col10, ms.coid, ms.col11, ms.company_code, ms.col12, ms.col13, ms.cost_report_year, ms.col14, ms.covered_days_los_cnt, ms.days_billed_cnt, ms.discharge_admit_date, ms.discharge_days_cnt, ms.col15, ms.drg_code, ms.col16, ms.col17, ms.dw_last_update_date_time, ms.col18, ms.col19, ms.exp_hipps_cmg_code, ms.facility_name, ms.col20, ms.col21, ms.col22, ms.col23, ms.col24, ms.col25, ms.col26, ms.col27, ms.col28, ms.col29, ms.col30, ms.col31, ms.col32, ms.pat_acct_num, ms.patient_name, ms.col33, ms.period_end_date, ms.col34, ms.col35, ms.col36, ms.col37, ms.ra_covered_days_cnt, ms.col38, ms.col39, ms.ra_drg_code, ms.ra_hipps_cmg_code, ms.col40, ms.col41, ms.col42, ms.col43, ms.col44, ms.col45, ms.ra_payment_date, ms.col46, ms.col47, ms.col48, ms.rate_schedule_name, ms.remit_cnt, ms.col49, ms.report_name, ms.report_run_date_time, ms.reporting_period, ms.col50, ms.section_month, ms.section_name, ms.col51, ms.col52, ms.col53, ms.col54, ms.col55, ms.col56, ms.col57, ms.col58, ms.col59, ms.col60, ms.col61, ms.unit_num, ms.var_cmg_flag, ms.col62, ms.col63, ms.col64, ms.var_covered_days_cnt, ms.col65, ms.var_drg_flag, ms.col66, ms.col67, ms.col68, ms.col69, ms.col70, ms.col71, ms.col72, ms.col73, ms.col74);


SET DUP_COUNT =
  (SELECT count(*)
   FROM
     (SELECT patient_dw_id,
             report_name,
             period_end_date,
             report_run_date_time
      FROM `{{ params.param_parallon_ra_core_dataset_name }}`.cc_gr_eom
      GROUP BY patient_dw_id,
               report_name,
               period_end_date,
               report_run_date_time
      HAVING count(*) > 1));

IF DUP_COUNT <> 0 THEN
ROLLBACK TRANSACTION;

RAISE USING MESSAGE = concat('Duplicates are not allowed in the table `{{ params.param_parallon_ra_core_dataset_name }}`.cc_gr_eom');

ELSE
COMMIT TRANSACTION;

END IF;


EXCEPTION WHEN ERROR THEN
SET _ERROR_CODE = 1;


SET _ERROR_MSG = @@error.message;

END;

IF _ERROR_CODE <> 0 THEN RAISE USING MESSAGE = concat('Script terminated with return code: ', _ERROR_CODE, ' ', _ERROR_MSG);

END IF;

-- CALL dbadmin_procs.collect_stats_table('EDWRA','CC_GR_EOM');
IF _ERROR_CODE <> 0 THEN RAISE USING MESSAGE = concat('Script terminated with return code: ', _ERROR_CODE, ' ', _ERROR_MSG);

END IF;

TRUNCATE TABLE {{ params.param_parallon_ra_stage_dataset_name }}.cc_gr_eom;

INSERT INTO {{ params.param_parallon_ra_stage_dataset_name }}.cc_gr_eom
SELECT *
FROM {{ params.param_parallon_ra_core_dataset_name }}.cc_gr_eom;