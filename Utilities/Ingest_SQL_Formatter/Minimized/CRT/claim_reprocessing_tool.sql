SELECT [lnglogid] AS log_id, [strunitid] AS unit_num, [strcoid] AS coid, [strrequesttypedesc] AS request_type_desc, CONVERT(VARCHAR(19), [datrequestdate], 120) AS request_date, CASE WHEN LTRIM(RTRIM(SUBSTRING(straccount, 1, 1))) IN ('H', 'D', 'R') THEN LTRIM(RTRIM(SUBSTRING(straccount, 2, 50))) ELSE straccount END AS account_no, [strfinancialclass] AS fin_class, CONVERT(VARCHAR(19), [datdatelastactivity], 120) AS last_activity_date, [strstatusdesc] AS status_desc, CONVERT(VARCHAR(19), [datdiscdate], 120) AS disc_date, TRIM([strdiscsourcedesc]) AS disc_source_desc, [strreimbursementimpact] AS reimb_impact, [strreprreasons] AS repr_reasons, [strqueuename] AS queue_name, COALESCE([straccoutprefix], '') AS accountprefix, 'v_currtimestamp' AS extract_date FROM [dbo].[vwclaimsreprocessingtool] WITH (nolock) WHERE CAST([datdatelastactivity] AS DATE) >= DATEADD(dd, -1, CAST(getdate() AS DATE));