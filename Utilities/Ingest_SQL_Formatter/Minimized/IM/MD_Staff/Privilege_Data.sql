SELECT t1.providerid AS md_staff_provider_id, t1.facilityid AS md_staff_primary_facility_id, t1.formname AS md_staff_form_name, t1.privilegetype AS md_staff_privilege_type_name, t1.privilegedesc AS md_staff_privilege_desc, t1.privilegestatus AS md_staff_status_code, t1.privilegestatusdesc AS md_staff_status_desc, t1.casescompleted AS md_staff_cases_completed, t1.granteddate AS md_staff_granted_date, t1.expireddate AS md_staff_expired_date, t1.commenttext1 AS md_staff_comment_text_1, t1.commenttext2 AS md_staff_comment_text_2, t2.downloaddate AS md_staff_download_date, 'S' AS source_system_code, 'v_currtimestamp' AS dw_last_update_date_time FROM ( SELECT DISTINCT CAST( [providerid] AS VARCHAR(50) ) AS [providerid], CAST( [facilityid] AS VARCHAR(255) ) AS facilityid, CAST( [formname] AS VARCHAR(255) ) AS formname, CAST( [type] AS VARCHAR(255) ) AS privilegetype, CAST( [privilege] AS VARCHAR(255) ) AS privilegedesc, CAST( [status] AS VARCHAR(255) ) AS privilegestatus, CAST( [statusdescription] AS VARCHAR(255) ) AS privilegestatusdesc, casescompleted, CAST([granted] AS DATE) AS granteddate, CAST([expired] AS DATE) AS expireddate, CAST( [comment] AS VARCHAR(255) ) AS commenttext1, CAST( [comments] AS VARCHAR(255) ) AS commenttext2 FROM [md-staff_import].mdstaff.privilegedata WITH (nolock) WHERE providerid IS NOT NULL ) t1 INNER JOIN ( SELECT DISTINCT CAST( providerid AS VARCHAR(50) ) AS providerid, CAST(downloaddate AS DATETIME) AS downloaddate FROM [mdstaff].dbo.vw_providerdata WITH (nolock) ) t2 ON t1.providerid = t2.providerid 