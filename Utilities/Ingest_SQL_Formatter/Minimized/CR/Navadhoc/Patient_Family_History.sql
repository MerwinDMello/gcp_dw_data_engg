SELECT patienthistoryfactid, patientdimid, coid, family_history_query_id, REPLACE(REPLACE(family_history_value_text, nCHAR(8211), nCHAR(32)), nCHAR(8217), nCHAR(32)) AS family_history_value_text, hbsource, 'v_currtimestamp' AS dw_last_update_date_time FROM ( SELECT patienthistoryfactid, patientdimid, coid, 61 AS family_history_query_id, LTRIM(RTRIM(CAST(familyhistory AS VARCHAR(1000)))) AS family_history_value_text, concat('0x', CONVERT(VARCHAR(50), hbsource, 2)) AS hbsource FROM navadhoc.dbo.patienthistory WHERE LTRIM(RTRIM(familyhistory)) IS NOT NULL AND LTRIM(RTRIM(familyhistory))<>'' UNION SELECT patienthistoryfactid, patientdimid, coid, 62 AS family_history_query_id, LTRIM(RTRIM(CAST(lineage AS VARCHAR(1000)))) AS family_history_value_text, concat('0x', CONVERT(VARCHAR(50), hbsource, 2)) AS hbsource FROM navadhoc.dbo.patienthistory WHERE LTRIM(RTRIM(lineage)) IS NOT NULL AND LTRIM(RTRIM(lineage))<>'' UNION SELECT patienthistoryfactid, patientdimid, coid, 63 AS family_history_query_id, LTRIM(RTRIM(CAST(age AS VARCHAR(1000)))) AS family_history_value_text, concat('0x', CONVERT(VARCHAR(50), hbsource, 2)) AS hbsource FROM navadhoc.dbo.patienthistory WHERE LTRIM(RTRIM(age)) IS NOT NULL AND LTRIM(RTRIM(age))<>'' UNION SELECT patienthistoryfactid, patientdimid, coid, 64 AS family_history_query_id, LTRIM(RTRIM(CAST(relationtopatient AS VARCHAR(1000)))) AS family_history_value_text, concat('0x', CONVERT(VARCHAR(50), hbsource, 2)) AS hbsource FROM navadhoc.dbo.patienthistory WHERE LTRIM(RTRIM(relationtopatient)) IS NOT NULL AND LTRIM(RTRIM(relationtopatient))<>'' UNION SELECT patienthistoryfactid, patientdimid, coid, 65 AS family_history_query_id, LTRIM(RTRIM(CAST(tumorsite AS VARCHAR(1000)))) AS family_history_value_text, concat('0x', CONVERT(VARCHAR(50), hbsource, 2)) AS hbsource FROM navadhoc.dbo.patienthistory WHERE LTRIM(RTRIM(tumorsite)) IS NOT NULL AND LTRIM(RTRIM(tumorsite))<>'' UNION SELECT patienthistoryfactid, patientdimid, coid, 66 AS family_history_query_id, LTRIM(RTRIM(CAST(ashkenazijewish AS VARCHAR(1000)))) AS family_history_value_text, concat('0x', CONVERT(VARCHAR(50), hbsource, 2)) AS hbsource FROM navadhoc.dbo.patienthistory WHERE LTRIM(RTRIM(ashkenazijewish)) IS NOT NULL AND LTRIM(RTRIM(ashkenazijewish))<>'' UNION SELECT patienthistoryfactid, patientdimid, coid, 67 AS family_history_query_id, LTRIM(RTRIM(CAST(eversmoked AS VARCHAR(1000)))) AS family_history_value_text, concat('0x', CONVERT(VARCHAR(50), hbsource, 2)) AS hbsource FROM navadhoc.dbo.patienthistory WHERE LTRIM(RTRIM(eversmoked)) IS NOT NULL AND LTRIM(RTRIM(eversmoked))<>'' UNION SELECT patienthistoryfactid, patientdimid, coid, 68 AS family_history_query_id, LTRIM(RTRIM(CAST(smokingcessationoffered AS VARCHAR(1000)))) AS family_history_value_text, concat('0x', CONVERT(VARCHAR(50), hbsource, 2)) AS hbsource FROM navadhoc.dbo.patienthistory WHERE LTRIM(RTRIM(smokingcessationoffered)) IS NOT NULL AND LTRIM(RTRIM(smokingcessationoffered))<>'' UNION SELECT patienthistoryfactid, patientdimid, coid, 69 AS family_history_query_id, LTRIM(RTRIM(CAST(quitsmoking AS VARCHAR(1000)))) AS family_history_value_text, concat('0x', CONVERT(VARCHAR(50), hbsource, 2)) AS hbsource FROM navadhoc.dbo.patienthistory WHERE LTRIM(RTRIM(quitsmoking)) IS NOT NULL AND LTRIM(RTRIM(quitsmoking))<>'' UNION SELECT patienthistoryfactid, patientdimid, coid, 70 AS family_history_query_id, LTRIM(RTRIM(CAST(datequitsmoking AS VARCHAR(1000)))) AS family_history_value_text, concat('0x', CONVERT(VARCHAR(50), hbsource, 2)) AS hbsource FROM navadhoc.dbo.patienthistory WHERE LTRIM(RTRIM(datequitsmoking)) IS NOT NULL AND LTRIM(RTRIM(datequitsmoking))<>'' UNION SELECT patienthistoryfactid, patientdimid, coid, 71 AS family_history_query_id, LTRIM(RTRIM(CAST(packperday AS VARCHAR(1000)))) AS family_history_value_text, concat('0x', CONVERT(VARCHAR(50), hbsource, 2)) AS hbsource FROM navadhoc.dbo.patienthistory WHERE LTRIM(RTRIM(packperday)) IS NOT NULL AND LTRIM(RTRIM(packperday))<>'' UNION SELECT patienthistoryfactid, patientdimid, coid, 72 AS family_history_query_id, LTRIM(RTRIM(CAST(years AS VARCHAR(1000)))) AS family_history_value_text, concat('0x', CONVERT(VARCHAR(50), hbsource, 2)) AS hbsource FROM navadhoc.dbo.patienthistory WHERE LTRIM(RTRIM(years)) IS NOT NULL AND LTRIM(RTRIM(years))<>'' UNION SELECT patienthistoryfactid, patientdimid, coid, 73 AS family_history_query_id, LTRIM(RTRIM(CAST(packyearhx AS VARCHAR(1000)))) AS family_history_value_text, concat('0x', CONVERT(VARCHAR(50), hbsource, 2)) AS hbsource FROM navadhoc.dbo.patienthistory WHERE LTRIM(RTRIM(packyearhx)) IS NOT NULL AND LTRIM(RTRIM(packyearhx))<>'' UNION SELECT patienthistoryfactid, patientdimid, coid, 74 AS family_history_query_id, LTRIM(RTRIM(CAST(takingestrogen AS VARCHAR(1000)))) AS family_history_value_text, concat('0x', CONVERT(VARCHAR(50), hbsource, 2)) AS hbsource FROM navadhoc.dbo.patienthistory WHERE LTRIM(RTRIM(takingestrogen)) IS NOT NULL AND LTRIM(RTRIM(takingestrogen))<>'' UNION SELECT patienthistoryfactid, patientdimid, coid, 75 AS family_history_query_id, LTRIM(RTRIM(CAST(takingprogesterone AS VARCHAR(1000)))) AS family_history_value_text, concat('0x', CONVERT(VARCHAR(50), hbsource, 2)) AS hbsource FROM navadhoc.dbo.patienthistory WHERE LTRIM(RTRIM(takingprogesterone)) IS NOT NULL AND LTRIM(RTRIM(takingprogesterone))<>'' UNION SELECT patienthistoryfactid, patientdimid, coid, 76 AS family_history_query_id, LTRIM(RTRIM(CAST(receptorser AS VARCHAR(1000)))) AS family_history_value_text, concat('0x', CONVERT(VARCHAR(50), hbsource, 2)) AS hbsource FROM navadhoc.dbo.patienthistory WHERE LTRIM(RTRIM(receptorser)) IS NOT NULL AND LTRIM(RTRIM(receptorser))<>'' UNION SELECT patienthistoryfactid, patientdimid, coid, 77 AS family_history_query_id, LTRIM(RTRIM(CAST(receptorspr AS VARCHAR(1000)))) AS family_history_value_text, concat('0x', CONVERT(VARCHAR(50), hbsource, 2)) AS hbsource FROM navadhoc.dbo.patienthistory WHERE LTRIM(RTRIM(receptorspr)) IS NOT NULL AND LTRIM(RTRIM(receptorspr))<>'' UNION SELECT patienthistoryfactid, patientdimid, coid, 78 AS family_history_query_id, LTRIM(RTRIM(CAST(advisedtoquiter AS VARCHAR(1000)))) AS family_history_value_text, concat('0x', CONVERT(VARCHAR(50), hbsource, 2)) AS hbsource FROM navadhoc.dbo.patienthistory WHERE LTRIM(RTRIM(advisedtoquiter)) IS NOT NULL AND LTRIM(RTRIM(advisedtoquiter))<>'' UNION SELECT patienthistoryfactid, patientdimid, coid, 79 AS family_history_query_id, LTRIM(RTRIM(CAST(advisedtoquitpr AS VARCHAR(1000)))) AS family_history_value_text, concat('0x', CONVERT(VARCHAR(50), hbsource, 2)) AS hbsource FROM navadhoc.dbo.patienthistory WHERE LTRIM(RTRIM(advisedtoquitpr)) IS NOT NULL AND LTRIM(RTRIM(advisedtoquitpr))<>'' UNION SELECT patienthistoryfactid, patientdimid, coid, 80 AS family_history_query_id, LTRIM(RTRIM(CAST(onoraboutdateer AS VARCHAR(1000)))) AS family_history_value_text, concat('0x', CONVERT(VARCHAR(50), hbsource, 2)) AS hbsource FROM navadhoc.dbo.patienthistory WHERE LTRIM(RTRIM(onoraboutdateer)) IS NOT NULL AND LTRIM(RTRIM(onoraboutdateer))<>'' UNION SELECT patienthistoryfactid, patientdimid, coid, 81 AS family_history_query_id, LTRIM(RTRIM(CAST(onoraboutdatepr AS VARCHAR(1000)))) AS family_history_value_text, concat('0x', CONVERT(VARCHAR(50), hbsource, 2)) AS hbsource FROM navadhoc.dbo.patienthistory WHERE LTRIM(RTRIM(riskfactornotes)) IS NOT NULL AND LTRIM(RTRIM(riskfactornotes))<>'' UNION SELECT patienthistoryfactid, patientdimid, coid, 86 AS family_history_query_id, LTRIM(RTRIM(CAST(onoraboutdatepr AS VARCHAR(1000)))) AS family_history_value_text, concat('0x', CONVERT(VARCHAR(50), hbsource, 2)) AS hbsource FROM navadhoc.dbo.patienthistory WHERE LTRIM(RTRIM(riskfactornotes)) IS NOT NULL AND LTRIM(RTRIM(riskfactornotes))<>'' ) source_query