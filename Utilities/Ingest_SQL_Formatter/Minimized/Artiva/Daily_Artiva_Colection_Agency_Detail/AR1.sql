SELECT CURRENT_DATE AS rptg_date, 'AR1' AS datasource, fac.csfahospnum AS unit_num, enc.hcenptacct AS pat_acct_num, acc.hcacvendid AS vendor_id, acc.hcacvepldte AS placement_date, acc.hcacvepltim AS placed_time, acc.hcacveplamt AS placement_amt, NULL AS recall_reason_code, NULL AS recall_reason_desc, acc.hcacvercldte AS recall_date, acc.hcacvercltim AS recall_time, 0 AS recall_amt, 'v_currtimestamp' AS dw_last_update_date_time FROM sqluser.hcencounter enc LEFT JOIN sqluser.hcaccount acc ON enc.hcenid = acc.hcacencntrid LEFT JOIN sqluser.hcfacility fac ON enc.hcenfacility = fac.hcfaid LEFT JOIN sqluser.hcpas pas ON fac.hcfapasid = pas.hcpsid WHERE acc.hcacvendid IS NOT NULL AND (acc.hcacvepldte = TODATE((CONVERT(INT, CURRENT_DATE))-1) OR acc.hcacvercldte = TODATE((CONVERT(INT, CURRENT_DATE))-1)) UNION ALL SELECT CURRENT_DATE AS rptg_date, 'AR1' AS datasource, fac.csfahospnum AS unit_num, enc.hcenptacct AS pat_acct_num, plc.hcacphveid AS vendor_id, plc.hcacphpldte AS placement_date, plc.hcacphpltim AS placed_time, plc.hcacphplamt AS placement_amt, rea.hcrrid AS recall_reason_code, rea.hcrrdesc AS recall_reason_desc, plc.hcacphrcldte AS recall_date, plc.hcacphrcltim AS recall_time, plc.hcacphrclamt AS recall_amt, 'v_currtimestamp' AS dw_last_update_date_time FROM sqluser.hcencounter enc LEFT JOIN sqluser.hcacplhist plc ON enc.hcenid = plc.hcacphenid LEFT JOIN sqluser.hcrclreas rea ON plc.hcacphrclreas = rea.hcrrid LEFT JOIN sqluser.hcfacility fac ON enc.hcenfacility = fac.hcfaid LEFT JOIN sqluser.hcpas pas ON fac.hcfapasid = pas.hcpsid WHERE plc.hcacphveid IS NOT NULL AND (plc.hcacphpldte = TODATE((CONVERT(INT, CURRENT_DATE))-1) OR plc.hcacphrcldte = TODATE((CONVERT(INT, CURRENT_DATE))-1))