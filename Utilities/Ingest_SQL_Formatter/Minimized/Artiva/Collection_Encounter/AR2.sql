SELECT sqluser.hcpas.hcpsid, sqluser.hcfacility.csfahospnumber, sqluser.hcfacility.hcfadesc, sqluser.hcencounter.csenaccountstatus, sqluser.hcencounter.hcenptacct, sqluser.hcencounter.hcenadmdte, sqluser.hcencounter.hcendscdte, sqluser.hcencounter.hcenorigbal, sqluser.hcencounter.hcenbal, sqluser.hcencounter.hcenfinclass, sqluser.hcencounter.csenearlyouthold, sqluser.hcencounter.csenfbildte, NULL AS hcpntyp, sqluser.hcencounter.csenbaddebttyp, sqluser.hcencounter.hcentotadj*-1 AS hcentotadj, sqluser.hcencounter.hcentotpay, CASE WHEN LTRIM(RTRIM(sqluser.hcaccount.csacprevpool)) = '' OR LTRIM(RTRIM(sqluser.hcaccount.csacprevpool)) IS NULL THEN '0' ELSE LTRIM(RTRIM(sqluser.hcaccount.csacprevpool)) END csacprevpool, sqluser.hcaccount.hcacpool, sqluser.hcaccount.hcacworkdte, sqluser.hcencounter.hcenlstwrkdte, sqluser.hcaccount.hcacwaitdate, sqluser.hcaccount.hcacseqnum, hcaccount_ins.hcacpayname, sqluser.hcaccount.hcacbal, hcaccount_ins.csacclmsubdte, CASE WHEN LTRIM(RTRIM(sqluser.hcencounter.csenvendid)) = '' THEN NULL ELSE LTRIM(RTRIM(sqluser.hcencounter.csenvendid)) END hcacvendid, sqluser.hcaccount.hcacphase, sqluser.hcaccount.hcaccode, hcaccount_ins.hcacdeniedcd, hcaccount_ins.hcacdenieddate, NULL AS csaceodte, NULL AS hcacphpllvl, NULL AS hcacphpldte, NULL AS hcacphrcldte, NULL AS hcacvenxtrclrvdte, NULL AS hcacphrclreas, sqluser.hcaccount.csacseries, sqluser.hcaccount.hcacphchgdate, hcaccount_ins.hcacfinclass, {fn right(hcaccount_ins.hcacpayerid, 5)} AS hcacpayerid, NULL AS hcvename, NULL AS gcpdesc, actdate.last_action_date, CURRENT_DATE AS maxdate, %truncate(sqluser.hcencounter.hcenmrn, 12) AS medical_record_number, %truncate(hcaccount_ins.hcacpolnum, 20) AS hic_number, %truncate(sqluser.hcencounter.hcensrvcd, 4) AS service_code, %truncate(hcaccount_ins.csacpyrseq, 1) AS ins_level, %truncate(hcaccount_ins.hcacdeniedcd, 4) AS denial_code, hcaccount_ins.hcacdenieddate AS denial_date, %truncate(hcaccount_ins.csacappealsflag, 1) AS appeals_flag, %truncate(v.hcvename, 40) AS vendor_name, %truncate(v2.hcvename, 40) AS previous_vendor_name, %truncate(sqluser.hcfacility.csfaactive, 1) AS active_status_flag, sqluser.hcaccount.csacprevpooldte AS previous_pool_date, %truncate(sqluser.hcaccount.hcacpristatus, 8) AS prior_status_code, %truncate(sqluser.hcaccount.hcacactcode, 8) AS action_code, %truncate(sqluser.hcaccount.hcacrescode, 8) AS result_code, %truncate(sqluser.hcencounter.csenprevvendid, 8) AS previous_vendorid, %truncate(sqluser.hcencounter.csenmiscvalue, 10) AS misc_value, %truncate(sqluser.hcaccount.hcacphprevvalue, 20) AS previous_liability_phase, sqluser.hcencounter.hcenacctbal AS total_balance_of_liabilities, sqluser.hcencounter.csennonbillchg AS non_billable_charges, %truncate(d.csappsource, 1) AS appeal_system, d.csappclosedte AS appeal_close_date, d.csappsentdte AS appeal_sent_date, d.csappamt AS appeal_amount, %truncate(d.csappsourceid, 30) AS appealid, %truncate(d.csappdenialcode, 4) AS appeal_denial_code, %truncate(d.csappdisposition, 10) AS appeal_system_desc, %truncate(d.csappdispdesc, 30) AS appeal_disposition, d.csappfollowupdte AS appeal_follow_up_date, %truncate(d.csappsourcelvl, 4) AS appeal_level, %truncate(d.csappsourceseq, 4) AS appeal_sequence, %truncate(d.csapplastactivity, 60) AS appeal_concuity_activity, %truncate(d.csappprlastactivity, 60) AS appeal_concuity_previous_activity, p.hcacvepldte AS placement_date, p.hcacveplamt AS placement_amount, p.hcacvepllvl AS placement_level, %truncate(hcaccount_ins.csacclaim, 20) AS claim_number, %truncate(r.cspoolincludeflg, 1) AS inclusion_flag, %truncate(r.cspoolrespdept, 20) AS responsible_department, hcaccount.csacinsballevel AS ins_liability_level, sqluser.hcaccount.csaclstclrspdte AS ci_stat_last_response_date, sqluser.hcaccount.csaclstclrspprob AS last_claim_status_rspn_pblm_code, sqluser.hcaccount.csaclstclrspcd AS ci_stat_last_response_status, CASE WHEN LTRIM(RTRIM(sqluser.hcaccount.csaclstclrspsubcat)) = '' OR LTRIM(RTRIM(sqluser.hcaccount.csaclstclrspsubcat)) IS NULL THEN '0' ELSE LTRIM(RTRIM(sqluser.hcaccount.csaclstclrspsubcat)) END ci_stat_last_response_subcategory, sqluser.hcaccount.csaclstclrsptype AS ci_stat_last_response_type, sqluser.hcclaimcodes.hcclsdesc AS report_desc, sqluser.hcclaimcodes.hcclid AS claim_status_code, %truncate(sqluser.hcclaimcodes.hcclccid, 20) AS claim_status_relt_scat_id, %truncate(sqluser.hcclsubcategory.hcccid, 6) AS claim_status_scat_id, sqluser.hcclsubcategory.hcccsdesc AS claim_status_scat_desc, CAST(sqluser.hcclsubcategory.hcccldesc AS CHAR(255)) AS category_desc, %truncate(hcaccount_ins.csacchecknum, 50) AS csacchecknum, hcaccount. hcacuseralertdte, hcaccount.hcacuseralertexpdte, hcaccount.hcacuseralert, sqluser.hcaccount.csacbhind AS billing_history_indicator, sqluser.hcpas.cspsinsigamt AS pas_insignificant_amt, actdate.last_action_code_time, actdate.last_action_code_user_id, hcaccount_ins.csacorigbal AS csacorigbal, hcaccount.csaclobgroup AS csaclobgroup, sqluser.hcencounter.csennoticeofadm AS notice_of_admission, sqluser.hcencounter.csennoticeofepisode AS notice_of_election, CAST(sqluser.hcencounter.csenepisodeid AS decimal(15, 0))AS episode_id, CAST(sqluser.hcencounter.csenpatientid AS decimal(15, 0)) AS patient_id, sqluser.hcaccount.csacerisa AS erisa_ind, hcaccount.csacwebstatusflag AS csacwebstatusflag, sqluser.cseligibilityhist.csehcoloradoscrnflag, sqluser.cseligibilityhist.csehinclinltr, sqluser.cseligibilityhist.csehprogramgrpdesc, sqluser.cseligibilityhist.csehscreendte FROM sqluser.hcpas INNER JOIN sqluser.hcfacility ON (sqluser.hcpas.hcpsid=sqluser.hcfacility.hcfapasid) INNER JOIN sqluser.hcencounter ON (sqluser.hcfacility.hcfaid=sqluser.hcencounter.hcenfacility) INNER JOIN sqluser.hcaccount ON (sqluser.hcencounter.hcenid=sqluser.hcaccount.hcacencntrid) INNER JOIN sqluser.hcaccount hcaccount_ins ON sqluser.hcaccount.hcacid=hcaccount_ins.hcacid LEFT OUTER JOIN sqluser.csappeals d ON d.csappid = hcaccount_ins.csacappid LEFT OUTER JOIN sqluser.hcaccount p ON sqluser.hcencounter.hcenid=p.hcacencntrid LEFT OUTER JOIN sqluser.hcvendor v ON v.hcvendid = sqluser.hcencounter.csenvendid LEFT OUTER JOIN sqluser.hcvendor v2 ON v2.hcvendid = sqluser.hcencounter.csenprevvendid LEFT OUTER JOIN sqluser.cspooloptions r ON sqluser.hcaccount.hcaclpool = r.cspoolkey LEFT OUTER JOIN sqluser.cseligibilityhist ON sqluser.cseligibilityhist.csehenid=sqluser.hcencounter.hcenid LEFT OUTER JOIN (SELECT h.hcacthacnum, a.last_action_date, h.hcacthtim AS last_action_code_time, h.hcacthuserid AS last_action_code_user_id FROM sqluser.hcactionhist AS h JOIN (SELECT hcacthacnum, max(hcacthdte) AS last_action_date FROM sqluser.hcactionhist WHERE (hcacthactid IS NOT NULL OR hcacthresid IS NOT NULL) GROUP BY hcacthacnum ) AS a ON a.hcacthacnum = h.hcacthacnum AND a.last_action_date = h.hcacthdte ) AS actdate ON sqluser.hcaccount.hcacid=actdate.hcacthacnum LEFT JOIN sqluser.hcclaimcodes ON sqluser.hcclaimcodes.hcclid = sqluser.hcaccount.csaclstclrspprob LEFT JOIN sqluser.hcclsubcategory ON sqluser.hcclsubcategory.hcccid = sqluser.hcaccount.csaclstclrspsubcat WHERE sqluser.hcencounter.csenaccountstatus IN ( 'CA', 'AR', 'AX' ) AND sqluser.hcencounter.hcenbal<>0 AND p.hcacseqnum=99 