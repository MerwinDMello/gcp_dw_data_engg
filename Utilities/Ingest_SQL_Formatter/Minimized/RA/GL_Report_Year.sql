SELECT $SchemaID AS schema_id, me.ssc_name, SUBSTR(me.client_id, 7, 5) AS coid, me.short_name AS unit_num, me.name AS facility_name, macp.cost_report_org_id AS org_id, macp.cost_report_year AS cost_report_year, MIN (map.start_date) AS rpt_yr_start_date, MAX (map.end_date) AS rpt_yr_end_date, CURRENT_DATE AS dw_last_update_date FROM concuity.mon_accounting_cost_period macp INNER JOIN hca_reporting.gsu_me_org me ON me.org_id = macp.cost_report_org_id INNER JOIN concuity.mon_accounting_period Map ON macp.mon_accounting_period_id = map.id GROUP BY me.ssc_name, me.client_id, me.short_name, me.name, macp.cost_report_org_id, macp.cost_report_year HAVING MAX ( CASE WHEN trunc(last_day(add_months(sysdate, -1))) BETWEEN map.start_date AND map.end_date THEN 1 ELSE 0 END) = 1