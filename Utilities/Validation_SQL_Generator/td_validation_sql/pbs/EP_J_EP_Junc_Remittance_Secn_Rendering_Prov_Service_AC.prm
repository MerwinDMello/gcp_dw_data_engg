#  @@START DMEXPRESS_EXPORTED_VARIABLES

export AC_EXP_TOLERANCE_PERCENT=0
export AC_EXP_TOLERANCE_AMT=0
export JOBNAME='J_EP_Junc_Remittance_Secn_Rendering_Prov_Service'


export AC_EXP_SQL_STATEMENT="SELECT 'J_EP_Junc_Remittance_Secn_Rendering_Prov_Service' || ',' || CAST(COUNT(*) AS VARCHAR(20)) || ',' as Source_String from
( 
SEL
Claim_GUID,
 'NA' as Payment_Guid,
 Service_GUID,
rendrng_provdr_ref_Idn_Qual1 AS Secn_Rendering_Provider_Id_Qlfr_Code,
Rendering_Provider_Identifier1 AS Secn_Rendering_Provider_Id,
 1 AS Secn_Rendering_Provider_Id_Line_Num
FROM  EDWPBS_Staging.remittance_service
WHERE Coalesce(rendrng_provdr_ref_Idn_Qual1,'') IS NOT IN ('') OR Coalesce(Rendering_Provider_Identifier1 ,'') IS NOT IN ('') 
UNION
SEL
Claim_GUID,
 'NA' as Payment_Guid,
 Service_GUID,
rendrng_provdr_ref_Idn_Qual2 AS Secn_Rendering_Provider_Id_Qlfr_Code,
Rendering_Provider_Identifier2 AS Secn_Rendering_Provider_Id,
 2 AS Secn_Rendering_Provider_Id_Line_Num
FROM  EDWPBS_Staging.remittance_service
WHERE Coalesce(rendrng_provdr_ref_Idn_Qual2,'') IS NOT IN ('') OR Coalesce(Rendering_Provider_Identifier2 ,'') IS NOT IN ('') 
UNION
SEL
Claim_GUID,
 'NA' as Payment_Guid,
 Service_GUID,
rendrng_provdr_ref_Idn_Qual3 AS Secn_Rendering_Provider_Id_Qlfr_Code,
Rendering_Provider_Identifier3 AS Secn_Rendering_Provider_Id,
 3 AS Secn_Rendering_Provider_Id_Line_Num
FROM  EDWPBS_Staging.remittance_service
WHERE Coalesce(rendrng_provdr_ref_Idn_Qual3,'') IS NOT IN ('') OR Coalesce(Rendering_Provider_Identifier3 ,'') IS NOT IN ('') 
UNION
SEL
Claim_GUID,
 'NA' as Payment_Guid,
 Service_GUID,
rendrng_provdr_ref_Idn_Qual4 AS Secn_Rendering_Provider_Id_Qlfr_Code,
Rendering_Provider_Identifier4 AS Secn_Rendering_Provider_Id,
 4 AS Secn_Rendering_Provider_Id_Line_Num
FROM  EDWPBS_Staging.remittance_service
WHERE Coalesce(rendrng_provdr_ref_Idn_Qual4,'') IS NOT IN ('') OR Coalesce(Rendering_Provider_Identifier4 ,'') IS NOT IN ('') 
UNION
SEL
Claim_GUID,
 'NA' as Payment_Guid,
 Service_GUID,
rendrng_provdr_ref_Idn_Qual5 AS Secn_Rendering_Provider_Id_Qlfr_Code,
Rendering_Provider_Identifier5 AS Secn_Rendering_Provider_Id,
 5 AS Secn_Rendering_Provider_Id_Line_Num
FROM  EDWPBS_Staging.remittance_service
WHERE Coalesce(rendrng_provdr_ref_Idn_Qual5,'') IS NOT IN ('') OR Coalesce(Rendering_Provider_Identifier5 ,'') IS NOT IN ('') 
UNION
SEL
Claim_GUID,
 'NA' as Payment_Guid,
 Service_GUID,
rendrng_provdr_ref_Idn_Qual6 AS Secn_Rendering_Provider_Id_Qlfr_Code,
Rendering_Provider_Identifier6 AS Secn_Rendering_Provider_Id,
 6 AS Secn_Rendering_Provider_Id_Line_Num
FROM  EDWPBS_Staging.remittance_service
WHERE Coalesce(rendrng_provdr_ref_Idn_Qual6,'') IS NOT IN ('') OR Coalesce(Rendering_Provider_Identifier6 ,'') IS NOT IN ('') 
UNION
SEL
Claim_GUID,
 'NA' as Payment_Guid,
 Service_GUID,
rendrng_provdr_ref_Idn_Qual7 AS Secn_Rendering_Provider_Id_Qlfr_Code,
Rendering_Provider_Identifier7 AS Secn_Rendering_Provider_Id,
 7 AS Secn_Rendering_Provider_Id_Line_Num
FROM  EDWPBS_Staging.remittance_service
WHERE Coalesce(rendrng_provdr_ref_Idn_Qual7,'') IS NOT IN ('') OR Coalesce(Rendering_Provider_Identifier7 ,'') IS NOT IN ('') 
UNION
SEL
Claim_GUID,
 'NA' as Payment_Guid,
 Service_GUID,
rendrng_provdr_ref_Idn_Qual8 AS Secn_Rendering_Provider_Id_Qlfr_Code,
Rendering_Provider_Identifier8 AS Secn_Rendering_Provider_Id,
 8 AS Secn_Rendering_Provider_Id_Line_Num
FROM  EDWPBS_Staging.remittance_service
WHERE Coalesce(rendrng_provdr_ref_Idn_Qual8,'') IS NOT IN ('') OR Coalesce(Rendering_Provider_Identifier8 ,'') IS NOT IN ('') 
UNION
SEL
Claim_GUID,
 'NA' as Payment_Guid,
 Service_GUID,
rendrng_provdr_ref_Idn_Qual9 AS Secn_Rendering_Provider_Id_Qlfr_Code,
Rendering_Provider_Identifier9 AS Secn_Rendering_Provider_Id,
 9 AS Secn_Rendering_Provider_Id_Line_Num
FROM  EDWPBS_Staging.remittance_service
WHERE Coalesce(rendrng_provdr_ref_Idn_Qual9,'') IS NOT IN ('') OR Coalesce(Rendering_Provider_Identifier9 ,'') IS NOT IN ('') 
UNION
SEL
Claim_GUID,
 'NA' as Payment_Guid,
 Service_GUID,
rendrng_provdr_ref_Idn_Qual10 AS Secn_Rendering_Provider_Id_Qlfr_Code,
Rendering_Providr_Identifier10 AS Secn_Rendering_Provider_Id,
 10 AS Secn_Rendering_Provider_Id_Line_Num
FROM  EDWPBS_Staging.remittance_service
WHERE Coalesce(rendrng_provdr_ref_Idn_Qual10,'') IS NOT IN ('') OR Coalesce(Rendering_Providr_Identifier10 ,'') IS NOT IN ('') 


 ) F 
 LEFT OUTER  JOIN EDWPBS.Ref_Secn_Remittance_Rendering_Provider RRAP ON 
F.Secn_Rendering_Provider_Id =RRAP.Secn_Rendering_Provider_Id AND
F.Secn_Rendering_Provider_Id_Qlfr_Code=RRAP.Secn_Rendering_Provider_Id_Qlfr_Code

"

export AC_ACT_SQL_STATEMENT="select 'J_EP_Junc_Remittance_Secn_Rendering_Prov_Service' || ',' || CAST(COUNT(*) AS VARCHAR(20)) || ',' as Source_String from EDWPBS.Junc_Remittance_Secn_Rendering_Prov where DW_Last_Update_Date_Time =(select max(Dw_Last_Update_Date_Time) from EDWPBS.Junc_Remittance_Secn_Rendering_Prov)"

#  @@END DMEXPRESS_EXPORTED_VARIABLES
#  End of Exported variables section
