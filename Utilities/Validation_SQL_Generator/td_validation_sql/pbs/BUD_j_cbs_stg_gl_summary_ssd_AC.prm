export AC_EXP_SQL_STATEMENT="SELECT 'CBS_STG_GL_SUMMARY_SSD' || ',' || CAST(COUNT(*) AS VARCHAR(20)) || ',' || CAST(SUM(CHARACTER_LENGTH(GLS.Scenario_Member)) AS VARCHAR(20)) || ',' || CAST(SUM(GLS.Jan_Amt) AS VARCHAR(20)) || ',' as SOURCE_STRING FROM (SELECT GLS.Account_Member, GLS.Organization_Member, GLS.Scenario_Member, GLS.Year_Member, GLS.Department_Member, CAST(SUM(Jan_Amt) AS DEC(18,2)) AS Jan_Amt FROM (SELECT CAST(('F' || GLS.GL_Account_Rollup_Group_Code || '_'|| CASE WHEN (GLS.Account_Type_Code = 4 AND GLS.GL_Account_Num BETWEEN 299999 AND 500000) THEN ('R' || GLS.GL_Sub_Account_Num) WHEN (GLS.Account_Type_Code = 6 AND GLS.GL_Account_Num BETWEEN 599999 AND 970000) THEN ('E' || GLS.GL_Sub_Account_Num) ELSE GLS.GL_Account_Num END) AS VARCHAR(80)) AS Account_Member, CAST('Z' || GLS.COID AS VARCHAR(80)) AS Organization_Member, GLS.Scenario_Member, CAST('Year_' || CAST(GLS.Year_Period AS VARCHAR(4)) AS VARCHAR(80)) AS Year_Member, CAST(COALESCE(GLS.Dept_Num, GLS.GL_Dept_Num) AS VARCHAR(80)) AS Department_Member, CASE WHEN GLS.Month_Period = 1 THEN GLS.Amount ELSE 0 END AS Jan_Amt FROM (SELECT GLS.COID, CAST('Actual' AS VARCHAR(80)) AS Scenario_Member, EXTRACT(MONTH FROM GLS.PE_Date) AS Month_Period, EXTRACT(YEAR FROM GLS.PE_Date) AS Year_Period, COA.Dept_Num, GLS.Gl_Dept_Num, GLS.Gl_Sub_Account_Num, (GLS.Gl_Dept_Num || GLS.Gl_Sub_Account_Num) AS GL_Account_Num, ZEROIFNULL(GLS.GL_CM_Actual) AS Amount, ACT.GL_Account_Rollup_Group_Code, COA.Account_Type_Code AS Account_Type_Code FROM EDWFS_Base_Views.GL_Summary GLS INNER JOIN EDWFS_Base_Views.GL_Coa COA ON GLS.Company_Code = COA.Company_Code AND GLS.COID = COA.COID AND GLS.GL_Dept_Num = COA.GL_Dept_Num AND GLS.GL_Sub_Account_Num = COA.GL_Sub_Account_Num INNER JOIN EDWFS_Base_Views.Gl_Coa_GL_Acct_Rollup ACT ON COA.Company_code = ACT.Company_Code AND COA.COID = ACT.COID AND COA.GL_Dept_Num = ACT.GL_Dept_Num AND COA.GL_Sub_Account_Num = ACT.GL_Sub_Account_Num AND CAST(ACT.GL_Account_Rollup_Group_Code AS INTEGER) > 99 AND ACT.GL_Account_Rollup_Set_Code <> 'FA' LEFT OUTER JOIN EDWFS_Base_Views.Department DPT ON COA.Company_Code = DPT.Company_Code AND COA.COID = DPT.COID AND COA.Dept_Num = DPT.Dept_Num AND DPT.Source_System_Code = 'Q' INNER JOIN EDWFS_Base_Views.Fact_Facility FAC ON GLS.COID = FAC.COID AND GLS.Company_Code = FAC.Company_Code WHERE GLS.PE_Date >= CAST((EXTRACT(YEAR FROM DATE) - 2 || '0101') AS DATE FORMAT 'yyyymmdd') AND GLS.PE_Date <> (SELECT MAX(PE_Date) AS PE_Date FROM EDWFS_Base_Views.GL_Summary_CM) AND COA.ACCOUNT_TYPE_CODE IN (4,5,6) AND AMOUNT <> 0 UNION ALL SELECT GLS.COID, CAST('Actual' AS VARCHAR(80)) AS Scenario_Member, EXTRACT(MONTH FROM GLS.PE_Date) AS Month_Period, EXTRACT(YEAR FROM GLS.PE_Date) AS Year_Period, COA.Dept_Num, GLS.Gl_Dept_Num, GLS.Gl_Sub_Account_Num, (GLS.Gl_Dept_Num || GLS.Gl_Sub_Account_Num) AS GL_Account_Num, ZEROIFNULL(GLS.GL_CM_Actual) AS Amount, ACT.GL_Account_Rollup_Group_Code, COA.Account_Type_Code AS Account_Type_Code FROM EDWFS_Base_Views.GL_Summary_CM GLS INNER JOIN EDWFS_Base_Views.GL_Coa COA ON GLS.Company_Code = COA.Company_Code AND GLS.COID = COA.COID AND GLS.GL_Dept_Num = COA.GL_Dept_Num AND GLS.GL_Sub_Account_Num = COA.GL_Sub_Account_Num INNER JOIN EDWFS_Base_Views.Gl_Coa_GL_Acct_Rollup ACT ON COA.Company_code = ACT.Company_Code AND COA.COID = ACT.COID AND COA.GL_Dept_Num = ACT.GL_Dept_Num AND COA.GL_Sub_Account_Num = ACT.GL_Sub_Account_Num AND CAST(ACT.GL_Account_Rollup_Group_Code AS INTEGER) > 99 AND ACT.GL_Account_Rollup_Set_Code <> 'FA' LEFT OUTER JOIN EDWFS_Base_Views.Department DPT ON COA.Company_Code = DPT.Company_Code AND COA.COID = DPT.COID AND COA.Dept_Num = DPT.Dept_Num AND DPT.Source_System_Code = 'Q' INNER JOIN EDWFS_Base_Views.Fact_Facility FAC ON GLS.COID = FAC.COID AND GLS.Company_Code = FAC.Company_Code WHERE GLS.PE_Date >= CAST((EXTRACT(YEAR FROM DATE) - 2 || '0101') AS DATE FORMAT 'yyyymmdd') AND COA.ACCOUNT_TYPE_CODE IN (4,5,6) AND Amount <> 0 UNION ALL SELECT GLS.COID, CAST('Current_Budget' AS VARCHAR(80)) AS Scenario_Member, EXTRACT(MONTH FROM GLS.PE_Date) AS Month_Period, EXTRACT(YEAR FROM GLS.PE_Date) AS Year_Period, COA.Dept_Num, GLS.Gl_Dept_Num, GLS.Gl_Sub_Account_Num, (GLS.Gl_Dept_Num || GLS.Gl_Sub_Account_Num) AS GL_Account_Num, ZEROIFNULL(GLS.GL_CM_Budget) AS Amount, ACT.GL_Account_Rollup_Group_Code, COA.Account_Type_Code AS Account_Type_Code FROM EDWFS_Base_Views.GL_Summary GLS INNER JOIN EDWFS_Base_Views.GL_Coa COA ON GLS.Company_Code = COA.Company_Code AND GLS.COID = COA.COID AND GLS.GL_Dept_Num = COA.GL_Dept_Num AND GLS.GL_Sub_Account_Num = COA.GL_Sub_Account_Num INNER JOIN EDWFS_Base_Views.Gl_Coa_GL_Acct_Rollup ACT ON COA.Company_code = ACT.Company_Code AND COA.COID = ACT.COID AND COA.GL_Dept_Num = ACT.GL_Dept_Num AND COA.GL_Sub_Account_Num = ACT.GL_Sub_Account_Num AND CAST(ACT.GL_Account_Rollup_Group_Code AS INTEGER) > 99 AND ACT.GL_Account_Rollup_Set_Code <> 'FA' LEFT OUTER JOIN EDWFS_Base_Views.Department DPT ON COA.Company_Code = DPT.Company_Code AND COA.COID = DPT.COID AND COA.Dept_Num = DPT.Dept_Num AND DPT.Source_System_Code = 'Q' INNER JOIN EDWFS_Base_Views.Fact_Facility FAC ON GLS.COID = FAC.COID AND GLS.Company_Code = FAC.Company_Code WHERE GLS.PE_Date >= CAST((EXTRACT(YEAR FROM DATE) - 2 || '0101') AS DATE FORMAT 'yyyymmdd') AND COA.ACCOUNT_TYPE_CODE IN (4,5,6) AND AMOUNT <> 0) GLS) GLS GROUP BY GLS.Account_Member, GLS.Organization_Member, GLS.Scenario_Member, GLS.Year_Member, GLS.Department_Member) GLS"
export JOBNAME='CBS_STG_GL_SUMMARY_SSD'
export AC_EXP_TOLERANCE_PERCENT=0
export AC_EXP_TOLERANCE_AMT=0
export AC_ACT_SQL_STATEMENT="SELECT 'CBS_STG_GL_SUMMARY_SSD' + ',' + CAST(Count(*) AS VARCHAR(20)) + ',' + CAST(SUM(LEN(GLS.Scenario)) AS VARCHAR(20)) + ',' + CAST(SUM(GLS.Jan) AS VARCHAR(20)) + ',' as SOURCE_STRING FROM dbo.Stg_GL_Summary GLS"